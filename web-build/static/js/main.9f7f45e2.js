(()=>{var e={35358:(e,t,a)=>{var s={"./af":17582,"./af.js":17582,"./ar":93042,"./ar-dz":54265,"./ar-dz.js":54265,"./ar-kw":92553,"./ar-kw.js":92553,"./ar-ly":85352,"./ar-ly.js":85352,"./ar-ma":67097,"./ar-ma.js":67097,"./ar-ps":76150,"./ar-ps.js":76150,"./ar-sa":84427,"./ar-sa.js":84427,"./ar-tn":7221,"./ar-tn.js":7221,"./ar.js":93042,"./az":60458,"./az.js":60458,"./be":17596,"./be.js":17596,"./bg":93830,"./bg.js":93830,"./bm":27044,"./bm.js":27044,"./bn":58573,"./bn-bd":13296,"./bn-bd.js":13296,"./bn.js":58573,"./bo":25614,"./bo.js":25614,"./br":62041,"./br.js":62041,"./bs":91786,"./bs.js":91786,"./ca":75833,"./ca.js":75833,"./cs":52711,"./cs.js":52711,"./cv":71036,"./cv.js":71036,"./cy":84977,"./cy.js":84977,"./da":8770,"./da.js":8770,"./de":67342,"./de-at":81566,"./de-at.js":81566,"./de-ch":87544,"./de-ch.js":87544,"./de.js":67342,"./dv":82875,"./dv.js":82875,"./el":78536,"./el.js":78536,"./en-au":38617,"./en-au.js":38617,"./en-ca":79227,"./en-ca.js":79227,"./en-gb":59754,"./en-gb.js":59754,"./en-ie":37217,"./en-ie.js":37217,"./en-il":85418,"./en-il.js":85418,"./en-in":80800,"./en-in.js":80800,"./en-nz":67299,"./en-nz.js":67299,"./en-sg":76305,"./en-sg.js":76305,"./eo":8673,"./eo.js":8673,"./es":71301,"./es-do":3187,"./es-do.js":3187,"./es-mx":48223,"./es-mx.js":48223,"./es-us":37634,"./es-us.js":37634,"./es.js":71301,"./et":4976,"./et.js":4976,"./eu":11847,"./eu.js":11847,"./fa":74372,"./fa.js":74372,"./fi":41628,"./fi.js":41628,"./fil":56802,"./fil.js":56802,"./fo":42874,"./fo.js":42874,"./fr":9853,"./fr-ca":87170,"./fr-ca.js":87170,"./fr-ch":22825,"./fr-ch.js":22825,"./fr.js":9853,"./fy":68876,"./fy.js":68876,"./ga":93533,"./ga.js":93533,"./gd":82770,"./gd.js":82770,"./gl":98602,"./gl.js":98602,"./gom-deva":63059,"./gom-deva.js":63059,"./gom-latn":48212,"./gom-latn.js":48212,"./gu":23409,"./gu.js":23409,"./he":17210,"./he.js":17210,"./hi":4750,"./hi.js":4750,"./hr":51315,"./hr.js":51315,"./hu":47626,"./hu.js":47626,"./hy-am":91317,"./hy-am.js":91317,"./id":26892,"./id.js":26892,"./is":97577,"./is.js":97577,"./it":57628,"./it-ch":3046,"./it-ch.js":3046,"./it.js":57628,"./ja":92504,"./ja.js":92504,"./jv":25917,"./jv.js":25917,"./ka":64513,"./ka.js":64513,"./kk":94935,"./kk.js":94935,"./km":96661,"./km.js":96661,"./kn":89964,"./kn.js":89964,"./ko":98067,"./ko.js":98067,"./ku":61165,"./ku-kmr":85158,"./ku-kmr.js":85158,"./ku.js":61165,"./ky":11177,"./ky.js":11177,"./lb":2967,"./lb.js":2967,"./lo":81972,"./lo.js":81972,"./lt":58469,"./lt.js":58469,"./lv":33155,"./lv.js":33155,"./me":87935,"./me.js":87935,"./mi":74483,"./mi.js":74483,"./mk":32501,"./mk.js":32501,"./ml":73120,"./ml.js":73120,"./mn":20266,"./mn.js":20266,"./mr":19406,"./mr.js":19406,"./ms":80109,"./ms-my":90864,"./ms-my.js":90864,"./ms.js":80109,"./mt":22904,"./mt.js":22904,"./my":44067,"./my.js":44067,"./nb":21301,"./nb.js":21301,"./ne":81152,"./ne.js":81152,"./nl":76735,"./nl-be":97761,"./nl-be.js":97761,"./nl.js":76735,"./nn":37569,"./nn.js":37569,"./oc-lnc":20833,"./oc-lnc.js":20833,"./pa-in":3044,"./pa-in.js":3044,"./pl":34249,"./pl.js":34249,"./pt":87585,"./pt-br":26826,"./pt-br.js":26826,"./pt.js":87585,"./ro":62526,"./ro.js":62526,"./ru":62204,"./ru.js":62204,"./sd":43270,"./sd.js":43270,"./se":61541,"./se.js":61541,"./si":71921,"./si.js":71921,"./sk":49935,"./sk.js":49935,"./sl":46254,"./sl.js":46254,"./sq":59897,"./sq.js":59897,"./sr":42496,"./sr-cyrl":11135,"./sr-cyrl.js":11135,"./sr.js":42496,"./ss":32215,"./ss.js":32215,"./sv":84716,"./sv.js":84716,"./sw":50803,"./sw.js":50803,"./ta":31538,"./ta.js":31538,"./te":2302,"./te.js":2302,"./tet":25280,"./tet.js":25280,"./tg":14100,"./tg.js":14100,"./th":95385,"./th.js":95385,"./tk":736,"./tk.js":736,"./tl-ph":79726,"./tl-ph.js":79726,"./tlh":41873,"./tlh.js":41873,"./tr":36463,"./tr.js":36463,"./tzl":27491,"./tzl.js":27491,"./tzm":29500,"./tzm-latn":80196,"./tzm-latn.js":80196,"./tzm.js":29500,"./ug-cn":91287,"./ug-cn.js":91287,"./uk":35341,"./uk.js":35341,"./ur":36246,"./ur.js":36246,"./uz":55550,"./uz-latn":77254,"./uz-latn.js":77254,"./uz.js":55550,"./vi":78796,"./vi.js":78796,"./x-pseudo":22736,"./x-pseudo.js":22736,"./yo":28621,"./yo.js":28621,"./zh-cn":67601,"./zh-cn.js":67601,"./zh-hk":39053,"./zh-hk.js":39053,"./zh-mo":71248,"./zh-mo.js":71248,"./zh-tw":74725,"./zh-tw.js":74725};function r(e){var t=l(e);return a(t)}function l(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}r.keys=function(){return Object.keys(s)},r.resolve=l,e.exports=r,r.id=35358},68274:(e,t,a)=>{"use strict";var s=a(42907),r=a(93806),l=a(23049),o=a(35708),n=a(73929),d=a(6283),i=a(78833),c=a(31412),u=a(53073),m=a(43658),x=a(72914),f=a(36665),g=a(2772),h=a(16773),p=a(78264),b=a(98587),y=a(8412),j=a(40864),N=a(7908),w=a(98069),S=a(9226),F=a(47640);const C=console.error;console.error=(...e)=>{const t=e.join(" ");t.includes("NSURLErrorDomain")||t.includes("error -1013")||t.includes("The operation couldn't be completed")||t.includes("API ERROR")&&t.includes("Network error")?console.log("[Firebase] Transient network error suppressed:",t):C(...e)};const v={apiKey:"AIzaSyCJcdvMnw-oqj7Ru1ggmlVC7MNA2un3b78",authDomain:"precast-qc-tools-web-app.firebaseapp.com",projectId:"precast-qc-tools-web-app",storageBucket:"precast-qc-tools-web-app.firebasestorage.app",messagingSenderId:"419696432513",appId:"1:419696432513:web:5aca59aac0d4c753688480"};let A,P,T;A=0===(0,N.getApps)().length?(0,N.initializeApp)(v):(0,N.getApp)(),P=(0,w.getAuth)(A);try{T=(0,j.initializeFirestore)(A,{localCache:(0,j.persistentLocalCache)({tabManager:(0,j.persistentMultipleTabManager)()})})}catch(qa){console.warn("Firestore already initialized:",qa.message),T=(0,j.getFirestore)(A)}(0,S.getStorage)(A);class E{unsubscribe=null;constructor(e){this.collectionName=e}async fetchAll(){try{const e=(0,j.query)((0,j.collection)(T,this.collectionName));return(await(0,j.getDocs)(e)).docs.map(e=>Object.assign({id:e.id},e.data()))}catch(qa){return console.error(`Error fetching ${this.collectionName}:`,qa),[]}}subscribe(e){const t=(0,j.query)((0,j.collection)(T,this.collectionName));return this.unsubscribe=(0,j.onSnapshot)(t,t=>{const a=t.docs.map(e=>Object.assign({id:e.id},e.data()));e(a)},e=>{console.error(`Error subscribing to ${this.collectionName}:`,e)}),()=>this.unsubscribe?.()}async set(e,t){try{const a=this.removeUndefinedFields(t),s=(0,j.doc)(T,this.collectionName,e);await(0,j.setDoc)(s,Object.assign({},a,{updatedAt:(0,j.serverTimestamp)()}),{merge:!0})}catch(qa){throw console.error(`Error setting document in ${this.collectionName}:`,qa),qa}}removeUndefinedFields(e){if(null===e||void 0===e)return e;if(Array.isArray(e))return e.map(e=>this.removeUndefinedFields(e));if("object"===typeof e){const t={};for(const a in e)if(e.hasOwnProperty(a)){const s=e[a];void 0!==s&&(t[a]=this.removeUndefinedFields(s))}return t}return e}async delete(e){try{const t=(0,j.doc)(T,this.collectionName,e);await(0,j.deleteDoc)(t)}catch(qa){throw console.error(`Error deleting document from ${this.collectionName}:`,qa),qa}}cleanup(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}}function z(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}const B=new E("aggregateLibrary"),D=(0,y.create)()((e,t)=>({aggregates:{},loading:!1,initialized:!1,initialize:async()=>{if(!t().initialized){e({loading:!0});try{const t=(await B.fetchAll()).reduce((e,t)=>(e[t.id]=t,e),{});e({aggregates:t,loading:!1,initialized:!0}),B.subscribe(t=>{const a=t.reduce((e,t)=>(e[t.id]=t,e),{});e({aggregates:a})})}catch(qa){console.error("Failed to initialize aggregates:",qa),e({loading:!1,initialized:!0})}}},addAggregate:async t=>{const a=Object.assign({},t,{createdAt:Date.now(),updatedAt:Date.now()});e(e=>({aggregates:Object.assign({},e.aggregates,{[t.id]:a})}));try{await B.set(t.id,a)}catch(qa){throw e(e=>{const a=e.aggregates,s=t.id;return{aggregates:(0,b.default)(a,[s].map(z))}}),qa}},updateAggregate:async(a,s)=>{const r=t().aggregates[a];if(!r)return;const l=Object.assign({},r,s,{updatedAt:Date.now()});e(e=>({aggregates:Object.assign({},e.aggregates,{[a]:l})}));try{await B.set(a,l)}catch(qa){throw e(e=>({aggregates:Object.assign({},e.aggregates,{[a]:r})})),qa}},deleteAggregate:async a=>{const s=t().aggregates[a];e(e=>{const t=e.aggregates;return{aggregates:(0,b.default)(t,[a].map(z))}});try{await B.delete(a)}catch(qa){throw s&&e(e=>({aggregates:Object.assign({},e.aggregates,{[a]:s})})),qa}},getAggregate:e=>t().aggregates[e],getAllAggregates:()=>{const e=t().aggregates;return Object.values(e).sort((e,t)=>e.name.localeCompare(t.name))},searchAggregates:e=>{const a=t().getAllAggregates(),s=e.toLowerCase();return a.filter(e=>e.name.toLowerCase().includes(s)||e.source?.toLowerCase().includes(s)||e.stockpileNumber?.toLowerCase().includes(s)||e.colorFamily?.toLowerCase().includes(s))},isAggregateComplete:e=>{const a=t().aggregates[e];return!!a&&(e=>{const t=!(!e.name||!e.type||void 0===e.dryRoddedUnitWeight||void 0===e.percentVoids||void 0===e.absorption||void 0===e.specificGravityBulkSSD||void 0===e.specificGravityBulkDry||void 0===e.specificGravityApparent);return"Fine"===e.type?t&&void 0!==e.finenessModulus:t})(a)},toggleFavorite:async a=>{const s=t().aggregates[a];if(!s)return;const r=Object.assign({},s,{isFavorite:!s.isFavorite,updatedAt:Date.now()});e(e=>({aggregates:Object.assign({},e.aggregates,{[a]:r})}));try{await B.set(a,r)}catch(qa){throw e(e=>({aggregates:Object.assign({},e.aggregates,{[a]:s})})),qa}},getFavorites:()=>t().getAllAggregates().filter(e=>e.isFavorite),trackAccess:async a=>{const s=t().aggregates[a];if(!s)return;const r=Object.assign({},s,{lastAccessedAt:Date.now()});e(e=>({aggregates:Object.assign({},e.aggregates,{[a]:r})}));try{await B.set(a,r)}catch(qa){console.error("Failed to track access:",qa)}},getRecentlyUsed:(e=5)=>t().getAllAggregates().filter(e=>e.lastAccessedAt).sort((e,t)=>(t.lastAccessedAt||0)-(e.lastAccessedAt||0)).slice(0,e),duplicateAggregate:async e=>{const a=t().aggregates[e];if(!a)return;const s=Object.assign({},a,{id:Date.now().toString(),name:`${a.name} (Copy)`,isFavorite:!1,lastAccessedAt:void 0,createdAt:Date.now(),updatedAt:Date.now()});return await t().addAggregate(s),s}}));function k(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}const I=new E("admixLibrary"),L=(0,y.create)()((e,t)=>({admixes:{},loading:!1,initialized:!1,initialize:async()=>{if(!t().initialized){e({loading:!0});try{const t=(await I.fetchAll()).reduce((e,t)=>(e[t.id]=t,e),{});e({admixes:t,loading:!1,initialized:!0}),I.subscribe(t=>{const a=t.reduce((e,t)=>(e[t.id]=t,e),{});e({admixes:a})})}catch(qa){console.error("Failed to initialize admixes:",qa),e({loading:!1,initialized:!0})}}},addAdmix:async t=>{const a=Object.assign({},t,{createdAt:Date.now(),updatedAt:Date.now()});e(e=>({admixes:Object.assign({},e.admixes,{[t.id]:a})}));try{await I.set(t.id,a)}catch(qa){throw e(e=>{const a=e.admixes,s=t.id;return{admixes:(0,b.default)(a,[s].map(k))}}),qa}},updateAdmix:async(a,s)=>{const r=t().admixes[a];if(!r)return;const l=Object.assign({},r,s,{updatedAt:Date.now()});e(e=>({admixes:Object.assign({},e.admixes,{[a]:l})}));try{await I.set(a,l)}catch(qa){throw e(e=>({admixes:Object.assign({},e.admixes,{[a]:r})})),qa}},deleteAdmix:async a=>{const s=t().admixes[a];e(e=>{const t=e.admixes;return{admixes:(0,b.default)(t,[a].map(k))}});try{await I.delete(a)}catch(qa){throw s&&e(e=>({admixes:Object.assign({},e.admixes,{[a]:s})})),qa}},getAdmix:e=>t().admixes[e],getAllAdmixes:()=>{const e=t().admixes;return Object.values(e).sort((e,t)=>e.name.localeCompare(t.name))},searchAdmixes:e=>{const a=t().getAllAdmixes(),s=e.toLowerCase();return a.filter(e=>e.name.toLowerCase().includes(s)||e.manufacturer.toLowerCase().includes(s)||e.class.toLowerCase().includes(s)||e.salesRepName?.toLowerCase().includes(s))},isAdmixComplete:e=>{const a=t().admixes[e];return!!a&&(e=>!!(e.name&&e.manufacturer&&e.class&&void 0!==e.specificGravity))(a)},toggleFavorite:async a=>{const s=t().admixes[a];if(!s)return;const r=Object.assign({},s,{isFavorite:!s.isFavorite,updatedAt:Date.now()});e(e=>({admixes:Object.assign({},e.admixes,{[a]:r})}));try{await I.set(a,r)}catch(qa){throw e(e=>({admixes:Object.assign({},e.admixes,{[a]:s})})),qa}},getFavorites:()=>t().getAllAdmixes().filter(e=>e.isFavorite),trackAccess:async a=>{const s=t().admixes[a];if(!s)return;const r=Object.assign({},s,{lastAccessedAt:Date.now()});e(e=>({admixes:Object.assign({},e.admixes,{[a]:r})}));try{await I.set(a,r)}catch(qa){console.error("Failed to track access:",qa)}},getRecentlyUsed:(e=5)=>t().getAllAdmixes().filter(e=>e.lastAccessedAt).sort((e,t)=>(t.lastAccessedAt||0)-(e.lastAccessedAt||0)).slice(0,e),duplicateAdmix:async e=>{const a=t().admixes[e];if(!a)return;const s=Object.assign({},a,{id:Date.now().toString(),name:`${a.name} (Copy)`,isFavorite:!1,lastAccessedAt:void 0,createdAt:Date.now(),updatedAt:Date.now()});return await t().addAdmix(s),s}}));function R(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}const $=new E("contacts"),W=(0,y.create)()((e,t)=>({contacts:{},loading:!1,initialized:!1,initialize:async()=>{if(!t().initialized){e({loading:!0});try{const t=(await $.fetchAll()).reduce((e,t)=>(e[t.id]=t,e),{});e({contacts:t,loading:!1,initialized:!0}),$.subscribe(t=>{const a=t.reduce((e,t)=>(e[t.id]=t,e),{});e({contacts:a})})}catch(qa){console.error("Failed to initialize contacts:",qa),e({loading:!1,initialized:!0})}}},addContact:async t=>{const a=Object.assign({},t,{createdAt:Date.now(),updatedAt:Date.now()});e(e=>({contacts:Object.assign({},e.contacts,{[t.id]:a})}));try{await $.set(t.id,a)}catch(qa){throw e(e=>{const a=e.contacts,s=t.id;return{contacts:(0,b.default)(a,[s].map(R))}}),qa}},updateContact:async(a,s)=>{const r=t().contacts[a];if(!r)return;const l=Object.assign({},r,s,{updatedAt:Date.now()});e(e=>({contacts:Object.assign({},e.contacts,{[a]:l})}));try{await $.set(a,l)}catch(qa){throw e(e=>({contacts:Object.assign({},e.contacts,{[a]:r})})),qa}},deleteContact:async a=>{const s=t().contacts[a];e(e=>{const t=e.contacts;return{contacts:(0,b.default)(t,[a].map(R))}});try{await $.delete(a)}catch(qa){throw s&&e(e=>({contacts:Object.assign({},e.contacts,{[a]:s})})),qa}},getContact:e=>t().contacts[e],getAllContacts:()=>{const e=t().contacts;return Object.values(e).sort((e,t)=>e.name.localeCompare(t.name))},searchContacts:e=>{const a=t().getAllContacts(),s=e.toLowerCase();return a.filter(e=>e.name.toLowerCase().includes(s)||e.company?.toLowerCase().includes(s)||e.role?.toLowerCase().includes(s)||e.email?.toLowerCase().includes(s))},isContactComplete:e=>{const a=t().contacts[e];return!!a&&(e=>!!(e.name&&e.phone&&e.email))(a)},toggleFavorite:async a=>{const s=t().contacts[a];if(!s)return;const r=Object.assign({},s,{isFavorite:!s.isFavorite,updatedAt:Date.now()});e(e=>({contacts:Object.assign({},e.contacts,{[a]:r})}));try{await $.set(a,r)}catch(qa){throw e(e=>({contacts:Object.assign({},e.contacts,{[a]:s})})),qa}},getFavorites:()=>t().getAllContacts().filter(e=>e.isFavorite),trackAccess:async a=>{const s=t().contacts[a];if(!s)return;const r=Object.assign({},s,{lastAccessedAt:Date.now()});e(e=>({contacts:Object.assign({},e.contacts,{[a]:r})}));try{await $.set(a,r)}catch(qa){console.error("Failed to track access:",qa)}},getRecentlyUsed:(e=5)=>t().getAllContacts().filter(e=>e.lastAccessedAt).sort((e,t)=>(t.lastAccessedAt||0)-(e.lastAccessedAt||0)).slice(0,e),duplicateContact:async e=>{const a=t().contacts[e];if(!a)return;const s=Object.assign({},a,{id:Date.now().toString(),name:`${a.name} (Copy)`,isFavorite:!1,lastAccessedAt:void 0,createdAt:Date.now(),updatedAt:Date.now()});return await t().addContact(s),s}}));var O=a(11377);const M=async()=>{try{return await(0,w.signOut)(P),{error:null}}catch(qa){return{error:qa.message||"Sign out failed"}}},U="users",H=async e=>{try{const t=(0,j.doc)(T,U,e),a=await(0,j.getDoc)(t);return a.exists()?{user:a.data(),error:null}:{user:null,error:"User profile not found"}}catch(qa){return{user:null,error:qa.message||"Failed to get user profile"}}},V=e=>{console.log("[AuthStore] firebaseUserToAppUser - RAW INPUT:",JSON.stringify(e,null,2)),console.log("[AuthStore] firebaseUserToAppUser - firebaseUser.uid value:",e.uid);const t=e.name.split(" "),a={id:String(e.uid),email:String(e.email),firstName:String(t[0]||""),lastName:String(t.slice(1).join(" ")||""),role:e.role,status:e.status,isTemporaryPassword:Boolean(e.needsPasswordChange||!1),createdAt:e.createdAt instanceof Date?e.createdAt.getTime():e.createdAt.toMillis()};return console.log("[AuthStore] firebaseUserToAppUser - CREATED USER:",JSON.stringify(a,null,2)),console.log("[AuthStore] firebaseUserToAppUser - user.id directly:",a.id),console.log("[AuthStore] firebaseUserToAppUser - typeof user.id:",typeof a.id),console.log("[AuthStore] firebaseUserToAppUser - Object.keys(user):",Object.keys(a)),console.log("[AuthStore] firebaseUserToAppUser - user hasOwnProperty id:",a.hasOwnProperty("id")),a},G=(0,y.create)()((0,O.persist)((e,t)=>({currentUser:null,users:{},pendingRequests:[],currentSession:null,isInitialized:!1,initializeAuth:async()=>{var a;console.log("[AuthStore] initializeAuth - Starting..."),a=async a=>{if(console.log("[AuthStore] onAuthStateChange - Firebase user:",a?.uid,a?.email),a)try{const{user:s,error:r}=await H(a.uid);if(console.log("[AuthStore] onAuthStateChange - Profile fetched:",s?.uid,s?.email),s&&!r){const r=V(s);console.log("[AuthStore] onAuthStateChange - Setting currentUser to:",JSON.stringify(r,null,2)),e({currentUser:r,currentSession:a.uid}),console.log("[AuthStore] onAuthStateChange - State after set:",JSON.stringify(t().currentUser,null,2))}else console.warn("Could not fetch user profile from Firestore:",r),console.warn("Firestore may be offline or inaccessible. User will remain signed in."),e({currentUser:null,currentSession:null}),await M()}catch(s){console.error("Error in auth state change:",s),e({currentUser:null,currentSession:null})}else e({currentUser:null,currentSession:null})},(0,w.onAuthStateChanged)(P,a),e({isInitialized:!0})},setCurrentUser:t=>{e({currentUser:t})},login:async(a,s)=>{try{const{user:r,error:l}=await(async(e,t)=>{try{return{user:(await(0,w.signInWithEmailAndPassword)(P,e,t)).user,error:null}}catch(l){let t="Login failed";return"auth/user-not-found"===l.code||"auth/wrong-password"===l.code?t="Invalid email or password":"auth/too-many-requests"===l.code?t="Too many failed attempts. Please try again later":"auth/network-request-failed"===l.code&&(t="Network error. Please check your connection"),{user:null,error:t}}})(a,s);if(l||!r)return{success:!1,error:l||"Login failed"};const{user:o,error:n}=await H(r.uid);if(n||!o)return await M(),{success:!1,error:"User profile not found. Please contact an administrator."};if("pending"===o.status)return await M(),{success:!1,error:"Your account is pending approval. Please wait for an administrator to approve your access."};if("rejected"===o.status)return await M(),{success:!1,error:"Your access request was denied. Please contact an administrator."};const d=V(o);return console.log("[AuthStore] login - Setting currentUser to:",JSON.stringify(d,null,2)),e({currentUser:d,currentSession:r.uid}),console.log("[AuthStore] login - Verifying state after set:",JSON.stringify(t().currentUser,null,2)),{success:!0,requiresPasswordChange:d.isTemporaryPassword}}catch(qa){return{success:!1,error:qa.message||"Login failed"}}},logout:async()=>{await M(),e({currentUser:null,currentSession:null})},requestAccess:async e=>{try{const{firstName:t,lastName:a,email:s,company:r}=e,l=`${t} ${a}`,{user:o,error:n}=await(async(e,t)=>{try{return{user:(await(0,w.createUserWithEmailAndPassword)(P,e,t)).user,error:null}}catch(qa){return{user:null,error:qa.message||"Registration failed"}}})(s,Math.random().toString(36).slice(-8)+Math.random().toString(36).slice(-8));if(n||!o)return{success:!1,requestId:"",error:n||"Failed to create user account"};const{error:d}=await(async(e,t)=>{try{const a=(0,j.doc)(T,U,e);return await(0,j.setDoc)(a,Object.assign({},t,{uid:e,createdAt:(0,j.serverTimestamp)(),updatedAt:(0,j.serverTimestamp)()})),{error:null}}catch(qa){return{error:qa.message||"Failed to create user profile"}}})(o.uid,{email:s,name:l,role:"user",status:"pending",company:r,needsPasswordChange:!0});return d?{success:!1,requestId:"",error:d}:(await M(),console.log("\ud83d\udce7 Access request submitted for:",s),console.log("Admin needs to approve this user in the Admin Approval screen"),{success:!0,requestId:o.uid})}catch(qa){return{success:!1,requestId:"",error:qa.message||"Failed to submit access request"}}},approveRequest:async(e,t)=>{try{const{error:a}=await(async(e,t="user")=>{try{const a=(0,j.doc)(T,U,e);return await(0,j.updateDoc)(a,{status:"approved",role:t,updatedAt:(0,j.serverTimestamp)()}),{error:null}}catch(qa){return{error:qa.message||"Failed to approve user"}}})(e,"user");if(a)return{success:!1,error:a};const{user:s}=await H(e);return s&&(console.log("\ud83d\udce7 User approved:",s.email),console.log("Temporary password:",t),console.log("NOTE: In production, this would be sent via email")),{success:!0}}catch(qa){return{success:!1,error:qa.message||"Failed to approve request"}}},denyRequest:async e=>{try{const{error:t}=await(async e=>{try{const t=(0,j.doc)(T,U,e);return await(0,j.updateDoc)(t,{status:"rejected",updatedAt:(0,j.serverTimestamp)()}),{error:null}}catch(t){return{error:t.message||"Failed to reject user"}}})(e);return t?{success:!1,error:t}:{success:!0}}catch(qa){return{success:!1,error:qa.message||"Failed to deny request"}}},changePassword:async a=>{try{const{currentUser:a}=t();if(!a)return{success:!1,error:"Not logged in"};const{error:s}=await(async(e,t)=>{try{const a=(0,j.doc)(T,U,e);return await(0,j.updateDoc)(a,Object.assign({},t,{updatedAt:(0,j.serverTimestamp)()})),{error:null}}catch(s){return{error:s.message||"Failed to update user profile"}}})(a.id,{needsPasswordChange:!1});if(s)return{success:!1,error:s};const r=Object.assign({},a,{isTemporaryPassword:!1});return e({currentUser:r}),{success:!0}}catch(qa){return{success:!1,error:qa.message||"Failed to change password"}}},getPendingRequests:async()=>{try{const{requests:e,error:t}=await(async()=>{try{const e=(0,j.query)((0,j.collection)(T,U),(0,j.where)("status","==","pending")),t=await(0,j.getDocs)(e),a=[];return t.forEach(e=>{a.push(e.data())}),{requests:a,error:null}}catch(t){return{requests:[],error:t.message||"Failed to get access requests"}}})();return t?(console.error("Failed to get pending requests:",t),[]):e.map(e=>({id:e.uid,email:e.email,firstName:e.name.split(" ")[0]||"",lastName:e.name.split(" ").slice(1).join(" ")||"",company:e.company||"",requestedAt:e.createdAt instanceof Date?e.createdAt.getTime():e.createdAt.toMillis(),status:"rejected"===e.status?"denied":e.status}))}catch(qa){return console.error("Failed to get pending requests:",qa),[]}}}),{name:"precast-auth-storage",storage:(0,O.createJSONStorage)(()=>F.default),partialize:e=>{const t=e.currentUser?{id:e.currentUser.id,email:e.currentUser.email,firstName:e.currentUser.firstName,lastName:e.currentUser.lastName,role:e.currentUser.role,status:e.currentUser.status,isTemporaryPassword:e.currentUser.isTemporaryPassword,createdAt:e.currentUser.createdAt}:null,a={currentUser:t,currentSession:e.currentSession};return console.log("[AuthStore] partialize - Saving state:",a),console.log("[AuthStore] partialize - currentUser.id:",t?.id),console.log("[AuthStore] partialize - Stringified:",JSON.stringify(a,null,2)),a},onRehydrateStorage:()=>(e,t)=>{console.log("[AuthStore] onRehydrateStorage - Rehydrated state:",{currentUser:e?.currentUser,currentSession:e?.currentSession,error:t}),e?.currentUser&&(console.log("[AuthStore] onRehydrateStorage - Current user ID:",e.currentUser.id),console.log("[AuthStore] onRehydrateStorage - typeof id:",typeof e.currentUser.id),console.log("[AuthStore] onRehydrateStorage - has id property:","id"in e.currentUser),console.log("[AuthStore] onRehydrateStorage - Current user FULL:",JSON.stringify(e.currentUser,null,2)),e.currentUser.id&&""!==e.currentUser.id&&"undefined"!==e.currentUser.id||(console.warn("[AuthStore] Migration: currentUser has invalid id field:",e.currentUser.id),console.warn("[AuthStore] Migration: Clearing auth state to force re-authentication"),F.default.removeItem("precast-auth-storage").then(()=>console.log("[AuthStore] Migration: Storage cleared")).catch(e=>console.error("[AuthStore] Migration: Failed to clear storage:",e)),M().then(()=>console.log("[AuthStore] Migration: Signed out from Firebase")).catch(e=>console.error("[AuthStore] Migration: Failed to sign out:",e))))}}));var q=a(20530);const Y=async(e,t,a)=>{let s=0;for(let r=0;r<t.length;r+=500){const l=(0,j.writeBatch)(T),o=t.slice(r,r+500);for(const t of o){const r=t.id||(0,j.doc)((0,j.collection)(T,e)).id,o=(0,j.doc)(T,e,r),n=Object.assign({},t,{importedAt:(0,j.serverTimestamp)(),importedBy:a,createdAt:t.createdAt?j.Timestamp.fromMillis(t.createdAt):(0,j.serverTimestamp)(),updatedAt:t.updatedAt?j.Timestamp.fromMillis(t.updatedAt):(0,j.serverTimestamp)()});l.set(o,n,{merge:!0}),s++}await l.commit()}return s},_=async(e,t)=>{const a=(0,j.doc)(T,"yardLocations","main");await(0,j.setDoc)(a,{yardLocations:e.yardLocations||[],yardedPieces:e.yardedPieces||[],importedAt:(0,j.serverTimestamp)(),importedBy:t,updatedAt:(0,j.serverTimestamp)()},{merge:!0})};var J=a(35111);function Q({onBack:e}){const t=(0,i.useSafeAreaInsets)(),[a,s]=(0,f.useState)(""),[r,l]=(0,f.useState)(!1),[c,u]=(0,f.useState)(null),m=G(e=>e.currentUser);return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(n.default,{className:"bg-white border-b border-gray-200",style:{paddingTop:t.top},children:(0,J.jsx)(n.default,{className:"flex-row items-center justify-between px-4 py-3",children:(0,J.jsxs)(o.default,{onPress:e,className:"flex-row items-center active:opacity-50",children:[(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#1f2937"}),(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 ml-2",children:"Import Data"})]})})}),(0,J.jsx)(g.default,{className:"flex-1",children:(0,J.jsxs)(n.default,{className:"p-4",children:[(0,J.jsx)(n.default,{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"document-text",size:20,color:"#3b82f6"}),(0,J.jsxs)(n.default,{className:"flex-1 ml-3",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-blue-900 mb-1",children:"Import Instructions"}),(0,J.jsx)(d.default,{className:"text-sm text-blue-800",children:"Paste your exported JSON data below. This will import strand patterns, products, materials, projects, and contacts to Firebase."})]})]})}),(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-900 mb-2",children:"JSON Data"}),(0,J.jsx)(h.default,{value:a,onChangeText:s,placeholder:"Paste your JSON export here...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",multiline:!0,numberOfLines:10,className:"bg-white border border-gray-300 rounded-lg p-3 text-sm font-mono text-gray-900 mb-4",style:{minHeight:200,textAlignVertical:"top"},editable:!r}),(0,J.jsx)(o.default,{onPress:async()=>{if(!a.trim())return void alert("Please paste your JSON data");const e=P.currentUser;if(!e||!m)return void alert("You must be logged in to import data");const t=(e=>{try{const t=JSON.parse(e);return"object"!==typeof t||null===t?{valid:!1,error:"Invalid JSON structure"}:t.strandPatterns&&t.strandPatterns.length>0||t.products&&t.products.length>0||t.strandLibrary&&t.strandLibrary.length>0||t.aggregateLibrary&&t.aggregateLibrary.length>0||t.admixLibrary&&t.admixLibrary.length>0||t.projects&&t.projects.length>0||t.contacts&&t.contacts.length>0||t.qualityLogs&&t.qualityLogs.length>0||t.pourSchedules&&t.pourSchedules.length>0||t.yardLocations?{valid:!0,data:t}:{valid:!1,error:"No data found to import"}}catch(qa){return{valid:!1,error:`Invalid JSON: ${qa.message}`}}})(a);if(!t.valid)return void alert("Invalid Data: "+(t.error||"Invalid JSON structure"));if(confirm("This will import the data to Firebase. Existing data with the same IDs will be merged. Continue?")){l(!0),u(null);try{const a=await(async(e,t)=>{try{const a={strandPatterns:0,products:0,strandLibrary:0,aggregateLibrary:0,admixLibrary:0,projects:0,contacts:0,qualityLogs:0,pourSchedules:0,yardLocations:0};return e.strandPatterns&&e.strandPatterns.length>0&&(a.strandPatterns=await Y("strandPatterns",e.strandPatterns,t)),e.products&&e.products.length>0&&(a.products=await Y("products",e.products,t)),e.strandLibrary&&e.strandLibrary.length>0&&(a.strandLibrary=await Y("strandLibrary",e.strandLibrary,t)),e.aggregateLibrary&&e.aggregateLibrary.length>0&&(a.aggregateLibrary=await Y("aggregateLibrary",e.aggregateLibrary,t)),e.admixLibrary&&e.admixLibrary.length>0&&(a.admixLibrary=await Y("admixLibrary",e.admixLibrary,t)),e.projects&&e.projects.length>0&&(a.projects=await Y("projects",e.projects,t)),e.contacts&&e.contacts.length>0&&(a.contacts=await Y("contacts",e.contacts,t)),e.qualityLogs&&e.qualityLogs.length>0&&(a.qualityLogs=await Y("qualityLogs",e.qualityLogs,t)),e.pourSchedules&&e.pourSchedules.length>0&&(a.pourSchedules=await Y("pourSchedules",e.pourSchedules,t)),e.yardLocations&&(await _(e.yardLocations,t),a.yardLocations=1),{success:!0,imported:a}}catch(qa){return console.error("Import error:",qa),{success:!1,error:qa.message||"Import failed"}}})(t.data,e.uid);u(a),a.success?(alert("Data imported successfully!"),s("")):alert("Import Failed: "+(a.error||"Unknown error"))}catch(qa){alert("Error: "+(qa.message||"Import failed"))}finally{l(!1)}}},disabled:r||!a.trim(),className:"flex-row items-center justify-center py-3 px-4 rounded-lg "+(r||!a.trim()?"bg-gray-300":"bg-blue-600 active:bg-blue-700"),children:r?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(q.default,{size:"small",color:"#fff"}),(0,J.jsx)(d.default,{className:"text-white font-semibold ml-2",children:"Importing..."})]}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(x.default,{name:"cloud-upload",size:20,color:"#fff"}),(0,J.jsx)(d.default,{className:"text-white font-semibold ml-2",children:"Import to Firebase"})]})}),c&&c.success&&c.imported&&(0,J.jsxs)(n.default,{className:"bg-green-50 border border-green-200 rounded-lg p-4 mt-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center mb-3",children:[(0,J.jsx)(x.default,{name:"checkmark-circle",size:20,color:"#10b981"}),(0,J.jsx)(d.default,{className:"text-sm font-semibold text-green-900 ml-2",children:"Import Successful"})]}),(0,J.jsxs)(n.default,{className:"space-y-1",children:[c.imported.strandPatterns>0&&(0,J.jsxs)(d.default,{className:"text-sm text-green-800",children:["\u2022 Strand Patterns: ",c.imported.strandPatterns]}),c.imported.products>0&&(0,J.jsxs)(d.default,{className:"text-sm text-green-800",children:["\u2022 Products: ",c.imported.products]}),c.imported.strandLibrary>0&&(0,J.jsxs)(d.default,{className:"text-sm text-green-800",children:["\u2022 Strand Library: ",c.imported.strandLibrary]}),c.imported.aggregateLibrary>0&&(0,J.jsxs)(d.default,{className:"text-sm text-green-800",children:["\u2022 Aggregate Library: ",c.imported.aggregateLibrary]}),c.imported.admixLibrary>0&&(0,J.jsxs)(d.default,{className:"text-sm text-green-800",children:["\u2022 Admix Library: ",c.imported.admixLibrary]}),c.imported.projects>0&&(0,J.jsxs)(d.default,{className:"text-sm text-green-800",children:["\u2022 Projects: ",c.imported.projects]}),c.imported.contacts>0&&(0,J.jsxs)(d.default,{className:"text-sm text-green-800",children:["\u2022 Contacts: ",c.imported.contacts]}),c.imported.yardLocations>0&&(0,J.jsx)(d.default,{className:"text-sm text-green-800",children:"\u2022 Yard Locations: Updated"})]})]}),c&&!c.success&&(0,J.jsxs)(n.default,{className:"bg-red-50 border border-red-200 rounded-lg p-4 mt-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-red-900 mb-1",children:"Import Failed"}),(0,J.jsx)(d.default,{className:"text-sm text-red-800",children:c.error})]})]})})]})}const X=[{id:"camber-calculator",name:"Camber Calculator",description:"Calculate precast concrete member camber with strand patterns",icon:"calculator",color:"#3B82F6",bgColor:"#EFF6FF",route:"Calculator"},{id:"slippage-identifier",name:"Slippage Identifier",description:"Track and report strand slippage with cross-section templates",icon:"resize",color:"#10B981",bgColor:"#F0FDF4",route:"ProductDetails"},{id:"stressing-calculator",name:"Stressing Force & Elongation",description:"Calculate expected strand elongation during prestressing",icon:"git-pull-request",color:"#8B5CF6",bgColor:"#F5F3FF",route:"StressingCalculator"},{id:"aggregate-gradation",name:"Aggregate Gradation Analysis",description:"Perform sieve analysis and verify ASTM C33 compliance",icon:"analytics",color:"#EA580C",bgColor:"#FFF7ED",route:"AggregateGradation"},{id:"quality-logs",name:"Quality Logs",description:"Track quality issues and production logs by department",icon:"clipboard",color:"#EC4899",bgColor:"#FCE7F3",route:"QualityLogDashboard"},{id:"daily-pour-schedule",name:"Daily Pour Schedule",description:"Manage concrete pours by department and form/bed",icon:"calendar",color:"#14B8A6",bgColor:"#F0FDFA",route:"DailyPourSchedule"},{id:"yard-maps",name:"Yard Maps",description:"Track and locate yarded pieces by department",icon:"map",color:"#8B5CF6",bgColor:"#F5F3FF",route:"YardMap"},{id:"product-library",name:"Product Library",description:"Manage product types and tolerance specifications",icon:"cube",color:"#6366F1",bgColor:"#EEF2FF",route:"ProductLibrary"},{id:"project-library",name:"Project Library",description:"Manage projects, team assignments, and piece counts",icon:"folder-open",color:"#F59E0B",bgColor:"#FEF3C7",route:"ProjectLibrary"},{id:"aggregate-library",name:"Aggregate Library",description:"Comprehensive database of aggregate characteristics",icon:"flask",color:"#DC2626",bgColor:"#FEF2F2",route:"AggregateLibrary"},{id:"admix-library",name:"Admix Library",description:"Manage admixture products and dosage information",icon:"water",color:"#0891B2",bgColor:"#ECFEFF",route:"AdmixLibrary"},{id:"contacts",name:"Contacts",description:"Manage vendors, suppliers, and sales representatives",icon:"people",color:"#7C3AED",bgColor:"#F5F3FF",route:"Contacts"},{id:"strand-library",name:"Strand Library",description:"Manage strand definitions and material properties",icon:"library",color:"#F59E0B",bgColor:"#FEF3C7",route:"StrandLibrary"}];function K(){const e=(0,i.useSafeAreaInsets)(),t=(0,c.useNavigation)(),[a,s]=(0,f.useState)(!1),[r,l]=(0,f.useState)(""),[u,m]=(0,f.useState)(!1),{getAllAggregates:b}=D(),{getAllAdmixes:y}=L(),{getAllContacts:j}=W(),N=G(e=>e.currentUser),w=G(e=>e.logout),S="admin"===N?.role,F=(()=>{if(!r.trim())return{aggregates:[],admixes:[],contacts:[]};const e=r.toLowerCase().trim();return{aggregates:b().filter(t=>t.name.toLowerCase().includes(e)||t.source?.toLowerCase().includes(e)||t.type?.toLowerCase().includes(e)),admixes:y().filter(t=>t.name.toLowerCase().includes(e)||t.manufacturer.toLowerCase().includes(e)||t.class.toLowerCase().includes(e)),contacts:j().filter(t=>t.name.toLowerCase().includes(e)||t.company?.toLowerCase().includes(e)||t.role?.toLowerCase().includes(e)||t.email?.toLowerCase().includes(e))}})(),C=F.aggregates.length+F.admixes.length+F.contacts.length;return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:e.bottom+20},children:(0,J.jsxs)(n.default,{className:"p-5",children:[(0,J.jsxs)(n.default,{className:"mb-6 mt-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-4xl font-bold text-gray-900",children:"Quality Tools"}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[S&&(0,J.jsx)(o.default,{onPress:()=>m(!0),className:"bg-green-600 rounded-full p-3 active:bg-green-700",children:(0,J.jsx)(x.default,{name:"cloud-upload",size:24,color:"white"})}),(0,J.jsx)(o.default,{onPress:()=>s(!0),className:"bg-blue-600 rounded-full p-3 active:bg-blue-700",children:(0,J.jsx)(x.default,{name:"search",size:24,color:"white"})}),(0,J.jsx)(o.default,{onPress:async()=>{await w()},className:"bg-red-600 rounded-full p-3 active:bg-red-700",children:(0,J.jsx)(x.default,{name:"log-out-outline",size:24,color:"white"})})]})]}),(0,J.jsx)(d.default,{className:"text-base text-gray-600",children:"Select a tool to get started"}),N&&(0,J.jsxs)(d.default,{className:"text-sm text-gray-500 mt-1",children:["Logged in as: ",N.email," (",N.role,")"]})]}),(0,J.jsx)(n.default,{style:{flexDirection:"row",flexWrap:"wrap",marginHorizontal:-6},children:X.map(e=>(0,J.jsx)(n.default,{style:{width:"33.333%",padding:6},children:(0,J.jsxs)(o.default,{onPress:()=>(e=>{e.comingSoon||e.route&&t.navigate(e.route)})(e),disabled:e.comingSoon,style:{backgroundColor:e.bgColor,borderRadius:16,padding:12,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2,opacity:e.comingSoon?.6:1,minHeight:160},children:[(0,J.jsxs)(n.default,{style:{alignItems:"center",marginBottom:8},children:[(0,J.jsx)(n.default,{style:{backgroundColor:e.color,borderRadius:12,padding:10,marginBottom:8},children:(0,J.jsx)(x.default,{name:e.icon,size:28,color:"white"})}),e.comingSoon&&(0,J.jsx)(n.default,{style:{backgroundColor:"#FEF3C7",paddingHorizontal:6,paddingVertical:2,borderRadius:8,marginBottom:4},children:(0,J.jsx)(d.default,{style:{fontSize:9,fontWeight:"700",color:"#92400E"},children:"SOON"})})]}),(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"700",color:"#111827",textAlign:"center",marginBottom:4,lineHeight:16},numberOfLines:2,children:e.name}),(0,J.jsx)(d.default,{style:{fontSize:10,color:"#6B7280",textAlign:"center",lineHeight:13},numberOfLines:3,children:e.description})]})},e.id))}),(0,J.jsx)(n.default,{className:"mt-8 bg-blue-50 rounded-xl p-5 border border-blue-200",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(n.default,{className:"bg-blue-500 rounded-full p-2 mr-3",children:(0,J.jsx)(x.default,{name:"information",size:20,color:"white"})}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-blue-900 mb-1",children:"More Tools Coming"}),(0,J.jsx)(d.default,{className:"text-xs text-blue-700",children:"We are continuously adding new quality control tools to help you work more efficiently. Check back for updates!"})]})]})})]})}),(0,J.jsx)(p.default,{visible:a,animationType:"slide",presentationStyle:"pageSheet",onRequestClose:()=>s(!1),children:(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"bg-white p-4 border-b border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-3 mb-3",children:[(0,J.jsx)(o.default,{onPress:()=>s(!1),children:(0,J.jsx)(x.default,{name:"arrow-back",size:28,color:"#111827"})}),(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900 flex-1",children:"Global Search"})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center bg-gray-100 rounded-lg px-4 py-3",children:[(0,J.jsx)(x.default,{name:"search",size:20,color:"#6b7280"}),(0,J.jsx)(h.default,{value:r,onChangeText:l,placeholder:"Search across all libraries...",placeholderTextColor:"#9ca3af",cursorColor:"#000000",autoFocus:!0,className:"flex-1 ml-3 text-base text-gray-900"}),r.length>0&&(0,J.jsx)(o.default,{onPress:()=>l(""),children:(0,J.jsx)(x.default,{name:"close-circle",size:20,color:"#6b7280"})})]}),r.length>0&&(0,J.jsxs)(d.default,{className:"text-sm text-gray-600 mt-2",children:[C," ",1===C?"result":"results"," found"]})]}),(0,J.jsx)(g.default,{className:"flex-1",children:0===r.trim().length?(0,J.jsxs)(n.default,{className:"items-center justify-center p-8 mt-20",children:[(0,J.jsx)(x.default,{name:"search-outline",size:64,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600 mt-4 text-center",children:"Start typing to search"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-2 text-center",children:"Search across Aggregate Library, Admix Library, and Contacts"})]}):0===C?(0,J.jsxs)(n.default,{className:"items-center justify-center p-8 mt-20",children:[(0,J.jsx)(x.default,{name:"sad-outline",size:64,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600 mt-4 text-center",children:"No results found"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-2 text-center",children:"Try a different search term"})]}):(0,J.jsxs)(n.default,{className:"p-4",children:[F.aggregates.length>0&&(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center mb-3",children:[(0,J.jsx)(x.default,{name:"flask",size:20,color:"#DC2626"}),(0,J.jsxs)(d.default,{className:"text-lg font-bold text-gray-900 ml-2",children:["Aggregate Library (",F.aggregates.length,")"]})]}),(0,J.jsx)(n.default,{className:"gap-2",children:F.aggregates.map(e=>(0,J.jsxs)(o.default,{onPress:()=>{s(!1),t.navigate("AggregateLibraryDetail",{aggregateId:e.id})},className:"bg-white rounded-lg p-4 shadow-sm active:bg-gray-50",children:[(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-900",children:e.name}),e.source&&(0,J.jsxs)(d.default,{className:"text-sm text-gray-600 mt-1",children:["Source: ",e.source]}),e.type&&(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-0.5",children:e.type})]},e.id))})]}),F.admixes.length>0&&(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center mb-3",children:[(0,J.jsx)(x.default,{name:"water",size:20,color:"#0891B2"}),(0,J.jsxs)(d.default,{className:"text-lg font-bold text-gray-900 ml-2",children:["Admix Library (",F.admixes.length,")"]})]}),(0,J.jsx)(n.default,{className:"gap-2",children:F.admixes.map(e=>(0,J.jsxs)(o.default,{onPress:()=>{s(!1),t.navigate("AdmixLibraryDetail",{admixId:e.id})},className:"bg-white rounded-lg p-4 shadow-sm active:bg-gray-50",children:[(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-900",children:e.name}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 mt-1",children:e.manufacturer}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-0.5",children:e.class})]},e.id))})]}),F.contacts.length>0&&(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center mb-3",children:[(0,J.jsx)(x.default,{name:"people",size:20,color:"#7C3AED"}),(0,J.jsxs)(d.default,{className:"text-lg font-bold text-gray-900 ml-2",children:["Contacts (",F.contacts.length,")"]})]}),(0,J.jsx)(n.default,{className:"gap-2",children:F.contacts.map(e=>(0,J.jsxs)(o.default,{onPress:()=>{s(!1),t.navigate("ContactDetail",{contactId:e.id})},className:"bg-white rounded-lg p-4 shadow-sm active:bg-gray-50",children:[(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-900",children:e.name}),e.company&&(0,J.jsx)(d.default,{className:"text-sm text-gray-600 mt-1",children:e.company}),e.role&&(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-0.5",children:e.role})]},e.id))})]})]})})]})}),(0,J.jsx)(p.default,{visible:u,animationType:"slide",presentationStyle:"pageSheet",onRequestClose:()=>m(!1),children:(0,J.jsx)(Q,{onBack:()=>m(!1)})})]})}var Z=a(44767);const ee={memberType:"hollow-core",releaseStrength:3500,concreteStrength:9e3},te=(0,y.create)()((0,O.persist)(e=>({history:[],currentInputs:ee,addCalculation:t=>e(e=>({history:[t,...e.history].slice(0,50)})),updateCalculation:(t,a)=>e(e=>({history:e.history.map(e=>e.id===t?Object.assign({},e,a):e)})),removeCalculation:t=>e(e=>({history:e.history.filter(e=>e.id!==t)})),clearHistory:()=>e({history:[]}),updateCurrentInputs:t=>e(e=>({currentInputs:Object.assign({},e.currentInputs,t)})),resetCurrentInputs:()=>e({currentInputs:ee})}),{name:"camber-calculator-storage",storage:(0,O.createJSONStorage)(()=>F.default),partialize:e=>({history:e.history})}));function ae(e,t=145){return 33*Math.pow(t,1.5)*Math.sqrt(e)}function se(e,t,a,s){const r=12*t;return 5*(e/12)*Math.pow(r,4)/(384*a*s)}const re=new E("strandPatterns"),le=(0,y.create)()((e,t)=>({customPatterns:[],loading:!1,initialized:!1,initialize:async()=>{if(!t().initialized){e({loading:!0});try{const t=await re.fetchAll();e({customPatterns:t,loading:!1,initialized:!0}),re.subscribe(t=>{e({customPatterns:t})})}catch(qa){console.error("Failed to initialize strand patterns:",qa),e({loading:!1,initialized:!0})}}},addPattern:async t=>{const a=Date.now().toString(),s=Object.assign({},t,{id:a});e(e=>({customPatterns:[...e.customPatterns,s]}));try{await re.set(a,s)}catch(qa){throw e(e=>({customPatterns:e.customPatterns.filter(e=>e.id!==a)})),qa}},updatePattern:async(a,s)=>{const r=t().customPatterns.find(e=>e.id===a);e(e=>({customPatterns:e.customPatterns.map(e=>e.id===a?Object.assign({},s,{id:a}):e)}));try{await re.set(a,Object.assign({},s,{id:a}))}catch(qa){throw r&&e(e=>({customPatterns:e.customPatterns.map(e=>e.id===a?r:e)})),qa}},removePattern:async a=>{const s=t().customPatterns.find(e=>e.id===a);e(e=>({customPatterns:e.customPatterns.filter(e=>e.id!==a)}));try{await re.delete(a)}catch(qa){throw s&&e(e=>({customPatterns:[...e.customPatterns,s]})),qa}},clearAllPatterns:async()=>{const a=t().customPatterns;e(()=>({customPatterns:[]}));try{await Promise.all(a.map(e=>re.delete(e.id)))}catch(qa){throw e(()=>({customPatterns:a})),qa}},getPatternById:e=>t().customPatterns.find(t=>t.id===e),getPatternByPatternId:e=>t().customPatterns.find(t=>t.patternId===e),getPatternsByPosition:e=>t().customPatterns.filter(t=>t.position===e||"Both"===t.position)})),oe=new E("products"),ne=(0,y.create)()((e,t)=>({products:[],loading:!1,initialized:!1,initialize:async()=>{if(!t().initialized){e({loading:!0});try{const t=await oe.fetchAll();e({products:t,loading:!1,initialized:!0}),oe.subscribe(t=>{e({products:t})})}catch(qa){console.error("Failed to initialize products:",qa),e({loading:!1,initialized:!0})}}},addProduct:async t=>{const a=`product-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,s=Object.assign({},t,{id:a,createdAt:Date.now(),updatedAt:Date.now()});e(e=>({products:[...e.products,s]}));try{return await oe.set(a,s),a}catch(qa){throw e(e=>({products:e.products.filter(e=>e.id!==a)})),qa}},updateProduct:async(a,s)=>{const r=t().products.find(e=>e.id===a),l=r?Object.assign({},r,s,{updatedAt:Date.now()}):null;if(l){e(e=>({products:e.products.map(e=>e.id===a?l:e)}));try{await oe.set(a,l)}catch(qa){throw r&&e(e=>({products:e.products.map(e=>e.id===a?r:e)})),qa}}},deleteProduct:async a=>{const s=t().products.find(e=>e.id===a);e(e=>({products:e.products.filter(e=>e.id!==a)}));try{await oe.delete(a)}catch(qa){throw s&&e(e=>({products:[...e.products,s]})),qa}},getProduct:e=>t().products.find(t=>t.id===e),getProductByType:e=>t().products.find(t=>t.name===e),addSubProduct:async(a,s)=>{const r=`subproduct-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,l=Object.assign({},s,{id:r,createdAt:Date.now(),updatedAt:Date.now()}),o=t().products.find(e=>e.id===a);if(!o)throw new Error("Product not found");const n=Object.assign({},o,{subProducts:[...o.subProducts||[],l],updatedAt:Date.now()});e(e=>({products:e.products.map(e=>e.id===a?n:e)}));try{return await oe.set(a,n),r}catch(qa){throw e(e=>({products:e.products.map(e=>e.id===a?o:e)})),qa}},updateSubProduct:async(a,s,r)=>{const l=t().products.find(e=>e.id===a);if(!l)return;const o=Object.assign({},l,{subProducts:(l.subProducts||[]).map(e=>e.id===s?Object.assign({},e,r,{updatedAt:Date.now()}):e),updatedAt:Date.now()});e(e=>({products:e.products.map(e=>e.id===a?o:e)}));try{await oe.set(a,o)}catch(qa){throw e(e=>({products:e.products.map(e=>e.id===a?l:e)})),qa}},deleteSubProduct:async(a,s)=>{const r=t().products.find(e=>e.id===a);if(!r)return;const l=Object.assign({},r,{subProducts:(r.subProducts||[]).filter(e=>e.id!==s),updatedAt:Date.now()});e(e=>({products:e.products.map(e=>e.id===a?l:e)}));try{await oe.set(a,l)}catch(qa){throw e(e=>({products:e.products.map(e=>e.id===a?r:e)})),qa}},getSubProduct:(e,a)=>{const s=t().products.find(t=>t.id===e);return s?.subProducts?.find(e=>e.id===a)},addTolerance:async(a,s)=>{const r=t().products.find(e=>e.id===a);if(!r)return;const l=Object.assign({},r,{tolerances:[...r.tolerances,s],updatedAt:Date.now()});e(e=>({products:e.products.map(e=>e.id===a?l:e)}));try{await oe.set(a,l)}catch(qa){throw e(e=>({products:e.products.map(e=>e.id===a?r:e)})),qa}},updateTolerance:async(a,s,r)=>{const l=t().products.find(e=>e.id===a);if(!l)return;const o=Object.assign({},l,{tolerances:l.tolerances.map((e,t)=>t===s?r:e),updatedAt:Date.now()});e(e=>({products:e.products.map(e=>e.id===a?o:e)}));try{await oe.set(a,o)}catch(qa){throw e(e=>({products:e.products.map(e=>e.id===a?l:e)})),qa}},deleteTolerance:async(a,s)=>{const r=t().products.find(e=>e.id===a);if(!r)return;const l=Object.assign({},r,{tolerances:r.tolerances.filter((e,t)=>t!==s),updatedAt:Date.now()});e(e=>({products:e.products.map(e=>e.id===a?l:e)}));try{await oe.set(a,l)}catch(qa){throw e(e=>({products:e.products.map(e=>e.id===a?r:e)})),qa}},addSubProductTolerance:async(a,s,r)=>{const l=t().products.find(e=>e.id===a);if(!l)return;const o=Object.assign({},l,{subProducts:(l.subProducts||[]).map(e=>e.id===s?Object.assign({},e,{tolerances:[...e.tolerances,r],updatedAt:Date.now()}):e),updatedAt:Date.now()});e(e=>({products:e.products.map(e=>e.id===a?o:e)}));try{await oe.set(a,o)}catch(qa){throw e(e=>({products:e.products.map(e=>e.id===a?l:e)})),qa}},updateSubProductTolerance:async(a,s,r,l)=>{const o=t().products.find(e=>e.id===a);if(!o)return;const n=Object.assign({},o,{subProducts:(o.subProducts||[]).map(e=>e.id===s?Object.assign({},e,{tolerances:e.tolerances.map((e,t)=>t===r?l:e),updatedAt:Date.now()}):e),updatedAt:Date.now()});e(e=>({products:e.products.map(e=>e.id===a?n:e)}));try{await oe.set(a,n)}catch(qa){throw e(e=>({products:e.products.map(e=>e.id===a?o:e)})),qa}},deleteSubProductTolerance:async(a,s,r)=>{const l=t().products.find(e=>e.id===a);if(!l)return;const o=Object.assign({},l,{subProducts:(l.subProducts||[]).map(e=>e.id===s?Object.assign({},e,{tolerances:e.tolerances.filter((e,t)=>t!==r),updatedAt:Date.now()}):e),updatedAt:Date.now()});e(e=>({products:e.products.map(e=>e.id===a?o:e)}));try{await oe.set(a,o)}catch(qa){throw e(e=>({products:e.products.map(e=>e.id===a?l:e)})),qa}},getActiveProducts:()=>t().products.filter(e=>e.isActive),getAllProductTypes:()=>t().products.map(e=>e.name),clearAllProducts:async()=>{const a=t().products;e({products:[]});try{await Promise.all(a.map(e=>oe.delete(e.id)))}catch(qa){throw e({products:a}),qa}}}));a(51391),a(91731);function de(e,t){return 0===t?e:de(t,e%t)}function ie(e){const t=Math.abs(e),a=Math.floor(t),s=t-a,r=Math.round(16*s);if(0===r)return a>0?`${a}"`:"0";if(16===r)return`${a+1}"`;const l=de(r,16),o=r/l,n=16/l;return a>0?`${a} ${o}/${n}"`:`${o}/${n}"`}function ce(e){const t=ie(e);return`${e.toFixed(3)} (\u2248${t})`}function ue(e){const t=e.trim();if(!t)return null;const a=t.match(/^(\d*\.?\d+)$/);if(a){const e=parseFloat(a[1]);return isNaN(e)?null:e}const s=t.match(/^(\d+)\s+(\d+)\/(\d+)$/);if(s){const e=parseInt(s[1]),t=parseInt(s[2]),a=parseInt(s[3]);return 0===a?null:e+t/a}const r=t.match(/^(\d+)\/(\d+)$/);if(r){const e=parseInt(r[1]),t=parseInt(r[2]);return 0===t?null:e/t}return null}function me(e){const t=Math.floor(e),a=12*(e-t);let s=Math.floor(a);const r=a-s;let l=Math.round(16*r);16===l&&(s+=1,l=0);let o="";return o=s>0&&l>0?`${s} ${l}/16"`:s>0?`${s}"`:l>0?`${l}/16"`:'0"',`${t}'-${o} (${e.toFixed(3)} ft)`}const xe=new E("projects"),fe=(0,y.create)()((e,t)=>({projects:[],loading:!1,initialized:!1,initialize:async()=>{if(!t().initialized){e({loading:!0});try{const t=await xe.fetchAll();e({projects:t,loading:!1,initialized:!0}),xe.subscribe(t=>{e({projects:t})})}catch(qa){console.error("Failed to initialize projects:",qa),e({loading:!1,initialized:!0})}}},addProject:async t=>{const a=Object.assign({},t,{id:`project-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,createdAt:Date.now(),updatedAt:Date.now()});e(e=>({projects:[...e.projects,a]}));try{await xe.set(a.id,a)}catch(qa){throw e(e=>({projects:e.projects.filter(e=>e.id!==a.id)})),qa}},updateProject:async(a,s)=>{const r=t().projects.find(e=>e.id===a);if(!r)return;const l=Object.assign({},r,s,{updatedAt:Date.now()});e(e=>({projects:e.projects.map(e=>e.id===a?l:e)}));try{await xe.set(a,l)}catch(qa){throw e(e=>({projects:e.projects.map(e=>e.id===a?r:e)})),qa}},deleteProject:async a=>{const s=t().projects.find(e=>e.id===a);e(e=>({projects:e.projects.filter(e=>e.id!==a)}));try{await xe.delete(a)}catch(qa){throw s&&e(e=>({projects:[...e.projects,s]})),qa}},getProjectById:e=>t().projects.find(t=>t.id===e),searchProjects:e=>{const a=e.toLowerCase().trim();return a?t().projects.filter(e=>e.jobNumber.toLowerCase().includes(a)||e.jobName.toLowerCase().includes(a)):t().projects},exportProjects:()=>{const e=t().projects;return JSON.stringify(e,null,2)},importProjects:a=>{try{const s=JSON.parse(a);if(!Array.isArray(s))return{success:!1,message:"Invalid format: Expected an array of projects",imported:0};for(const e of s)if(!e.jobNumber||!e.jobName)return{success:!1,message:"Invalid project data: Missing required fields",imported:0};const r=t().projects,l=new Set(r.map(e=>e.jobNumber)),o=s.filter(e=>!l.has(e.jobNumber));if(0===o.length)return{success:!0,message:"All projects already exist",imported:0};const n=o.map(e=>Object.assign({},e,{id:`project-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,createdAt:Date.now(),updatedAt:Date.now()}));return Promise.all(n.map(e=>xe.set(e.id,e))).catch(e=>console.error("Failed to sync imported projects to Firebase:",e)),e(e=>({projects:[...e.projects,...n]})),{success:!0,message:`Successfully imported ${o.length} project(s)`,imported:o.length}}catch(qa){return{success:!1,message:`Import failed: ${qa}`,imported:0}}},clearAllProjects:async()=>{const a=t().projects;e({projects:[]});try{await Promise.all(a.map(e=>xe.delete(e.id)))}catch(qa){throw e({projects:a}),qa}}}));function ge(){const e=fe(e=>e.projects);return{findByJobNumber:(0,f.useCallback)(t=>{const a=t.trim();return a&&e.find(e=>e.jobNumber.toLowerCase()===a.toLowerCase())||null},[e]),findByJobName:(0,f.useCallback)(t=>{const a=t.trim();return a&&e.find(e=>e.jobName.toLowerCase()===a.toLowerCase())||null},[e]),searchByJobName:(0,f.useCallback)(t=>{const a=t.trim().toLowerCase();if(!a||a.length<2)return[];return e.filter(e=>e.jobName.toLowerCase().includes(a)).map(e=>({jobNumber:e.jobNumber,jobName:e.jobName,project:e})).sort((e,t)=>{const s=e.jobName.toLowerCase(),r=t.jobName.toLowerCase();return s===a&&r!==a?-1:r===a&&s!==a?1:s.startsWith(a)&&!r.startsWith(a)?-1:r.startsWith(a)&&!s.startsWith(a)?1:e.jobName.localeCompare(t.jobName)})},[e]),searchByJobNumber:(0,f.useCallback)(t=>{const a=t.trim().toLowerCase();return a?e.filter(e=>e.jobNumber.toLowerCase().includes(a)).map(e=>({jobNumber:e.jobNumber,jobName:e.jobName,project:e})).sort((e,t)=>e.jobNumber.localeCompare(t.jobNumber)):[]},[e])}}function he(){const e=(0,i.useSafeAreaInsets)(),t=(0,c.useNavigation)(),{currentInputs:a,addCalculation:s}=te(),{customPatterns:r}=le(),{products:l}=ne(),{findByJobNumber:u,searchByJobName:m}=ge(),[b,y]=(0,f.useState)(""),[j,N]=(0,f.useState)(""),[w,S]=(0,f.useState)(""),[F,C]=(0,f.useState)(""),[v,A]=(0,f.useState)(""),[P,T]=(0,f.useState)(""),[E,z]=(0,f.useState)("0"),[B,D]=(0,f.useState)(""),[k,I]=(0,f.useState)(""),[L,R]=(0,f.useState)(""),[$,W]=(0,f.useState)(""),[O,M]=(0,f.useState)(!1),[U,H]=(0,f.useState)(!1),[V,G]=(0,f.useState)([]),[q,Y]=(0,f.useState)(!1);(0,f.useEffect)(()=>{if(j.trim()){const e=u(j);if(e){Y(!0),y(e.jobName);const t=setTimeout(()=>Y(!1),100);return()=>clearTimeout(t)}y("")}else y("")},[j,u]),(0,f.useEffect)(()=>{if(!q)if(b.trim().length>=2){const e=m(b);G(e),H(e.length>0)}else G([]),H(!1)},[b,m,q]);const[_,Q]=(0,f.useState)(""),[X,K]=(0,f.useState)(""),[ee,re]=(0,f.useState)(!1),[oe,de]=(0,f.useState)(!1),[ie,ce]=(0,f.useState)([]),me=r.find(e=>e.id===_),xe=l.find(e=>e.id===L),fe=xe?.subProducts?.find(e=>e.id===$),he=fe?.momentOfInertia||0,pe=fe?.deadLoadPerLinearFoot||0,be=me?.strandCoordinates&&me.strandCoordinates.length>0?Math.max(...me.strandCoordinates.map(e=>e.x)):48,ye=B.trim()?ue(B):null,je=null!==ye&&Math.abs(ye-be)>.001&&ye<be,Ne=e=>{if(!e||"0"===e)return 0;const t=e.split("/");if(2===t.length){const e=parseFloat(t[0]),a=parseFloat(t[1]);if(0!==a)return e/a}return 0};return(0,J.jsxs)(Z.default,{behavior:"height",className:"flex-1 bg-white",style:{paddingTop:e.top},children:[(0,J.jsxs)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:40},keyboardShouldPersistTaps:"handled",children:[(0,J.jsxs)(n.default,{className:"px-6 py-4 border-b border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-1",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-2xl font-bold",children:"Camber Calculator"}),(0,J.jsxs)(o.default,{onPress:()=>{t.navigate("ProductTagScanner",{onDataScanned:e=>{if(e.projectName&&y(e.projectName),e.projectNumber&&N(e.projectNumber),e.markNumber&&S(e.markNumber),e.idNumber&&C(e.idNumber),e.span&&(A(e.span.feet.toString()),T(e.span.inches.toString()),z("0")),e.productWidth&&D(e.productWidth.toString()),e.strandPattern){const t=r.find(t=>t.patternId===e.strandPattern||t.name.includes(e.strandPattern||""));t&&Q(t.id)}}})},className:"bg-blue-500 rounded-lg px-4 py-2 flex-row items-center",children:[(0,J.jsx)(x.default,{name:"camera",size:20,color:"#fff"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold ml-2",children:"Scan Product Tag"})]})]}),(0,J.jsx)(d.default,{className:"text-gray-600 text-sm mt-1",children:"Configure project details and select strand pattern"})]}),ie.length>0&&(0,J.jsx)(n.default,{className:"mx-6 mt-4 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"alert-circle",size:20,color:"#DC2626"}),(0,J.jsxs)(n.default,{className:"ml-2 flex-1",children:[(0,J.jsx)(d.default,{className:"text-red-800 font-semibold text-sm mb-1",children:"Please fix the following:"}),ie.map((e,t)=>(0,J.jsxs)(d.default,{className:"text-red-700 text-sm",children:["\u2022 ",e]},t))]})]})}),(0,J.jsxs)(n.default,{className:"px-6 mt-6",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold mb-4",children:"Product Details (Optional)"}),(0,J.jsxs)(n.default,{className:"mb-4",style:{zIndex:10},children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Project Name"}),(0,J.jsxs)(n.default,{style:{position:"relative"},children:[(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base text-gray-900",placeholder:"Enter project name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:b,onChangeText:y,onBlur:()=>{setTimeout(()=>H(!1),200)},onFocus:()=>{b.trim().length>=2&&V.length>0&&H(!0)}}),U&&V.length>0&&(0,J.jsx)(n.default,{className:"bg-white border border-gray-300 rounded-lg",style:{position:"absolute",top:"100%",left:0,right:0,marginTop:4,zIndex:9999,maxHeight:200,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.15,shadowRadius:8,elevation:8},children:(0,J.jsx)(g.default,{style:{maxHeight:200},keyboardShouldPersistTaps:"handled",nestedScrollEnabled:!0,children:V.map((e,t)=>(0,J.jsxs)(o.default,{onPress:()=>{return t=e.jobNumber,a=e.jobName,Y(!0),y(a),N(t),H(!1),void setTimeout(()=>Y(!1),100);var t,a},className:"px-4 py-3 border-b border-gray-200",style:{backgroundColor:"#fff"},children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-medium",children:e.jobName}),(0,J.jsxs)(d.default,{className:"text-gray-500 text-sm",children:["Job #: ",e.jobNumber]})]},`${e.jobNumber}-${t}`))})})]})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Project Number"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base text-gray-900",placeholder:"Enter project number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:j,onChangeText:N})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3 mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Mark Number"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base text-gray-900",placeholder:"Mark #",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:w,onChangeText:S})]}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"ID Number"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base text-gray-900",placeholder:"ID #",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:F,onChangeText:C})]})]}),(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Span (Optional)"}),(0,J.jsxs)(n.default,{className:"flex-row items-center",style:{gap:8},children:[(0,J.jsx)(n.default,{style:{flex:1,minWidth:0},children:(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900",placeholder:"Feet",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:v,onChangeText:A,keyboardType:"numeric"})}),(0,J.jsx)(d.default,{className:"text-gray-600 font-medium",children:"-"}),(0,J.jsx)(n.default,{style:{flex:1,minWidth:0},children:(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900",placeholder:"Inches",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:P,onChangeText:T,keyboardType:"numeric"})}),(0,J.jsx)(o.default,{className:"bg-gray-100 border border-gray-300 rounded-lg px-3 py-3 items-center",style:{width:70},onPress:()=>{const e=["0","1/8","1/4","3/8","1/2","5/8","3/4","7/8"],t=(e.indexOf(E)+1)%e.length;z(e[t])},children:(0,J.jsxs)(d.default,{className:"text-gray-900 font-medium text-sm",children:["0"===E?"0":E,'"']})})]})]}),(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Product Width (Optional)"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-2",children:"For cut-width products, enter actual width in inches (decimal or fraction)"}),(0,J.jsx)(h.default,{style:{backgroundColor:"#FFFFFF",borderWidth:1,borderColor:"#D1D5DB",borderRadius:8,paddingHorizontal:16,paddingVertical:12,fontSize:16,color:"#111827"},placeholder:"e.g., 28 or 28 1/2 or 28.5",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#000000",value:B,onChangeText:D,keyboardType:"default"})]}),je&&(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(n.default,{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-3",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"cut",size:20,color:"#F59E0B"}),(0,J.jsxs)(n.default,{className:"flex-1 ml-3",children:[(0,J.jsx)(d.default,{className:"text-amber-900 font-semibold text-sm mb-1",children:"Cut-Width Product Detected"}),(0,J.jsxs)(d.default,{className:"text-amber-800 text-xs",children:["Product: ",ye,'" (cut from ',be,'")']})]})]})}),(0,J.jsxs)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:["Product Side ",(0,J.jsx)(d.default,{className:"text-red-500",children:"*"})]}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-3",children:"Which side is the keeper side (product side)?"}),(0,J.jsxs)(n.default,{className:"flex-row gap-3 mb-3",children:[(0,J.jsxs)(o.default,{onPress:()=>I("L1"),className:"flex-1 rounded-lg py-3 px-4 border-2 "+("L1"===k?"bg-blue-50 border-blue-500":"bg-white border-gray-300"),children:[(0,J.jsx)(d.default,{className:"text-center font-semibold text-sm "+("L1"===k?"text-blue-700":"text-gray-700"),children:"L1 (Left Side)"}),(0,J.jsx)(d.default,{className:"text-center text-xs text-gray-600 mt-1",children:"Keep left side"})]}),(0,J.jsxs)(o.default,{onPress:()=>I("L2"),className:"flex-1 rounded-lg py-3 px-4 border-2 "+("L2"===k?"bg-blue-50 border-blue-500":"bg-white border-gray-300"),children:[(0,J.jsx)(d.default,{className:"text-center font-semibold text-sm "+("L2"===k?"text-blue-700":"text-gray-700"),children:"L2 (Right Side)"}),(0,J.jsx)(d.default,{className:"text-center text-xs text-gray-600 mt-1",children:"Keep right side"})]})]}),(0,J.jsxs)(n.default,{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,J.jsx)(d.default,{className:"text-xs font-semibold text-gray-700 mb-3 text-center",children:"Visual Guide"}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-600 mb-2",children:"L1 Product Side (Keep left):"}),(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"flex-1 h-12 bg-blue-100 border-2 border-blue-500 items-center justify-center",children:(0,J.jsx)(d.default,{className:"text-xs text-blue-700",children:"Keep (L1)"})}),(0,J.jsx)(n.default,{className:"flex-1 h-12 bg-red-100 border-r-4 border-red-500 items-center justify-center",children:(0,J.jsx)(d.default,{className:"text-xs text-red-700",children:"Cut Edge"})})]})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-600 mb-2",children:"L2 Product Side (Keep right):"}),(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"flex-1 h-12 bg-red-100 border-l-4 border-red-500 items-center justify-center",children:(0,J.jsx)(d.default,{className:"text-xs text-red-700",children:"Cut Edge"})}),(0,J.jsx)(n.default,{className:"flex-1 h-12 bg-blue-100 border-2 border-blue-500 items-center justify-center",children:(0,J.jsx)(d.default,{className:"text-xs text-blue-700",children:"Keep (L2)"})})]})]})]}),ie.includes("Product side is required for cut-width products")&&(0,J.jsx)(d.default,{className:"text-red-600 text-xs mt-2",children:"\u26a0 Please select which side is the product side (keeper side)"})]})]}),(0,J.jsxs)(n.default,{className:"px-6 mb-6",children:[(0,J.jsxs)(d.default,{className:"text-gray-900 text-lg font-semibold mb-4",children:["Configuration ",(0,J.jsx)(d.default,{className:"text-red-500",children:"*"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:["Product Type/Size ",(0,J.jsx)(d.default,{className:"text-red-500",children:"*"})]}),(0,J.jsxs)(o.default,{className:`bg-white border ${ie.includes("Product Type/Size is required")?"border-red-500":"border-gray-300"} rounded-lg px-4 py-3 flex-row items-center justify-between`,onPress:()=>M(!0),children:[(0,J.jsx)(d.default,{className:"text-base "+(fe?"text-gray-900":"text-gray-400"),children:fe?`${xe?.name} - ${fe.name}`:"Select product type/size"}),(0,J.jsx)(x.default,{name:"chevron-down",size:20,color:"#6B7280"})]})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:["Strand Pattern ",(0,J.jsx)(d.default,{className:"text-red-500",children:"*"})]}),(0,J.jsxs)(o.default,{className:`bg-white border ${ie.includes("Strand Pattern is required")?"border-red-500":"border-gray-300"} rounded-lg px-4 py-3 flex-row items-center justify-between`,onPress:()=>re(!0),children:[(0,J.jsx)(d.default,{className:"text-base "+(_?"text-gray-900":"text-gray-400"),children:me?me.name:"Select strand pattern"}),(0,J.jsx)(x.default,{name:"chevron-down",size:20,color:"#6B7280"})]}),0===r.length&&(0,J.jsx)(d.default,{className:"text-orange-600 text-xs mt-1",children:"No patterns available. Create one in Strand Patterns."})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Top Strand Pattern (Optional)"}),(0,J.jsxs)(o.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 flex-row items-center justify-between",onPress:()=>de(!0),children:[(0,J.jsx)(d.default,{className:"text-base "+(X?"text-gray-900":"text-gray-400"),children:X?r.find(e=>e.id===X)?.name:"None"}),(0,J.jsx)(x.default,{name:"chevron-down",size:20,color:"#6B7280"})]})]})]}),(0,J.jsx)(n.default,{className:"px-6",children:(0,J.jsx)(o.default,{className:"bg-blue-500 rounded-xl py-4 items-center active:bg-blue-600",onPress:()=>{const e=[];if($||e.push("Product Type/Size is required"),_||e.push("Strand Pattern is required"),je&&!k&&e.push("Product side is required for cut-width products"),e.length>0)return void ce(e);ce([]);const a=(parseFloat(v)||0)+((parseFloat(P)||0)+Ne(E))/12,l=r.find(e=>e.id===_),o=B.trim()?ue(B):null,n={span:a,memberType:"hollow-core",releaseStrength:3500,concreteStrength:9e3,momentOfInertia:he||l?.momentOfInertia||0,deadLoad:pe||l?.deadLoad||0,liveLoad:void 0,strandPattern:_||void 0,strandEValue:l?.eValue,topStrandPattern:X||void 0,productWidth:null!==o?o:void 0,productSide:je&&k?k:void 0,projectNumber:j||void 0,markNumber:w||void 0,idNumber:F||void 0},d=function(e){const t=e.modulusOfElasticity||ae(e.releaseStrength),a=ae(e.concreteStrength),s=se(e.deadLoad,e.span,t,e.momentOfInertia),r=e.liveLoad?se(e.liveLoad,e.span,a,e.momentOfInertia):void 0,l={beam:2,"double-tee":2,"hollow-core":1.8,"single-tee":2,"solid-slab":2.2,"wall-panel":1.5,stadia:2}[e.memberType]||2,o=(i=e.memberType,{beam:.2,"double-tee":.2,"hollow-core":.15,"single-tee":.2,"solid-slab":.25,"wall-panel":.15,stadia:.2}[i]||.2),n=function(e,t,a){return e*(1+t+a)}(s,l,o),d=function(e,t){return.75*t}(0,n);var i;return{initialCamber:d,netInitialCamber:d-s,deadLoadDeflection:s,liveLoadDeflection:r,longTermDeflection:n,finalCamber:d-n,recommendedCamber:d,releaseModulusOfElasticity:t,modulusOfElasticity:a,creepFactor:l,shrinkageFactor:o}}(n),i={id:Date.now().toString(),timestamp:Date.now(),inputs:n,results:d,projectName:b||void 0};s(i),t.navigate("Results",{calculation:i})},children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Continue to Input Values"})})})]}),(0,J.jsx)(p.default,{visible:O,transparent:!0,animationType:"slide",onRequestClose:()=>M(!1),children:(0,J.jsx)(n.default,{className:"flex-1 justify-end bg-black/50",children:(0,J.jsxs)(n.default,{className:"bg-white rounded-t-3xl max-h-[70%]",children:[(0,J.jsxs)(n.default,{className:"p-4 border-b border-gray-200 flex-row items-center justify-between",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold",children:"Select Product Type/Size"}),(0,J.jsx)(o.default,{onPress:()=>M(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsxs)(g.default,{className:"p-4",children:[l.filter(e=>e.isActive).map(e=>(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-base font-bold text-gray-900 mb-3",children:e.name}),e.subProducts&&e.subProducts.length>0?e.subProducts.filter(e=>e.isActive&&e.momentOfInertia&&e.deadLoadPerLinearFoot).map(t=>(0,J.jsxs)(o.default,{onPress:()=>{R(e.id),W(t.id),M(!1),ce([])},className:"mb-3 p-4 rounded-lg border "+($===t.id?"bg-blue-50 border-blue-500":"bg-white border-gray-200"),children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-base font-bold "+($===t.id?"text-blue-600":"text-gray-900"),children:t.name}),$===t.id&&(0,J.jsx)(x.default,{name:"checkmark-circle",size:24,color:"#3B82F6"})]}),t.description&&(0,J.jsx)(d.default,{className:"text-sm mb-2 "+($===t.id?"text-blue-800":"text-gray-600"),children:t.description}),(0,J.jsxs)(n.default,{className:"mt-2",children:[(0,J.jsx)(d.default,{className:"text-xs font-semibold mb-1 "+($===t.id?"text-blue-800":"text-gray-600"),children:"Properties:"}),(0,J.jsxs)(d.default,{className:"text-xs "+($===t.id?"text-blue-700":"text-gray-600"),children:["\u2022 Moment of Inertia: ",t.momentOfInertia?.toLocaleString()," in\u2074"]}),(0,J.jsxs)(d.default,{className:"text-xs "+($===t.id?"text-blue-700":"text-gray-600"),children:["\u2022 Dead Load: ",t.deadLoadPerLinearFoot?.toLocaleString()," lb/ft"]}),t.area&&(0,J.jsxs)(d.default,{className:"text-xs "+($===t.id?"text-blue-700":"text-gray-600"),children:["\u2022 Area: ",t.area.toLocaleString()," in\xb2"]})]})]},t.id)):(0,J.jsx)(n.default,{className:"bg-gray-100 rounded-lg p-4",children:(0,J.jsx)(d.default,{className:"text-sm text-gray-600 text-center",children:"No sub-products available"})})]},e.id)),0===l.filter(e=>e.isActive).length&&(0,J.jsxs)(n.default,{className:"items-center py-8",children:[(0,J.jsx)(x.default,{name:"cube-outline",size:48,color:"#9CA3AF"}),(0,J.jsxs)(d.default,{className:"text-gray-600 text-base mt-4 text-center",children:["No products available.","\n","Add products in Product Library."]})]})]})]})})}),(0,J.jsx)(p.default,{visible:ee,transparent:!0,animationType:"slide",onRequestClose:()=>re(!1),children:(0,J.jsx)(n.default,{className:"flex-1 justify-end bg-black/50",children:(0,J.jsxs)(n.default,{className:"bg-white rounded-t-3xl max-h-[70%]",children:[(0,J.jsxs)(n.default,{className:"p-4 border-b border-gray-200 flex-row items-center justify-between",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold",children:"Select Strand Pattern"}),(0,J.jsx)(o.default,{onPress:()=>re(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsx)(g.default,{className:"p-4",children:0===r.length?(0,J.jsxs)(n.default,{className:"items-center py-8",children:[(0,J.jsx)(x.default,{name:"albums-outline",size:48,color:"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-gray-600 text-base mt-4 mb-4 text-center",children:"No strand patterns available."}),(0,J.jsx)(o.default,{onPress:()=>{re(!1),t.navigate("StrandPatterns")},className:"bg-blue-500 rounded-xl py-3 px-6 items-center active:bg-blue-600",children:(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold",children:"Go to Strand Library"})})]}):r.map(e=>(0,J.jsxs)(o.default,{className:"p-4 mb-2 rounded-lg border "+(_===e.id?"bg-blue-50 border-blue-500":"bg-white border-gray-200"),onPress:()=>{Q(e.id),re(!1),ce([])},children:[(0,J.jsx)(d.default,{className:"text-base font-semibold "+(_===e.id?"text-blue-600":"text-gray-900"),children:e.name}),(0,J.jsxs)(d.default,{className:"text-gray-600 text-sm mt-1",children:["Pattern ID: ",e.patternId," \u2022 Position: ",e.position]})]},e.id))})]})})}),(0,J.jsx)(p.default,{visible:oe,transparent:!0,animationType:"slide",onRequestClose:()=>de(!1),children:(0,J.jsx)(n.default,{className:"flex-1 justify-end bg-black/50",children:(0,J.jsxs)(n.default,{className:"bg-white rounded-t-3xl max-h-[70%]",children:[(0,J.jsxs)(n.default,{className:"p-4 border-b border-gray-200 flex-row items-center justify-between",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold",children:"Select Top Strand Pattern"}),(0,J.jsx)(o.default,{onPress:()=>de(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsxs)(g.default,{className:"p-4",children:[(0,J.jsx)(o.default,{className:"p-4 mb-2 rounded-lg border "+(""===X?"bg-blue-50 border-blue-500":"bg-white border-gray-200"),onPress:()=>{K(""),de(!1)},children:(0,J.jsx)(d.default,{className:"text-base font-semibold "+(""===X?"text-blue-600":"text-gray-900"),children:"None"})}),r.map(e=>(0,J.jsxs)(o.default,{className:"p-4 mb-2 rounded-lg border "+(X===e.id?"bg-blue-50 border-blue-500":"bg-white border-gray-200"),onPress:()=>{K(e.id),de(!1)},children:[(0,J.jsx)(d.default,{className:"text-base font-semibold "+(X===e.id?"text-blue-600":"text-gray-900"),children:e.name}),(0,J.jsxs)(d.default,{className:"text-gray-600 text-sm mt-1",children:["Pattern ID: ",e.patternId," \u2022 Position: ",e.position]})]},e.id))]})]})})})]})}var pe=a(68703),be=a(82909);const ye=[{id:"pattern-1",name:'Pattern 1: 4\xd71/2"',strands:[{size:"1/2",count:4,diameter:.5,area:.153}],eValue:2,totalArea:.612,description:'4 strands of 1/2" diameter'},{id:"pattern-2",name:'Pattern 2: 6\xd71/2"',strands:[{size:"1/2",count:6,diameter:.5,area:.153}],eValue:2.5,totalArea:.918,description:'6 strands of 1/2" diameter'},{id:"pattern-3",name:'Pattern 3: 8\xd71/2"',strands:[{size:"1/2",count:8,diameter:.5,area:.153}],eValue:3,totalArea:1.224,description:'8 strands of 1/2" diameter'},{id:"pattern-4",name:'Pattern 4: 10\xd71/2"',strands:[{size:"1/2",count:10,diameter:.5,area:.153}],eValue:3.5,totalArea:1.53,description:'10 strands of 1/2" diameter'},{id:"pattern-5",name:'Pattern 5: 4\xd70.6"',strands:[{size:"0.6",count:4,diameter:.6,area:.217}],eValue:2.5,totalArea:.868,description:'4 strands of 0.6" diameter'},{id:"pattern-6",name:'Pattern 6: 6\xd70.6"',strands:[{size:"0.6",count:6,diameter:.6,area:.217}],eValue:3,totalArea:1.302,description:'6 strands of 0.6" diameter'},{id:"pattern-7",name:'Pattern 7: Mixed 4\xd71/2" + 4\xd73/8"',strands:[{size:"1/2",count:4,diameter:.5,area:.153},{size:"3/8",count:4,diameter:.375,area:.085}],eValue:2.25,totalArea:.952,description:'4 strands 1/2" + 4 strands 3/8"'},{id:"pattern-8",name:'Pattern 8: 12\xd71/2"',strands:[{size:"1/2",count:12,diameter:.5,area:.153}],eValue:4,totalArea:1.836,description:'12 strands of 1/2" diameter'},{id:"custom",name:"Custom Pattern",strands:[],eValue:0,totalArea:0,description:"Define your own strand pattern"}];function je(e){return ye.find(t=>t.id===e)}function Ne(){const e=(0,i.useSafeAreaInsets)(),t=(0,c.useNavigation)(),a=(0,c.useRoute)(),{calculation:s}=a.params,{updateCalculation:r}=te(),[l,u]=(0,f.useState)(s.actualMeasuredCamber?.toString()||""),m=void 0!==s.variance?s.variance:void 0!==s.actualMeasuredCamber?s.actualMeasuredCamber-s.results.netInitialCamber:void 0;return(0,J.jsx)(n.default,{className:"flex-1 bg-gray-50",children:(0,J.jsx)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:e.bottom+20},children:(0,J.jsxs)(n.default,{className:"p-5",children:[(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-3xl font-bold text-gray-900",children:"Results"}),(0,J.jsx)(o.default,{onPress:async()=>{const{inputs:e,results:t}=s,a=`Camber Calculator Results\nProject: ${s.projectName||"Unnamed"}\n\nINPUTS:\n\u2022 Member Type: ${e.memberType}\n\u2022 Span: ${e.span.toFixed(3)} ft\n\u2022 Release Strength (f'ci): ${e.releaseStrength} psi\n\u2022 28-Day Strength (f'c): ${e.concreteStrength} psi\n\u2022 Moment of Inertia: ${e.momentOfInertia.toFixed(0)} in\u2074\n\u2022 Dead Load: ${e.deadLoad} lb/ft\n${e.liveLoad?`\u2022 Live Load: ${e.liveLoad} lb/ft`:""}\n\nRESULTS:\n\u2022 Recommended Camber: ${ce(t.recommendedCamber)}\n\u2022 Calculated Camber at Release: ${ce(t.netInitialCamber)}\n  (Prestress: ${ce(t.initialCamber)} - Dead Load: ${ce(t.deadLoadDeflection)})\n${t.liveLoadDeflection?`\u2022 Live Load Deflection: ${ce(t.liveLoadDeflection)}`:""}\n\u2022 Long-Term Deflection: ${ce(t.longTermDeflection)}\n\u2022 Final Camber: ${ce(t.finalCamber)}\n\u2022 Ec at Release: ${(t.releaseModulusOfElasticity/1e6).toFixed(2)} x 10\u2076 psi\n\u2022 Ec at 28 Days: ${(t.modulusOfElasticity/1e6).toFixed(2)} x 10\u2076 psi\n\nGenerated by Camber Calculator`;try{await pe.default.share({message:a})}catch(qa){console.error("Error sharing:",qa)}},className:"bg-blue-500 rounded-full p-2.5",children:(0,J.jsx)(x.default,{name:"share-outline",size:20,color:"white"})})]}),s.projectName&&(0,J.jsx)(d.default,{className:"text-base text-gray-600",children:s.projectName})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-4 mb-5 shadow-sm",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-4",children:"Camber Profile"}),(0,J.jsx)(Fe,{calculation:s})]}),(0,J.jsxs)(n.default,{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-5 mb-5 shadow-sm",children:[(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold mb-3",children:"RECOMMENDED CAMBER"}),(0,J.jsx)(d.default,{className:"text-white text-5xl font-bold mb-2",children:s.results.recommendedCamber.toFixed(3)}),(0,J.jsxs)(d.default,{className:"text-blue-100 text-base",children:["inches (\u2248",ie(s.results.recommendedCamber),")"]})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-5 mb-5 shadow-sm",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center mb-4",children:[(0,J.jsx)(x.default,{name:"resize",size:20,color:"#3B82F6"}),(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 ml-2",children:"Measured Camber at Release"})]}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 mb-3",children:"Enter the actual measured camber from the field at release:"}),(0,J.jsxs)(n.default,{className:"flex-row gap-3 mb-3",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"e.g., 0.6875 or 11/16",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:l,onChangeText:u}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-1 px-1",children:"Accepts decimal (0.6875) or fraction (11/16 or 1 5/16)"})]}),(0,J.jsx)(o.default,{onPress:()=>{const e=ue(l);if(null!==e&&e>0){const t=e-s.results.netInitialCamber;r(s.id,{actualMeasuredCamber:e,variance:t,measurementDate:Date.now()})}},className:"bg-blue-500 rounded-xl px-6 py-3 justify-center active:bg-blue-600",children:(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Save"})})]}),void 0!==s.actualMeasuredCamber&&void 0!==m&&(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded-lg p-3",children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-sm text-gray-700",children:"Measured:"}),(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-900",children:ce(s.actualMeasuredCamber)})]}),(0,J.jsxs)(n.default,{className:"flex-row justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-sm text-gray-700",children:"Calculated at Release:"}),(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-900",children:ce(s.results.netInitialCamber)})]}),(0,J.jsx)(n.default,{className:"border-t border-gray-300 my-2"}),(0,J.jsxs)(n.default,{className:"flex-row justify-between",children:[(0,J.jsx)(d.default,{className:"text-sm font-bold text-gray-900",children:"Variance:"}),(0,J.jsxs)(d.default,{className:"text-sm font-bold "+(m>=0?"text-blue-600":"text-orange-600"),children:[m>=0?"+":"",m.toFixed(3),'" (',m>=0?"+":"",ie(Math.abs(m)),")"]})]}),(0,J.jsx)(n.default,{className:"mt-3 bg-yellow-50 border border-yellow-200 rounded-lg p-2",children:(0,J.jsx)(d.default,{className:"text-xs text-yellow-800 text-center",children:"\u26a0\ufe0f Tolerance checking coming soon"})})]})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-5 mb-5 shadow-sm",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-4",children:"Detailed Results"}),(0,J.jsx)(n.default,{className:"bg-blue-50 rounded-lg p-3 mb-3 border-2 border-blue-200",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center flex-1",children:[(0,J.jsx)(n.default,{className:"bg-blue-500 rounded-full p-2 mr-3",children:(0,J.jsx)(x.default,{name:"trending-up",size:18,color:"white"})}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-bold text-blue-900",children:"Calculated Camber at Release"}),(0,J.jsx)(d.default,{className:"text-xs text-blue-700 mt-0.5",children:"Expected field measurement after stripping"})]})]}),(0,J.jsx)(n.default,{className:"items-end",children:(0,J.jsx)(d.default,{className:"text-lg font-bold text-blue-900",children:ce(s.results.netInitialCamber)})})]})}),(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[(0,J.jsx)(d.default,{className:"text-xs font-semibold text-gray-700 mb-2",children:"Breakdown:"}),(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center mb-1",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:"\u2022 Prestress Camber (built-in)"}),(0,J.jsx)(d.default,{className:"text-xs font-medium text-gray-900",children:ce(s.results.initialCamber)})]}),(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center mb-1",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:"\u2022 Dead Load Deflection"}),(0,J.jsxs)(d.default,{className:"text-xs font-medium text-red-600",children:["-",ce(s.results.deadLoadDeflection)]})]}),(0,J.jsx)(n.default,{className:"border-t border-gray-300 my-1"}),(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsx)(d.default,{className:"text-xs font-semibold text-gray-900",children:"= Net Camber Measurement"}),(0,J.jsx)(d.default,{className:"text-xs font-bold text-blue-900",children:ce(s.results.netInitialCamber)})]})]}),s.results.liveLoadDeflection&&(0,J.jsx)(we,{label:"Live Load Deflection",value:s.results.liveLoadDeflection,unit:"in",icon:"arrow-down-circle",showFraction:!0}),(0,J.jsx)(we,{label:"Long-Term Deflection",value:s.results.longTermDeflection,unit:"in",icon:"time",showFraction:!0}),(0,J.jsx)(we,{label:"Final Camber",value:s.results.finalCamber,unit:"in",icon:"analytics",showFraction:!0,isLast:!0})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-5 mb-5 shadow-sm",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-4",children:"Material Properties"}),(0,J.jsx)(we,{label:"Ec at Release",value:(s.results.releaseModulusOfElasticity/1e6).toFixed(2),unit:"\xd7 10\u2076 psi",icon:"flash"}),(0,J.jsx)(we,{label:"Ec at 28 Days",value:(s.results.modulusOfElasticity/1e6).toFixed(2),unit:"\xd7 10\u2076 psi",icon:"cube"}),(0,J.jsx)(we,{label:"Creep Factor",value:s.results.creepFactor.toFixed(2),unit:"",icon:"hourglass"}),(0,J.jsx)(we,{label:"Shrinkage Factor",value:s.results.shrinkageFactor.toFixed(2),unit:"",icon:"contract",isLast:!0})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-5 mb-5 shadow-sm",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-4",children:"Input Summary"}),s.inputs.projectNumber&&(0,J.jsx)(Se,{label:"Project #",value:s.inputs.projectNumber}),s.inputs.markNumber&&(0,J.jsx)(Se,{label:"Mark #",value:s.inputs.markNumber}),s.inputs.idNumber&&(0,J.jsx)(Se,{label:"ID #",value:s.inputs.idNumber}),(0,J.jsx)(Se,{label:"Member Type",value:s.inputs.memberType}),(0,J.jsx)(Se,{label:"Span",value:`${s.inputs.span.toFixed(3)} ft`}),(0,J.jsx)(Se,{label:"Release Strength (f'ci)",value:`${s.inputs.releaseStrength} psi`}),(0,J.jsx)(Se,{label:"28-Day Strength (f'c)",value:`${s.inputs.concreteStrength} psi`}),(0,J.jsx)(Se,{label:"Moment of Inertia",value:`${s.inputs.momentOfInertia.toFixed(0)} in\u2074`}),(0,J.jsx)(Se,{label:"Dead Load",value:`${s.inputs.deadLoad} lb/ft`}),s.inputs.liveLoad&&(0,J.jsx)(Se,{label:"Live Load",value:`${s.inputs.liveLoad} lb/ft`}),s.inputs.strandPattern&&je(s.inputs.strandPattern)&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Se,{label:"Strand Pattern",value:je(s.inputs.strandPattern)?.name||""}),(0,J.jsx)(Se,{label:"e value",value:`${s.inputs.strandEValue}" from bottom`})]}),s.inputs.topStrandPattern&&je(s.inputs.topStrandPattern)&&(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(Se,{label:"Top Strand Pattern",value:je(s.inputs.topStrandPattern)?.name||"",isLast:!0})}),!s.inputs.topStrandPattern&&(0,J.jsx)(n.default,{style:{height:0}})]}),(0,J.jsx)(o.default,{onPress:()=>t.navigate("Calculator"),className:"bg-blue-500 rounded-xl py-4 items-center active:bg-blue-600 mb-3",children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"New Calculation"})}),(0,J.jsx)(o.default,{onPress:()=>t.navigate("History"),className:"bg-white border border-gray-300 rounded-xl py-4 items-center active:bg-gray-50",children:(0,J.jsx)(d.default,{className:"text-gray-700 text-base font-semibold",children:"View History"})})]})})})}function we({label:e,value:t,unit:a,icon:s,isLast:r,showFraction:l=!1}){const o="number"===typeof t&&l?ce(t):"number"===typeof t?t.toFixed(3):t;return(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between py-3 "+(r?"":"border-b border-gray-100"),children:[(0,J.jsxs)(n.default,{className:"flex-row items-center flex-1",children:[(0,J.jsx)(n.default,{className:"bg-gray-100 rounded-full p-2 mr-3",children:(0,J.jsx)(x.default,{name:s,size:18,color:"#4B5563"})}),(0,J.jsx)(d.default,{className:"text-sm text-gray-700",children:e})]}),(0,J.jsxs)(d.default,{className:"text-base font-semibold text-gray-900",children:[o," ",(0,J.jsx)(d.default,{className:"text-sm text-gray-600",children:a})]})]})}function Se({label:e,value:t,isLast:a}){return(0,J.jsxs)(n.default,{className:"flex-row justify-between py-3 "+(a?"":"border-b border-gray-100"),children:[(0,J.jsx)(d.default,{className:"text-sm text-gray-600",children:e}),(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-900",children:t})]})}function Fe({calculation:e}){const t=20,a=100,{netInitialCamber:s,finalCamber:r}=e.results,{actualMeasuredCamber:l}=e,o=Math.max(Math.abs(s),Math.abs(r),l?Math.abs(l):0),i=o>0?30/o:1,c=a-s*i,u=a-r*i,m=l?a-l*i:null,x=e=>`M 20 100 Q 160 ${e} 300 100`;return(0,J.jsxs)(n.default,{children:[(0,J.jsxs)(be.default,{width:320,height:200,children:[(0,J.jsx)(be.Line,{x1:t,y1:a,x2:300,y2:a,stroke:"#D1D5DB",strokeWidth:"1",strokeDasharray:"4,4"}),(0,J.jsx)(be.Path,{d:x(c),stroke:"#3B82F6",strokeWidth:"2",fill:"none"}),null!==m&&(0,J.jsx)(be.Path,{d:x(m),stroke:"#F97316",strokeWidth:"2",fill:"none"}),r>0&&(0,J.jsx)(be.Path,{d:x(u),stroke:"#10B981",strokeWidth:"2",fill:"none",strokeDasharray:"4,4"}),(0,J.jsx)(be.Circle,{cx:t,cy:a,r:"4",fill:"#6B7280"}),(0,J.jsx)(be.Circle,{cx:300,cy:a,r:"4",fill:"#6B7280"}),(0,J.jsx)(be.Line,{x1:160,y1:a,x2:160,y2:c,stroke:"#3B82F6",strokeWidth:"1"}),(0,J.jsx)(be.Circle,{cx:160,cy:c,r:"3",fill:"#3B82F6"}),null!==m&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(be.Line,{x1:200,y1:a,x2:200,y2:m,stroke:"#F97316",strokeWidth:"1"}),(0,J.jsx)(be.Circle,{cx:200,cy:m,r:"3",fill:"#F97316"})]})]}),(0,J.jsxs)(n.default,{className:"flex-row justify-center gap-4 mt-2 mb-2",children:[(0,J.jsxs)(n.default,{className:"items-center",children:[(0,J.jsxs)(d.default,{className:"text-xs font-semibold text-blue-600",children:[s.toFixed(3),'" (\u2248',ie(s),")"]}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:"Calculated"})]}),void 0!==l&&(0,J.jsxs)(n.default,{className:"items-center",children:[(0,J.jsxs)(d.default,{className:"text-xs font-semibold text-orange-600",children:[l.toFixed(3),'" (\u2248',ie(l),")"]}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:"Measured"})]})]}),(0,J.jsxs)(n.default,{className:"mt-2 space-y-2",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"w-8 h-0.5 bg-blue-500 mr-2"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:"Calculated camber at release"})]}),void 0!==l&&(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"w-8 h-0.5 bg-orange-500 mr-2"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:"Measured camber at release"})]}),r>0&&(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"w-8 border-b border-dashed border-green-500 mr-2"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:"Final camber (long-term)"})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"w-8 border-b border-dashed border-gray-400 mr-2"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:"Reference (no camber)"})]})]})]})}var Ce=a(9948);function ve({visible:e,title:t,message:a,confirmText:s="Confirm",cancelText:r="Cancel",onConfirm:l,onCancel:i,confirmStyle:c="default"}){return(0,J.jsx)(p.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:i,children:(0,J.jsx)(o.default,{className:"flex-1 items-center justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onPress:i,children:(0,J.jsxs)(o.default,{className:"bg-white rounded-2xl mx-5 w-80 overflow-hidden",onPress:e=>e.stopPropagation(),children:[(0,J.jsxs)(n.default,{className:"p-5",children:[(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900 mb-2",children:t}),(0,J.jsx)(d.default,{className:"text-base text-gray-600 leading-6",children:a})]}),(0,J.jsx)(n.default,{className:"border-t border-gray-200",children:(0,J.jsxs)(n.default,{className:"flex-row",children:[(0,J.jsx)(o.default,{onPress:i,className:"flex-1 py-4 items-center border-r border-gray-200 active:bg-gray-50",children:(0,J.jsx)(d.default,{className:"text-base font-semibold text-blue-500",children:r})}),(0,J.jsx)(o.default,{onPress:l,className:"flex-1 py-4 items-center active:bg-gray-50",children:(0,J.jsx)(d.default,{className:"text-base font-semibold "+("destructive"===c?"text-red-500":"text-blue-500"),children:s})})]})})]})})})}const Ae=[{value:"beam",label:"Beam"},{value:"double-tee",label:"Double Tee"},{value:"hollow-core",label:"Hollow Core"},{value:"single-tee",label:"Single Tee"},{value:"solid-slab",label:"Solid Slab"},{value:"wall-panel",label:"Wall Panel"},{value:"stadia",label:"Stadia"}];function Pe(){const e=(0,i.useSafeAreaInsets)(),t=(0,c.useNavigation)(),{history:a,removeCalculation:s,clearHistory:r}=te(),{customPatterns:l}=le(),[u,m]=(0,f.useState)(!1),[b,y]=(0,f.useState)(null),[j,N]=(0,f.useState)(!1),[w,S]=(0,f.useState)({}),[F,C]=(0,f.useState)({}),v=()=>{C({}),S({}),N(!1)},A=(0,f.useMemo)(()=>0===Object.keys(w).length?a:a.filter(e=>!(w.projectName&&!e.projectName?.toLowerCase().includes(w.projectName.toLowerCase()))&&(!(w.projectNumber&&!e.inputs.projectNumber?.toLowerCase().includes(w.projectNumber.toLowerCase()))&&(!(w.markNumber&&!e.inputs.markNumber?.toLowerCase().includes(w.markNumber.toLowerCase()))&&(!(w.idNumber&&!e.inputs.idNumber?.toLowerCase().includes(w.idNumber.toLowerCase()))&&((!w.memberType||e.inputs.memberType===w.memberType)&&((!w.strandPattern||e.inputs.strandPattern===w.strandPattern)&&((!w.topStrandPattern||e.inputs.topStrandPattern===w.topStrandPattern)&&(!(void 0!==w.minSpan&&e.inputs.span<w.minSpan)&&!(void 0!==w.maxSpan&&e.inputs.span>w.maxSpan))))))))),[a,w]),P=Object.keys(w).length;return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:e.bottom+20},children:(0,J.jsxs)(n.default,{className:"p-5",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-6",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-3xl font-bold text-gray-900 mb-1",children:"History"}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600",children:[A.length," ",1===A.length?"calculation":"calculations",P>0&&` (${P} ${1===P?"filter":"filters"} active)`]})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>{console.log("Filter button pressed - opening modal"),C(w),N(!0)},className:(P>0?"bg-blue-500":"bg-gray-200")+" rounded-full p-3",children:(0,J.jsx)(x.default,{name:"filter",size:20,color:P>0?"white":"#6B7280"})}),a.length>0&&(0,J.jsx)(o.default,{onPress:()=>m(!0),className:"bg-red-50 px-3 py-2 rounded-lg",children:(0,J.jsx)(d.default,{className:"text-red-600 text-sm font-medium",children:"Clear All"})})]})]}),P>0&&(0,J.jsx)(n.default,{className:"mb-4",children:(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-2",children:[w.projectName&&(0,J.jsxs)(n.default,{className:"bg-blue-100 px-3 py-1.5 rounded-full flex-row items-center",children:[(0,J.jsxs)(d.default,{className:"text-blue-700 text-xs font-medium mr-1",children:["Project: ",w.projectName]}),(0,J.jsx)(o.default,{onPress:()=>S(e=>Object.assign({},e,{projectName:void 0})),children:(0,J.jsx)(x.default,{name:"close-circle",size:14,color:"#1D4ED8"})})]}),w.projectNumber&&(0,J.jsxs)(n.default,{className:"bg-blue-100 px-3 py-1.5 rounded-full flex-row items-center",children:[(0,J.jsxs)(d.default,{className:"text-blue-700 text-xs font-medium mr-1",children:["Proj #: ",w.projectNumber]}),(0,J.jsx)(o.default,{onPress:()=>S(e=>Object.assign({},e,{projectNumber:void 0})),children:(0,J.jsx)(x.default,{name:"close-circle",size:14,color:"#1D4ED8"})})]}),w.markNumber&&(0,J.jsxs)(n.default,{className:"bg-blue-100 px-3 py-1.5 rounded-full flex-row items-center",children:[(0,J.jsxs)(d.default,{className:"text-blue-700 text-xs font-medium mr-1",children:["Mark #: ",w.markNumber]}),(0,J.jsx)(o.default,{onPress:()=>S(e=>Object.assign({},e,{markNumber:void 0})),children:(0,J.jsx)(x.default,{name:"close-circle",size:14,color:"#1D4ED8"})})]}),w.idNumber&&(0,J.jsxs)(n.default,{className:"bg-blue-100 px-3 py-1.5 rounded-full flex-row items-center",children:[(0,J.jsxs)(d.default,{className:"text-blue-700 text-xs font-medium mr-1",children:["ID #: ",w.idNumber]}),(0,J.jsx)(o.default,{onPress:()=>S(e=>Object.assign({},e,{idNumber:void 0})),children:(0,J.jsx)(x.default,{name:"close-circle",size:14,color:"#1D4ED8"})})]}),w.memberType&&(0,J.jsxs)(n.default,{className:"bg-purple-100 px-3 py-1.5 rounded-full flex-row items-center",children:[(0,J.jsxs)(d.default,{className:"text-purple-700 text-xs font-medium mr-1",children:["Type: ",Ae.find(e=>e.value===w.memberType)?.label]}),(0,J.jsx)(o.default,{onPress:()=>S(e=>Object.assign({},e,{memberType:void 0})),children:(0,J.jsx)(x.default,{name:"close-circle",size:14,color:"#7C3AED"})})]}),w.strandPattern&&(0,J.jsxs)(n.default,{className:"bg-green-100 px-3 py-1.5 rounded-full flex-row items-center",children:[(0,J.jsxs)(d.default,{className:"text-green-700 text-xs font-medium mr-1",children:["Strand: ",l.find(e=>e.id===w.strandPattern)?.name]}),(0,J.jsx)(o.default,{onPress:()=>S(e=>Object.assign({},e,{strandPattern:void 0})),children:(0,J.jsx)(x.default,{name:"close-circle",size:14,color:"#059669"})})]}),(void 0!==w.minSpan||void 0!==w.maxSpan)&&(0,J.jsxs)(n.default,{className:"bg-orange-100 px-3 py-1.5 rounded-full flex-row items-center",children:[(0,J.jsxs)(d.default,{className:"text-orange-700 text-xs font-medium mr-1",children:["Span: ",w.minSpan??"0"," - ",w.maxSpan??"\u221e"," ft"]}),(0,J.jsx)(o.default,{onPress:()=>S(e=>Object.assign({},e,{minSpan:void 0,maxSpan:void 0})),children:(0,J.jsx)(x.default,{name:"close-circle",size:14,color:"#EA580C"})})]})]})}),0===A.length?(0,J.jsxs)(n.default,{className:"items-center justify-center py-20",children:[(0,J.jsx)(n.default,{className:"bg-gray-100 rounded-full p-6 mb-4",children:(0,J.jsx)(x.default,{name:P>0?"search-outline":"calculator-outline",size:48,color:"#9CA3AF"})}),(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-2",children:P>0?"No Matching Calculations":"No Calculations Yet"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 text-center mb-6 px-8",children:P>0?"Try adjusting your filters to see more results":"Your calculation history will appear here"}),P>0?(0,J.jsx)(o.default,{onPress:v,className:"bg-blue-500 px-6 py-3 rounded-xl",children:(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Clear Filters"})}):(0,J.jsx)(o.default,{onPress:()=>t.navigate("Calculator"),className:"bg-blue-500 px-6 py-3 rounded-xl",children:(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Create First Calculation"})})]}):(0,J.jsx)(n.default,{className:"space-y-3",children:A.map(e=>(0,J.jsxs)(o.default,{onPress:()=>t.navigate("Results",{calculation:e}),className:"bg-white rounded-xl p-4 shadow-sm active:bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-row items-start justify-between mb-3",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-900 mb-1",children:e.projectName||"Unnamed Project"}),(e.inputs.projectNumber||e.inputs.markNumber||e.inputs.idNumber)&&(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-2 mb-1",children:[e.inputs.projectNumber&&(0,J.jsx)(n.default,{className:"bg-gray-100 px-2 py-0.5 rounded",children:(0,J.jsxs)(d.default,{className:"text-xs text-gray-700",children:["Proj: ",e.inputs.projectNumber]})}),e.inputs.markNumber&&(0,J.jsx)(n.default,{className:"bg-gray-100 px-2 py-0.5 rounded",children:(0,J.jsxs)(d.default,{className:"text-xs text-gray-700",children:["Mark: ",e.inputs.markNumber]})}),e.inputs.idNumber&&(0,J.jsx)(n.default,{className:"bg-gray-100 px-2 py-0.5 rounded",children:(0,J.jsxs)(d.default,{className:"text-xs text-gray-700",children:["ID: ",e.inputs.idNumber]})})]}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:(0,Ce.format)(new Date(e.timestamp),"MMM dd, yyyy \u2022 h:mm a")})]}),(0,J.jsx)(o.default,{onPress:()=>y(e.id),className:"bg-red-50 rounded-full p-2 ml-2",children:(0,J.jsx)(x.default,{name:"trash-outline",size:16,color:"#EF4444"})})]}),(0,J.jsxs)(n.default,{className:"border-t border-gray-100 pt-3",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"resize-outline",size:16,color:"#6B7280"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 ml-1",children:e.inputs.memberType})]}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600",children:me(e.inputs.span)})]}),(0,J.jsx)(n.default,{className:"bg-blue-50 rounded-lg px-3 py-2 mt-2",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsx)(d.default,{className:"text-xs text-blue-700 font-medium",children:"Calculated Camber at Release"}),(0,J.jsx)(d.default,{className:"text-base font-bold text-blue-700",children:ce(e.results.netInitialCamber)})]})}),void 0!==e.actualMeasuredCamber&&(0,J.jsxs)(n.default,{className:"bg-green-50 rounded-lg px-3 py-2 mt-2",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-1",children:[(0,J.jsx)(d.default,{className:"text-xs text-green-700 font-medium",children:"Measured Camber"}),(0,J.jsx)(d.default,{className:"text-sm font-bold text-green-700",children:ce(e.actualMeasuredCamber)})]}),void 0!==e.variance&&(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:"Variance"}),(0,J.jsxs)(d.default,{className:"text-xs font-semibold "+(Math.abs(e.variance)<.0625?"text-green-600":"text-orange-600"),children:[e.variance>=0?"+":"",e.variance.toFixed(3),'" (\u2248',e.variance>=0?"+":"",ie(Math.abs(e.variance)),")"]})]})]})]}),(0,J.jsx)(n.default,{className:"flex-row items-center justify-end mt-3",children:(0,J.jsx)(x.default,{name:"chevron-forward",size:16,color:"#9CA3AF"})})]},e.id))})]})}),(0,J.jsx)(p.default,{visible:j,transparent:!0,animationType:"slide",onRequestClose:()=>N(!1),children:(0,J.jsxs)(n.default,{className:"flex-1 justify-end",style:{backgroundColor:"rgba(0,0,0,0.5)"},children:[(0,J.jsx)(o.default,{onPress:()=>N(!1),className:"flex-1"}),(0,J.jsxs)(n.default,{className:"bg-white rounded-t-3xl overflow-hidden",style:{height:"85%",flexDirection:"column"},children:[(0,J.jsx)(n.default,{className:"p-5 border-b border-gray-200",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900",children:"Filter Calculations"}),(0,J.jsx)(o.default,{onPress:()=>N(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]})}),(0,J.jsxs)(g.default,{style:{flex:1},contentContainerStyle:{padding:20,paddingBottom:40},children:[(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Project Name"}),(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"Search by project name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:F.projectName||"",onChangeText:e=>C(t=>Object.assign({},t,{projectName:e||void 0}))})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Project #"}),(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"Search by project number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:F.projectNumber||"",onChangeText:e=>C(t=>Object.assign({},t,{projectNumber:e||void 0}))})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Mark #"}),(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"Search by mark number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:F.markNumber||"",onChangeText:e=>C(t=>Object.assign({},t,{markNumber:e||void 0}))})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"ID #"}),(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"Search by ID number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:F.idNumber||"",onChangeText:e=>C(t=>Object.assign({},t,{idNumber:e||void 0}))})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Member Type"}),(0,J.jsx)(n.default,{className:"flex-row flex-wrap gap-2",children:Ae.map(e=>(0,J.jsx)(o.default,{onPress:()=>C(t=>Object.assign({},t,{memberType:t.memberType===e.value?void 0:e.value})),className:"px-3 py-2 rounded-xl border "+(F.memberType===e.value?"bg-purple-500 border-purple-500":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-sm font-medium "+(F.memberType===e.value?"text-white":"text-gray-700"),children:e.label})},e.value))})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Strand Pattern"}),(0,J.jsxs)(g.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>C(e=>Object.assign({},e,{strandPattern:void 0})),className:"px-3 py-2 rounded-xl border "+(F.strandPattern?"bg-white border-gray-300":"bg-gray-500 border-gray-500"),children:(0,J.jsx)(d.default,{className:"text-sm font-medium "+(F.strandPattern?"text-gray-700":"text-white"),children:"Any"})}),l.map(e=>(0,J.jsx)(o.default,{onPress:()=>C(t=>Object.assign({},t,{strandPattern:t.strandPattern===e.id?void 0:e.id})),className:"px-3 py-2 rounded-xl border "+(F.strandPattern===e.id?"bg-green-500 border-green-500":"bg-white border-gray-300"),children:(0,J.jsxs)(d.default,{className:"text-sm font-medium "+(F.strandPattern===e.id?"text-white":"text-gray-700"),children:[e.patternId," - ",e.name]})},e.id))]})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Top Strand Pattern"}),(0,J.jsxs)(g.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>C(e=>Object.assign({},e,{topStrandPattern:void 0})),className:"px-3 py-2 rounded-xl border "+(F.topStrandPattern?"bg-white border-gray-300":"bg-gray-500 border-gray-500"),children:(0,J.jsx)(d.default,{className:"text-sm font-medium "+(F.topStrandPattern?"text-gray-700":"text-white"),children:"Any"})}),l.map(e=>(0,J.jsx)(o.default,{onPress:()=>C(t=>Object.assign({},t,{topStrandPattern:t.topStrandPattern===e.id?void 0:e.id})),className:"px-3 py-2 rounded-xl border "+(F.topStrandPattern===e.id?"bg-blue-500 border-blue-500":"bg-white border-gray-300"),children:(0,J.jsxs)(d.default,{className:"text-sm font-medium "+(F.topStrandPattern===e.id?"text-white":"text-gray-700"),children:[e.patternId," - ",e.name]})},e.id))]})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Span Range (feet)"}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-600 mb-1",children:"Min"}),(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"0",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"decimal-pad",value:F.minSpan?.toString()||"",onChangeText:e=>{const t=parseFloat(e);C(e=>Object.assign({},e,{minSpan:isNaN(t)?void 0:t}))}})]}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-600 mb-1",children:"Max"}),(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"\u221e",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"decimal-pad",value:F.maxSpan?.toString()||"",onChangeText:e=>{const t=parseFloat(e);C(e=>Object.assign({},e,{maxSpan:isNaN(t)?void 0:t}))}})]})]})]})]}),(0,J.jsxs)(n.default,{className:"p-5 border-t border-gray-200",children:[(0,J.jsx)(o.default,{onPress:()=>{S(F),N(!1)},className:"bg-blue-500 rounded-xl py-4 items-center active:bg-blue-600 mb-3",children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Apply Filters"})}),(0,J.jsx)(o.default,{onPress:v,className:"bg-white border border-gray-300 rounded-xl py-4 items-center active:bg-gray-50",children:(0,J.jsx)(d.default,{className:"text-gray-700 text-base font-semibold",children:"Clear All Filters"})})]})]})]})}),(0,J.jsx)(ve,{visible:u,title:"Clear History",message:"Are you sure you want to delete all calculations? This action cannot be undone.",confirmText:"Clear All",cancelText:"Cancel",confirmStyle:"destructive",onConfirm:()=>{r(),m(!1)},onCancel:()=>m(!1)}),(0,J.jsx)(ve,{visible:null!==b,title:"Delete Calculation",message:"Are you sure you want to delete this calculation?",confirmText:"Delete",cancelText:"Cancel",confirmStyle:"destructive",onConfirm:()=>b&&(s(b),void y(null)),onCancel:()=>y(null)})]})}var Te=a(51690),Ee=a(9443);const ze={Extruded:["8048","1048","1247","1250","1648"],"Wall Panels":[],Flexicore:[],Precast:[]};function Be(){const e=(0,i.useSafeAreaInsets)(),{customPatterns:t,addPattern:a,removePattern:s,updatePattern:r,clearAllPatterns:l}=le(),[c,u]=(0,f.useState)(null),[m,h]=(0,f.useState)(null),[p,b]=(0,f.useState)(!1),[y,j]=(0,f.useState)(null),[N,w]=(0,f.useState)(null),[S,F]=(0,f.useState)(!1);f.useEffect(()=>{t.forEach(e=>{if(!e.department||!e.productType){const t=e.name.toLowerCase();let a="",s="Extruded";t.includes("8048")?(a="8048",s="Extruded"):t.includes("1048")?(a="1048",s="Extruded"):t.includes("1247")?(a="1247",s="Extruded"):t.includes("1250")?(a="1250",s="Extruded"):t.includes("1648")&&(a="1648",s="Extruded"),a&&r(e.id,Object.assign({},e,{department:s,productType:a}))}})},[]);const C=[...t.filter(e=>!!c&&(m?e.department===c&&e.productType===m:e.department===c))].sort((e,t)=>{const a={Bottom:0,Top:1,Both:2},s=a[e.position]-a[t.position];if(0!==s)return s;const r=e=>{const t=e.match(/(\d+)/);return t?parseInt(t[1]):0},l=r(e.patternId);return r(t.patternId)-l}),v=async()=>{try{const e=JSON.stringify(t,null,2);{const t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=`strand-patterns-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}}catch(qa){console.error("Export error:",qa)}},A=async()=>{try{{const e=document.createElement("input");e.type="file",e.accept="application/json",e.onchange=async e=>{const s=e.target.files[0];if(s){const e=new FileReader;e.onload=e=>{try{const s=JSON.parse(e.target.result);Array.isArray(s)&&s.forEach(e=>{t.find(t=>t.id===e.id)||a(e)})}catch(qa){console.error("JSON parse error:",qa)}},e.readAsText(s)}},e.click()}}catch(qa){console.error("Import error:",qa)}},P=async()=>{try{const e=JSON.stringify(t,null,2);await Ee.setStringAsync(e),Te.default.alert("Success","Patterns copied to clipboard!")}catch(qa){console.error("Copy error:",qa),Te.default.alert("Error","Failed to copy to clipboard")}},T=async()=>{try{const e=await Ee.getStringAsync();if(!e)return void Te.default.alert("Error","Clipboard is empty");const s=JSON.parse(e);if(!Array.isArray(s))return void Te.default.alert("Error","Invalid data format");let r=0;s.forEach(e=>{t.find(t=>t.id===e.id)||(a(e),r++)}),Te.default.alert("Success",`Imported ${r} pattern(s)`)}catch(qa){console.error("Paste error:",qa),Te.default.alert("Error","Failed to parse clipboard data")}},E=()=>{h(null),u(null)};if(!c)return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:e.bottom+20},children:(0,J.jsxs)(n.default,{className:"p-5",children:[(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-3xl font-bold text-gray-900 mb-2",children:"Strand Pattern Manager"}),(0,J.jsx)(d.default,{className:"text-base text-gray-600",children:"Select a department to manage strand patterns"})]}),(0,J.jsx)(n.default,{className:"space-y-3",children:["Extruded","Wall Panels","Flexicore","Precast"].map(e=>(0,J.jsx)(o.default,{onPress:()=>u(e),className:"bg-white rounded-xl p-5 shadow-sm active:bg-gray-50",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900 mb-1",children:e}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600",children:[t.filter(t=>t.department===e).length," patterns"]})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:24,color:"#9CA3AF"})]})},e))}),(0,J.jsxs)(n.default,{className:"mt-8 space-y-3",children:[(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsxs)(o.default,{onPress:A,className:"flex-1 bg-green-500 rounded-xl py-3 items-center active:bg-green-600",children:[(0,J.jsx)(x.default,{name:"cloud-upload-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold mt-1",children:"Import JSON"})]}),(0,J.jsxs)(o.default,{onPress:v,className:"flex-1 bg-purple-500 rounded-xl py-3 items-center active:bg-purple-600",disabled:0===t.length,style:{opacity:0===t.length?.5:1},children:[(0,J.jsx)(x.default,{name:"cloud-download-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold mt-1",children:"Export JSON"})]})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsxs)(o.default,{onPress:P,className:"flex-1 bg-orange-500 rounded-xl py-3 items-center active:bg-orange-600",disabled:0===t.length,style:{opacity:0===t.length?.5:1},children:[(0,J.jsx)(x.default,{name:"copy-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold mt-1",children:"Copy Text"})]}),(0,J.jsxs)(o.default,{onPress:T,className:"flex-1 bg-teal-500 rounded-xl py-3 items-center active:bg-teal-600",children:[(0,J.jsx)(x.default,{name:"clipboard-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold mt-1",children:"Paste Text"})]})]}),t.length>0&&(0,J.jsxs)(o.default,{onPress:()=>F(!0),className:"bg-red-500 rounded-xl py-3 items-center active:bg-red-600",children:[(0,J.jsx)(x.default,{name:"trash-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold mt-1",children:"Clear All Patterns"})]})]})]})}),(0,J.jsx)(ve,{visible:S,title:"Clear All Patterns?",message:"This will permanently delete all custom strand patterns. This action cannot be undone.",onConfirm:()=>{l(),F(!1)},onCancel:()=>F(!1)})]});if(!m){const a=ze[c];return(0,J.jsx)(n.default,{className:"flex-1 bg-gray-50",children:(0,J.jsx)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:e.bottom+20},children:(0,J.jsxs)(n.default,{className:"p-5",children:[(0,J.jsxs)(o.default,{onPress:E,className:"flex-row items-center mb-4",children:[(0,J.jsx)(x.default,{name:"chevron-back",size:24,color:"#3B82F6"}),(0,J.jsx)(d.default,{className:"text-blue-500 text-base font-semibold ml-1",children:"Back to Departments"})]}),(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-3xl font-bold text-gray-900 mb-2",children:c}),(0,J.jsx)(d.default,{className:"text-base text-gray-600",children:"Select a product type"})]}),a.length>0?(0,J.jsx)(n.default,{className:"space-y-3",children:a.map(e=>(0,J.jsx)(o.default,{onPress:()=>h(e),className:"bg-white rounded-xl p-5 shadow-sm active:bg-gray-50",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900 mb-1",children:e}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600",children:[t.filter(t=>t.department===c&&t.productType===e).length," patterns"]})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:24,color:"#9CA3AF"})]})},e))}):(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-8 items-center",children:[(0,J.jsx)(x.default,{name:"construct-outline",size:48,color:"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mt-4 mb-2",children:"No Product Types Yet"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 text-center",children:"Product types for this department will be added soon"})]})]})})})}return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:e.bottom+20},children:(0,J.jsxs)(n.default,{className:"p-5",children:[(0,J.jsxs)(o.default,{onPress:()=>{h(null)},className:"flex-row items-center mb-4",children:[(0,J.jsx)(x.default,{name:"chevron-back",size:24,color:"#3B82F6"}),(0,J.jsx)(d.default,{className:"text-blue-500 text-base font-semibold ml-1",children:"Back to Product Types"})]}),(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsxs)(d.default,{className:"text-sm text-gray-500 mb-1",children:[c," / ",m]}),(0,J.jsx)(d.default,{className:"text-3xl font-bold text-gray-900 mb-2",children:"Strand Patterns"}),(0,J.jsxs)(d.default,{className:"text-base text-gray-600",children:[C.length," pattern(s) for ",m]})]}),0===C.length?(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-8 items-center mb-5",children:[(0,J.jsx)(n.default,{className:"bg-gray-100 rounded-full p-6 mb-4",children:(0,J.jsx)(x.default,{name:"albums-outline",size:48,color:"#9CA3AF"})}),(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Patterns Yet"}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600 text-center",children:["Add your first strand pattern for ",m]})]}):(0,J.jsx)(n.default,{className:"space-y-3 mb-5",children:C.map(e=>(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-4 shadow-sm",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-3",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2 mb-1",children:[(0,J.jsx)(d.default,{className:"text-lg font-bold text-gray-900",children:e.patternId}),(0,J.jsx)(n.default,{className:"px-2 py-1 rounded "+("Top"===e.position?"bg-blue-100":"Bottom"===e.position?"bg-green-100":"bg-purple-100"),children:(0,J.jsx)(d.default,{className:"text-xs font-semibold "+("Top"===e.position?"text-blue-700":"Bottom"===e.position?"text-green-700":"text-purple-700"),children:e.position})})]}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600",children:e.name})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>(e=>{j(e),b(!0)})(e),className:"bg-blue-50 rounded-full p-2",children:(0,J.jsx)(x.default,{name:"pencil",size:20,color:"#3B82F6"})}),(0,J.jsx)(o.default,{onPress:()=>w(e.id),className:"bg-red-50 rounded-full p-2",children:(0,J.jsx)(x.default,{name:"trash-outline",size:20,color:"#EF4444"})})]})]}),(0,J.jsx)(n.default,{className:"border-t border-gray-100 pt-3",children:(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:[e.strand_3_8>0&&`${e.strand_3_8} \xd7 3/8" `,e.strand_1_2>0&&`${e.strand_1_2} \xd7 1/2" `,e.strand_0_6>0&&`${e.strand_0_6} \xd7 0.6" `,"\u2022 e = ",e.eValue,'" \u2022 Force = ',e.pullingForce,"%",e.requiredForce&&` \u2022 ${e.requiredForce.toLocaleString()} lbs`]})})]},e.id))}),(0,J.jsxs)(o.default,{onPress:()=>{c&&m?(j(null),b(!0)):Te.default.alert("Error","Please select a department and product type first")},className:"bg-blue-500 rounded-xl py-4 items-center mb-3 active:bg-blue-600 flex-row justify-center",children:[(0,J.jsx)(x.default,{name:"add-circle-outline",size:24,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Add New Pattern"})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3 mb-3",children:[(0,J.jsxs)(o.default,{onPress:A,className:"flex-1 bg-green-500 rounded-xl py-3 items-center active:bg-green-600",children:[(0,J.jsx)(x.default,{name:"cloud-upload-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold mt-1",children:"Import JSON"})]}),(0,J.jsxs)(o.default,{onPress:v,className:"flex-1 bg-purple-500 rounded-xl py-3 items-center active:bg-purple-600",disabled:0===t.length,style:{opacity:0===t.length?.5:1},children:[(0,J.jsx)(x.default,{name:"cloud-download-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold mt-1",children:"Export JSON"})]})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3 mb-3",children:[(0,J.jsxs)(o.default,{onPress:P,className:"flex-1 bg-orange-500 rounded-xl py-3 items-center active:bg-orange-600",disabled:0===t.length,style:{opacity:0===t.length?.5:1},children:[(0,J.jsx)(x.default,{name:"copy-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold mt-1",children:"Copy Text"})]}),(0,J.jsxs)(o.default,{onPress:T,className:"flex-1 bg-teal-500 rounded-xl py-3 items-center active:bg-teal-600",children:[(0,J.jsx)(x.default,{name:"clipboard-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold mt-1",children:"Paste Text"})]})]}),t.length>0&&(0,J.jsxs)(o.default,{onPress:()=>F(!0),className:"bg-red-500 rounded-xl py-3 items-center active:bg-red-600",children:[(0,J.jsx)(x.default,{name:"trash-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold mt-1",children:"Clear All Patterns"})]})]})}),p&&(0,J.jsx)(De,{pattern:y,onClose:()=>b(!1),onSave:async e=>{if(!c||!m)return void Te.default.alert("Error","Please select a department and product type");const t=Object.assign({},e,{department:c,productType:m});y?await r(y.id,t):await a(t),b(!1)}}),(0,J.jsx)(ve,{visible:null!==N,title:"Delete Pattern?",message:"This will permanently delete this strand pattern. This action cannot be undone.",onConfirm:()=>N&&(s(N),void w(null)),onCancel:()=>w(null)}),(0,J.jsx)(ve,{visible:S,title:"Clear All Patterns?",message:"This will permanently delete all custom strand patterns. This action cannot be undone.",onConfirm:()=>{l(),F(!1)},onCancel:()=>F(!1)})]})}function De({pattern:e,onClose:t,onSave:a}){const[s,r]=(0,f.useState)(e?.patternId.split("-")[0]||""),[l,i]=(0,f.useState)(e?.pullingForce.toString()||"75"),[c,u]=(0,f.useState)(e?.name||""),[m,p]=(0,f.useState)(e?.position||"Bottom"),[b,y]=(0,f.useState)(e?.strand_3_8.toString()||"0"),[j,N]=(0,f.useState)(e?.strand_1_2.toString()||"0"),[w,S]=(0,f.useState)(e?.strand_0_6.toString()||"0"),[F,C]=(0,f.useState)(e?.strandSizes||[]),[v,A]=(0,f.useState)(e?.strandCoordinates?.map(e=>({x:e.x.toString(),y:e.y.toString()}))||[]),[P,T]=(0,f.useState)(""),[E,z]=(0,f.useState)(""),[B,D]=(0,f.useState)(e?.eValue.toString()||""),[k,I]=(0,f.useState)(e?.requiredForce?.toString()||""),[L,R]=(0,f.useState)([]),$=e=>{if(!e||""===e.trim())return 0;const t=e.match(/(\d+)?\s*(\d+)\/(\d+)/);if(t){return parseInt(t[1]||"0")+parseInt(t[2])/parseInt(t[3])}return parseFloat(e)||0};f.useEffect(()=>{(()=>{const e=$(P),t=$(E);e>0&&t>0&&D((e-t).toFixed(3))})()},[P,E]);const W=.085,O=.153,M=.217,U=()=>{const e=parseInt(b)||0,t=parseInt(j)||0,a=parseInt(w)||0;return e*W+t*O+a*M},H=()=>(parseInt(b)||0)+(parseInt(j)||0)+(parseInt(w)||0);f.useEffect(()=>{const e=H();if(e>0&&F.length!==e){const t=[];for(let a=0;a<e;a++)t.push(F[a]||"1/2");C(t)}else 0===e&&C([])},[b,j,w]);const V=(e,t)=>{const a=[...F];a[e]=t,C(a)},G=()=>{const e=parseInt(b)||0,t=parseInt(j)||0,a=parseInt(w)||0,s=F.filter(e=>"3/8"===e).length,r=F.filter(e=>"1/2"===e).length,l=F.filter(e=>"0.6"===e).length;return s===e&&r===t&&l===a};return(0,J.jsx)(n.default,{className:"absolute inset-0 items-center justify-center",style:{backgroundColor:"rgba(0,0,0,0.5)"},children:(0,J.jsxs)(n.default,{className:"bg-white rounded-2xl mx-5 w-full max-w-md",children:[(0,J.jsx)(g.default,{className:"max-h-96",children:(0,J.jsxs)(n.default,{className:"p-5",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-4",children:[(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900",children:e?"Edit Pattern":"New Pattern"}),(0,J.jsx)(o.default,{onPress:t,children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),L.length>0&&(0,J.jsx)(n.default,{className:"bg-red-50 border border-red-200 rounded-xl p-3 mb-4",children:L.map((e,t)=>(0,J.jsxs)(d.default,{className:"text-red-700 text-sm",children:["\u2022 ",e]},t))}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Pattern ID"}),(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2",children:[(0,J.jsx)(h.default,{className:"flex-1 bg-white border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"101",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"number-pad",maxLength:3,value:s,onChangeText:r}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600",children:"-"}),(0,J.jsx)(h.default,{className:"w-20 bg-white border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"75",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"number-pad",maxLength:2,value:l,onChangeText:i}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600",children:"%"})]}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-1",children:"Format: [Number]-[Pulling Force %]"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Pattern Name"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"e.g., Heavy Load Pattern",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:c,onChangeText:u})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Strand Position"}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>p("Bottom"),className:"flex-1 rounded-xl py-3 items-center border-2 "+("Bottom"===m?"bg-green-50 border-green-500":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"font-semibold "+("Bottom"===m?"text-green-700":"text-gray-600"),children:"Bottom"})}),(0,J.jsx)(o.default,{onPress:()=>p("Top"),className:"flex-1 rounded-xl py-3 items-center border-2 "+("Top"===m?"bg-blue-50 border-blue-500":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"font-semibold "+("Top"===m?"text-blue-700":"text-gray-600"),children:"Top"})}),(0,J.jsx)(o.default,{onPress:()=>p("Both"),className:"flex-1 rounded-xl py-3 items-center border-2 "+("Both"===m?"bg-purple-50 border-purple-500":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"font-semibold "+("Both"===m?"text-purple-700":"text-gray-600"),children:"Both"})})]}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-1",children:"Select where these strands are positioned in the member"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Number of Strands"}),(0,J.jsxs)(n.default,{className:"space-y-3",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(d.default,{className:"w-16 text-sm text-gray-700",children:'3/8"'}),(0,J.jsx)(h.default,{className:"flex-1 bg-white border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"0",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"number-pad",value:b,onChangeText:y})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(d.default,{className:"w-16 text-sm text-gray-700",children:'1/2"'}),(0,J.jsx)(h.default,{className:"flex-1 bg-white border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"0",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"number-pad",value:j,onChangeText:N})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(d.default,{className:"w-16 text-sm text-gray-700",children:'0.6"'}),(0,J.jsx)(h.default,{className:"flex-1 bg-white border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"0",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"number-pad",value:w,onChangeText:S})]})]})]}),H()>0&&(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:["Designate Strand Sizes (Position 1-",H(),", Left to Right)"]}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-500 mb-3",children:["Total: ",parseInt(b)||0,' \xd7 3/8", ',parseInt(j)||0,' \xd7 1/2", ',parseInt(w)||0,' \xd7 0.6"']}),(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded-xl p-3 border border-gray-200",children:[(0,J.jsx)(n.default,{className:"flex-row flex-wrap gap-2",children:F.map((e,t)=>(0,J.jsxs)(n.default,{className:"items-center",children:[(0,J.jsxs)(d.default,{className:"text-xs text-gray-600 mb-1",children:["Pos ",t+1]}),(0,J.jsxs)(n.default,{className:"flex-row border border-gray-300 rounded-lg overflow-hidden",children:[(0,J.jsx)(o.default,{onPress:()=>V(t,"3/8"),className:"px-2 py-1 "+("3/8"===e?"bg-blue-500":"bg-white"),children:(0,J.jsx)(d.default,{className:"text-xs font-semibold "+("3/8"===e?"text-white":"text-gray-700"),children:"3/8"})}),(0,J.jsx)(n.default,{className:"w-px bg-gray-300"}),(0,J.jsx)(o.default,{onPress:()=>V(t,"1/2"),className:"px-2 py-1 "+("1/2"===e?"bg-green-500":"bg-white"),children:(0,J.jsx)(d.default,{className:"text-xs font-semibold "+("1/2"===e?"text-white":"text-gray-700"),children:"1/2"})}),(0,J.jsx)(n.default,{className:"w-px bg-gray-300"}),(0,J.jsx)(o.default,{onPress:()=>V(t,"0.6"),className:"px-2 py-1 "+("0.6"===e?"bg-purple-500":"bg-white"),children:(0,J.jsx)(d.default,{className:"text-xs font-semibold "+("0.6"===e?"text-white":"text-gray-700"),children:"0.6"})})]})]},t))}),(0,J.jsxs)(n.default,{className:"mt-3 pt-3 border-t border-gray-300",children:[(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:["Designated: ",F.filter(e=>"3/8"===e).length,' \xd7 3/8", ',F.filter(e=>"1/2"===e).length,' \xd7 1/2", ',F.filter(e=>"0.6"===e).length,' \xd7 0.6"']}),!G()&&(0,J.jsx)(d.default,{className:"text-xs text-orange-600 font-semibold mt-1",children:"\u26a0 Designations must match strand counts above"})]})]})]}),H()>0&&(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700",children:"Strand Coordinates (Optional)"}),(0,J.jsx)(o.default,{onPress:()=>{const e=H();if(0===v.length){const t=Array(e).fill(null).map(()=>({x:"",y:"2 1/8"}));A(t)}else A([])},className:"bg-blue-500 rounded-lg px-3 py-1",children:(0,J.jsx)(d.default,{className:"text-xs font-semibold text-white",children:v.length>0?"Remove":"Add Coordinates"})})]}),(0,J.jsx)(n.default,{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-3",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"information-circle",size:16,color:"#F59E0B"}),(0,J.jsx)(d.default,{className:"flex-1 text-xs text-amber-800 ml-2",children:"For cut-width products: Enter (x,y) position of each strand from bottom-left corner. x=0 is left edge, y=0 is bottom. Use decimals or fractions (e.g., 2.5 or 2 1/2). App will auto-calculate which strands are active based on product width."})]})}),v.length>0&&(0,J.jsx)(n.default,{className:"bg-gray-50 rounded-xl p-3 border border-gray-200",children:(0,J.jsx)(g.default,{style:{maxHeight:300},children:(0,J.jsx)(n.default,{className:"space-y-3",children:v.map((e,t)=>(0,J.jsxs)(n.default,{children:[(0,J.jsxs)(d.default,{className:"text-xs font-semibold text-gray-700 mb-2",children:["Strand ",t+1," (",F[t],'")']}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-600 mb-1",children:"x (horizontal, in)"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-900",placeholder:"e.g., 2.5 or 2 1/2",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:e.x,onChangeText:e=>{const a=[...v];a[t]=Object.assign({},a[t],{x:e}),A(a)}})]}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-600 mb-1",children:"y (vertical, in)"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-900",placeholder:"e.g., 3 or 2 7/8",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:e.y,onChangeText:e=>{const a=[...v];a[t]=Object.assign({},a[t],{y:e}),A(a)}})]})]})]},t))})})})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Section Centroid (inches from bottom)"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-2",children:"Enter as decimal or fraction (e.g., 6 or 5 7/8)"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"e.g., 6 or 5 7/8",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:P,onChangeText:T})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Strand Height from Bottom (inches)"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-2",children:"Enter as decimal or fraction (e.g., 2.125 or 2 1/8)"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"e.g., 2.125 or 2 1/8",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:E,onChangeText:z})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"e Value (inches) - Auto-calculated"}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-500 mb-2",children:["Calculated as: Centroid - Strand height","\n","Or enter manually"]}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"e.g., 3.875",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"decimal-pad",value:B,onChangeText:D})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Required Force (lbs) - Optional"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-2",children:"Required force in pounds for this strand pattern"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-xl px-4 py-3 text-base text-gray-900",placeholder:"e.g., 15000",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"numeric",value:k,onChangeText:I})]}),(0,J.jsxs)(n.default,{className:"bg-blue-50 rounded-xl p-3 mb-4",children:[(0,J.jsx)(d.default,{className:"text-xs font-semibold text-blue-900",children:"Total Strand Area"}),(0,J.jsxs)(d.default,{className:"text-lg font-bold text-blue-900",children:[U().toFixed(3)," in\xb2"]})]})]})}),(0,J.jsxs)(n.default,{className:"border-t border-gray-200 p-4 flex-row gap-3",children:[(0,J.jsx)(o.default,{onPress:t,className:"flex-1 bg-gray-100 rounded-xl py-3 items-center",children:(0,J.jsx)(d.default,{className:"text-gray-700 font-semibold",children:"Cancel"})}),(0,J.jsx)(o.default,{onPress:()=>{const e=[];(!s||s.length<2||s.length>3)&&e.push("Pattern number must be 2-3 digits");const t=parseInt(l);(!l||isNaN(t)||t<1||t>99)&&e.push("Pulling force must be 1-99%"),c.trim()||e.push("Pattern name is required");const r=parseInt(b)||0,o=parseInt(j)||0,n=parseInt(w)||0;r+o+n===0&&e.push("At least one strand is required");const d=parseFloat(B);if(!B||isNaN(d)?e.push("e value is required"):"Bottom"===m&&d<=0&&e.push("e value must be greater than 0 for bottom strands"),r+o+n>0&&!G()){const t=F.filter(e=>"3/8"===e).length,a=F.filter(e=>"1/2"===e).length,s=F.filter(e=>"0.6"===e).length;e.push(`Strand designations must match counts: Need ${r} \xd7 3/8", ${o} \xd7 1/2", ${n} \xd7 0.6" but have ${t}, ${a}, ${s}`)}let i;if(v.length>0){H();if(v.every(e=>""!==e.x.trim()&&""!==e.y.trim())){i=[];for(let t=0;t<v.length;t++){const a=$(v[t].x),s=$(v[t].y);isNaN(a)||isNaN(s)?e.push(`Invalid coordinate for strand ${t+1}: x="${v[t].x}", y="${v[t].y}"`):a<0||s<0?e.push(`Coordinates for strand ${t+1} must be non-negative`):i.push({x:a,y:s})}}else e.push("All strand coordinates must be filled or remove coordinates entirely")}if(e.length>0)return void R(e);a({patternId:`${s}-${l}`,name:c.trim(),position:m,strand_3_8:r,strand_1_2:o,strand_0_6:n,strandSizes:F.length>0?F:void 0,strandCoordinates:i,eValue:d,pullingForce:t,requiredForce:k?parseFloat(k):void 0,totalArea:U()})},className:"flex-1 bg-blue-500 rounded-xl py-3 items-center",children:(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Save"})})]})]})})}const ke=[{id:"8048",label:"8048",height:8,width:48},{id:"1048",label:"1048",height:10,width:48},{id:"1247",label:"1247",height:12,width:48},{id:"1250",label:"1250",height:12,width:48},{id:"1648",label:"1648",height:16,width:48},{id:"1650",label:"1650",height:16,width:48}];function Ie({navigation:e}){const t=(0,i.useSafeAreaInsets)(),{customPatterns:a}=le(),{findByJobNumber:s,searchByJobName:r}=ge(),[l,c]=(0,f.useState)(""),[u,m]=(0,f.useState)(""),[b,y]=(0,f.useState)(""),[j,N]=(0,f.useState)(""),[w,S]=(0,f.useState)(""),[F,C]=(0,f.useState)(""),[v,A]=(0,f.useState)("0"),[P,T]=(0,f.useState)(""),[E,z]=(0,f.useState)(""),[B,D]=(0,f.useState)(""),[k,I]=(0,f.useState)(""),[L,R]=(0,f.useState)(""),[$,W]=(0,f.useState)(""),[O,M]=(0,f.useState)(!1),[U,H]=(0,f.useState)(!1),[V,G]=(0,f.useState)(!1),[q,Y]=(0,f.useState)(!1),[_,Q]=(0,f.useState)([]),[X,K]=(0,f.useState)(!1),[ee,te]=(0,f.useState)([]);(0,f.useEffect)(()=>{if(u.trim()){const e=s(u);e?(K(!0),c(e.jobName),setTimeout(()=>K(!1),100)):c("")}else c("")},[u,s]),(0,f.useEffect)(()=>{if(!X)if(l.trim().length>=2){const e=r(l);Q(e),Y(e.length>0)}else Q([]),Y(!1)},[l,r,X]);const ae=a.filter(e=>"Bottom"===e.position||"Both"===e.position),se=a.filter(e=>"Top"===e.position||"Both"===e.position),re=ke.find(e=>e.id===E),oe=a.find(e=>e.id===B),ne=a.find(e=>e.id===k),de=re?.width||48,ie=L.trim()?ue(L):null,ce=null!==ie&&Math.abs(ie-de)>.001&&ie<de,me=()=>(parseFloat(w)||0)+((parseFloat(F)||0)+(e=>{if(!e||"0"===e)return 0;const t=e.split("/");if(2===t.length){const e=parseFloat(t[0]),a=parseFloat(t[1]);if(0!==a)return e/a}return 0})(v))/12;return(0,J.jsxs)(Z.default,{behavior:"height",className:"flex-1 bg-white",style:{paddingTop:t.top},children:[(0,J.jsxs)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:40},keyboardShouldPersistTaps:"handled",children:[(0,J.jsxs)(n.default,{className:"px-6 py-4 border-b border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-1",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-2xl font-bold",children:"Product Details"}),(0,J.jsxs)(o.default,{onPress:()=>{e.navigate("ProductTagScanner",{onDataScanned:e=>{if(e.projectName&&c(e.projectName),e.projectNumber&&m(e.projectNumber),e.markNumber&&y(e.markNumber),e.idNumber&&N(e.idNumber),e.span&&(S(e.span.feet.toString()),C(e.span.inches.toString()),A("0")),e.pourDate&&T(e.pourDate),e.productWidth&&R(e.productWidth.toString()),e.strandPattern){const t=a.find(t=>t.patternId===e.strandPattern||t.name.includes(e.strandPattern||""));t&&D(t.id)}}})},className:"bg-blue-500 rounded-lg px-4 py-2 flex-row items-center",children:[(0,J.jsx)(x.default,{name:"camera",size:20,color:"#fff"}),(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold ml-2",children:"Scan Product Tag"})]})]}),(0,J.jsx)(d.default,{className:"text-gray-600 text-sm mt-1",children:"Configure project details and select strand pattern"})]}),ee.length>0&&(0,J.jsx)(n.default,{className:"mx-6 mt-4 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"alert-circle",size:20,color:"#DC2626"}),(0,J.jsxs)(n.default,{className:"ml-2 flex-1",children:[(0,J.jsx)(d.default,{className:"text-red-800 font-semibold text-sm mb-1",children:"Please fix the following:"}),ee.map((e,t)=>(0,J.jsxs)(d.default,{className:"text-red-700 text-sm",children:["\u2022 ",e]},t))]})]})}),(0,J.jsxs)(n.default,{className:"px-6 mt-6",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold mb-4",children:"Product Details (Optional)"}),(0,J.jsxs)(n.default,{className:"mb-4",style:{zIndex:10},children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Project Name"}),(0,J.jsxs)(n.default,{style:{position:"relative"},children:[(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base text-gray-900",placeholder:"Enter project name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:l,onChangeText:c,onBlur:()=>{setTimeout(()=>Y(!1),200)},onFocus:()=>{l.trim().length>=2&&_.length>0&&Y(!0)}}),q&&_.length>0&&(0,J.jsx)(n.default,{className:"bg-white border border-gray-300 rounded-lg",style:{position:"absolute",top:"100%",left:0,right:0,marginTop:4,zIndex:9999,maxHeight:200,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.15,shadowRadius:8,elevation:8},children:(0,J.jsx)(g.default,{style:{maxHeight:200},keyboardShouldPersistTaps:"handled",nestedScrollEnabled:!0,children:_.map((e,t)=>(0,J.jsxs)(o.default,{onPress:()=>{return t=e.jobNumber,a=e.jobName,K(!0),c(a),m(t),Y(!1),void setTimeout(()=>K(!1),100);var t,a},className:"px-4 py-3 border-b border-gray-200",style:{backgroundColor:"#fff"},children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-medium",children:e.jobName}),(0,J.jsxs)(d.default,{className:"text-gray-500 text-sm",children:["Job #: ",e.jobNumber]})]},`${e.jobNumber}-${t}`))})})]})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Project Number"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base text-gray-900",placeholder:"Enter project number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:u,onChangeText:m})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3 mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Mark Number"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base text-gray-900",placeholder:"Mark #",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:b,onChangeText:y})]}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"ID Number"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base text-gray-900",placeholder:"ID #",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:j,onChangeText:N})]})]}),(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Span (Optional)"}),(0,J.jsxs)(n.default,{className:"flex-row items-center",style:{gap:8},children:[(0,J.jsx)(n.default,{style:{flex:1,minWidth:0},children:(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900",placeholder:"Feet",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:w,onChangeText:S,keyboardType:"numeric"})}),(0,J.jsx)(d.default,{className:"text-gray-600 font-medium",children:"-"}),(0,J.jsx)(n.default,{style:{flex:1,minWidth:0},children:(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900",placeholder:"Inches",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:F,onChangeText:C,keyboardType:"numeric"})}),(0,J.jsx)(o.default,{className:"bg-gray-100 border border-gray-300 rounded-lg px-3 py-3 items-center",style:{width:70},onPress:()=>{const e=["0","1/8","1/4","3/8","1/2","5/8","3/4","7/8"],t=(e.indexOf(v)+1)%e.length;A(e[t])},children:(0,J.jsxs)(d.default,{className:"text-gray-900 font-medium text-sm",children:["0"===v?"0":v,"\u2033"]})})]})]}),(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Pour Date (Optional)"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base text-gray-900",placeholder:"MM/DD/YYYY",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:P,onChangeText:T,keyboardType:"default"})]}),(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Product Width (Optional)"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-2",children:"For cut-width products, enter actual width in inches (decimal or fraction)"}),(0,J.jsx)(h.default,{style:{backgroundColor:"#FFFFFF",borderWidth:1,borderColor:"#D1D5DB",borderRadius:8,paddingHorizontal:16,paddingVertical:12,fontSize:16,color:"#111827"},placeholder:"e.g., 28 or 28 1/2 or 28.5",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#000000",value:L,onChangeText:R,keyboardType:"default"})]}),ce&&(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(n.default,{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-3",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"cut",size:20,color:"#F59E0B"}),(0,J.jsxs)(n.default,{className:"flex-1 ml-3",children:[(0,J.jsx)(d.default,{className:"text-amber-900 font-semibold text-sm mb-1",children:"Cut-Width Product Detected"}),(0,J.jsxs)(d.default,{className:"text-amber-800 text-xs",children:["Product: ",ie,'" (cut from ',de,'")']})]})]})}),(0,J.jsxs)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:["Product Side ",(0,J.jsx)(d.default,{className:"text-red-500",children:"*"})]}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-3",children:"Which side is the keeper side (product side)?"}),(0,J.jsxs)(n.default,{className:"flex-row gap-3 mb-3",children:[(0,J.jsxs)(o.default,{onPress:()=>W("L1"),className:"flex-1 rounded-lg py-3 px-4 border-2 "+("L1"===$?"bg-blue-50 border-blue-500":"bg-white border-gray-300"),children:[(0,J.jsx)(d.default,{className:"text-center font-semibold text-sm "+("L1"===$?"text-blue-700":"text-gray-700"),children:"L1 (Left Side)"}),(0,J.jsx)(d.default,{className:"text-center text-xs text-gray-600 mt-1",children:"Keep left side"})]}),(0,J.jsxs)(o.default,{onPress:()=>W("L2"),className:"flex-1 rounded-lg py-3 px-4 border-2 "+("L2"===$?"bg-blue-50 border-blue-500":"bg-white border-gray-300"),children:[(0,J.jsx)(d.default,{className:"text-center font-semibold text-sm "+("L2"===$?"text-blue-700":"text-gray-700"),children:"L2 (Right Side)"}),(0,J.jsx)(d.default,{className:"text-center text-xs text-gray-600 mt-1",children:"Keep right side"})]})]}),(0,J.jsxs)(n.default,{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,J.jsx)(d.default,{className:"text-xs font-semibold text-gray-700 mb-3 text-center",children:"Visual Guide"}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-600 mb-2",children:"L1 Product Side (Keep left):"}),(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"flex-1 h-12 bg-blue-100 border-2 border-blue-500 items-center justify-center",children:(0,J.jsx)(d.default,{className:"text-xs text-blue-700",children:"Keep (L1)"})}),(0,J.jsx)(n.default,{className:"flex-1 h-12 bg-red-100 border-r-4 border-red-500 items-center justify-center",children:(0,J.jsx)(d.default,{className:"text-xs text-red-700",children:"Cut Edge"})})]})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-600 mb-2",children:"L2 Product Side (Keep right):"}),(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"flex-1 h-12 bg-red-100 border-l-4 border-red-500 items-center justify-center",children:(0,J.jsx)(d.default,{className:"text-xs text-red-700",children:"Cut Edge"})}),(0,J.jsx)(n.default,{className:"flex-1 h-12 bg-blue-100 border-2 border-blue-500 items-center justify-center",children:(0,J.jsx)(d.default,{className:"text-xs text-blue-700",children:"Keep (L2)"})})]})]})]}),ee.includes("Product side is required for cut-width products")&&(0,J.jsx)(d.default,{className:"text-red-600 text-xs mt-2",children:"\u26a0 Please select which side is the product side (keeper side)"})]})]}),(0,J.jsxs)(n.default,{className:"px-6 mb-6",children:[(0,J.jsxs)(d.default,{className:"text-gray-900 text-lg font-semibold mb-4",children:["Configuration ",(0,J.jsx)(d.default,{className:"text-red-500",children:"*"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:["Product Type/Size ",(0,J.jsx)(d.default,{className:"text-red-500",children:"*"})]}),(0,J.jsxs)(o.default,{className:`bg-white border ${ee.includes("Product Type/Size is required")?"border-red-500":"border-gray-300"} rounded-lg px-4 py-3 flex-row items-center justify-between`,onPress:()=>M(!0),children:[(0,J.jsx)(d.default,{className:"text-base "+(E?"text-gray-900":"text-gray-400"),children:re?re.label:"Select product type/size"}),(0,J.jsx)(x.default,{name:"chevron-down",size:20,color:"#6B7280"})]})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:["Strand Pattern ",(0,J.jsx)(d.default,{className:"text-red-500",children:"*"})]}),(0,J.jsxs)(o.default,{className:`bg-white border ${ee.includes("Strand Pattern is required")?"border-red-500":"border-gray-300"} rounded-lg px-4 py-3 flex-row items-center justify-between`,onPress:()=>H(!0),children:[(0,J.jsx)(d.default,{className:"text-base "+(B?"text-gray-900":"text-gray-400"),children:oe?oe.name:"Select strand pattern"}),(0,J.jsx)(x.default,{name:"chevron-down",size:20,color:"#6B7280"})]}),0===ae.length&&(0,J.jsx)(d.default,{className:"text-orange-600 text-xs mt-1",children:"No bottom patterns available. Create one in Strand Patterns."})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Top Strand Pattern (Optional)"}),(0,J.jsxs)(o.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 flex-row items-center justify-between",onPress:()=>G(!0),children:[(0,J.jsx)(d.default,{className:"text-base "+(k?"text-gray-900":"text-gray-400"),children:ne?ne.name:"None"}),(0,J.jsx)(x.default,{name:"chevron-down",size:20,color:"#6B7280"})]})]})]}),(0,J.jsx)(n.default,{className:"px-6",children:(0,J.jsx)(o.default,{className:"bg-blue-500 rounded-xl py-4 items-center active:bg-blue-600",onPress:()=>{const t=[];if(E||t.push("Product Type/Size is required"),B||t.push("Strand Pattern is required"),ce&&!$&&t.push("Product side is required for cut-width products"),t.length>0)return void te(t);const a=L.trim()?ue(L):null;e.navigate("SlippageIdentifier",{config:{projectName:l||void 0,projectNumber:u||void 0,markNumber:b||void 0,idNumber:j||void 0,span:w||F||"0"!==v?me():void 0,pourDate:P||void 0,productType:E,strandPattern:B,topStrandPattern:k||void 0,productWidth:null!==a?a:void 0,productSide:ce&&$?$:void 0}})},children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Continue to Input Values"})})})]}),(0,J.jsx)(p.default,{visible:O,transparent:!0,animationType:"slide",onRequestClose:()=>M(!1),children:(0,J.jsx)(n.default,{className:"flex-1 justify-end bg-black/50",children:(0,J.jsxs)(n.default,{className:"bg-white rounded-t-3xl max-h-[70%]",children:[(0,J.jsxs)(n.default,{className:"p-4 border-b border-gray-200 flex-row items-center justify-between",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold",children:"Select Product Type/Size"}),(0,J.jsx)(o.default,{onPress:()=>M(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsx)(g.default,{className:"p-4",children:ke.map(e=>(0,J.jsxs)(o.default,{className:"p-4 mb-2 rounded-lg border "+(E===e.id?"bg-blue-50 border-blue-500":"bg-white border-gray-200"),onPress:()=>{z(e.id),M(!1),te([])},children:[(0,J.jsx)(d.default,{className:"text-base font-semibold "+(E===e.id?"text-blue-600":"text-gray-900"),children:e.label}),(0,J.jsxs)(d.default,{className:"text-gray-600 text-sm mt-1",children:[e.height,'" thick \xd7 ',e.width,'" wide hollow core slab']})]},e.id))})]})})}),(0,J.jsx)(p.default,{visible:U,transparent:!0,animationType:"slide",onRequestClose:()=>H(!1),children:(0,J.jsx)(n.default,{className:"flex-1 justify-end bg-black/50",children:(0,J.jsxs)(n.default,{className:"bg-white rounded-t-3xl max-h-[70%]",children:[(0,J.jsxs)(n.default,{className:"p-4 border-b border-gray-200 flex-row items-center justify-between",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold",children:"Select Strand Pattern"}),(0,J.jsx)(o.default,{onPress:()=>H(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsx)(g.default,{className:"p-4",children:0===ae.length?(0,J.jsxs)(n.default,{className:"items-center py-8",children:[(0,J.jsx)(x.default,{name:"albums-outline",size:48,color:"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-gray-600 text-base mt-4 mb-4 text-center",children:"No bottom strand patterns available."}),(0,J.jsx)(o.default,{onPress:()=>{H(!1),e.navigate("StrandPatterns")},className:"bg-blue-500 rounded-xl py-3 px-6 items-center active:bg-blue-600",children:(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold",children:"Go to Strand Library"})})]}):ae.map(e=>(0,J.jsxs)(o.default,{className:"p-4 mb-2 rounded-lg border "+(B===e.id?"bg-blue-50 border-blue-500":"bg-white border-gray-200"),onPress:()=>{D(e.id),H(!1),te([])},children:[(0,J.jsx)(d.default,{className:"text-base font-semibold "+(B===e.id?"text-blue-600":"text-gray-900"),children:e.name}),(0,J.jsxs)(d.default,{className:"text-gray-600 text-sm mt-1",children:["Pattern ID: ",e.patternId," \u2022 Position:"," ",e.position]})]},e.id))})]})})}),(0,J.jsx)(p.default,{visible:V,transparent:!0,animationType:"slide",onRequestClose:()=>G(!1),children:(0,J.jsx)(n.default,{className:"flex-1 justify-end bg-black/50",children:(0,J.jsxs)(n.default,{className:"bg-white rounded-t-3xl max-h-[70%]",children:[(0,J.jsxs)(n.default,{className:"p-4 border-b border-gray-200 flex-row items-center justify-between",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold",children:"Select Top Strand Pattern"}),(0,J.jsx)(o.default,{onPress:()=>G(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsxs)(g.default,{className:"p-4",children:[(0,J.jsx)(o.default,{className:"p-4 mb-2 rounded-lg border "+(""===k?"bg-blue-50 border-blue-500":"bg-white border-gray-200"),onPress:()=>{I(""),G(!1)},children:(0,J.jsx)(d.default,{className:"text-base font-semibold "+(""===k?"text-blue-600":"text-gray-900"),children:"None"})}),se.map(e=>(0,J.jsxs)(o.default,{className:"p-4 mb-2 rounded-lg border "+(k===e.id?"bg-blue-50 border-blue-500":"bg-white border-gray-200"),onPress:()=>{I(e.id),G(!1)},children:[(0,J.jsx)(d.default,{className:"text-base font-semibold "+(k===e.id?"text-blue-600":"text-gray-900"),children:e.name}),(0,J.jsxs)(d.default,{className:"text-gray-600 text-sm mt-1",children:["Pattern ID: ",e.patternId," \u2022 Position:"," ",e.position]})]},e.id))]})]})})})]})}function Le({scale:e=10,showDimensions:t=!1,highlightedStrand:a=null,activeStrands:s,productSide:r=null,productWidth:l,slippages:o=[],showSlippageValues:d=!1,strandCoordinates:i,bottomStrandSizes:c,topStrandCoordinates:u,topStrandSizes:m}){const x=[...i?i.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:c?.[t],isTop:!1})):[{x:2,y:2.125,id:1,size:c?.[0],isTop:!1},{x:9.125,y:2.125,id:2,size:c?.[1],isTop:!1},{x:16.5625,y:2.125,id:3,size:c?.[2],isTop:!1},{x:24,y:2.125,id:4,size:c?.[3],isTop:!1},{x:31.4375,y:2.125,id:5,size:c?.[4],isTop:!1},{x:38.875,y:2.125,id:6,size:c?.[5],isTop:!1},{x:46,y:2.125,id:7,size:c?.[6],isTop:!1}],...u?u.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:m?.[t],isTop:!0})):[]],g=l?l*e:48*e,h=8*e;let p=0;"L1"===r&&l?p=0:"L2"===r&&l&&(p=(48-l)*e);const b=1.1875*e,y=[];for(let n=0;n<6;n++){const t=(2.625+7.4375*n)*e;y.push({x:t-p,y:b,width:5.5*e,height:5.625*e})}const j=y.filter(e=>{const t=e.x+e.width;return e.x<g&&t>0}),N=x.map(t=>Object.assign({},t,{displayX:t.x*e-p,displayY:h-t.y*e,isActive:!s||s.includes(t.id),isHighlighted:a===t.id})).filter(e=>e.displayX>=0&&e.displayX<=g),w=g+40,S=h+40+(d?45:0)+(i||c||u?60:0),F=20,C=.5*e,v=[{x:0,y:.5},{x:.25,y:.625},{x:.5625,y:5},{x:.75,y:5.125},{x:.8125,y:6.875},{x:.625,y:7},{x:.75,y:7.5},{x:1.25,y:8}].map(t=>({x:t.x*e,y:t.y*e})),A=f.useMemo(()=>`plank-clip-${Math.random().toString(36).substr(2,9)}`,[]);return(0,J.jsx)(n.default,{style:{width:w,height:S,alignSelf:"center"},children:(0,J.jsxs)(be.default,{width:w,height:S,children:[(0,J.jsx)(be.Defs,{children:(0,J.jsx)(be.ClipPath,{id:A,children:(0,J.jsx)(be.Rect,{x:F,y:F,width:g,height:h})})}),(0,J.jsx)(be.Path,{d:(()=>{const e=F,t=F,a=g,s=h,l="L1"===r;if(!(null!==r)){let r=`M ${e+C} ${t+s}`;r+=` Q 20 ${t+s} 20 ${t+s-C}`;for(let a=0;a<v.length;a++){const l=v[a];r+=` L ${e+l.x} ${t+s-l.y}`}r+=` L ${e+a-v[v.length-1].x} 20`;for(let l=v.length-1;l>=0;l--){const o=v[l];r+=` L ${e+a-o.x} ${t+s-o.y}`}return r+=` Q ${e+a} ${t+s} ${e+a-C} ${t+s}`,r+=` L ${e+C} ${t+s}`,r+=" Z",r}let o="";if(l){o=`M ${e+C} ${t+s}`,o+=` Q 20 ${t+s} 20 ${t+s-C}`;for(let a=0;a<v.length;a++){const r=v[a];o+=` L ${e+r.x} ${t+s-r.y}`}o+=` L ${e+a} 20`,o+=` L ${e+a} ${t+s}`,o+=` L ${e+C} ${t+s}`,o+=" Z"}else{o="M 20 20";o+=` L ${e+a-v[v.length-1].x} 20`;for(let r=v.length-1;r>=0;r--){const l=v[r];o+=` L ${e+a-l.x} ${t+s-l.y}`}o+=` Q ${e+a} ${t+s} ${e+a-C} ${t+s}`,o+=` L 20 ${t+s}`,o+=" L 20 20",o+=" Z"}return o})(),fill:"#E5E7EB",stroke:"#374151",strokeWidth:2}),j.map((e,t)=>e.x+e.width<=0||e.x>=g?null:(0,J.jsx)(be.Ellipse,{cx:F+e.x+e.width/2,cy:F+e.y+e.height/2,rx:e.width/2,ry:e.height/2,fill:"white",stroke:"#9CA3AF",strokeWidth:1.5,clipPath:`url(#${A})`},`core-${t}`)),(i||c||u)&&N.map(e=>{const t=e.isActive?5:3.5,a=e.isActive?2.5:1.5,s=e.isTop?"#2563EB":"#059669",r=e.isTop?"#1E40AF":"#047857",l=e.isActive?s:"#D1D5DB",o=e.isHighlighted?"#3B82F6":e.isActive?r:"#9CA3AF",n=F+e.displayX,d=F+e.displayY;if("3/8"===e.size){const t=e.isActive?7:5,s=`${n},${d-t} ${n+t},${d} ${n},${d+t} ${n-t},${d}`;return(0,J.jsx)(be.Polygon,{points:s,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}if("1/2"===e.size){const t=e.isActive?6:4;return(0,J.jsxs)(f.Fragment,{children:[(0,J.jsx)(be.Line,{x1:n-t,y1:d-t,x2:n+t,y2:d+t,stroke:o,strokeWidth:a+.5}),(0,J.jsx)(be.Line,{x1:n-t,y1:d+t,x2:n+t,y2:d-t,stroke:o,strokeWidth:a+.5})]},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}return(0,J.jsx)(be.Circle,{cx:n,cy:d,r:t,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}),(i||c||u)&&N.map(e=>{const t=e.isActive?12:10,a=e.isActive?"bold":"normal",s=e.isActive?"#1F2937":"#9CA3AF";return(0,J.jsx)(be.Text,{x:F+e.displayX,y:F+e.displayY-(e.isActive?12:10),fontSize:t,fill:s,fontWeight:a,textAnchor:"middle",children:e.isTop?`T${e.id}`:`B${e.id}`},`label-${e.id}-${e.isTop?"top":"bottom"}`)}),d&&o.length>0&&N.map(e=>{const t=o.find(t=>parseInt(t.strandId)===e.id);if(!t)return null;const a=t.leftExceedsOne?'>1"':t.leftSlippage,s=t.rightExceedsOne?'>1"':t.rightSlippage,r=F+h+15,l=r,n=r+16;return(0,J.jsxs)(f.Fragment,{children:[(0,J.jsxs)(be.Text,{x:F+e.displayX,y:l,fontSize:11,fill:"#059669",fontWeight:"bold",textAnchor:"middle",children:["E1: ",a]}),(0,J.jsxs)(be.Text,{x:F+e.displayX,y:n,fontSize:11,fill:"#7C3AED",fontWeight:"bold",textAnchor:"middle",children:["E2: ",s]})]},`slippage-${e.id}`)}),(i||c||u)&&(()=>{const t=e/10,a=16*t,s=70*t,r=8*t,l=14*t,o=F+h+(d?45:0)+10,n=w/2;return(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Text,{x:n,y:o+l,fontSize:l,fill:"#374151",fontWeight:"600",textAnchor:"middle",children:"Strand Size Key"}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Circle,{cx:n-s,cy:o+1.5*a,r:r,fill:"#059669",stroke:"#047857",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n-s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 0.6"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a-r,x2:n+r,y2:o+1.5*a+r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a+r,x2:n+r,y2:o+1.5*a-r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Text,{x:n+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 1/2"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Polygon,{points:`${n+s},${o+1.5*a-r} ${n+s+r},${o+1.5*a} ${n+s},${o+1.5*a+r} ${n+s-r},${o+1.5*a}`,fill:"#2563EB",stroke:"#1E40AF",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n+s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 3/8"'})]})]})})()]})})}function Re({scale:e=10,showDimensions:t=!1,highlightedStrand:a=null,activeStrands:s,productSide:r=null,productWidth:l,slippages:o=[],showSlippageValues:d=!1,strandCoordinates:i,bottomStrandSizes:c,topStrandCoordinates:u,topStrandSizes:m}){const x=[...i?i.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:c?.[t],isTop:!1})):[{x:1.375,y:2.46,id:1,size:c?.[0],isTop:!1},{x:10.78125,y:2.46,id:2,size:c?.[1],isTop:!1},{x:19.59375,y:2.46,id:3,size:c?.[2],isTop:!1},{x:28.40625,y:2.46,id:4,size:c?.[3],isTop:!1},{x:37.21875,y:2.46,id:5,size:c?.[4],isTop:!1},{x:46.625,y:2.46,id:6,size:c?.[5],isTop:!1}],...u?u.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:m?.[t],isTop:!0})):[]],g=l?l*e:48*e,h=10*e;let p=0;"L1"===r&&l?p=0:"L2"===r&&l&&(p=(48-l)*e);const b=1.375*e,y=[];for(let n=0;n<5;n++){const t=(2.75+8.8125*n)*e;y.push({x:t-p,y:b,width:7.25*e,height:7.25*e})}const j=y.filter(e=>{const t=e.x+e.width;return e.x<g&&t>0}),N=x.map(t=>Object.assign({},t,{displayX:t.x*e-p,displayY:h-t.y*e,isActive:!s||s.includes(t.id),isHighlighted:a===t.id})).filter(e=>e.displayX>=0&&e.displayX<=g),w=g+40,S=h+40+(d?45:0),F=20,C=.625*e,v=[{x:0,y:.625},{x:.25,y:.78125},{x:.5625,y:6.25},{x:.75,y:6.40625},{x:.8125,y:8.59375},{x:.625,y:8.75},{x:.75,y:9.375},{x:1.25,y:10}].map(t=>({x:t.x*e,y:t.y*e})),A=f.useMemo(()=>`plank-clip-${Math.random().toString(36).substr(2,9)}`,[]);return(0,J.jsx)(n.default,{style:{width:w,height:S,alignSelf:"center"},children:(0,J.jsxs)(be.default,{width:w,height:S,children:[(0,J.jsx)(be.Defs,{children:(0,J.jsx)(be.ClipPath,{id:A,children:(0,J.jsx)(be.Rect,{x:F,y:F,width:g,height:h})})}),(0,J.jsx)(be.Path,{d:(()=>{const e=F,t=F,a=g,s=h,l="L1"===r;if(!(null!==r)){let r=`M ${e+C} ${t+s}`;r+=` Q 20 ${t+s} 20 ${t+s-C}`;for(let a=0;a<v.length;a++){const l=v[a];r+=` L ${e+l.x} ${t+s-l.y}`}r+=` L ${e+a-v[v.length-1].x} 20`;for(let l=v.length-1;l>=0;l--){const o=v[l];r+=` L ${e+a-o.x} ${t+s-o.y}`}return r+=` Q ${e+a} ${t+s} ${e+a-C} ${t+s}`,r+=` L ${e+C} ${t+s}`,r+=" Z",r}let o="";if(l){o=`M ${e+C} ${t+s}`,o+=` Q 20 ${t+s} 20 ${t+s-C}`;for(let a=0;a<v.length;a++){const r=v[a];o+=` L ${e+r.x} ${t+s-r.y}`}o+=` L ${e+a} 20`,o+=` L ${e+a} ${t+s}`,o+=` L ${e+C} ${t+s}`,o+=" Z"}else{o="M 20 20";o+=` L ${e+a-v[v.length-1].x} 20`;for(let r=v.length-1;r>=0;r--){const l=v[r];o+=` L ${e+a-l.x} ${t+s-l.y}`}o+=` Q ${e+a} ${t+s} ${e+a-C} ${t+s}`,o+=` L 20 ${t+s}`,o+=" L 20 20",o+=" Z"}return o})(),fill:"#E5E7EB",stroke:"#374151",strokeWidth:2}),j.map((e,t)=>e.x+e.width<=0||e.x>=g?null:(0,J.jsx)(be.Ellipse,{cx:F+e.x+e.width/2,cy:F+e.y+e.height/2,rx:e.width/2,ry:e.height/2,fill:"white",stroke:"#9CA3AF",strokeWidth:1.5,clipPath:`url(#${A})`},`core-${t}`)),(i||c||u)&&N.map(e=>{const t=e.isActive?5:3.5,a=e.isActive?2.5:1.5,s=e.isTop?"#2563EB":"#059669",r=e.isTop?"#1E40AF":"#047857",l=e.isActive?s:"#D1D5DB",o=e.isHighlighted?"#3B82F6":e.isActive?r:"#9CA3AF",n=F+e.displayX,d=F+e.displayY;if("3/8"===e.size){const t=e.isActive?7:5,s=`${n},${d-t} ${n+t},${d} ${n},${d+t} ${n-t},${d}`;return(0,J.jsx)(be.Polygon,{points:s,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}if("1/2"===e.size){const t=e.isActive?6:4;return(0,J.jsxs)(f.Fragment,{children:[(0,J.jsx)(be.Line,{x1:n-t,y1:d-t,x2:n+t,y2:d+t,stroke:o,strokeWidth:a+.5}),(0,J.jsx)(be.Line,{x1:n-t,y1:d+t,x2:n+t,y2:d-t,stroke:o,strokeWidth:a+.5})]},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}return(0,J.jsx)(be.Circle,{cx:n,cy:d,r:t,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}),(i||c||u)&&N.map(e=>{const t=e.isActive?12:10,a=e.isActive?"bold":"normal",s=e.isActive?"#1F2937":"#9CA3AF";return(0,J.jsx)(be.Text,{x:F+e.displayX,y:F+e.displayY-(e.isActive?12:10),fontSize:t,fill:s,fontWeight:a,textAnchor:"middle",children:e.isTop?`T${e.id}`:`B${e.id}`},`label-${e.id}-${e.isTop?"top":"bottom"}`)}),d&&o.length>0&&N.map(e=>{const t=o.find(t=>parseInt(t.strandId)===e.id);if(!t)return null;const a=t.leftExceedsOne?'>1"':t.leftSlippage,s=t.rightExceedsOne?'>1"':t.rightSlippage,r=F+h+15,l=r,n=r+16;return(0,J.jsxs)(f.Fragment,{children:[(0,J.jsxs)(be.Text,{x:F+e.displayX,y:l,fontSize:11,fill:"#059669",fontWeight:"bold",textAnchor:"middle",children:["E1: ",a]}),(0,J.jsxs)(be.Text,{x:F+e.displayX,y:n,fontSize:11,fill:"#7C3AED",fontWeight:"bold",textAnchor:"middle",children:["E2: ",s]})]},`slippage-${e.id}`)}),(i||c||u)&&(()=>{const t=e/10,a=16*t,s=70*t,r=8*t,l=14*t,o=F+h+(d?45:0)+10,n=w/2;return(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Text,{x:n,y:o+l,fontSize:l,fill:"#374151",fontWeight:"600",textAnchor:"middle",children:"Strand Size Key"}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Circle,{cx:n-s,cy:o+1.5*a,r:r,fill:"#059669",stroke:"#047857",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n-s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 0.6"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a-r,x2:n+r,y2:o+1.5*a+r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a+r,x2:n+r,y2:o+1.5*a-r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Text,{x:n+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 1/2"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Polygon,{points:`${n+s},${o+1.5*a-r} ${n+s+r},${o+1.5*a} ${n+s},${o+1.5*a+r} ${n+s-r},${o+1.5*a}`,fill:"#2563EB",stroke:"#1E40AF",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n+s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 3/8"'})]})]})})()]})})}function $e({scale:e=10,showDimensions:t=!1,highlightedStrand:a=null,activeStrands:s,productSide:r=null,productWidth:l,slippages:o=[],showSlippageValues:d=!1,strandCoordinates:i,bottomStrandSizes:c,topStrandCoordinates:u,topStrandSizes:m}){const x=[...i?i.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:c?.[t],isTop:!1})):[{x:1.375,y:2.46,id:1,size:c?.[0],isTop:!1},{x:10.78125,y:2.46,id:2,size:c?.[1],isTop:!1},{x:19.59375,y:2.46,id:3,size:c?.[2],isTop:!1},{x:28.40625,y:2.46,id:4,size:c?.[3],isTop:!1},{x:37.21875,y:2.46,id:5,size:c?.[4],isTop:!1},{x:46.625,y:2.46,id:6,size:c?.[5],isTop:!1}],...u?u.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:m?.[t],isTop:!0})):[]],g=l?l*e:48*e,h=12*e;let p=0;"L1"===r&&l?p=0:"L2"===r&&l&&(p=(48-l)*e);const b=1.375*e,y=[];for(let n=0;n<5;n++){const t=(2.75+8.8125*n)*e;y.push({x:t-p,y:b,width:7.25*e,height:9.25*e})}const j=y.filter(e=>{const t=e.x+e.width;return e.x<g&&t>0}),N=x.map(t=>Object.assign({},t,{displayX:t.x*e-p,displayY:h-t.y*e,isActive:!s||s.includes(t.id),isHighlighted:a===t.id})).filter(e=>e.displayX>=0&&e.displayX<=g),w=g+40,S=h+40+(d?45:0),F=20,C=.75*e,v=[{x:0,y:.75},{x:.25,y:.9375},{x:.5625,y:7.5},{x:.75,y:7.6875},{x:.8125,y:10.3125},{x:.625,y:10.5},{x:.75,y:11.25},{x:1.25,y:12}].map(t=>({x:t.x*e,y:t.y*e})),A=f.useMemo(()=>`plank-clip-${Math.random().toString(36).substr(2,9)}`,[]);return(0,J.jsx)(n.default,{style:{width:w,height:S,alignSelf:"center"},children:(0,J.jsxs)(be.default,{width:w,height:S,children:[(0,J.jsx)(be.Defs,{children:(0,J.jsx)(be.ClipPath,{id:A,children:(0,J.jsx)(be.Rect,{x:F,y:F,width:g,height:h})})}),(0,J.jsx)(be.Path,{d:(()=>{const e=F,t=F,a=g,s=h,l="L1"===r;if(!(null!==r)){let r=`M ${e+C} ${t+s}`;r+=` Q 20 ${t+s} 20 ${t+s-C}`;for(let a=0;a<v.length;a++){const l=v[a];r+=` L ${e+l.x} ${t+s-l.y}`}r+=` L ${e+a-v[v.length-1].x} 20`;for(let l=v.length-1;l>=0;l--){const o=v[l];r+=` L ${e+a-o.x} ${t+s-o.y}`}return r+=` Q ${e+a} ${t+s} ${e+a-C} ${t+s}`,r+=` L ${e+C} ${t+s}`,r+=" Z",r}let o="";if(l){o=`M ${e+C} ${t+s}`,o+=` Q 20 ${t+s} 20 ${t+s-C}`;for(let a=0;a<v.length;a++){const r=v[a];o+=` L ${e+r.x} ${t+s-r.y}`}o+=` L ${e+a} 20`,o+=` L ${e+a} ${t+s}`,o+=` L ${e+C} ${t+s}`,o+=" Z"}else{o="M 20 20";o+=` L ${e+a-v[v.length-1].x} 20`;for(let r=v.length-1;r>=0;r--){const l=v[r];o+=` L ${e+a-l.x} ${t+s-l.y}`}o+=` Q ${e+a} ${t+s} ${e+a-C} ${t+s}`,o+=` L 20 ${t+s}`,o+=" L 20 20",o+=" Z"}return o})(),fill:"#E5E7EB",stroke:"#374151",strokeWidth:2}),j.map((e,t)=>e.x+e.width<=0||e.x>=g?null:(0,J.jsx)(be.Ellipse,{cx:F+e.x+e.width/2,cy:F+e.y+e.height/2,rx:e.width/2,ry:e.height/2,fill:"white",stroke:"#9CA3AF",strokeWidth:1.5,clipPath:`url(#${A})`},`core-${t}`)),(i||c||u)&&N.map(e=>{const t=e.isActive?5:3.5,a=e.isActive?2.5:1.5,s=e.isTop?"#2563EB":"#059669",r=e.isTop?"#1E40AF":"#047857",l=e.isActive?s:"#D1D5DB",o=e.isHighlighted?"#3B82F6":e.isActive?r:"#9CA3AF",n=F+e.displayX,d=F+e.displayY;if("3/8"===e.size){const t=e.isActive?7:5,s=`${n},${d-t} ${n+t},${d} ${n},${d+t} ${n-t},${d}`;return(0,J.jsx)(be.Polygon,{points:s,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}if("1/2"===e.size){const t=e.isActive?6:4;return(0,J.jsxs)(f.Fragment,{children:[(0,J.jsx)(be.Line,{x1:n-t,y1:d-t,x2:n+t,y2:d+t,stroke:o,strokeWidth:a+.5}),(0,J.jsx)(be.Line,{x1:n-t,y1:d+t,x2:n+t,y2:d-t,stroke:o,strokeWidth:a+.5})]},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}return(0,J.jsx)(be.Circle,{cx:n,cy:d,r:t,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}),(i||c||u)&&N.map(e=>{const t=e.isActive?12:10,a=e.isActive?"bold":"normal",s=e.isActive?"#1F2937":"#9CA3AF";return(0,J.jsx)(be.Text,{x:F+e.displayX,y:F+e.displayY-(e.isActive?12:10),fontSize:t,fill:s,fontWeight:a,textAnchor:"middle",children:e.isTop?`T${e.id}`:`B${e.id}`},`label-${e.id}-${e.isTop?"top":"bottom"}`)}),d&&o.length>0&&N.map(e=>{const t=o.find(t=>parseInt(t.strandId)===e.id);if(!t)return null;const a=t.leftExceedsOne?'>1"':t.leftSlippage,s=t.rightExceedsOne?'>1"':t.rightSlippage,r=F+h+15,l=r,n=r+16;return(0,J.jsxs)(f.Fragment,{children:[(0,J.jsxs)(be.Text,{x:F+e.displayX,y:l,fontSize:11,fill:"#059669",fontWeight:"bold",textAnchor:"middle",children:["E1: ",a]}),(0,J.jsxs)(be.Text,{x:F+e.displayX,y:n,fontSize:11,fill:"#7C3AED",fontWeight:"bold",textAnchor:"middle",children:["E2: ",s]})]},`slippage-${e.id}`)}),(i||c||u)&&(()=>{const t=e/10,a=16*t,s=70*t,r=8*t,l=14*t,o=F+h+(d?45:0)+10,n=w/2;return(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Text,{x:n,y:o+l,fontSize:l,fill:"#374151",fontWeight:"600",textAnchor:"middle",children:"Strand Size Key"}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Circle,{cx:n-s,cy:o+1.5*a,r:r,fill:"#059669",stroke:"#047857",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n-s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 0.6"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a-r,x2:n+r,y2:o+1.5*a+r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a+r,x2:n+r,y2:o+1.5*a-r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Text,{x:n+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 1/2"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Polygon,{points:`${n+s},${o+1.5*a-r} ${n+s+r},${o+1.5*a} ${n+s},${o+1.5*a+r} ${n+s-r},${o+1.5*a}`,fill:"#2563EB",stroke:"#1E40AF",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n+s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 3/8"'})]})]})})()]})})}function We({scale:e=10,showDimensions:t=!1,highlightedStrand:a=null,activeStrands:s,productSide:r=null,productWidth:l,slippages:o=[],showSlippageValues:d=!1,strandCoordinates:i,bottomStrandSizes:c,topStrandCoordinates:u,topStrandSizes:m}){const x=6.4375,g=[...i?i.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:c?.[t],isTop:!1})):[{x:1.57812,y:2.79531,id:1,size:c?.[0],isTop:!1},{x:10.78125,y:2.79531,id:2,size:c?.[1],isTop:!1},{x:19.59375,y:2.79531,id:3,size:c?.[2],isTop:!1},{x:28.40625,y:2.79531,id:4,size:c?.[3],isTop:!1},{x:37.21875,y:2.79531,id:5,size:c?.[4],isTop:!1},{x:46.42188,y:2.79531,id:6,size:c?.[5],isTop:!1}],...u?u.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:m?.[t],isTop:!0})):[]],h=l?l*e:48*e,p=12*e;let b=0;"L1"===r&&l?b=0:"L2"===r&&l&&(b=(48-l)*e);const y=1.5625*e,j=[];for(let n=0;n<5;n++){const t=(3.15625+8.8125*n)*e;j.push({x:t-b,y:y,width:x*e,height:8.875*e})}const N=j.filter(e=>{const t=e.x+e.width;return e.x<h&&t>0}),w=g.map(t=>Object.assign({},t,{displayX:t.x*e-b,displayY:p-t.y*e,isActive:!s||s.includes(t.id),isHighlighted:a===t.id})).filter(e=>e.displayX>=0&&e.displayX<=h),S=h+40,F=p+40+(d?45:0),C=20,v=.75*e,A=[{x:0,y:.75},{x:.25,y:.9375},{x:.5625,y:7.5},{x:.75,y:7.6875},{x:.8125,y:10.3125},{x:.625,y:10.5},{x:.75,y:11.25},{x:1.25,y:12}].map(t=>({x:t.x*e,y:t.y*e})),P=f.useMemo(()=>`plank-clip-${Math.random().toString(36).substr(2,9)}`,[]);return(0,J.jsx)(n.default,{style:{width:S,height:F,alignSelf:"center"},children:(0,J.jsxs)(be.default,{width:S,height:F,children:[(0,J.jsx)(be.Defs,{children:(0,J.jsx)(be.ClipPath,{id:P,children:(0,J.jsx)(be.Rect,{x:C,y:C,width:h,height:p})})}),(0,J.jsx)(be.Path,{d:(()=>{const e=C,t=C,a=h,s=p,l="L1"===r;if(!(null!==r)){let r=`M ${e+v} ${t+s}`;r+=` Q 20 ${t+s} 20 ${t+s-v}`;for(let a=0;a<A.length;a++){const l=A[a];r+=` L ${e+l.x} ${t+s-l.y}`}r+=` L ${e+a-A[A.length-1].x} 20`;for(let l=A.length-1;l>=0;l--){const o=A[l];r+=` L ${e+a-o.x} ${t+s-o.y}`}return r+=` Q ${e+a} ${t+s} ${e+a-v} ${t+s}`,r+=` L ${e+v} ${t+s}`,r+=" Z",r}let o="";if(l){o=`M ${e+v} ${t+s}`,o+=` Q 20 ${t+s} 20 ${t+s-v}`;for(let a=0;a<A.length;a++){const r=A[a];o+=` L ${e+r.x} ${t+s-r.y}`}o+=` L ${e+a} 20`,o+=` L ${e+a} ${t+s}`,o+=` L ${e+v} ${t+s}`,o+=" Z"}else{o="M 20 20";o+=` L ${e+a-A[A.length-1].x} 20`;for(let r=A.length-1;r>=0;r--){const l=A[r];o+=` L ${e+a-l.x} ${t+s-l.y}`}o+=` Q ${e+a} ${t+s} ${e+a-v} ${t+s}`,o+=` L 20 ${t+s}`,o+=" L 20 20",o+=" Z"}return o})(),fill:"#E5E7EB",stroke:"#374151",strokeWidth:2}),N.map((e,t)=>e.x+e.width<=0||e.x>=h?null:(0,J.jsx)(be.Ellipse,{cx:C+e.x+e.width/2,cy:C+e.y+e.height/2,rx:e.width/2,ry:e.height/2,fill:"white",stroke:"#9CA3AF",strokeWidth:1.5,clipPath:`url(#${P})`},`core-${t}`)),(i||c||u)&&w.map(e=>{const t=e.isActive?5:3.5,a=e.isActive?2.5:1.5,s=e.isTop?"#2563EB":"#059669",r=e.isTop?"#1E40AF":"#047857",l=e.isActive?s:"#D1D5DB",o=e.isHighlighted?"#3B82F6":e.isActive?r:"#9CA3AF",n=C+e.displayX,d=C+e.displayY;if("3/8"===e.size){const t=e.isActive?7:5,s=`${n},${d-t} ${n+t},${d} ${n},${d+t} ${n-t},${d}`;return(0,J.jsx)(be.Polygon,{points:s,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}if("1/2"===e.size){const t=e.isActive?6:4;return(0,J.jsxs)(f.Fragment,{children:[(0,J.jsx)(be.Line,{x1:n-t,y1:d-t,x2:n+t,y2:d+t,stroke:o,strokeWidth:a+.5}),(0,J.jsx)(be.Line,{x1:n-t,y1:d+t,x2:n+t,y2:d-t,stroke:o,strokeWidth:a+.5})]},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}return(0,J.jsx)(be.Circle,{cx:n,cy:d,r:t,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}),(i||c||u)&&w.map(e=>{const t=e.isActive?12:10,a=e.isActive?"bold":"normal",s=e.isActive?"#1F2937":"#9CA3AF";return(0,J.jsx)(be.Text,{x:C+e.displayX,y:C+e.displayY-(e.isActive?12:10),fontSize:t,fill:s,fontWeight:a,textAnchor:"middle",children:e.isTop?`T${e.id}`:`B${e.id}`},`label-${e.id}-${e.isTop?"top":"bottom"}`)}),d&&o.length>0&&w.map(e=>{const t=o.find(t=>parseInt(t.strandId)===e.id);if(!t)return null;const a=t.leftExceedsOne?'>1"':t.leftSlippage,s=t.rightExceedsOne?'>1"':t.rightSlippage,r=C+p+15,l=r,n=r+16;return(0,J.jsxs)(f.Fragment,{children:[(0,J.jsxs)(be.Text,{x:C+e.displayX,y:l,fontSize:11,fill:"#059669",fontWeight:"bold",textAnchor:"middle",children:["E1: ",a]}),(0,J.jsxs)(be.Text,{x:C+e.displayX,y:n,fontSize:11,fill:"#7C3AED",fontWeight:"bold",textAnchor:"middle",children:["E2: ",s]})]},`slippage-${e.id}`)}),(i||c||u)&&(()=>{const t=e/10,a=16*t,s=70*t,r=8*t,l=14*t,o=C+p+(d?45:0)+10,n=S/2;return(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Text,{x:n,y:o+l,fontSize:l,fill:"#374151",fontWeight:"600",textAnchor:"middle",children:"Strand Size Key"}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Circle,{cx:n-s,cy:o+1.5*a,r:r,fill:"#059669",stroke:"#047857",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n-s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 0.6"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a-r,x2:n+r,y2:o+1.5*a+r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a+r,x2:n+r,y2:o+1.5*a-r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Text,{x:n+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 1/2"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Polygon,{points:`${n+s},${o+1.5*a-r} ${n+s+r},${o+1.5*a} ${n+s},${o+1.5*a+r} ${n+s-r},${o+1.5*a}`,fill:"#2563EB",stroke:"#1E40AF",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n+s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 3/8"'})]})]})})()]})})}function Oe({scale:e=10,showDimensions:t=!1,highlightedStrand:a=null,activeStrands:s,productSide:r=null,productWidth:l,slippages:o=[],showSlippageValues:d=!1,strandCoordinates:i,bottomStrandSizes:c,topStrandCoordinates:u,topStrandSizes:m}){const x=[...i?i.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:c?.[t],isTop:!1})):[],...u?u.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:m?.[t],isTop:!0})):[]],g=l?l*e:48*e,h=16*e;let p=0;"L1"===r&&l?p=0:"L2"===r&&l&&(p=(48-l)*e);const b=1.375*e,y=[];for(let n=0;n<4;n++){const t=(2.8125+11.1875*n)*e;y.push({x:t-p,y:b,width:9*e,height:13.1875*e})}const j=y.filter(e=>{const t=e.x+e.width;return e.x<g&&t>0}),N=x.map(t=>Object.assign({},t,{displayX:t.x*e-p,displayY:h-t.y*e,isActive:!s||s.includes(t.id),isHighlighted:a===t.id})).filter(e=>e.displayX>=0&&e.displayX<=g),w=g+40,S=h+40+(d?45:0),F=20,C=1*e,v=[{x:0,y:1},{x:.25,y:1.25},{x:.5625,y:10},{x:.75,y:10.25},{x:.8125,y:13.75},{x:.625,y:14},{x:.75,y:15},{x:1.25,y:16}].map(t=>({x:t.x*e,y:t.y*e})),A=f.useMemo(()=>`plank-clip-${Math.random().toString(36).substr(2,9)}`,[]);return(0,J.jsx)(n.default,{style:{width:w,height:S,alignSelf:"center"},children:(0,J.jsxs)(be.default,{width:w,height:S,children:[(0,J.jsx)(be.Defs,{children:(0,J.jsx)(be.ClipPath,{id:A,children:(0,J.jsx)(be.Rect,{x:F,y:F,width:g,height:h})})}),(0,J.jsx)(be.Path,{d:(()=>{const e=F,t=F,a=g,s=h,l="L1"===r;if(!(null!==r)){let r=`M ${e+C} ${t+s}`;r+=` Q 20 ${t+s} 20 ${t+s-C}`;for(let a=0;a<v.length;a++){const l=v[a];r+=` L ${e+l.x} ${t+s-l.y}`}r+=` L ${e+a-v[v.length-1].x} 20`;for(let l=v.length-1;l>=0;l--){const o=v[l];r+=` L ${e+a-o.x} ${t+s-o.y}`}return r+=` Q ${e+a} ${t+s} ${e+a-C} ${t+s}`,r+=` L ${e+C} ${t+s}`,r+=" Z",r}let o="";if(l){o=`M ${e+C} ${t+s}`,o+=` Q 20 ${t+s} 20 ${t+s-C}`;for(let a=0;a<v.length;a++){const r=v[a];o+=` L ${e+r.x} ${t+s-r.y}`}o+=` L ${e+a} 20`,o+=` L ${e+a} ${t+s}`,o+=` L ${e+C} ${t+s}`,o+=" Z"}else{o="M 20 20";o+=` L ${e+a-v[v.length-1].x} 20`;for(let r=v.length-1;r>=0;r--){const l=v[r];o+=` L ${e+a-l.x} ${t+s-l.y}`}o+=` Q ${e+a} ${t+s} ${e+a-C} ${t+s}`,o+=` L 20 ${t+s}`,o+=" L 20 20",o+=" Z"}return o})(),fill:"#E5E7EB",stroke:"#374151",strokeWidth:2}),j.map((e,t)=>e.x+e.width<=0||e.x>=g?null:(0,J.jsx)(be.Ellipse,{cx:F+e.x+e.width/2,cy:F+e.y+e.height/2,rx:e.width/2,ry:e.height/2,fill:"white",stroke:"#9CA3AF",strokeWidth:1.5,clipPath:`url(#${A})`},`core-${t}`)),(i||c||u)&&N.map(e=>{const t=e.isActive?5:3.5,a=e.isActive?2.5:1.5,s=e.isTop?"#2563EB":"#059669",r=e.isTop?"#1E40AF":"#047857",l=e.isActive?s:"#D1D5DB",o=e.isHighlighted?"#3B82F6":e.isActive?r:"#9CA3AF",n=F+e.displayX,d=F+e.displayY;if("3/8"===e.size){const t=e.isActive?7:5,s=`${n},${d-t} ${n+t},${d} ${n},${d+t} ${n-t},${d}`;return(0,J.jsx)(be.Polygon,{points:s,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}if("1/2"===e.size){const t=e.isActive?6:4;return(0,J.jsxs)(f.Fragment,{children:[(0,J.jsx)(be.Line,{x1:n-t,y1:d-t,x2:n+t,y2:d+t,stroke:o,strokeWidth:a+.5}),(0,J.jsx)(be.Line,{x1:n-t,y1:d+t,x2:n+t,y2:d-t,stroke:o,strokeWidth:a+.5})]},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}return(0,J.jsx)(be.Circle,{cx:n,cy:d,r:t,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}),(i||c||u)&&N.map(e=>{const t=e.isActive?12:10,a=e.isActive?"bold":"normal",s=e.isActive?"#1F2937":"#9CA3AF";return(0,J.jsx)(be.Text,{x:F+e.displayX,y:F+e.displayY-(e.isActive?12:10),fontSize:t,fill:s,fontWeight:a,textAnchor:"middle",children:e.isTop?`T${e.id}`:`B${e.id}`},`label-${e.id}-${e.isTop?"top":"bottom"}`)}),d&&N.map(e=>{const t=o.find(t=>t.strandId===`S${e.id}`);return t?(0,J.jsxs)(f.Fragment,{children:[(0,J.jsxs)(be.Text,{x:F+e.displayX,y:F+h+25,fontSize:12,fontWeight:"600",fill:t.leftExceedsOne?"#EF4444":"#10B981",textAnchor:"middle",children:["E1: ",t.leftSlippage,'"']}),(0,J.jsxs)(be.Text,{x:F+e.displayX,y:F+h+40,fontSize:12,fontWeight:"600",fill:t.rightExceedsOne?"#EF4444":"#10B981",textAnchor:"middle",children:["E2: ",t.rightSlippage,'"']})]},`slippage-${e.id}`):null}),(i||c||u)&&(()=>{const t=e/10,a=16*t,s=70*t,r=8*t,l=14*t,o=F+h+(d?45:0)+10,n=w/2;return(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Text,{x:n,y:o+l,fontSize:l,fill:"#374151",fontWeight:"600",textAnchor:"middle",children:"Strand Size Key"}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Circle,{cx:n-s,cy:o+1.5*a,r:r,fill:"#059669",stroke:"#047857",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n-s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 0.6"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a-r,x2:n+r,y2:o+1.5*a+r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a+r,x2:n+r,y2:o+1.5*a-r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Text,{x:n+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 1/2"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Polygon,{points:`${n+s},${o+1.5*a-r} ${n+s+r},${o+1.5*a} ${n+s},${o+1.5*a+r} ${n+s-r},${o+1.5*a}`,fill:"#2563EB",stroke:"#1E40AF",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n+s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 3/8"'})]})]})})()]})})}function Me({scale:e=10,showDimensions:t=!1,highlightedStrand:a=null,activeStrands:s,productSide:r=null,productWidth:l,slippages:o=[],showSlippageValues:d=!1,strandCoordinates:i,bottomStrandSizes:c,topStrandCoordinates:u,topStrandSizes:m}){const x=[...i?i.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:c?.[t],isTop:!1})):[],...u?u.map((e,t)=>({x:e.x,y:e.y,id:t+1,size:m?.[t],isTop:!0})):[]],g=l?l*e:48*e,h=16*e;let p=0;"L1"===r&&l?p=0:"L2"===r&&l&&(p=(48-l)*e);const b=2.375*e,y=[];for(let n=0;n<4;n++){const t=(3.1875+11.3125*n)*e;y.push({x:t-p,y:b,width:7.625*e,height:11.25*e})}const j=y.filter(e=>{const t=e.x+e.width;return e.x<g&&t>0}),N=x.map(t=>Object.assign({},t,{displayX:t.x*e-p,displayY:h-t.y*e,isActive:!s||s.includes(t.id),isHighlighted:a===t.id})).filter(e=>e.displayX>=0&&e.displayX<=g),w=g+40,S=h+40+(d?45:0),F=20,C=1*e,v=[{x:0,y:1},{x:.25,y:1.25},{x:.5625,y:10},{x:.75,y:10.25},{x:.8125,y:13.75},{x:.625,y:14},{x:.75,y:15},{x:1.25,y:16}].map(t=>({x:t.x*e,y:t.y*e})),A=f.useMemo(()=>`plank-clip-${Math.random().toString(36).substr(2,9)}`,[]);return(0,J.jsx)(n.default,{style:{width:w,height:S,alignSelf:"center"},children:(0,J.jsxs)(be.default,{width:w,height:S,children:[(0,J.jsx)(be.Defs,{children:(0,J.jsx)(be.ClipPath,{id:A,children:(0,J.jsx)(be.Rect,{x:F,y:F,width:g,height:h})})}),(0,J.jsx)(be.Path,{d:(()=>{const e=F,t=F,a=g,s=h,l="L1"===r;if(!(null!==r)){let r=`M ${e+C} ${t+s}`;r+=` Q 20 ${t+s} 20 ${t+s-C}`;for(let a=0;a<v.length;a++){const l=v[a];r+=` L ${e+l.x} ${t+s-l.y}`}r+=` L ${e+a-v[v.length-1].x} 20`;for(let l=v.length-1;l>=0;l--){const o=v[l];r+=` L ${e+a-o.x} ${t+s-o.y}`}return r+=` Q ${e+a} ${t+s} ${e+a-C} ${t+s}`,r+=` L ${e+C} ${t+s}`,r+=" Z",r}let o="";if(l){o=`M ${e+C} ${t+s}`,o+=` Q 20 ${t+s} 20 ${t+s-C}`;for(let a=0;a<v.length;a++){const r=v[a];o+=` L ${e+r.x} ${t+s-r.y}`}o+=` L ${e+a} 20`,o+=` L ${e+a} ${t+s}`,o+=` L ${e+C} ${t+s}`,o+=" Z"}else{o="M 20 20";o+=` L ${e+a-v[v.length-1].x} 20`;for(let r=v.length-1;r>=0;r--){const l=v[r];o+=` L ${e+a-l.x} ${t+s-l.y}`}o+=` Q ${e+a} ${t+s} ${e+a-C} ${t+s}`,o+=` L 20 ${t+s}`,o+=" L 20 20",o+=" Z"}return o})(),fill:"#E5E7EB",stroke:"#374151",strokeWidth:2}),j.map((e,t)=>e.x+e.width<=0||e.x>=g?null:(0,J.jsx)(be.Ellipse,{cx:F+e.x+e.width/2,cy:F+e.y+e.height/2,rx:e.width/2,ry:e.height/2,fill:"white",stroke:"#9CA3AF",strokeWidth:1.5,clipPath:`url(#${A})`},`core-${t}`)),(i||c||u)&&N.map(e=>{const t=e.isActive?5:3.5,a=e.isActive?2.5:1.5,s=e.isTop?"#2563EB":"#059669",r=e.isTop?"#1E40AF":"#047857",l=e.isActive?s:"#D1D5DB",o=e.isHighlighted?"#3B82F6":e.isActive?r:"#9CA3AF",n=F+e.displayX,d=F+e.displayY;if("3/8"===e.size){const t=e.isActive?7:5,s=`${n},${d-t} ${n+t},${d} ${n},${d+t} ${n-t},${d}`;return(0,J.jsx)(be.Polygon,{points:s,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}if("1/2"===e.size){const t=e.isActive?6:4;return(0,J.jsxs)(f.Fragment,{children:[(0,J.jsx)(be.Line,{x1:n-t,y1:d-t,x2:n+t,y2:d+t,stroke:o,strokeWidth:a+.5}),(0,J.jsx)(be.Line,{x1:n-t,y1:d+t,x2:n+t,y2:d-t,stroke:o,strokeWidth:a+.5})]},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}return(0,J.jsx)(be.Circle,{cx:n,cy:d,r:t,fill:l,stroke:o,strokeWidth:a},`strand-${e.id}-${e.isTop?"top":"bottom"}`)}),(i||c||u)&&N.map(e=>{const t=e.isActive?12:10,a=e.isActive?"bold":"normal",s=e.isActive?"#1F2937":"#9CA3AF";return(0,J.jsx)(be.Text,{x:F+e.displayX,y:F+e.displayY-(e.isActive?12:10),fontSize:t,fill:s,fontWeight:a,textAnchor:"middle",children:e.isTop?`T${e.id}`:`B${e.id}`},`label-${e.id}-${e.isTop?"top":"bottom"}`)}),d&&N.map(e=>{const t=o.find(t=>t.strandId===`S${e.id}`);return t?(0,J.jsxs)(f.Fragment,{children:[(0,J.jsxs)(be.Text,{x:F+e.displayX,y:F+h+25,fontSize:12,fontWeight:"600",fill:t.leftExceedsOne?"#EF4444":"#10B981",textAnchor:"middle",children:["E1: ",t.leftSlippage,'"']}),(0,J.jsxs)(be.Text,{x:F+e.displayX,y:F+h+40,fontSize:12,fontWeight:"600",fill:t.rightExceedsOne?"#EF4444":"#10B981",textAnchor:"middle",children:["E2: ",t.rightSlippage,'"']})]},`slippage-${e.id}`):null}),(i||c||u)&&(()=>{const t=e/10,a=16*t,s=70*t,r=8*t,l=14*t,o=F+h+(d?45:0)+10,n=w/2;return(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Text,{x:n,y:o+l,fontSize:l,fill:"#374151",fontWeight:"600",textAnchor:"middle",children:"Strand Size Key"}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Circle,{cx:n-s,cy:o+1.5*a,r:r,fill:"#059669",stroke:"#047857",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n-s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 0.6"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a-r,x2:n+r,y2:o+1.5*a+r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Line,{x1:n-r,y1:o+1.5*a+r,x2:n+r,y2:o+1.5*a-r,stroke:"#059669",strokeWidth:3}),(0,J.jsx)(be.Text,{x:n+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 1/2"'})]}),(0,J.jsxs)(be.G,{children:[(0,J.jsx)(be.Polygon,{points:`${n+s},${o+1.5*a-r} ${n+s+r},${o+1.5*a} ${n+s},${o+1.5*a+r} ${n+s-r},${o+1.5*a}`,fill:"#2563EB",stroke:"#1E40AF",strokeWidth:2.5}),(0,J.jsx)(be.Text,{x:n+s+r+5,y:o+1.5*a+4,fontSize:.9*l,fill:"#1F2937",children:'= 3/8"'})]})]})})()]})})}function Ue({navigation:e,route:t}){const a=(0,i.useSafeAreaInsets)(),{config:s}=t.params,{customPatterns:r}=le(),l=r.find(e=>e.id===s.strandPattern),c=s.topStrandPattern?r.find(e=>e.id===s.topStrandPattern):void 0,u=(0,f.useMemo)(()=>{if(!l||!l.strandCoordinates||!s.productWidth||!s.productSide)return null;const{strandCoordinates:e}=l,{productWidth:t,productSide:a}=s,r=Math.min(...e.map(e=>e.x)),o=Math.max(...e.map(e=>e.x)),n=o+2;console.log("[SlippageIdentifier] Calculating active strands:"),console.log("  Strand positions:",`x=${r}" to x=${o}"`),console.log("  Full product width:",n),console.log("  Cut product width:",t),console.log("  Product side:",a),console.log("  Total strands:",e.length);const d=[];return e.forEach((e,s)=>{let r=!1;if("L1"===a)r=e.x<=t,console.log(`  Strand ${s+1} at x=${e.x}": ${r?"ACTIVE":"inactive"} (keeping 0-${t}")`);else if("L2"===a){const a=n-t;r=e.x>=a,console.log(`  Strand ${s+1} at x=${e.x}": ${r?"ACTIVE":"inactive"} (keeping ${a}-${n}")`)}r&&d.push(s)}),console.log("[SlippageIdentifier] Active strand count:",d.length),console.log("[SlippageIdentifier] Active strand indices:",d),d},[l,s.productWidth,s.productSide]),m=(0,f.useMemo)(()=>{const e=[];if(l){const t=l.strand_3_8+l.strand_1_2+l.strand_0_6;let a;a=null===u?Array.from({length:t},(e,t)=>t+1):u.map(e=>e+1);for(const s of a){const t=l.strandSizes?.[s-1];e.push({strandId:`B${s}`,leftSlippage:"0",rightSlippage:"0",leftExceedsOne:!1,rightExceedsOne:!1,size:t})}}if(c){const t=c.strand_3_8+c.strand_1_2+c.strand_0_6;for(let a=1;a<=t;a++){const t=c.strandSizes?.[a-1];e.push({strandId:`T${a}`,leftSlippage:"0",rightSlippage:"0",leftExceedsOne:!1,rightExceedsOne:!1,size:t})}}return e},[l,c,u]),[p,b]=(0,f.useState)(m),y=(e,t,a)=>{b(s=>s.map(s=>s.strandId===e?Object.assign({},s,{["left"===t?"leftSlippage":"rightSlippage"]:a}):s))},j=(e,t)=>{b(a=>a.map(a=>{if(a.strandId===e){if("0"===("left"===t?a.leftSlippage:a.rightSlippage))return Object.assign({},a,{["left"===t?"leftSlippage":"rightSlippage"]:""})}return a}))},N=(e,t)=>{b(a=>a.map(a=>{if(a.strandId===e){if(""===("left"===t?a.leftSlippage:a.rightSlippage).trim())return Object.assign({},a,{["left"===t?"leftSlippage":"rightSlippage"]:"0"})}return a}))},w=(e,t)=>{b(a=>a.map(a=>a.strandId===e?Object.assign({},a,{["left"===t?"leftExceedsOne":"rightExceedsOne"]:!a["left"===t?"leftExceedsOne":"rightExceedsOne"]}):a))};return(0,J.jsx)(Z.default,{behavior:"height",className:"flex-1 bg-white",style:{paddingTop:a.top},children:(0,J.jsxs)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:40},keyboardShouldPersistTaps:"handled",children:[(0,J.jsxs)(n.default,{className:"px-6 py-4 border-b border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-2xl font-bold",children:"Slippage Identifier"}),(0,J.jsx)(d.default,{className:"text-gray-600 text-sm mt-1",children:"Enter slippage values at each strand end"})]}),(0,J.jsxs)(n.default,{className:"items-center my-4",style:{overflow:"visible",minHeight:200},children:[(0,J.jsxs)(d.default,{className:"text-gray-700 text-xs font-semibold mb-2",children:["Cross Section - ",s.productType," Hollow Core Plank"]}),"1048"===s.productType?(0,J.jsx)(Re,{scale:6,activeStrands:null!==u?u.map(e=>e+1):void 0,productSide:s.productSide||null,productWidth:s.productWidth,strandCoordinates:l?.strandCoordinates,bottomStrandSizes:l?.strandSizes,topStrandCoordinates:c?.strandCoordinates,topStrandSizes:c?.strandSizes}):"1247"===s.productType?(0,J.jsx)($e,{scale:6,activeStrands:null!==u?u.map(e=>e+1):void 0,productSide:s.productSide||null,productWidth:s.productWidth,strandCoordinates:l?.strandCoordinates,bottomStrandSizes:l?.strandSizes,topStrandCoordinates:c?.strandCoordinates,topStrandSizes:c?.strandSizes}):"1250"===s.productType?(0,J.jsx)(We,{scale:6,activeStrands:null!==u?u.map(e=>e+1):void 0,productSide:s.productSide||null,productWidth:s.productWidth,strandCoordinates:l?.strandCoordinates,bottomStrandSizes:l?.strandSizes,topStrandCoordinates:c?.strandCoordinates,topStrandSizes:c?.strandSizes}):"1648"===s.productType?(0,J.jsx)(Oe,{scale:6,activeStrands:null!==u?u.map(e=>e+1):void 0,productSide:s.productSide||null,productWidth:s.productWidth,strandCoordinates:l?.strandCoordinates,bottomStrandSizes:l?.strandSizes,topStrandCoordinates:c?.strandCoordinates,topStrandSizes:c?.strandSizes}):"1650"===s.productType?(0,J.jsx)(Me,{scale:6,activeStrands:null!==u?u.map(e=>e+1):void 0,productSide:s.productSide||null,productWidth:s.productWidth,strandCoordinates:l?.strandCoordinates,bottomStrandSizes:l?.strandSizes,topStrandCoordinates:c?.strandCoordinates,topStrandSizes:c?.strandSizes}):(0,J.jsx)(Le,{scale:6,activeStrands:null!==u?u.map(e=>e+1):void 0,productSide:s.productSide||null,productWidth:s.productWidth,strandCoordinates:l?.strandCoordinates,bottomStrandSizes:l?.strandSizes,topStrandCoordinates:c?.strandCoordinates,topStrandSizes:c?.strandSizes})]}),null!==u&&l&&s.productSide&&(0,J.jsx)(n.default,{className:"px-6 mb-3",children:(0,J.jsx)(n.default,{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"cut",size:18,color:"#10B981"}),(0,J.jsxs)(n.default,{className:"flex-1 ml-2",children:[(0,J.jsx)(d.default,{className:"text-green-900 font-semibold text-xs mb-0.5",children:"Cut-Width Product"}),(0,J.jsxs)(d.default,{className:"text-green-800 text-xs",children:[s.productWidth,'" \u2022 ',s.productSide," (","L1"===s.productSide?"Left side":"Right side",") \u2022 ",p.length,"/",l.strand_3_8+l.strand_1_2+l.strand_0_6," strands"]})]})]})})}),(0,J.jsxs)(n.default,{className:"px-6",children:[p.some(e=>e.strandId.startsWith("B"))&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(d.default,{className:"text-gray-900 text-base font-semibold mb-2",children:["Bottom Strands ",null===u?"":"(Active Strands)"]}),p.filter(e=>e.strandId.startsWith("B")).map((e,t)=>(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded-lg p-3 mb-2 border border-gray-200",children:[(0,J.jsx)(n.default,{className:"flex-row items-center justify-between mb-2",children:(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"bg-green-600 rounded-full w-6 h-6 items-center justify-center mr-2",children:(0,J.jsx)(d.default,{className:"text-white font-bold text-xs",children:e.strandId.substring(1)})}),(0,J.jsxs)(d.default,{className:"text-gray-900 font-semibold text-sm",children:["Bottom Strand ",e.strandId.substring(1),e.size&&(0,J.jsxs)(d.default,{className:"text-gray-600 font-normal text-xs",children:[" ","(",e.size,'")']})]})]})}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-xs font-medium text-gray-600 mb-1",children:"END 1"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-2 py-2 text-sm mb-1 "+(e.leftExceedsOne?"text-orange-600 font-bold":"text-gray-900"),placeholder:"0.5",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:e.leftExceedsOne?'>1"':e.leftSlippage,onChangeText:t=>y(e.strandId,"left",t),onFocus:()=>j(e.strandId,"left"),onBlur:()=>N(e.strandId,"left"),editable:!e.leftExceedsOne,keyboardType:"default"}),(0,J.jsxs)(o.default,{className:"flex-row items-center",onPress:()=>w(e.strandId,"left"),children:[(0,J.jsx)(n.default,{className:"w-4 h-4 rounded border-2 mr-1.5 items-center justify-center "+(e.leftExceedsOne?"bg-orange-500 border-orange-500":"bg-white border-gray-300"),children:e.leftExceedsOne&&(0,J.jsx)(d.default,{className:"text-white text-xs font-bold",children:"\u2713"})}),(0,J.jsx)(d.default,{className:"text-gray-700 text-xs",children:'>1"'})]})]}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-xs font-medium text-gray-600 mb-1",children:"END 2"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-2 py-2 text-sm mb-1 "+(e.rightExceedsOne?"text-orange-600 font-bold":"text-gray-900"),placeholder:"0.5",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:e.rightExceedsOne?'>1"':e.rightSlippage,onChangeText:t=>y(e.strandId,"right",t),onFocus:()=>j(e.strandId,"right"),onBlur:()=>N(e.strandId,"right"),editable:!e.rightExceedsOne,keyboardType:"default"}),(0,J.jsxs)(o.default,{className:"flex-row items-center",onPress:()=>w(e.strandId,"right"),children:[(0,J.jsx)(n.default,{className:"w-4 h-4 rounded border-2 mr-1.5 items-center justify-center "+(e.rightExceedsOne?"bg-orange-500 border-orange-500":"bg-white border-gray-300"),children:e.rightExceedsOne&&(0,J.jsx)(d.default,{className:"text-white text-xs font-bold",children:"\u2713"})}),(0,J.jsx)(d.default,{className:"text-gray-700 text-xs",children:'>1"'})]})]})]})]},e.strandId))]}),p.some(e=>e.strandId.startsWith("T"))&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-semibold mb-2 mt-4",children:"Top Strands"}),p.filter(e=>e.strandId.startsWith("T")).map((e,t)=>(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded-lg p-3 mb-2 border border-gray-200",children:[(0,J.jsx)(n.default,{className:"flex-row items-center justify-between mb-2",children:(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"bg-blue-600 rounded-full w-6 h-6 items-center justify-center mr-2",children:(0,J.jsx)(d.default,{className:"text-white font-bold text-xs",children:e.strandId.substring(1)})}),(0,J.jsxs)(d.default,{className:"text-gray-900 font-semibold text-sm",children:["Top Strand ",e.strandId.substring(1),e.size&&(0,J.jsxs)(d.default,{className:"text-gray-600 font-normal text-xs",children:[" ","(",e.size,'")']})]})]})}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-xs font-medium text-gray-600 mb-1",children:"END 1"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-2 py-2 text-sm mb-1 "+(e.leftExceedsOne?"text-orange-600 font-bold":"text-gray-900"),placeholder:"0.5",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:e.leftExceedsOne?'>1"':e.leftSlippage,onChangeText:t=>y(e.strandId,"left",t),onFocus:()=>j(e.strandId,"left"),onBlur:()=>N(e.strandId,"left"),editable:!e.leftExceedsOne,keyboardType:"default"}),(0,J.jsxs)(o.default,{className:"flex-row items-center",onPress:()=>w(e.strandId,"left"),children:[(0,J.jsx)(n.default,{className:"w-4 h-4 rounded border-2 mr-1.5 items-center justify-center "+(e.leftExceedsOne?"bg-orange-500 border-orange-500":"bg-white border-gray-300"),children:e.leftExceedsOne&&(0,J.jsx)(d.default,{className:"text-white text-xs font-bold",children:"\u2713"})}),(0,J.jsx)(d.default,{className:"text-gray-700 text-xs",children:'>1"'})]})]}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-xs font-medium text-gray-600 mb-1",children:"END 2"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-2 py-2 text-sm mb-1 "+(e.rightExceedsOne?"text-orange-600 font-bold":"text-gray-900"),placeholder:"0.5",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:e.rightExceedsOne?'>1"':e.rightSlippage,onChangeText:t=>y(e.strandId,"right",t),onFocus:()=>j(e.strandId,"right"),onBlur:()=>N(e.strandId,"right"),editable:!e.rightExceedsOne,keyboardType:"default"}),(0,J.jsxs)(o.default,{className:"flex-row items-center",onPress:()=>w(e.strandId,"right"),children:[(0,J.jsx)(n.default,{className:"w-4 h-4 rounded border-2 mr-1.5 items-center justify-center "+(e.rightExceedsOne?"bg-orange-500 border-orange-500":"bg-white border-gray-300"),children:e.rightExceedsOne&&(0,J.jsx)(d.default,{className:"text-white text-xs font-bold",children:"\u2713"})}),(0,J.jsx)(d.default,{className:"text-gray-700 text-xs",children:'>1"'})]})]})]})]},e.strandId))]}),(0,J.jsx)(o.default,{className:"bg-blue-500 rounded-xl py-3 items-center active:bg-blue-600 mt-2",onPress:()=>e.navigate("SlippageSummary",{slippages:p,config:s}),children:(0,J.jsx)(d.default,{className:"text-white text-sm font-semibold",children:"Calculate Results"})})]})]})})}const He=new E("userSlippageRecords"),Ve=new E("publishedSlippageRecords"),Ge=(0,y.create)()((0,O.persist)((e,t)=>({userRecords:[],publishedRecords:[],isLoading:!1,isSyncing:!1,addUserRecord:async t=>{console.log("[SlippageHistoryStore] Adding user record:",{id:t.id,userId:t.userId,timestamp:t.timestamp,hasSlippages:t.slippages?.length>0}),e(e=>({userRecords:[t,...e.userRecords].slice(0,100)}));try{console.log("[SlippageHistoryStore] Syncing to Firebase..."),await He.set(t.id,t),console.log("[SlippageHistoryStore] Successfully synced to Firebase")}catch(qa){console.error("[SlippageHistoryStore] Failed to sync user record to Firebase:",qa),qa instanceof Error&&(console.error("[SlippageHistoryStore] Error message:",qa.message),console.error("[SlippageHistoryStore] Error stack:",qa.stack))}},updateUserRecord:(t,a)=>e(e=>({userRecords:e.userRecords.map(e=>e.id===t?Object.assign({},e,a):e)})),removeUserRecord:async t=>{e(e=>({userRecords:e.userRecords.filter(e=>e.id!==t)}));try{await He.delete(t)}catch(qa){console.error("Failed to delete user record from Firebase:",qa)}},clearUserRecords:()=>e({userRecords:[]}),publishRecord:async(t,a)=>{const s=Object.assign({},t,{publishedAt:Date.now(),publishedBy:a});e(e=>({publishedRecords:[s,...e.publishedRecords].slice(0,200)}));try{await Ve.set(s.id,s)}catch(qa){console.error("Failed to publish record to Firebase:",qa)}},removePublishedRecord:async t=>{e(e=>({publishedRecords:e.publishedRecords.filter(e=>e.id!==t)}));try{await Ve.delete(t)}catch(qa){console.error("Failed to delete published record from Firebase:",qa)}},clearPublishedRecords:()=>e({publishedRecords:[]}),syncUserRecords:async()=>{const t=G.getState().currentUser;if(console.log("[SlippageHistoryStore] syncUserRecords called. Current user:",t?.email),console.log("[SlippageHistoryStore] Current user FULL object:",JSON.stringify(t,null,2)),console.log("[SlippageHistoryStore] Current user ID specifically:",t?.id),console.log("[SlippageHistoryStore] Type of user ID:",typeof t?.id),t){e({isSyncing:!0});try{console.log("[SlippageHistoryStore] Fetching all records from Firebase...");const a=await He.fetchAll();console.log("[SlippageHistoryStore] Fetched",a.length,"total records"),a.length>0&&console.log("[SlippageHistoryStore] Sample record:",JSON.stringify(a[0],null,2));const s=a.filter(e=>e.userId===t.id);console.log("[SlippageHistoryStore] Filtered to",s.length,"user records for userId:",t.id),e({userRecords:s,isSyncing:!1})}catch(qa){console.error("[SlippageHistoryStore] Failed to sync user records from Firebase:",qa),qa instanceof Error&&console.error("[SlippageHistoryStore] Error message:",qa.message),e({isSyncing:!1})}}else console.log("[SlippageHistoryStore] No current user, skipping sync")},syncPublishedRecords:async()=>{e({isSyncing:!0});try{const t=await Ve.fetchAll();e({publishedRecords:t,isSyncing:!1})}catch(qa){console.error("Failed to sync published records from Firebase:",qa),e({isSyncing:!1})}},subscribeToPublishedRecords:()=>Ve.subscribe(t=>{e({publishedRecords:t})})}),{name:"slippage-history-storage",storage:(0,O.createJSONStorage)(()=>F.default)}));var qe=a(68056),Ye=a(16931),_e=a(12348),Je=a(18876);let Qe=null,Xe=null,Ke=null;async function Ze(e){const{slippages:t,config:a,slippageStats:s,userEmail:r,userName:l,crossSectionImageUri:o,getStrandSize:n,strandPatternName:d}=e;try{const e=t.filter(e=>e.strandId.startsWith("B")),s=t.filter(e=>e.strandId.startsWith("T")),x=(()=>{const t=e.map(e=>{const t=ue(e.leftSlippage),a=ue(e.rightSlippage),s=e.leftExceedsOne?1:t??0,r=e.rightExceedsOne?1:a??0;return{e1:s,e2:r,e1Exceeds:e.leftExceedsOne,e2Exceeds:e.rightExceedsOne,total:s+r}}),a=t.reduce((e,t)=>e+t.e1,0),s=t.reduce((e,t)=>e+t.e2,0),r=t.reduce((e,t)=>e+t.total,0),l=t.length,o=t.some(e=>e.e1Exceeds),n=t.some(e=>e.e2Exceeds);return{totalE1:a,totalE2:s,totalBoth:r,avgE1:l>0?a/l:0,avgE2:l>0?s/l:0,avgBoth:l>0?r/l:0,anyE1Exceeds:o,anyE2Exceeds:n,anyExceeds:o||n}})(),f=(()=>{const e=s.map(e=>{const t=ue(e.leftSlippage),a=ue(e.rightSlippage),s=e.leftExceedsOne?1:t??0,r=e.rightExceedsOne?1:a??0;return{e1:s,e2:r,e1Exceeds:e.leftExceedsOne,e2Exceeds:e.rightExceedsOne,total:s+r}}),t=e.reduce((e,t)=>e+t.e1,0),a=e.reduce((e,t)=>e+t.e2,0),r=e.reduce((e,t)=>e+t.total,0),l=e.length,o=e.some(e=>e.e1Exceeds),n=e.some(e=>e.e2Exceeds);return{totalE1:t,totalE2:a,totalBoth:r,avgE1:l>0?t/l:0,avgE2:l>0?a/l:0,avgBoth:l>0?r/l:0,anyE1Exceeds:o,anyE2Exceeds:n,anyExceeds:o||n}})();let g;const h="undefined"!==typeof document;if(o)try{if(console.log("[PDF Generator] Converting image to base64:",o),h)if(o.startsWith("data:"))g=o,console.log("[PDF Generator] Using data URI directly for web");else if(o.startsWith("blob:")){console.log("[PDF Generator] Converting blob URL to data URI...");const e=await fetch(o),t=await e.blob(),a=new FileReader;g=await new Promise(e=>{a.onloadend=()=>e(a.result),a.readAsDataURL(t)}),console.log("[PDF Generator] Blob converted to data URI")}else console.warn("[PDF Generator] Unknown URI format on web:",o),g=o;else{const e=await _e.getInfoAsync(o);if(console.log("[PDF Generator] Image file info:",e),!e.exists)throw console.error("[PDF Generator] Image file does not exist"),new Error("Image file does not exist");const t=await _e.readAsStringAsync(o,{encoding:Je.EncodingType.Base64}),a=2097152;t.length>a?(console.warn("[PDF Generator] Image too large (>2MB), skipping to prevent errors"),g=void 0):t&&0!==t.length?(g=`data:image/png;base64,${t}`,console.log("[PDF Generator] Image converted successfully, size:",Math.round(t.length/1024),"KB")):(console.warn("[PDF Generator] Invalid base64 data, skipping image"),g=void 0)}}catch(qa){console.error("[PDF Generator] Error converting image to base64:",qa),g=void 0}else console.log("[PDF Generator] No cross-section image provided");const p=`\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset="UTF-8">\n          <meta name="viewport" content="width=device-width, initial-scale=1.0">\n          <style>\n            @page {\n              size: letter;\n              margin: 0;\n            }\n\n            * {\n              margin: 0;\n              padding: 0;\n              box-sizing: border-box;\n            }\n\n            body, .pdf-container {\n              font-family: 'Helvetica Neue', Arial, sans-serif;\n              padding: 12px 18px;\n              color: #1f2937;\n              line-height: 1.3;\n              background-color: #ffffff;\n              font-size: 9px;\n              word-spacing: 0.2em;\n              letter-spacing: 0.02em;\n              max-width: 612px;\n              overflow: hidden;\n            }\n\n            /* Responsive font and layout sizing */\n            @media screen and (min-width: 768px) {\n              /* Tablets - slightly larger text */\n              body, .pdf-container {\n                font-size: 10px;\n                padding: 16px 24px;\n              }\n              h1 {\n                font-size: 16px !important;\n              }\n              h2 {\n                font-size: 11px !important;\n              }\n              .strand-table th {\n                font-size: 8px !important;\n              }\n              .strand-table td {\n                font-size: 8.5px !important;\n              }\n            }\n\n            @media screen and (min-width: 1024px) {\n              /* Desktop - much larger text for readability */\n              body, .pdf-container {\n                font-size: 12px;\n                padding: 20px 30px;\n                max-width: 800px;\n              }\n              h1 {\n                font-size: 20px !important;\n              }\n              h2 {\n                font-size: 14px !important;\n              }\n              .strand-table th {\n                font-size: 10px !important;\n                padding: 5px 6px !important;\n              }\n              .strand-table td {\n                font-size: 11px !important;\n                padding: 5px 6px !important;\n              }\n              .info-label {\n                font-size: 8px !important;\n              }\n              .info-value {\n                font-size: 10px !important;\n              }\n              .stat-label {\n                font-size: 8px !important;\n              }\n              .stat-value {\n                font-size: 11px !important;\n              }\n            }\n\n            .header {\n              border-bottom: 2px solid #2563eb;\n              padding-bottom: 3px;\n              margin-bottom: 4px;\n            }\n\n            h1 {\n              font-size: 14px;\n              color: #1e40af;\n              margin-bottom: 2px;\n              line-height: 1.3;\n              letter-spacing: 0.05em;\n              word-spacing: 0.2em;\n            }\n\n            .subtitle {\n              color: #6b7280;\n              font-size: 7.5px;\n              line-height: 1.3;\n              word-spacing: 0.15em;\n              letter-spacing: 0.02em;\n            }\n\n            .section {\n              margin-bottom: 4px;\n            }\n\n            h2 {\n              font-size: 9px;\n              color: #374151;\n              margin-bottom: 2px;\n              padding-bottom: 2px;\n              border-bottom: 1px solid #e5e7eb;\n              line-height: 1.3;\n              letter-spacing: 0.05em;\n              word-spacing: 0.2em;\n            }\n\n            .info-grid {\n              display: grid;\n              grid-template-columns: repeat(4, 1fr);\n              gap: 3px;\n              margin-bottom: 3px;\n            }\n\n            .info-item {\n              padding: 3px 4px;\n              background: #f9fafb;\n              border-left: 2px solid #2563eb;\n            }\n\n            .info-label {\n              font-size: 6.5px;\n              color: #6b7280;\n              text-transform: uppercase;\n              letter-spacing: 0.08em;\n              word-spacing: 0.2em;\n              line-height: 1.3;\n              margin-bottom: 1px;\n            }\n\n            .info-value {\n              font-size: 8px;\n              color: #111827;\n              font-weight: 600;\n              margin-top: 1px;\n              line-height: 1.3;\n              letter-spacing: 0.03em;\n              word-spacing: 0.15em;\n            }\n\n            .info-value-sub {\n              font-size: 6.5px;\n              color: #6b7280;\n              font-style: italic;\n              margin-top: 1px;\n              line-height: 1.3;\n              letter-spacing: 0.02em;\n            }\n\n            ${o?"\n            .cross-section {\n              text-align: center;\n              margin: 4px auto;\n              padding: 4px;\n              background: #ffffff;\n              border-radius: 3px;\n              border: 1px solid #e5e7eb;\n              display: flex;\n              justify-content: center;\n              align-items: center;\n            }\n\n            .cross-section img {\n              max-width: 95%;\n              max-height: 180px;\n              height: auto;\n              border-radius: 2px;\n              display: block;\n              margin: 0 auto;\n            }\n\n            /* Responsive sizing for different devices */\n            @media screen and (min-width: 768px) {\n              /* Tablets and larger - increase cross-section size */\n              .cross-section img {\n                max-height: 300px;\n                max-width: 90%;\n              }\n            }\n\n            @media screen and (min-width: 1024px) {\n              /* Desktop - significantly larger cross-section */\n              .cross-section {\n                padding: 8px;\n              }\n              .cross-section img {\n                max-height: 500px;\n                max-width: 85%;\n              }\n            }\n\n            @media screen and (max-width: 767px) {\n              /* Mobile devices - ensure cross-section fits with legend */\n              .cross-section {\n                padding: 2px;\n                margin: 2px auto;\n              }\n              .cross-section img {\n                max-height: 180px;\n                max-width: 100%;\n              }\n            }\n            ":""}\n\n            .stats-grid {\n              display: grid;\n              grid-template-columns: repeat(3, 1fr);\n              gap: 3px;\n              margin-bottom: 4px;\n            }\n\n            .stat-card {\n              padding: 3px 4px;\n              background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);\n              border-radius: 4px;\n              border: 1px solid #d1d5db;\n            }\n\n            .stat-label {\n              font-size: 6px;\n              color: #4b5563;\n              text-transform: uppercase;\n              letter-spacing: 0.08em;\n              word-spacing: 0.2em;\n              font-weight: 600;\n              margin-bottom: 1px;\n              line-height: 1.3;\n            }\n\n            .stat-value {\n              font-size: 8.5px;\n              color: #1e40af;\n              font-weight: 700;\n              margin-top: 1px;\n              line-height: 1.2;\n              letter-spacing: 0.02em;\n            }\n\n            .stat-value-small {\n              font-size: 6.5px;\n              color: #6b7280;\n              margin-top: 1px;\n              font-style: italic;\n              line-height: 1.3;\n              letter-spacing: 0.01em;\n            }\n\n            .strand-table {\n              width: 100%;\n              border-collapse: separate;\n              border-spacing: 0;\n              margin-top: 3px;\n            }\n\n            .strand-table th {\n              background: #000000;\n              padding: 3px 4px;\n              text-align: left;\n              font-size: 6.5px;\n              color: #ffffff;\n              text-transform: uppercase;\n              letter-spacing: 0.08em;\n              word-spacing: 0.2em;\n              font-weight: 700;\n              border-bottom: 2px solid #000000;\n              line-height: 1.4;\n              vertical-align: middle;\n              white-space: nowrap;\n            }\n\n            .strand-table td {\n              padding: 3px 4px;\n              border-bottom: 1px solid #e5e7eb;\n              font-size: 7px;\n              line-height: 1.4;\n              vertical-align: middle;\n              letter-spacing: 0.02em;\n              word-spacing: 0.1em;\n            }\n\n            .strand-table tr:nth-child(even) {\n              background: #f9fafb;\n            }\n\n            .strand-id {\n              font-weight: 700;\n              color: #1e40af;\n            }\n\n            .strand-total {\n              font-weight: 700;\n              color: #047857;\n            }\n\n            .warning-box {\n              background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);\n              border-left: 3px solid #f59e0b;\n              padding: 4px 6px;\n              margin: 5px 0;\n              border-radius: 3px;\n            }\n\n            .warning-text {\n              font-size: 7.5px;\n              color: #92400e;\n              font-weight: 700;\n              line-height: 1.4;\n              letter-spacing: 0.02em;\n              word-spacing: 0.15em;\n            }\n\n            .footer {\n              margin-top: 5px;\n              padding-top: 3px;\n              border-top: 1px solid #e5e7eb;\n              font-size: 6px;\n              color: #6b7280;\n              line-height: 1.4;\n              letter-spacing: 0.02em;\n              word-spacing: 0.15em;\n            }\n\n            .footer-item {\n              margin-bottom: 1px;\n              line-height: 1.4;\n            }\n          </style>\n        </head>\n        <body>\n          <div class="pdf-container">\n          \x3c!-- Header --\x3e\n          <div class="header">\n            <h1>Slippage Report</h1>\n            <div class="subtitle">\n              ${a.projectName||"Unnamed Project"} \u2022 Generated ${(new Date).toLocaleDateString()}\n            </div>\n          </div>\n\n          \x3c!-- Product Details --\x3e\n          <div class="section">\n            <h2>Product Details</h2>\n            <div class="info-grid">\n              <div class="info-item">\n                <div class="info-label">Project Number</div>\n                <div class="info-value">${a.projectNumber||""}</div>\n              </div>\n              <div class="info-item">\n                <div class="info-label">Project Name</div>\n                <div class="info-value">${a.projectName||""}</div>\n              </div>\n              <div class="info-item">\n                <div class="info-label">Mark Number</div>\n                <div class="info-value">${a.markNumber||""}</div>\n              </div>\n              <div class="info-item">\n                <div class="info-label">ID Number</div>\n                <div class="info-value">${a.idNumber||""}</div>\n              </div>\n              <div class="info-item">\n                <div class="info-label">Product Type</div>\n                <div class="info-value">${a.productType}</div>\n              </div>\n              <div class="info-item">\n                <div class="info-label">Strand Pattern</div>\n                <div class="info-value">${d||a.strandPattern}</div>\n              </div>\n              ${a.span?(()=>{const e=function(e){const t=Math.floor(e),a=12*(e-t),s=Math.floor(a),r=a-s,l=`${t}'-${a.toFixed(3)}"`;let o=Math.round(8*r),n=s;8===o&&(n+=1,o=0);let d="";if(0===o)d=`${t}'-${n}"`;else{const e=de(o,8);d=`${t}'-${n} ${o/e}/${8/e}"`}return{main:l,fraction:`\u2248${d}`}}(a.span);return`\n              <div class="info-item">\n                <div class="info-label">Span</div>\n                <div class="info-value">${e.main}</div>\n                <div class="info-value-sub">${e.fraction}</div>\n              </div>\n                `})():'\n              <div class="info-item">\n                <div class="info-label">Span</div>\n                <div class="info-value">-</div>\n              </div>\n              '}\n              <div class="info-item">\n                <div class="info-label">Width${a.productWidth?" (Cut)":""}</div>\n                <div class="info-value">${a.productWidth?`${a.productWidth}"`:"-"}</div>\n              </div>\n            </div>\n          </div>\n\n          ${g?`\n          \x3c!-- Cross Section --\x3e\n          <div class="section">\n            <h2>Cross Section with Strand Pattern</h2>\n            <div class="cross-section">\n              <img src="${g}" alt="Cross Section Diagram" />\n            </div>\n          </div>\n          `:""}\n\n          \x3c!-- Bottom Strand Statistics --\x3e\n          ${e.length>0?`\n          <div class="section">\n            <h2 style="color: #059669;">Bottom Strand Statistics</h2>\n            <div class="stats-grid">\n              <div class="stat-card">\n                <div class="stat-label">Total Slippage (Both Ends)</div>\n                <div class="stat-value">\n                  ${x.anyExceeds?">":""}${x.totalBoth.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${x.anyExceeds?">":""}${ie(x.totalBoth)}\n                </div>\n              </div>\n              <div class="stat-card">\n                <div class="stat-label">Total E1 Slippage</div>\n                <div class="stat-value">\n                  ${x.anyE1Exceeds?">":""}${x.totalE1.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${x.anyE1Exceeds?">":""}${ie(x.totalE1)}\n                </div>\n              </div>\n              <div class="stat-card">\n                <div class="stat-label">Total E2 Slippage</div>\n                <div class="stat-value">\n                  ${x.anyE2Exceeds?">":""}${x.totalE2.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${x.anyE2Exceeds?">":""}${ie(x.totalE2)}\n                </div>\n              </div>\n              <div class="stat-card">\n                <div class="stat-label">Average Slippage (Both Ends)</div>\n                <div class="stat-value">\n                  ${x.anyExceeds?">":""}${x.avgBoth.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${x.anyExceeds?">":""}${ie(x.avgBoth)}\n                </div>\n              </div>\n              <div class="stat-card">\n                <div class="stat-label">Average E1 Slippage</div>\n                <div class="stat-value">\n                  ${x.anyE1Exceeds?">":""}${x.avgE1.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${x.anyE1Exceeds?">":""}${ie(x.avgE1)}\n                </div>\n              </div>\n              <div class="stat-card">\n                <div class="stat-label">Average E2 Slippage</div>\n                <div class="stat-value">\n                  ${x.anyE2Exceeds?">":""}${x.avgE2.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${x.anyE2Exceeds?">":""}${ie(x.avgE2)}\n                </div>\n              </div>\n            </div>\n            ${x.anyExceeds?'\n            <div class="warning-box">\n              <div class="warning-text">\u26a0 WARNING: Bottom strands contain values exceeding 1"</div>\n            </div>\n            ':""}\n          </div>\n          `:""}\n\n          \x3c!-- Top Strand Statistics --\x3e\n          ${s.length>0?`\n          <div class="section">\n            <h2 style="color: #2563eb;">Top Strand Statistics</h2>\n            <div class="stats-grid">\n              <div class="stat-card">\n                <div class="stat-label">Total Slippage (Both Ends)</div>\n                <div class="stat-value">\n                  ${f.anyExceeds?">":""}${f.totalBoth.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${f.anyExceeds?">":""}${ie(f.totalBoth)}\n                </div>\n              </div>\n              <div class="stat-card">\n                <div class="stat-label">Total E1 Slippage</div>\n                <div class="stat-value">\n                  ${f.anyE1Exceeds?">":""}${f.totalE1.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${f.anyE1Exceeds?">":""}${ie(f.totalE1)}\n                </div>\n              </div>\n              <div class="stat-card">\n                <div class="stat-label">Total E2 Slippage</div>\n                <div class="stat-value">\n                  ${f.anyE2Exceeds?">":""}${f.totalE2.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${f.anyE2Exceeds?">":""}${ie(f.totalE2)}\n                </div>\n              </div>\n              <div class="stat-card">\n                <div class="stat-label">Average Slippage (Both Ends)</div>\n                <div class="stat-value">\n                  ${f.anyExceeds?">":""}${f.avgBoth.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${f.anyExceeds?">":""}${ie(f.avgBoth)}\n                </div>\n              </div>\n              <div class="stat-card">\n                <div class="stat-label">Average E1 Slippage</div>\n                <div class="stat-value">\n                  ${f.anyE1Exceeds?">":""}${f.avgE1.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${f.anyE1Exceeds?">":""}${ie(f.avgE1)}\n                </div>\n              </div>\n              <div class="stat-card">\n                <div class="stat-label">Average E2 Slippage</div>\n                <div class="stat-value">\n                  ${f.anyE2Exceeds?">":""}${f.avgE2.toFixed(3)}"\n                </div>\n                <div class="stat-value-small">\n                  \u2248${f.anyE2Exceeds?">":""}${ie(f.avgE2)}\n                </div>\n              </div>\n            </div>\n            ${f.anyExceeds?'\n            <div class="warning-box">\n              <div class="warning-text">\u26a0 WARNING: Top strands contain values exceeding 1"</div>\n            </div>\n            ':""}\n          </div>\n          `:""}\n\n          \x3c!-- Individual Strand Data --\x3e\n          <div class="section">\n            <h2>Slippage by Strand</h2>\n\n            ${t.some(e=>e.strandId.startsWith("B"))?`\n              <h3 style="font-size: 13px; color: #059669; margin: 10px 0 5px 0; font-weight: 600;">Bottom Strands</h3>\n              <table class="strand-table">\n                <thead>\n                  <tr>\n                    <th>Strand</th>\n                    <th>END 1</th>\n                    <th>END 2</th>\n                    <th>Total</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  ${t.filter(e=>e.strandId.startsWith("B")).map(e=>{const t=ue(e.leftSlippage),a=ue(e.rightSlippage),s=(e.leftExceedsOne?1:t??0)+(e.rightExceedsOne?1:a??0),r=e.leftExceedsOne||e.rightExceedsOne,l=n?n(e.strandId):"";return`\n                      <tr>\n                        <td style="font-weight: 700; color: #059669;">\n                          Bottom Strand ${e.strandId.substring(1)}${l?` (${l})`:""}\n                        </td>\n                        <td>\n                          <span style="color: #111827; font-weight: 600;">\n                            ${e.leftExceedsOne?">1.000":null!==t?t.toFixed(3):"0.000"}"\n                          </span>\n                          <span style="color: #6b7280; font-size: 11px; margin-left: 5px;">\n                            (\u2248${e.leftExceedsOne?">1":null!==t?ie(t):"0"})\n                          </span>\n                        </td>\n                        <td>\n                          <span style="color: #111827; font-weight: 600;">\n                            ${e.rightExceedsOne?">1.000":null!==a?a.toFixed(3):"0.000"}"\n                          </span>\n                          <span style="color: #6b7280; font-size: 11px; margin-left: 5px;">\n                            (\u2248${e.rightExceedsOne?">1":null!==a?ie(a):"0"})\n                          </span>\n                        </td>\n                        <td class="strand-total">\n                          ${r?">":""}${s.toFixed(3)}"\n                          <span style="color: #6b7280; font-size: 11px; margin-left: 5px;">\n                            (\u2248${r?">":""}${ie(s)})\n                          </span>\n                        </td>\n                      </tr>\n                    `}).join("")}\n                </tbody>\n              </table>\n            `:""}\n\n            ${t.some(e=>e.strandId.startsWith("T"))?`\n              <h3 style="font-size: 13px; color: #2563eb; margin: 15px 0 5px 0; font-weight: 600;">Top Strands</h3>\n              <table class="strand-table">\n                <thead>\n                  <tr>\n                    <th>Strand</th>\n                    <th>END 1</th>\n                    <th>END 2</th>\n                    <th>Total</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  ${t.filter(e=>e.strandId.startsWith("T")).map(e=>{const t=ue(e.leftSlippage),a=ue(e.rightSlippage),s=(e.leftExceedsOne?1:t??0)+(e.rightExceedsOne?1:a??0),r=e.leftExceedsOne||e.rightExceedsOne,l=n?n(e.strandId):"";return`\n                      <tr>\n                        <td style="font-weight: 700; color: #2563eb;">\n                          Top Strand ${e.strandId.substring(1)}${l?` (${l})`:""}\n                        </td>\n                        <td>\n                          <span style="color: #111827; font-weight: 600;">\n                            ${e.leftExceedsOne?">1.000":null!==t?t.toFixed(3):"0.000"}"\n                          </span>\n                          <span style="color: #6b7280; font-size: 11px; margin-left: 5px;">\n                            (\u2248${e.leftExceedsOne?">1":null!==t?ie(t):"0"})\n                          </span>\n                        </td>\n                        <td>\n                          <span style="color: #111827; font-weight: 600;">\n                            ${e.rightExceedsOne?">1.000":null!==a?a.toFixed(3):"0.000"}"\n                          </span>\n                          <span style="color: #6b7280; font-size: 11px; margin-left: 5px;">\n                            (\u2248${e.rightExceedsOne?">1":null!==a?ie(a):"0"})\n                          </span>\n                        </td>\n                        <td class="strand-total">\n                          ${r?">":""}${s.toFixed(3)}"\n                          <span style="color: #6b7280; font-size: 11px; margin-left: 5px;">\n                            (\u2248${r?">":""}${ie(s)})\n                          </span>\n                        </td>\n                      </tr>\n                    `}).join("")}\n                </tbody>\n              </table>\n            `:""}\n          </div>\n\n          \x3c!-- Footer --\x3e\n          <div class="footer">\n            <div class="footer-item"><strong>Generated by:</strong> ${l} (${r})</div>\n            <div class="footer-item"><strong>Date:</strong> ${(new Date).toLocaleString()}</div>\n            <div class="footer-item"><strong>Tool:</strong> Slippage Identifier Tool</div>\n          </div>\n          </div>\n        </body>\n      </html>\n    `;console.log("[PDF Generator] Generating PDF..."),console.log("[PDF Generator] Platform:","web");if(!0){if(console.log("[PDF Generator] Web platform detected - using jsPDF for direct PDF download..."),Ke)try{console.log("[PDF Generator] Waiting for libraries to load..."),await Ke,console.log("[PDF Generator] Libraries loaded successfully")}catch(i){return console.error("[PDF Generator] Failed to load libraries:",i),console.log("[PDF Generator] Falling back to print dialog"),await qe.printAsync({html:p}),"web-print-dialog-opened"}if(!Qe||!Xe)return console.error("[PDF Generator] Libraries not available, falling back to print dialog"),await qe.printAsync({html:p}),"web-print-dialog-opened";try{console.log("[PDF Generator] Creating temporary element for rendering..."),console.log("[PDF Generator] Has base64Image:",!!g),g&&(console.log("[PDF Generator] Image data length:",g.length),console.log("[PDF Generator] Image prefix:",g.substring(0,50)));const e=document.createElement("div");if(e.innerHTML=p,e.style.position="absolute",e.style.left="-9999px",e.style.top="0",e.style.width="612px",e.style.backgroundColor="white",document.body.appendChild(e),g){console.log("[PDF Generator] Waiting for image to load...");const t=e.querySelectorAll("img");t.length>0&&(console.log("[PDF Generator] Found",t.length,"images in HTML"),await Promise.all(Array.from(t).map(e=>new Promise(t=>{e.complete?(console.log("[PDF Generator] Image already loaded"),t(!0)):(e.onload=()=>{console.log("[PDF Generator] Image loaded successfully"),t(!0)},e.onerror=()=>{console.error("[PDF Generator] Image failed to load"),t(!1)},setTimeout(()=>t(!1),5e3))}))))}await new Promise(e=>setTimeout(e,200)),console.log("[PDF Generator] Rendering HTML to canvas...");const t=await Xe(e,{scale:2,useCORS:!0,allowTaint:!0,logging:!0,backgroundColor:"#ffffff",onclone:e=>{console.log("[PDF Generator] Document cloned for rendering");const t=e.querySelectorAll("img");console.log("[PDF Generator] Found",t.length,"images in cloned document")}});console.log("[PDF Generator] Canvas created successfully"),console.log("[PDF Generator] Canvas dimensions:",t.width,"x",t.height),console.log("[PDF Generator] Creating PDF from canvas...");const a=new Qe("p","pt","letter"),s=t.toDataURL("image/png"),r=612,l=792,o=r,n=t.height*r/t.width;let d=n,i=0;for(a.addImage(s,"PNG",0,i,o,n),d-=l;d>0;)i=d-n,a.addPage(),a.addImage(s,"PNG",0,i,o,n),d-=l;return a.save(`Slippage-Report-${Date.now()}.pdf`),document.body.removeChild(e),console.log("[PDF Generator] PDF downloaded successfully"),"web-pdf-downloaded"}catch(qa){console.error("[PDF Generator] PDF generation failed:",qa),console.error("[PDF Generator] Error name:",qa?.name),console.error("[PDF Generator] Error message:",qa?.message),qa?.stack&&console.error("[PDF Generator] Error stack:",qa.stack);try{const e=document.querySelector('[style*="-9999px"]');e&&document.body.removeChild(e)}catch(c){console.error("[PDF Generator] Cleanup failed:",c)}return console.log("[PDF Generator] Falling back to print dialog"),await qe.printAsync({html:p}),"web-print-dialog-opened"}}let b;try{if(console.log("[PDF Generator] Starting PDF generation..."),console.log("[PDF Generator] HTML length:",p.length,"characters"),console.log("[PDF Generator] Has base64 image:",!!g),!p||0===p.length)throw new Error("HTML content is empty");b=(await qe.printToFileAsync({html:p,width:612,height:792})).uri,console.log("[PDF Generator] PDF created successfully at:",b)}catch(u){console.error("[PDF Generator] First attempt failed:",u),console.error("[PDF Generator] Error message:",u?.message),console.error("[PDF Generator] Error name:",u?.name);const e=u?.message?.toLowerCase()||"";if(!(g&&(e.includes("c++")||e.includes("exception")||e.includes("image")||e.includes("memory")||e.includes("printing did not complete"))))throw u;{console.log("[PDF Generator] Detected potential image-related error, retrying without image..."),g=void 0;const e=p.replace(/<img[^>]*>/gi,"").replace(/data:image\/[^"'\s]*/gi,"").replace(/<!-- Cross Section -->[\s\S]*?<\/div>\s*<\/div>/i,"");console.log("[PDF Generator] Retrying without image, HTML length:",e.length);try{b=(await qe.printToFileAsync({html:e,width:612,height:792})).uri,console.log("[PDF Generator] PDF created successfully without image at:",b)}catch(m){throw console.error("[PDF Generator] Retry failed:",m),new Error("Failed to generate PDF even without images: "+m?.message)}}}return b}catch(qa){return console.error("[PDF Generator] Error generating PDF:",qa),qa instanceof Error&&console.error("[PDF Generator] Error stack:",qa.stack),null}}Ke=(async()=>{try{const e=await a.e(627).then(a.bind(a,8627));Qe=e.jsPDF,console.log("[PDF Generator] jsPDF loaded successfully");const t=await Promise.resolve().then(a.t.bind(a,38589,23));Xe=t.default,console.log("[PDF Generator] html2canvas loaded successfully")}catch(e){throw console.error("[PDF Generator] Failed to load PDF libraries:",e),e}})();var et=a(73727);function tt({navigation:e,route:t}){const s=(0,i.useSafeAreaInsets)(),{slippages:r,config:l}=t.params,{customPatterns:c}=le(),{addUserRecord:u,publishRecord:m}=Ge(),h=G(e=>e.currentUser),[p,b]=(0,f.useState)(!1),[y,j]=(0,f.useState)(!1),[N,w]=(0,f.useState)(!1),[S,F]=(0,f.useState)(!1),[C,v]=(0,f.useState)(!1),A=(0,f.useRef)(null),P=c.find(e=>e.id===l.strandPattern),T=l.topStrandPattern?c.find(e=>e.id===l.topStrandPattern):void 0,E=e=>{const t=e.startsWith("T"),a=e.startsWith("B"),s=t||a?e.substring(1):e,r=parseInt(s)-1,l=t?T:P,o=l?.strandSizes?.[r];return o?`${o}"`:""},z=(0,f.useMemo)(()=>{const e=r.map(e=>({strandId:e.strandId,end1Raw:ue(e.leftSlippage),end2Raw:ue(e.rightSlippage),end1Exceeds:e.leftExceedsOne,end2Exceeds:e.rightExceedsOne,end1:e.leftExceedsOne?1:ue(e.leftSlippage)??0,end2:e.rightExceedsOne?1:ue(e.rightSlippage)??0})),t=e.some(e=>e.end1Exceeds),a=e.some(e=>e.end2Exceeds),s=t||a,l=e.map(e=>e.end1).filter(e=>null!==e&&!isNaN(e)),o=e.map(e=>e.end2).filter(e=>null!==e&&!isNaN(e)),n=[...l,...o],d=n.reduce((e,t)=>e+t,0),i=l.reduce((e,t)=>e+t,0),c=o.reduce((e,t)=>e+t,0);return{totalSlippage:d,totalSlippageEnd1:i,totalSlippageEnd2:c,strandTotals:e.map(e=>({strandId:e.strandId,total:e.end1+e.end2,exceeds:e.end1Exceeds||e.end2Exceeds})),totalAvgSlippage:n.length>0?d/n.length:0,totalAvgSlippageEnd1:l.length>0?i/l.length:0,totalAvgSlippageEnd2:o.length>0?c/o.length:0,anyValueExceeds:s,anyEnd1Exceeds:t,anyEnd2Exceeds:a}},[r]),B=(0,f.useMemo)(()=>{if(!P||!P.strandCoordinates||!l.productWidth||!l.productSide)return null;const{strandCoordinates:e}=P,{productWidth:t,productSide:a}=l,s=Math.min(...e.map(e=>e.x)),r=Math.max(...e.map(e=>e.x)),o=r+2;console.log("[SlippageSummary] Calculating active strands:"),console.log("  Strand positions:",`x=${s}" to x=${r}"`),console.log("  Full product width:",o),console.log("  Cut product width:",t),console.log("  Product side:",a),console.log("  Total strands:",e.length);const n=[];return e.forEach((e,s)=>{let r=!1;if("L1"===a)r=e.x<=t,console.log(`  Strand ${s+1} at x=${e.x}": ${r?"ACTIVE":"inactive"} (keeping 0-${t}")`);else if("L2"===a){const a=o-t;r=e.x>=a,console.log(`  Strand ${s+1} at x=${e.x}": ${r?"ACTIVE":"inactive"} (keeping ${a}-${o}")`)}r&&n.push(s+1)}),console.log("[SlippageSummary] Active strand count:",n.length),console.log("[SlippageSummary] Active strand indices:",n),n},[P,l.productWidth,l.productSide]);return(0,J.jsxs)(n.default,{className:"flex-1 bg-white",style:{paddingTop:s.top},children:[(0,J.jsxs)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:20},children:[(0,J.jsx)(n.default,{className:"px-6 py-3 border-b border-gray-200",children:(0,J.jsx)(d.default,{className:"text-gray-900 text-xl font-bold",children:"Slippage Summary"})}),(0,J.jsxs)(n.default,{ref:A,className:"items-center my-3",style:{overflow:"visible",minHeight:200},collapsable:!1,"data-testid":"cross-section-container",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-xs font-semibold mb-2",children:"Cross Section with Slippage Values"}),"1048"===l.productType?(0,J.jsx)(Re,{scale:6,activeStrands:B||void 0,productSide:l.productSide||null,productWidth:l.productWidth,slippages:r,showSlippageValues:!0,strandCoordinates:P?.strandCoordinates,bottomStrandSizes:P?.strandSizes,topStrandCoordinates:T?.strandCoordinates,topStrandSizes:T?.strandSizes}):"1247"===l.productType?(0,J.jsx)($e,{scale:6,activeStrands:B||void 0,productSide:l.productSide||null,productWidth:l.productWidth,slippages:r,showSlippageValues:!0,strandCoordinates:P?.strandCoordinates,bottomStrandSizes:P?.strandSizes,topStrandCoordinates:T?.strandCoordinates,topStrandSizes:T?.strandSizes}):"1250"===l.productType?(0,J.jsx)(We,{scale:6,activeStrands:B||void 0,productSide:l.productSide||null,productWidth:l.productWidth,slippages:r,showSlippageValues:!0,strandCoordinates:P?.strandCoordinates,bottomStrandSizes:P?.strandSizes,topStrandCoordinates:T?.strandCoordinates,topStrandSizes:T?.strandSizes}):(0,J.jsx)(Le,{scale:6,activeStrands:B||void 0,productSide:l.productSide||null,productWidth:l.productWidth,slippages:r,showSlippageValues:!0,strandCoordinates:P?.strandCoordinates,bottomStrandSizes:P?.strandSizes,topStrandCoordinates:T?.strandCoordinates,topStrandSizes:T?.strandSizes})]}),l.productWidth&&l.productSide&&P?.strandCoordinates&&(0,J.jsx)(n.default,{className:"px-6 mb-2",children:(0,J.jsx)(n.default,{className:"bg-amber-50 border border-amber-200 rounded-lg p-2.5",children:(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"cut",size:16,color:"#F59E0B"}),(0,J.jsxs)(d.default,{className:"text-amber-900 text-xs ml-2",children:["Cut: ",l.productWidth,'" \u2022 ',l.productSide," \u2022 ",r.length,"/",P.strand_3_8+P.strand_1_2+P.strand_0_6," strands"]})]})})}),(0,J.jsxs)(n.default,{className:"px-6",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-semibold mb-2",children:"Statistics"}),(0,J.jsxs)(n.default,{className:"flex-row gap-2 mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-blue-50 rounded-lg p-2.5",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-xs font-medium mb-0.5",children:"Total Slippage"}),(0,J.jsxs)(d.default,{className:"text-blue-600 text-lg font-bold",children:[z.anyValueExceeds&&">",z.totalSlippage.toFixed(3),'"']}),(0,J.jsxs)(d.default,{className:"text-blue-600 text-xs",children:["\u2248",z.anyValueExceeds&&">",ie(z.totalSlippage)]})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-orange-50 rounded-lg p-2.5",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-xs font-medium mb-0.5",children:"Avg Slippage"}),(0,J.jsxs)(d.default,{className:"text-orange-600 text-lg font-bold",children:[z.anyValueExceeds&&">",z.totalAvgSlippage.toFixed(3),'"']}),(0,J.jsxs)(d.default,{className:"text-orange-600 text-xs",children:["\u2248",z.anyValueExceeds&&">",ie(z.totalAvgSlippage)]})]})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-2 mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-green-50 rounded-lg p-2.5",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-xs font-medium",children:"END 1 Total"}),(0,J.jsxs)(d.default,{className:"text-green-600 text-base font-bold",children:[z.anyEnd1Exceeds&&">",z.totalSlippageEnd1.toFixed(3),'"']})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-purple-50 rounded-lg p-2.5",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-xs font-medium",children:"END 2 Total"}),(0,J.jsxs)(d.default,{className:"text-purple-600 text-base font-bold",children:[z.anyEnd2Exceeds&&">",z.totalSlippageEnd2.toFixed(3),'"']})]})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-2 mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-green-50 rounded-lg p-2.5",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-xs font-medium",children:"END 1 Avg"}),(0,J.jsxs)(d.default,{className:"text-green-600 text-base font-bold",children:[z.anyEnd1Exceeds&&">",z.totalAvgSlippageEnd1.toFixed(3),'"']})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-purple-50 rounded-lg p-2.5",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-xs font-medium",children:"END 2 Avg"}),(0,J.jsxs)(d.default,{className:"text-purple-600 text-base font-bold",children:[z.anyEnd2Exceeds&&">",z.totalAvgSlippageEnd2.toFixed(3),'"']})]})]}),(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded-lg p-2.5 mb-3",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-xs font-semibold mb-2",children:"By Strand"}),r.some(e=>e.strandId.startsWith("B"))&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-xs font-semibold mb-1.5",children:"Bottom Strands"}),r.filter(e=>e.strandId.startsWith("B")).map(e=>{const t=ue(e.leftSlippage),a=ue(e.rightSlippage),s=(e.leftExceedsOne?1:t??0)+(e.rightExceedsOne?1:a??0),r=e.leftExceedsOne||e.rightExceedsOne;return(0,J.jsxs)(n.default,{className:"mb-2 pb-2 border-b border-gray-300 last:border-b-0",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-1.5",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"bg-green-600 rounded-full w-5 h-5 items-center justify-center mr-1.5",children:(0,J.jsx)(d.default,{className:"text-white font-bold text-xs",children:e.strandId.substring(1)})}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-xs font-semibold",children:["Bottom Strand ",e.strandId.substring(1),E(e.strandId)&&(0,J.jsxs)(d.default,{className:"text-gray-600 font-normal",children:[" ","(",E(e.strandId),")"]})]})]}),(0,J.jsx)(n.default,{className:"bg-blue-100 px-2 py-0.5 rounded",children:(0,J.jsxs)(d.default,{className:"text-blue-700 text-xs font-bold",children:[r&&">","Total: ",s.toFixed(2),'"']})})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-2 ml-6",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-white rounded p-1.5 border border-green-200",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-xs mb-0.5",children:"E1"}),(0,J.jsx)(d.default,{className:"text-green-600 text-xs font-bold",children:e.leftExceedsOne?'>1"':null!==t&&0!==t?`${t.toFixed(3)}"`:'0"'})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-white rounded p-1.5 border border-purple-200",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-xs mb-0.5",children:"E2"}),(0,J.jsx)(d.default,{className:"text-purple-600 text-xs font-bold",children:e.rightExceedsOne?'>1"':null!==a&&0!==a?`${a.toFixed(3)}"`:'0"'})]})]})]},e.strandId)})]}),r.some(e=>e.strandId.startsWith("T"))&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-xs font-semibold mb-1.5 mt-2",children:"Top Strands"}),r.filter(e=>e.strandId.startsWith("T")).map(e=>{const t=ue(e.leftSlippage),a=ue(e.rightSlippage),s=(e.leftExceedsOne?1:t??0)+(e.rightExceedsOne?1:a??0),r=e.leftExceedsOne||e.rightExceedsOne;return(0,J.jsxs)(n.default,{className:"mb-2 pb-2 border-b border-gray-300 last:border-b-0",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-1.5",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"bg-blue-600 rounded-full w-5 h-5 items-center justify-center mr-1.5",children:(0,J.jsx)(d.default,{className:"text-white font-bold text-xs",children:e.strandId.substring(1)})}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-xs font-semibold",children:["Top Strand ",e.strandId.substring(1),E(e.strandId)&&(0,J.jsxs)(d.default,{className:"text-gray-600 font-normal",children:[" ","(",E(e.strandId),")"]})]})]}),(0,J.jsx)(n.default,{className:"bg-blue-100 px-2 py-0.5 rounded",children:(0,J.jsxs)(d.default,{className:"text-blue-700 text-xs font-bold",children:[r&&">","Total: ",s.toFixed(2),'"']})})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-2 ml-6",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-white rounded p-1.5 border border-green-200",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-xs mb-0.5",children:"E1"}),(0,J.jsx)(d.default,{className:"text-green-600 text-xs font-bold",children:e.leftExceedsOne?'>1"':null!==t&&0!==t?`${t.toFixed(3)}"`:'0"'})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-white rounded p-1.5 border border-purple-200",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-xs mb-0.5",children:"E2"}),(0,J.jsx)(d.default,{className:"text-purple-600 text-xs font-bold",children:e.rightExceedsOne?'>1"':null!==a&&0!==a?`${a.toFixed(3)}"`:'0"'})]})]})]},e.strandId)})]})]}),N&&(0,J.jsxs)(n.default,{className:"bg-green-50 border border-green-200 rounded-xl p-4 mb-4 flex-row items-center",children:[(0,J.jsx)(x.default,{name:"checkmark-circle",size:24,color:"#10B981"}),(0,J.jsx)(d.default,{className:"text-green-700 font-semibold ml-3",children:"Record saved successfully!"})]}),S&&(0,J.jsxs)(n.default,{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4 flex-row items-center",children:[(0,J.jsx)(x.default,{name:"checkmark-circle",size:24,color:"#3B82F6"}),(0,J.jsx)(d.default,{className:"text-blue-700 font-semibold ml-3",children:"Record published successfully!"})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3 mb-3",children:[(0,J.jsx)(o.default,{className:"flex-1 bg-green-500 rounded-xl py-4 items-center active:bg-green-600",onPress:()=>b(!0),children:(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"save-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Save"})]})}),(0,J.jsx)(o.default,{className:"flex-1 bg-purple-500 rounded-xl py-4 items-center active:bg-purple-600",onPress:()=>j(!0),children:(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"cloud-upload-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Publish"})]})})]}),(0,J.jsx)(o.default,{className:"bg-blue-500 rounded-xl py-4 items-center active:bg-blue-600 mb-3",onPress:async()=>{v(!0);try{let t;const s=!0;if(A.current)try{if(console.log("[PDF] Capturing cross-section..."),console.log("[PDF] Platform:",s?"web":"native"),console.log("[PDF] crossSectionRef.current exists:",!!A.current),s){console.log("[PDF] Using html2canvas for web...");const e=await Promise.resolve().then(a.t.bind(a,38589,23));let s=A.current;if(s._nativeTag||s._internalFiberInstanceHandleDEV){const e=document.querySelector('[data-testid="cross-section-container"]');e&&(s=e,console.log("[PDF] Found cross-section container via selector"))}console.log("[PDF] Capturing element:",s);t=(await e.default(s,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",logging:!1})).toDataURL("image/png"),console.log("[PDF] Cross-section captured successfully via html2canvas"),console.log("[PDF] Image URI length:",t?.length)}else t=await(0,et.captureRef)(A,{format:"png",quality:.8}),console.log("[PDF] Cross-section captured successfully via captureRef")}catch(e){console.error("[PDF] Error capturing cross-section:",e),console.log("[PDF] Continuing without cross-section image"),t=void 0}else console.log("[PDF] No cross-section ref available");const o=h?.email||"unknown@example.com",n=h?`${h.firstName} ${h.lastName}`:"Unknown User";console.log("[PDF] Generating PDF...");const d=await Ze({slippages:r,config:l,slippageStats:z,userEmail:o,userName:n,crossSectionImageUri:t,getStrandSize:E,strandPatternName:P?.name});d?(console.log("[PDF] PDF generated successfully:",d),"web-pdf-downloaded"===d?(console.log("[PDF] PDF downloaded successfully on web"),Te.default.alert("PDF Downloaded","The slippage report has been downloaded to your Downloads folder.")):"web-print-dialog-opened"===d?(console.log("[PDF] Web print dialog opened - user can save as PDF from browser"),Te.default.alert("Print Dialog Opened",'Use your browser\'s print dialog to save the report as PDF. Select "Save as PDF" as the printer destination.')):(await async function(e){try{await Ye.isAvailableAsync()?await Ye.shareAsync(e,{mimeType:"application/pdf",dialogTitle:"Share Slippage Report",UTI:"com.adobe.pdf"}):console.error("Sharing is not available on this device")}catch(qa){throw console.error("Error sharing PDF:",qa),qa}}(d),console.log("[PDF] PDF shared successfully"))):(console.log("[PDF] Failed to generate PDF - no file path returned"),Te.default.alert("Error","Failed to generate PDF report. Please try again."))}catch(qa){console.error("[PDF] Error generating/sharing PDF:",qa);const t=qa instanceof Error?qa.message:"Unknown error";console.error("[PDF] Error details:",t),t.includes("C++")||t.includes("exception")?Te.default.alert("PDF Generation Error","There was an issue processing the image. The PDF may have been generated without the cross-section diagram. Please try again."):Te.default.alert("Error",`Failed to generate or share PDF report: ${t}`)}finally{v(!1)}},disabled:C,children:(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:C?"hourglass-outline":"document-text-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:C?"Generating PDF...":"Generate Report"})]})}),(0,J.jsx)(o.default,{className:"bg-gray-100 rounded-xl py-4 items-center active:bg-gray-200 mb-4",onPress:()=>e.goBack(),children:(0,J.jsx)(d.default,{className:"text-gray-700 text-base font-semibold",children:"Back to Input"})})]})]}),(0,J.jsx)(ve,{visible:p,title:"Save Record",message:"Save this slippage record to your personal records?",confirmText:"Save",cancelText:"Cancel",confirmStyle:"default",onConfirm:()=>{console.log("[SlippageSummaryScreen] Current user object:",JSON.stringify(h,null,2)),console.log("[SlippageSummaryScreen] Current user ID:",h?.id),console.log("[SlippageSummaryScreen] Current user email:",h?.email);const e={id:`slippage-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now(),slippages:r,config:l,createdBy:h?.email||"Unknown",userId:h?.id||""};console.log("[SlippageSummaryScreen] Created record with userId:",e.userId),u(e),w(!0),b(!1),setTimeout(()=>w(!1),3e3)},onCancel:()=>b(!1)}),(0,J.jsx)(ve,{visible:y,title:"Publish Record",message:"Publish this slippage record to the official records visible to all users?",confirmText:"Publish",cancelText:"Cancel",confirmStyle:"default",onConfirm:()=>{const e={id:`slippage-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now(),slippages:r,config:l,createdBy:h?.email||"Unknown",userId:h?.id||""};m(e,h?.email||"Unknown"),F(!0),j(!1),setTimeout(()=>F(!1),3e3)},onCancel:()=>j(!1)})]})}var at=a(75675);function st(){const e=(0,i.useSafeAreaInsets)(),t=(0,c.useNavigation)(),{userRecords:a,publishedRecords:s,removeUserRecord:r,removePublishedRecord:l,clearUserRecords:u,clearPublishedRecords:m,syncUserRecords:h,syncPublishedRecords:p,subscribeToPublishedRecords:b,isSyncing:y}=Ge(),{customPatterns:j}=le(),N=G(e=>e.currentUser),[w,S]=(0,f.useState)("my-records"),[F,C]=(0,f.useState)(!1),[v,A]=(0,f.useState)(null);(0,f.useEffect)(()=>{h(),p();const e=b();return()=>e()},[h,p,b]),(0,f.useEffect)(()=>{"my-records"===w&&h()},[w,h]);const P="my-records"===w?a:s,T="my-records"===w||"admin"===N?.role;return(0,J.jsxs)(n.default,{style:rt.container,children:[(0,J.jsx)(g.default,{style:rt.scrollView,contentContainerStyle:{paddingBottom:e.bottom+20},children:(0,J.jsxs)(n.default,{style:rt.content,children:[(0,J.jsxs)(n.default,{style:rt.header,children:[(0,J.jsxs)(n.default,{style:rt.headerLeft,children:[(0,J.jsx)(d.default,{style:rt.title,children:"Slippage History"}),(0,J.jsxs)(d.default,{style:rt.subtitle,children:[P.length," ",1===P.length?"record":"records"]})]}),P.length>0&&T&&(0,J.jsx)(o.default,{onPress:()=>C(!0),style:rt.clearButton,children:(0,J.jsx)(d.default,{style:rt.clearButtonText,children:"Clear All"})})]}),(0,J.jsxs)(n.default,{style:rt.tabContainer,children:[(0,J.jsx)(o.default,{onPress:()=>S("my-records"),style:[rt.tab,"my-records"===w&&rt.activeTab],children:(0,J.jsx)(d.default,{style:[rt.tabText,"my-records"===w&&rt.activeTabText],children:"My Records"})}),(0,J.jsx)(o.default,{onPress:()=>S("published"),style:[rt.tab,"published"===w&&rt.activeTab],children:(0,J.jsx)(d.default,{style:[rt.tabText,"published"===w&&rt.activeTabText],children:"Published Records"})})]}),0===P.length?(0,J.jsxs)(n.default,{style:rt.emptyState,children:[(0,J.jsx)(n.default,{style:rt.emptyIcon,children:(0,J.jsx)(x.default,{name:"my-records"===w?"folder-outline":"cloud-outline",size:48,color:"#9CA3AF"})}),(0,J.jsx)(d.default,{style:rt.emptyTitle,children:"my-records"===w?"No Records Yet":"No Published Records"}),(0,J.jsx)(d.default,{style:rt.emptyMessage,children:"my-records"===w?"Your saved slippage records will appear here":"Published slippage records from all users will appear here"}),(0,J.jsx)(o.default,{onPress:()=>t.navigate("ProductDetails"),style:rt.createButton,children:(0,J.jsx)(d.default,{style:rt.createButtonText,children:"Create New Record"})})]}):(0,J.jsx)(n.default,{style:rt.recordsList,children:P.map(e=>{const{total:a,hasExceeds:s}=(e=>{let t=0,a=!1;return e.slippages.forEach(e=>{const s=ue(e.leftSlippage)??0,r=ue(e.rightSlippage)??0;t+=s+r,(e.leftExceedsOne||e.rightExceedsOne)&&(a=!0)}),{total:t,hasExceeds:a}})(e),r=j.find(t=>t.id===e.config.strandPattern),l="publishedAt"in e;return(0,J.jsxs)(o.default,{onPress:()=>(e=>{t.navigate("SlippageSummary",{slippages:e.slippages,config:e.config})})(e),style:rt.recordCard,children:[(0,J.jsxs)(n.default,{style:rt.recordHeader,children:[(0,J.jsxs)(n.default,{style:rt.recordHeaderLeft,children:[(0,J.jsxs)(n.default,{style:rt.recordTitleRow,children:[(0,J.jsx)(d.default,{style:rt.recordTitle,children:e.config.projectName||"Unnamed Project"}),l&&(0,J.jsx)(n.default,{style:rt.publishedBadge,children:(0,J.jsx)(d.default,{style:rt.publishedBadgeText,children:"PUBLISHED"})})]}),(e.config.projectNumber||e.config.markNumber||e.config.idNumber)&&(0,J.jsxs)(n.default,{style:rt.recordMetaRow,children:[e.config.projectNumber&&(0,J.jsx)(n.default,{style:rt.metaBadge,children:(0,J.jsxs)(d.default,{style:rt.metaBadgeText,children:["Proj: ",e.config.projectNumber]})}),e.config.markNumber&&(0,J.jsx)(n.default,{style:rt.metaBadge,children:(0,J.jsxs)(d.default,{style:rt.metaBadgeText,children:["Mark: ",e.config.markNumber]})}),e.config.idNumber&&(0,J.jsx)(n.default,{style:rt.metaBadge,children:(0,J.jsxs)(d.default,{style:rt.metaBadgeText,children:["ID: ",e.config.idNumber]})})]}),(0,J.jsx)(d.default,{style:rt.recordDate,children:(0,Ce.format)(new Date(e.timestamp),"MMM dd, yyyy \u2022 h:mm a")}),(0,J.jsxs)(d.default,{style:rt.recordCreator,children:["By: ",e.createdBy]}),l&&(0,J.jsxs)(d.default,{style:rt.recordPublished,children:["Published: ",(0,Ce.format)(new Date(e.publishedAt),"MMM dd, yyyy")]})]}),T&&(0,J.jsx)(o.default,{onPress:()=>A(e.id),style:rt.deleteButton,children:(0,J.jsx)(x.default,{name:"trash-outline",size:16,color:"#EF4444"})})]}),(0,J.jsx)(n.default,{style:rt.recordDivider}),(0,J.jsxs)(n.default,{style:rt.recordDetails,children:[(0,J.jsxs)(n.default,{style:rt.recordDetailRow,children:[(0,J.jsxs)(n.default,{style:rt.recordDetailLeft,children:[(0,J.jsx)(x.default,{name:"cube-outline",size:16,color:"#6B7280"}),(0,J.jsx)(d.default,{style:rt.recordDetailText,children:e.config.productType})]}),e.config.span&&(0,J.jsxs)(d.default,{style:rt.recordDetailText,children:[e.config.span,'" span']})]}),r&&(0,J.jsxs)(n.default,{style:rt.recordDetailLeft,children:[(0,J.jsx)(x.default,{name:"albums-outline",size:16,color:"#6B7280"}),(0,J.jsxs)(d.default,{style:rt.recordDetailText,children:["Pattern: ",r.name]})]}),(0,J.jsxs)(n.default,{style:rt.totalSlippageCard,children:[(0,J.jsxs)(n.default,{style:rt.totalSlippageRow,children:[(0,J.jsx)(d.default,{style:rt.totalSlippageLabel,children:"Total Slippage"}),(0,J.jsxs)(d.default,{style:rt.totalSlippageValue,children:[s&&">",a.toFixed(3),'" (\u2248',s&&">",ie(a),")"]})]}),s&&(0,J.jsx)(d.default,{style:rt.warningText,children:'\u26a0 Contains values exceeding 1"'})]})]}),(0,J.jsx)(n.default,{style:rt.recordFooter,children:(0,J.jsx)(x.default,{name:"chevron-forward",size:16,color:"#9CA3AF"})})]},e.id)})})]})}),(0,J.jsx)(ve,{visible:F,title:"Clear "+("my-records"===w?"My Records":"Published Records"),message:`Are you sure you want to delete all ${"my-records"===w?"your":"published"} records? This action cannot be undone.`,confirmText:"Clear All",cancelText:"Cancel",confirmStyle:"destructive",onConfirm:()=>{"my-records"===w?u():"admin"===N?.role&&m(),C(!1)},onCancel:()=>C(!1)}),(0,J.jsx)(ve,{visible:null!==v,title:"Delete Record",message:"Are you sure you want to delete this record?",confirmText:"Delete",cancelText:"Cancel",confirmStyle:"destructive",onConfirm:()=>{return v&&(e=v,"my-records"===w?r(e):"admin"===N?.role&&l(e),void A(null));var e},onCancel:()=>A(null)})]})}const rt=at.default.create({container:{flex:1,backgroundColor:"#F9FAFB"},scrollView:{flex:1},content:{padding:20},header:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:24},headerLeft:{flex:1},title:{fontSize:30,fontWeight:"bold",color:"#111827",marginBottom:4},subtitle:{fontSize:14,color:"#6B7280"},clearButton:{backgroundColor:"#FEF2F2",paddingHorizontal:12,paddingVertical:8,borderRadius:8},clearButtonText:{color:"#DC2626",fontSize:14,fontWeight:"500"},tabContainer:{flexDirection:"row",backgroundColor:"#E5E7EB",borderRadius:12,padding:4,marginBottom:24},tab:{flex:1,paddingVertical:12,borderRadius:8,backgroundColor:"transparent"},activeTab:{backgroundColor:"white",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},tabText:{textAlign:"center",fontWeight:"600",color:"#6B7280"},activeTabText:{color:"#111827"},emptyState:{alignItems:"center",justifyContent:"center",paddingVertical:80},emptyIcon:{backgroundColor:"#F3F4F6",borderRadius:9999,padding:24,marginBottom:16},emptyTitle:{fontSize:18,fontWeight:"600",color:"#111827",marginBottom:8},emptyMessage:{fontSize:14,color:"#6B7280",textAlign:"center",marginBottom:24,paddingHorizontal:32},createButton:{backgroundColor:"#3B82F6",paddingHorizontal:24,paddingVertical:12,borderRadius:12},createButtonText:{color:"white",fontWeight:"600"},recordsList:{gap:12},recordCard:{backgroundColor:"white",borderRadius:12,padding:16,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:1},recordHeader:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",marginBottom:12},recordHeaderLeft:{flex:1},recordTitleRow:{flexDirection:"row",alignItems:"center",marginBottom:4},recordTitle:{fontSize:16,fontWeight:"600",color:"#111827"},publishedBadge:{backgroundColor:"#F3E8FF",paddingHorizontal:8,paddingVertical:2,borderRadius:4,marginLeft:8},publishedBadgeText:{fontSize:10,fontWeight:"bold",color:"#7C3AED"},recordMetaRow:{flexDirection:"row",flexWrap:"wrap",gap:8,marginBottom:4},metaBadge:{backgroundColor:"#F3F4F6",paddingHorizontal:8,paddingVertical:2,borderRadius:4},metaBadgeText:{fontSize:12,color:"#374151"},recordDate:{fontSize:12,color:"#6B7280"},recordCreator:{fontSize:12,color:"#6B7280"},recordPublished:{fontSize:12,color:"#7C3AED"},deleteButton:{backgroundColor:"#FEF2F2",borderRadius:9999,padding:8,marginLeft:8},recordDivider:{height:at.default.hairlineWidth,backgroundColor:"#F3F4F6",marginVertical:12},recordDetails:{gap:8},recordDetailRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},recordDetailLeft:{flexDirection:"row",alignItems:"center",gap:4},recordDetailText:{fontSize:14,color:"#6B7280"},totalSlippageCard:{backgroundColor:"#EFF6FF",borderRadius:8,paddingHorizontal:12,paddingVertical:8,marginTop:8},totalSlippageRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},totalSlippageLabel:{fontSize:12,color:"#1D4ED8",fontWeight:"500"},totalSlippageValue:{fontSize:16,fontWeight:"bold",color:"#1D4ED8"},warningText:{fontSize:12,color:"#EA580C",fontWeight:"600",marginTop:4},recordFooter:{flexDirection:"row",alignItems:"center",justifyContent:"flex-end",marginTop:12}});var lt=a(92482);a(8787).maybeCompleteAuthSession();const ot={clientId:{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.EXPO_PUBLIC_AZURE_AD_CLIENT_ID||"YOUR_CLIENT_ID_HERE",tenantId:{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.EXPO_PUBLIC_AZURE_AD_TENANT_ID||"common",redirectUri:lt.makeRedirectUri({scheme:"exp"}),scopes:["Mail.Send","User.Read"]},nt="microsoft_graph_token";async function dt(e){try{const t=await async function(){try{const e=await F.default.getItem(nt);if(!e)throw new Error("No authentication token found. Please sign in.");const t=JSON.parse(e);if(Date.now()>=t.expiresAt-3e5)throw new Error("Token expired. Please sign in again.");return t.accessToken}catch(qa){throw console.error("Token retrieval error:",qa),qa}}(),a=e.to.split(",").map(e=>({emailAddress:{address:e.trim()}})),s=e.cc?e.cc.split(",").map(e=>({emailAddress:{address:e.trim()}})):void 0,r={message:{subject:e.subject,body:{contentType:"Text",content:e.body},toRecipients:a,ccRecipients:s},saveToSentItems:!0},l=await fetch("https://graph.microsoft.com/v1.0/me/sendMail",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(!l.ok){const e=await l.json();throw new Error(e.error?.message||`HTTP ${l.status}: ${l.statusText}`)}console.log("Email sent successfully via Graph API")}catch(qa){throw console.error("Graph API send email error:",qa),(qa.message?.includes("token")||qa.message?.includes("authentication"))&&await F.default.removeItem(nt),qa}}function it({navigation:e,route:t}){const a=(0,i.useSafeAreaInsets)(),s=G(e=>e.currentUser),{subject:r,body:l}=t.params,[c,u]=(0,f.useState)(""),[m,p]=(0,f.useState)(""),[b,y]=(0,f.useState)(!1),[j,N]=(0,f.useState)(!1),[w,S]=(0,f.useState)(!1),[C,v]=(0,f.useState)(!0),A=s?.email||"";(0,f.useEffect)(()=>{P()},[]);const P=async()=>{v(!0);const e=await async function(){try{const e=await F.default.getItem(nt);if(!e)return!1;const t=JSON.parse(e);return Date.now()<t.expiresAt}catch{return!1}}();S(e),v(!1)},T=async()=>{try{y(!0),await async function(){try{const e={authorizationEndpoint:`https://login.microsoftonline.com/${ot.tenantId}/oauth2/v2.0/authorize`,tokenEndpoint:`https://login.microsoftonline.com/${ot.tenantId}/oauth2/v2.0/token`},t=new lt.AuthRequest({clientId:ot.clientId,scopes:ot.scopes,redirectUri:ot.redirectUri,responseType:lt.ResponseType.Code,usePKCE:!0}),a=await t.promptAsync(e);if("success"===a.type){const{code:s}=a.params,r=await fetch(e.tokenEndpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:ot.clientId,code:s,redirect_uri:ot.redirectUri,grant_type:"authorization_code",code_verifier:t.codeVerifier||""}).toString()}),l=await r.json();if(l.error)throw new Error(l.error_description||l.error);const o={accessToken:l.access_token,refreshToken:l.refresh_token,expiresAt:Date.now()+1e3*l.expires_in};return await F.default.setItem(nt,JSON.stringify(o)),o}if("error"===a.type)throw new Error(a.params.error_description||"Authentication failed");{const e=new Error("Authentication was cancelled");throw e.name="AuthCancelledError",e}}catch(qa){throw"AuthCancelledError"!==qa.name&&console.error("Microsoft authentication error:",qa),qa}}(),S(!0),Te.default.alert("Success","Successfully signed in with Microsoft. You can now send emails.")}catch(qa){if("AuthCancelledError"===qa.name)return;console.error("Microsoft sign-in error:",qa),Te.default.alert("Sign In Failed",qa.message||"Unable to sign in with Microsoft. Please try again.")}finally{y(!1)}};return(0,J.jsx)(Z.default,{style:ct.container,behavior:"height",children:(0,J.jsx)(g.default,{style:ct.scrollView,contentContainerStyle:{paddingBottom:a.bottom+20},keyboardShouldPersistTaps:"handled",children:(0,J.jsx)(n.default,{style:ct.content,children:C?(0,J.jsxs)(n.default,{style:ct.authCheckContainer,children:[(0,J.jsx)(q.default,{color:"#3B82F6"}),(0,J.jsx)(d.default,{style:ct.authCheckText,children:"Checking authentication..."})]}):w?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(n.default,{style:ct.fieldContainer,children:[(0,J.jsx)(d.default,{style:ct.label,children:"From"}),(0,J.jsxs)(n.default,{style:ct.fromContainer,children:[(0,J.jsx)(d.default,{style:ct.fromEmail,children:A}),(0,J.jsxs)(n.default,{style:ct.verifiedBadge,children:[(0,J.jsx)(x.default,{name:"checkmark-circle",size:16,color:"#10B981"}),(0,J.jsx)(d.default,{style:ct.verifiedText,children:"Microsoft"})]})]})]}),(0,J.jsxs)(n.default,{style:ct.fieldContainer,children:[(0,J.jsx)(d.default,{style:ct.label,children:"To *"}),(0,J.jsx)(h.default,{style:ct.input,placeholder:"recipient@example.com",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:c,onChangeText:u,keyboardType:"email-address",autoCapitalize:"none",autoCorrect:!1,editable:!b})]}),(0,J.jsxs)(n.default,{style:ct.fieldContainer,children:[(0,J.jsx)(d.default,{style:ct.label,children:"CC (Optional)"}),(0,J.jsx)(h.default,{style:ct.input,placeholder:"cc@example.com",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:m,onChangeText:p,keyboardType:"email-address",autoCapitalize:"none",autoCorrect:!1,editable:!b})]}),(0,J.jsxs)(n.default,{style:ct.fieldContainer,children:[(0,J.jsx)(d.default,{style:ct.label,children:"Subject"}),(0,J.jsx)(n.default,{style:ct.readOnlyField,children:(0,J.jsx)(d.default,{style:ct.readOnlyText,children:r})})]}),(0,J.jsxs)(o.default,{style:ct.previewButton,onPress:()=>N(!j),children:[(0,J.jsx)(x.default,{name:j?"eye-off-outline":"eye-outline",size:20,color:"#3B82F6"}),(0,J.jsx)(d.default,{style:ct.previewButtonText,children:j?"Hide Preview":"Show Preview"})]}),j&&(0,J.jsxs)(n.default,{style:ct.previewContainer,children:[(0,J.jsx)(d.default,{style:ct.previewLabel,children:"Email Body Preview:"}),(0,J.jsx)(g.default,{style:ct.previewScroll,children:(0,J.jsx)(d.default,{style:ct.previewText,children:l})})]}),(0,J.jsxs)(n.default,{style:ct.infoBox,children:[(0,J.jsx)(x.default,{name:"information-circle",size:20,color:"#3B82F6"}),(0,J.jsx)(d.default,{style:ct.infoText,children:"This email will be sent through your Microsoft 365 account and will appear in your Outlook Sent folder."})]}),(0,J.jsx)(o.default,{style:[ct.sendButton,b&&ct.sendButtonDisabled],onPress:async()=>{if(!w)return void Te.default.alert("Authentication Required","Please sign in with your Microsoft account to send emails.",[{text:"Cancel",style:"cancel"},{text:"Sign In",onPress:T}]);if(!c.trim())return void Te.default.alert("Missing Recipient","Please enter a recipient email address.");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.trim())){y(!0);try{await dt({from:A,to:c.trim(),cc:m.trim()||void 0,subject:r,body:l}),Te.default.alert("Email Sent Successfully","Your report has been sent and will appear in your Outlook Sent folder.",[{text:"OK",onPress:()=>e.goBack()}])}catch(qa){console.error("Email send error:",qa),qa.message?.includes("authentication")||qa.message?.includes("token")?(S(!1),Te.default.alert("Authentication Required","Your session has expired. Please sign in again.",[{text:"Cancel",style:"cancel"},{text:"Sign In",onPress:T}])):Te.default.alert("Send Failed",`Unable to send email: ${qa.message||"Unknown error"}. Please try again.`,[{text:"OK"}])}finally{y(!1)}}else Te.default.alert("Invalid Email","Please enter a valid email address.")},disabled:b,children:b?(0,J.jsx)(q.default,{color:"white"}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(x.default,{name:"send",size:20,color:"white"}),(0,J.jsx)(d.default,{style:ct.sendButtonText,children:"Send Report"})]})}),(0,J.jsx)(o.default,{style:ct.cancelButton,onPress:()=>e.goBack(),disabled:b,children:(0,J.jsx)(d.default,{style:ct.cancelButtonText,children:"Cancel"})})]}):(0,J.jsxs)(n.default,{style:ct.authRequiredContainer,children:[(0,J.jsx)(x.default,{name:"alert-circle",size:48,color:"#F59E0B"}),(0,J.jsx)(d.default,{style:ct.authRequiredTitle,children:"Microsoft Sign-In Required"}),(0,J.jsx)(d.default,{style:ct.authRequiredText,children:"To send emails through your Outlook account, please sign in with Microsoft."}),(0,J.jsx)(o.default,{style:ct.signInButton,onPress:T,disabled:b,children:b?(0,J.jsx)(q.default,{color:"white"}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(x.default,{name:"logo-microsoft",size:20,color:"white"}),(0,J.jsx)(d.default,{style:ct.signInButtonText,children:"Sign in with Microsoft"})]})})]})})})})}const ct=at.default.create({container:{flex:1,backgroundColor:"#F9FAFB"},scrollView:{flex:1},content:{padding:20},authCheckContainer:{padding:40,alignItems:"center",justifyContent:"center"},authCheckText:{marginTop:12,fontSize:14,color:"#6B7280"},authRequiredContainer:{padding:32,alignItems:"center",backgroundColor:"white",borderRadius:16,borderWidth:2,borderColor:"#FED7AA"},authRequiredTitle:{fontSize:20,fontWeight:"700",color:"#92400E",marginTop:16,marginBottom:8,textAlign:"center"},authRequiredText:{fontSize:14,color:"#78350F",textAlign:"center",marginBottom:24,lineHeight:20},signInButton:{backgroundColor:"#0078D4",borderRadius:12,paddingVertical:14,paddingHorizontal:24,flexDirection:"row",alignItems:"center",justifyContent:"center",gap:10,minWidth:200},signInButtonText:{color:"white",fontSize:16,fontWeight:"600"},fieldContainer:{marginBottom:20},label:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},input:{backgroundColor:"white",borderWidth:1,borderColor:"#D1D5DB",borderRadius:12,paddingHorizontal:16,paddingVertical:12,fontSize:16,color:"#111827"},fromContainer:{backgroundColor:"#F3F4F6",borderWidth:1,borderColor:"#E5E7EB",borderRadius:12,paddingHorizontal:16,paddingVertical:12,flexDirection:"row",alignItems:"center",justifyContent:"space-between"},fromEmail:{fontSize:16,color:"#374151",fontWeight:"500"},verifiedBadge:{flexDirection:"row",alignItems:"center",backgroundColor:"#ECFDF5",paddingHorizontal:8,paddingVertical:4,borderRadius:8,gap:4},verifiedText:{fontSize:12,color:"#10B981",fontWeight:"600"},readOnlyField:{backgroundColor:"#F9FAFB",borderWidth:1,borderColor:"#E5E7EB",borderRadius:12,paddingHorizontal:16,paddingVertical:12},readOnlyText:{fontSize:16,color:"#6B7280"},previewButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:12,gap:8,marginBottom:16},previewButtonText:{fontSize:16,color:"#3B82F6",fontWeight:"600"},previewContainer:{backgroundColor:"white",borderWidth:1,borderColor:"#D1D5DB",borderRadius:12,padding:16,marginBottom:20},previewLabel:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},previewScroll:{maxHeight:200},previewText:{fontSize:14,color:"#6B7280",lineHeight:20},infoBox:{flexDirection:"row",backgroundColor:"#EFF6FF",borderWidth:1,borderColor:"#DBEAFE",borderRadius:12,padding:12,marginBottom:20,gap:12},infoText:{flex:1,fontSize:13,color:"#1E40AF",lineHeight:18},sendButton:{backgroundColor:"#3B82F6",borderRadius:12,paddingVertical:16,flexDirection:"row",alignItems:"center",justifyContent:"center",gap:8,marginBottom:12},sendButtonDisabled:{backgroundColor:"#93C5FD"},sendButtonText:{color:"white",fontSize:16,fontWeight:"600"},cancelButton:{backgroundColor:"white",borderWidth:1,borderColor:"#D1D5DB",borderRadius:12,paddingVertical:16,alignItems:"center"},cancelButtonText:{color:"#374151",fontSize:16,fontWeight:"600"}});var ut=a(51950);const mt=[{name:'3/8" Grade 250',diameter:.375,area:.08,elasticModulus:28500,breakingStrength:20,grade:"250",isDefault:!0},{name:'7/16" Grade 250',diameter:.4375,area:.115,elasticModulus:28500,breakingStrength:29,grade:"250",isDefault:!0},{name:'1/2" Grade 250',diameter:.5,area:.153,elasticModulus:28500,breakingStrength:38.3,grade:"250",isDefault:!0},{name:'0.6" Grade 250',diameter:.6,area:.217,elasticModulus:28500,breakingStrength:54,grade:"250",isDefault:!0},{name:'3/8" Grade 270',diameter:.375,area:.08,elasticModulus:28500,breakingStrength:23,grade:"270",isDefault:!0},{name:'7/16" Grade 270',diameter:.4375,area:.115,elasticModulus:28500,breakingStrength:31,grade:"270",isDefault:!0},{name:'1/2" Grade 270',diameter:.5,area:.153,elasticModulus:28500,breakingStrength:41.3,grade:"270",isDefault:!0},{name:'0.6" Grade 270',diameter:.6,area:.217,elasticModulus:28500,breakingStrength:58.6,grade:"270",isDefault:!0}],xt=new E("strandLibrary"),ft=(0,y.create)()((e,t)=>({strands:[],loading:!1,initialized:!1,initialize:async()=>{if(!t().initialized){e({loading:!0});try{const a=await xt.fetchAll();e({strands:a,loading:!1,initialized:!0}),xt.subscribe(t=>{e({strands:t})}),0===a.length&&await t().seedDefaultStrands()}catch(qa){console.error("Failed to initialize strand library:",qa),e({loading:!1,initialized:!0})}}},addStrand:async t=>{const a=`strand-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,s=Object.assign({},t,{id:a,createdAt:Date.now()});e(e=>({strands:[...e.strands,s]}));try{await xt.set(a,s)}catch(qa){throw e(e=>({strands:e.strands.filter(e=>e.id!==a)})),qa}},updateStrand:async(a,s)=>{const r=t().strands.find(e=>e.id===a);e(e=>({strands:e.strands.map(e=>e.id===a?Object.assign({},e,s):e)}));try{await xt.set(a,s)}catch(qa){throw r&&e(e=>({strands:e.strands.map(e=>e.id===a?r:e)})),qa}},removeStrand:async a=>{const s=t().strands.find(e=>e.id===a);e(e=>({strands:e.strands.filter(e=>e.id!==a)}));try{await xt.delete(a)}catch(qa){throw s&&e(e=>({strands:[...e.strands,s]})),qa}},getStrandById:e=>t().strands.find(t=>t.id===e),getStrandsByDiameter:e=>t().strands.filter(t=>Math.abs(t.diameter-e)<.001),seedDefaultStrands:async()=>{const e=t(),a=e.strands.some(e=>"250"===e.grade);if(0===e.strands.length)for(const t of mt)await e.addStrand(t);else if(!a){const t=mt.filter(e=>"250"===e.grade);for(const a of t)await e.addStrand(a)}}}));function gt({navigation:e}){const t=(0,i.useSafeAreaInsets)(),a=ft(e=>e.strands),s=ft(e=>e.getStrandById),[r,l]=(0,f.useState)(""),[c,u]=(0,f.useState)(""),[m,b]=(0,f.useState)(a.length>0?a[0].id:""),[y,j]=(0,f.useState)(""),[N,w]=(0,f.useState)(""),[S,F]=(0,f.useState)(""),[C,v]=(0,f.useState)(""),[A,P]=(0,f.useState)(!1),T=m?s(m):null;return(0,J.jsxs)(Z.default,{behavior:"height",className:"flex-1 bg-white",style:{paddingTop:t.top},children:[(0,J.jsxs)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:40},keyboardShouldPersistTaps:"handled",children:[(0,J.jsxs)(n.default,{className:"px-6 py-4 border-b border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-2xl font-bold",children:"Stressing Force & Elongation"}),(0,J.jsx)(d.default,{className:"text-gray-600 text-sm mt-1",children:"Calculate expected strand elongation measurement"})]}),(0,J.jsx)(n.default,{className:"px-6 mt-4 mb-3",children:(0,J.jsx)(n.default,{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"information-circle",size:20,color:"#3B82F6"}),(0,J.jsx)(d.default,{className:"text-blue-900 text-xs ml-2 flex-1",children:"Enter the total jacking force, bed dimensions, and strand details to calculate what the elongation gauge should read for a single strand during prestressing."})]})})}),(0,J.jsxs)(n.default,{className:"px-6",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold mb-3",children:"Required Information"}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1.5",children:"Total Jacking Force (kips) *"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base",placeholder:"e.g., 120.5",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:r,onChangeText:l,keyboardType:"decimal-pad"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-xs mt-1",children:"Total force applied to all strands (1 kip = 1,000 lbs)"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1.5",children:"Bed Length (feet) *"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base",placeholder:"e.g., 400",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:c,onChangeText:u,keyboardType:"decimal-pad"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-xs mt-1",children:"Distance between anchorages"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center mb-1.5",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium",children:"Strand Type *"}),(0,J.jsxs)(o.default,{onPress:()=>e.navigate("StrandLibrary"),className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"library",size:14,color:"#3B82F6"}),(0,J.jsx)(d.default,{className:"text-blue-500 text-xs ml-1",children:"Manage Library"})]})]}),0===a.length?(0,J.jsxs)(n.default,{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,J.jsx)(d.default,{className:"text-yellow-900 text-sm mb-2",children:"No strands available in library"}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("StrandLibrary"),className:"bg-yellow-500 rounded-lg py-2 px-4 items-center",children:(0,J.jsx)(d.default,{className:"text-white text-sm font-medium",children:"Add Strands to Library"})})]}):(0,J.jsx)(o.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3",onPress:()=>P(!0),children:(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-medium",children:T?.name||"Select a strand"}),T&&(0,J.jsxs)(d.default,{className:"text-gray-500 text-xs mt-1",children:[T.diameter,'" \u2022 ',T.area.toFixed(3)," in\xb2 \u2022 Grade ",T.grade]})]}),(0,J.jsx)(x.default,{name:"chevron-down",size:20,color:"#6B7280"})]})})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1.5",children:"Number of Strands *"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base",placeholder:"e.g., 7",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:y,onChangeText:j,keyboardType:"number-pad"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-xs mt-1",children:"Total number of strands being stressed"})]})]}),(0,J.jsxs)(n.default,{className:"px-6 mt-2",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold mb-3",children:"Optional Adjustments"}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1.5",children:"Bed Shortening (inches)"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base",placeholder:"e.g., 0.125",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:N,onChangeText:w,keyboardType:"decimal-pad"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-xs mt-1",children:"Elastic compression of the bed during stressing"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1.5",children:"Friction Loss (%)"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base",placeholder:"e.g., 1.5",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:S,onChangeText:F,keyboardType:"decimal-pad"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-xs mt-1",children:"Typical range: 0.5-2% for long beds"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1.5",children:"Anchor Set Loss (inches)"}),(0,J.jsx)(h.default,{className:"bg-white border border-gray-300 rounded-lg px-4 py-3 text-base",placeholder:"e.g., 0.25",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:C,onChangeText:v,keyboardType:"decimal-pad"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-xs mt-1",children:"Slip at anchorage during lock-off"})]})]}),(0,J.jsx)(n.default,{className:"px-6 mt-2",children:(0,J.jsx)(o.default,{className:"bg-blue-500 rounded-xl py-4 items-center active:bg-blue-600",onPress:()=>{r&&c&&y&&m&&e.navigate("StressingResults",{jackingForce:parseFloat(r),bedLength:parseFloat(c),strandId:m,numberOfStrands:parseInt(y),bedShortening:N?parseFloat(N):void 0,frictionLoss:S?parseFloat(S):void 0,anchorSetLoss:C?parseFloat(C):void 0})},children:(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"calculator",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Calculate Elongation"})]})})})]}),(0,J.jsx)(p.default,{visible:A,transparent:!0,animationType:"slide",onRequestClose:()=>P(!1),children:(0,J.jsx)(ut.default,{onPress:()=>P(!1),children:(0,J.jsx)(n.default,{className:"flex-1 bg-black/50 justify-end",children:(0,J.jsx)(ut.default,{children:(0,J.jsxs)(n.default,{className:"bg-white rounded-t-3xl",style:{paddingBottom:t.bottom+20},children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center px-6 py-4 border-b border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-bold",children:"Select Strand"}),(0,J.jsx)(o.default,{onPress:()=>P(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsx)(g.default,{className:"max-h-96",children:a.map(e=>(0,J.jsx)(o.default,{className:"px-6 py-4 border-b border-gray-100 "+(m===e.id?"bg-blue-50":""),onPress:()=>{b(e.id),P(!1)},children:(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-semibold",children:e.name}),(0,J.jsxs)(d.default,{className:"text-gray-600 text-sm mt-1",children:[e.diameter,'" diameter \u2022 ',e.area.toFixed(3)," in\xb2 \u2022 ",e.breakingStrength.toFixed(1)," kips"]}),e.isDefault&&(0,J.jsx)(d.default,{className:"text-gray-400 text-xs mt-0.5",children:"Standard (ASTM A416)"})]}),m===e.id&&(0,J.jsx)(x.default,{name:"checkmark-circle",size:24,color:"#3B82F6"})]})},e.id))})]})})})})})]})}function ht(e,t,a,s){return e*t/(a*s)}function pt(e,t=3,a=""){return`${e.toFixed(t)}${a}`}function bt({navigation:e,route:t}){const a=(0,i.useSafeAreaInsets)(),s=t.params,r=ft(e=>e.getStrandById)(s.strandId),l=(0,f.useMemo)(()=>{if(!r)return null;const e=12*s.bedLength,t=s.jackingForce/s.numberOfStrands,a=t/r.area,l=ht(t,e,r.area,r.elasticModulus),o=s.bedShortening||0,n=(s.frictionLoss||0)/100*l,d=s.anchorSetLoss||0;return{theoreticalElongation:l,bedShortening:o,frictionLoss:n,anchorSetLoss:d,totalElongation:l+o-n-d,forcePerStrand:t,stressPerStrand:a}},[s,r]);return r&&l?(0,J.jsx)(n.default,{className:"flex-1 bg-white",style:{paddingTop:a.top},children:(0,J.jsxs)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:20},children:[(0,J.jsxs)(n.default,{className:"px-6 py-4 border-b border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-2xl font-bold",children:"Elongation Results"}),(0,J.jsxs)(d.default,{className:"text-gray-600 text-sm mt-1",children:[r.name," \u2022 ",s.numberOfStrands," strands \u2022 ",s.bedLength,'" bed']})]}),(0,J.jsx)(n.default,{className:"px-6 mt-4",children:(0,J.jsxs)(n.default,{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border-2 border-blue-500",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-2",children:"Expected Elongation (Per Strand)"}),(0,J.jsx)(d.default,{className:"text-blue-600 text-4xl font-bold",children:pt(l.totalElongation,3,'"')}),(0,J.jsx)(d.default,{className:"text-gray-600 text-xs mt-2",children:"Measurement reading on gauge/dial"})]})}),(0,J.jsxs)(n.default,{className:"px-6 mt-4",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold mb-3",children:"Elongation Breakdown"}),(0,J.jsxs)(n.default,{className:"bg-green-50 rounded-lg p-4 mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium",children:"Theoretical Elongation"}),(0,J.jsxs)(d.default,{className:"text-green-600 text-lg font-bold",children:["+",pt(l.theoreticalElongation,3,'"')]})]}),(0,J.jsx)(d.default,{className:"text-gray-600 text-xs mt-1",children:"Based on elastic deformation formula"})]}),l.bedShortening>0&&(0,J.jsxs)(n.default,{className:"bg-blue-50 rounded-lg p-4 mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium",children:"Bed Shortening"}),(0,J.jsxs)(d.default,{className:"text-blue-600 text-lg font-bold",children:["+",pt(l.bedShortening,3,'"')]})]}),(0,J.jsx)(d.default,{className:"text-gray-600 text-xs mt-1",children:"Elastic compression of casting bed"})]}),l.frictionLoss>0&&(0,J.jsxs)(n.default,{className:"bg-orange-50 rounded-lg p-4 mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium",children:"Friction Loss"}),(0,J.jsxs)(d.default,{className:"text-orange-600 text-lg font-bold",children:["-",pt(l.frictionLoss,3,'"')]})]}),(0,J.jsx)(d.default,{className:"text-gray-600 text-xs mt-1",children:"Loss due to friction along bed length"})]}),l.anchorSetLoss>0&&(0,J.jsxs)(n.default,{className:"bg-purple-50 rounded-lg p-4 mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium",children:"Anchor Set Loss"}),(0,J.jsxs)(d.default,{className:"text-purple-600 text-lg font-bold",children:["-",pt(l.anchorSetLoss,3,'"')]})]}),(0,J.jsx)(d.default,{className:"text-gray-600 text-xs mt-1",children:"Slip during anchorage lock-off"})]})]}),(0,J.jsxs)(n.default,{className:"px-6 mt-4",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold mb-3",children:"Force & Stress Analysis"}),(0,J.jsxs)(n.default,{className:"flex-row gap-2 mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-xs mb-1",children:"Force/Strand"}),(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-bold",children:pt(l.forcePerStrand,2," kips")}),(0,J.jsx)(d.default,{className:"text-gray-500 text-xs mt-0.5",children:pt(1e3*l.forcePerStrand,0," lbs")})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-xs mb-1",children:"Stress/Strand"}),(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-bold",children:pt(l.stressPerStrand,1," ksi")}),(0,J.jsx)(d.default,{className:"text-gray-500 text-xs mt-0.5",children:pt(1e3*l.stressPerStrand,0," psi")})]})]})]}),(0,J.jsxs)(n.default,{className:"px-6 mt-4",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold mb-3",children:"Strand Properties"}),(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded-lg p-4",children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-sm",children:"Name"}),(0,J.jsx)(d.default,{className:"text-gray-900 text-sm font-semibold",children:r.name})]}),(0,J.jsxs)(n.default,{className:"flex-row justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-sm",children:"Diameter"}),(0,J.jsx)(d.default,{className:"text-gray-900 text-sm font-semibold",children:pt(r.diameter,3,'"')})]}),(0,J.jsxs)(n.default,{className:"flex-row justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-sm",children:"Cross-Sectional Area"}),(0,J.jsx)(d.default,{className:"text-gray-900 text-sm font-semibold",children:pt(r.area,3," in\xb2")})]}),(0,J.jsxs)(n.default,{className:"flex-row justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-sm",children:"Elastic Modulus"}),(0,J.jsx)(d.default,{className:"text-gray-900 text-sm font-semibold",children:pt(r.elasticModulus,0," ksi")})]}),(0,J.jsxs)(n.default,{className:"flex-row justify-between",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-sm",children:"Minimum Breaking Strength"}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-sm font-semibold",children:[pt(r.breakingStrength,1," kips")," (",pt(1e3*r.breakingStrength,0," lbs"),")"]})]}),r.grade&&(0,J.jsxs)(n.default,{className:"flex-row justify-between mt-2",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-sm",children:"Grade"}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-sm font-semibold",children:[r.grade," ksi"]})]}),r.isDefault&&(0,J.jsxs)(d.default,{className:"text-gray-500 text-xs mt-3",children:["Based on ASTM A416 Grade ",r.grade," standards"]})]})]}),(0,J.jsxs)(n.default,{className:"px-6 mt-6",children:[(0,J.jsx)(o.default,{className:"bg-gray-100 rounded-xl py-4 items-center active:bg-gray-200 mb-3",onPress:()=>e.goBack(),children:(0,J.jsx)(d.default,{className:"text-gray-700 text-base font-semibold",children:"Back to Calculator"})}),(0,J.jsx)(o.default,{className:"bg-blue-500 rounded-xl py-4 items-center active:bg-blue-600",onPress:()=>e.navigate("Dashboard"),children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Return to Dashboard"})})]})]})}):(0,J.jsxs)(n.default,{className:"flex-1 bg-white items-center justify-center",style:{paddingTop:a.top},children:[(0,J.jsx)(x.default,{name:"alert-circle",size:48,color:"#EF4444"}),(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-bold mt-4",children:"Strand Not Found"}),(0,J.jsx)(d.default,{className:"text-gray-600 text-sm mt-2 px-6 text-center",children:"The selected strand is no longer available in the library."}),(0,J.jsx)(o.default,{className:"bg-blue-500 rounded-xl py-3 px-6 mt-6",onPress:()=>e.goBack(),children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Go Back"})})]})}function yt(){const e=(0,c.useNavigation)(),t=(0,i.useSafeAreaInsets)(),{strands:a,loading:s,initialize:r,addStrand:l,updateStrand:u,removeStrand:m}=ft();(0,f.useEffect)(()=>{r()},[]);const[p,b]=(0,f.useState)(!1),[y,j]=(0,f.useState)(null),[N,w]=(0,f.useState)(null),[S,F]=(0,f.useState)(""),[C,v]=(0,f.useState)(""),[A,P]=(0,f.useState)(""),[T,E]=(0,f.useState)("28500"),[z,B]=(0,f.useState)(""),[D,k]=(0,f.useState)("270"),I=()=>{F(""),v(""),P(""),E("28500"),B(""),k("270")},L=a.filter(e=>e.isDefault),R=a.filter(e=>!e.isDefault);return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",style:{paddingTop:t.top},children:[(0,J.jsxs)(g.default,{className:"flex-1",contentContainerStyle:{paddingBottom:20},children:[(0,J.jsxs)(n.default,{className:"px-6 py-4 bg-white border-b border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-2xl font-bold",children:"Strand Library"}),(0,J.jsx)(d.default,{className:"text-gray-600 text-sm mt-1",children:"Manage strand definitions and properties"})]}),(0,J.jsx)(n.default,{className:"px-6 mt-4",children:(0,J.jsxs)(o.default,{className:"bg-blue-500 rounded-xl py-3 items-center active:bg-blue-600 flex-row justify-center",onPress:()=>{j(null),I(),b(!0)},children:[(0,J.jsx)(x.default,{name:"add-circle-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Add Custom Strand"})]})}),(0,J.jsxs)(n.default,{className:"px-6 mt-3",children:[(0,J.jsxs)(o.default,{className:"bg-purple-500 rounded-xl py-3 items-center active:bg-purple-600 flex-row justify-center",onPress:()=>e.navigate("StrandPatterns"),children:[(0,J.jsx)(x.default,{name:"albums-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Manage Strand Patterns"})]}),(0,J.jsx)(d.default,{className:"text-gray-500 text-xs mt-2 text-center",children:"Strand patterns define configurations of multiple strands used in tools"})]}),(0,J.jsxs)(n.default,{className:"px-6 mt-4",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold mb-3",children:"Standard Strands (ASTM A416)"}),L.map(e=>(0,J.jsxs)(n.default,{className:"bg-white rounded-lg p-4 mb-3 border border-gray-200",children:[(0,J.jsx)(n.default,{className:"flex-row justify-between items-start mb-2",children:(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-bold",children:e.name}),e.grade&&(0,J.jsxs)(d.default,{className:"text-gray-500 text-xs mt-0.5",children:["Grade ",e.grade," ksi"]})]})}),(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-3 mt-2",children:[(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded px-3 py-1.5",children:[(0,J.jsx)(d.default,{className:"text-gray-500 text-xs",children:"Diameter"}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-sm font-semibold",children:[e.diameter,'"']})]}),(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded px-3 py-1.5",children:[(0,J.jsx)(d.default,{className:"text-gray-500 text-xs",children:"Area"}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-sm font-semibold",children:[e.area," in\xb2"]})]}),(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded px-3 py-1.5",children:[(0,J.jsx)(d.default,{className:"text-gray-500 text-xs",children:"Elastic Modulus"}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-sm font-semibold",children:[e.elasticModulus.toLocaleString()," ksi"]})]}),(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded px-3 py-1.5",children:[(0,J.jsx)(d.default,{className:"text-gray-500 text-xs",children:"Breaking Strength"}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-sm font-semibold",children:[e.breakingStrength," kips (",(1e3*e.breakingStrength).toLocaleString()," lbs)"]})]})]})]},e.id))]}),R.length>0&&(0,J.jsxs)(n.default,{className:"px-6 mt-4",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-lg font-semibold mb-3",children:"Custom Strands"}),R.map(e=>(0,J.jsxs)(n.default,{className:"bg-white rounded-lg p-4 mb-3 border border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between items-start mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-bold",children:e.name}),e.grade&&(0,J.jsxs)(d.default,{className:"text-gray-500 text-xs mt-0.5",children:["Grade ",e.grade," ksi"]})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{className:"bg-blue-100 rounded-full p-2",onPress:()=>(e=>{j(e),F(e.name),v(e.diameter.toString()),P(e.area.toString()),E(e.elasticModulus.toString()),B(e.breakingStrength.toString()),k(e.grade||""),b(!0)})(e),children:(0,J.jsx)(x.default,{name:"pencil",size:16,color:"#3B82F6"})}),(0,J.jsx)(o.default,{className:"bg-red-100 rounded-full p-2",onPress:()=>w(e.id),children:(0,J.jsx)(x.default,{name:"trash",size:16,color:"#EF4444"})})]})]}),(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-3 mt-2",children:[(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded px-3 py-1.5",children:[(0,J.jsx)(d.default,{className:"text-gray-500 text-xs",children:"Diameter"}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-sm font-semibold",children:[e.diameter,'"']})]}),(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded px-3 py-1.5",children:[(0,J.jsx)(d.default,{className:"text-gray-500 text-xs",children:"Area"}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-sm font-semibold",children:[e.area," in\xb2"]})]}),(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded px-3 py-1.5",children:[(0,J.jsx)(d.default,{className:"text-gray-500 text-xs",children:"Elastic Modulus"}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-sm font-semibold",children:[e.elasticModulus.toLocaleString()," ksi"]})]}),(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded px-3 py-1.5",children:[(0,J.jsx)(d.default,{className:"text-gray-500 text-xs",children:"Breaking Strength"}),(0,J.jsxs)(d.default,{className:"text-gray-900 text-sm font-semibold",children:[e.breakingStrength," kips (",(1e3*e.breakingStrength).toLocaleString()," lbs)"]})]})]})]},e.id))]})]}),p&&(0,J.jsx)(n.default,{className:"absolute inset-0 bg-black/50 justify-center items-center",children:(0,J.jsx)(Z.default,{behavior:"height",className:"w-11/12 max-w-lg",children:(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-6",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-xl font-bold mb-4",children:y?"Edit Strand":"Add Custom Strand"}),(0,J.jsxs)(g.default,{className:"max-h-96",showsVerticalScrollIndicator:!1,children:[(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1",children:"Name *"}),(0,J.jsx)(h.default,{cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2",placeholder:'e.g., "1/2 inch Grade 270"',value:S,onChangeText:F})]}),(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1",children:"Diameter (inches) *"}),(0,J.jsx)(h.default,{cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2",placeholder:"e.g., 0.5",value:C,onChangeText:v,keyboardType:"decimal-pad"})]}),(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1",children:"Cross-Sectional Area (in\xb2) *"}),(0,J.jsx)(h.default,{cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2",placeholder:"e.g., 0.153",value:A,onChangeText:P,keyboardType:"decimal-pad"})]}),(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1",children:"Elastic Modulus (ksi) *"}),(0,J.jsx)(h.default,{cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2",placeholder:"e.g., 28500",value:T,onChangeText:E,keyboardType:"decimal-pad"})]}),(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1",children:"Minimum Breaking Strength (kips) *"}),(0,J.jsx)(h.default,{cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2",placeholder:"e.g., 41.3",value:z,onChangeText:B,keyboardType:"decimal-pad"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-xs mt-1",children:"1 kip = 1,000 lbs"})]}),(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-medium mb-1",children:"Grade (optional)"}),(0,J.jsx)(h.default,{cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2",placeholder:"e.g., 270",value:D,onChangeText:k})]})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3 mt-4",children:[(0,J.jsx)(o.default,{className:"flex-1 bg-gray-100 rounded-lg py-3 items-center",onPress:()=>{b(!1),I()},children:(0,J.jsx)(d.default,{className:"text-gray-700 font-semibold",children:"Cancel"})}),(0,J.jsx)(o.default,{className:"flex-1 bg-blue-500 rounded-lg py-3 items-center active:bg-blue-600",onPress:()=>{if(!S||!C||!A||!T||!z)return void alert("Please fill in all required fields");const e={name:S,diameter:parseFloat(C),area:parseFloat(A),elasticModulus:parseFloat(T),breakingStrength:parseFloat(z),grade:D||void 0,isDefault:!1};y?u(y.id,e):l(e),b(!1),I()},children:(0,J.jsx)(d.default,{className:"text-white font-semibold",children:y?"Update":"Add"})})]})]})})}),(0,J.jsx)(ve,{visible:null!==N,title:"Delete Strand",message:"Are you sure you want to delete this strand definition? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",confirmStyle:"destructive",onConfirm:()=>N&&(m(N),void w(null)),onCancel:()=>w(null)})]})}const jt={'1"':25,'3/4"':19,'1/2"':12.5,'3/8"':9.5,"#4":4.75,"#8":2.36,"#16":1.18,"#30":.6,"#50":.3,"#100":.15,"#200":.075,Pan:0},Nt={"Keystone #7":{type:"Coarse",sieves:[{name:'3/4"',size:19,weightRetained:"",c33Lower:90,c33Upper:100},{name:'1/2"',size:12.5,weightRetained:"",c33Lower:20,c33Upper:55},{name:'3/8"',size:9.5,weightRetained:"",c33Lower:0,c33Upper:15},{name:"#4",size:4.75,weightRetained:"",c33Lower:0,c33Upper:5},{name:"#8",size:2.36,weightRetained:"",c33Lower:"-",c33Upper:"-"},{name:"Pan",size:0,weightRetained:"",c33Lower:"-",c33Upper:"-"}]},'Kraemer 9/16"':{type:"Coarse",sieves:[{name:'3/4"',size:19,weightRetained:"",c33Lower:100,c33Upper:100},{name:'1/2"',size:12.5,weightRetained:"",c33Lower:90,c33Upper:100},{name:'3/8"',size:9.5,weightRetained:"",c33Lower:40,c33Upper:70},{name:"#4",size:4.75,weightRetained:"",c33Lower:0,c33Upper:15},{name:"#8",size:2.36,weightRetained:"",c33Lower:0,c33Upper:5},{name:"Pan",size:0,weightRetained:"",c33Lower:"-",c33Upper:"-"}]},"#9 Gravel (St. Croix)":{type:"Coarse",sieves:[{name:'1/2"',size:12.5,weightRetained:"",c33Lower:100,c33Upper:100},{name:'3/8"',size:9.5,weightRetained:"",c33Lower:85,c33Upper:100},{name:"#4",size:4.75,weightRetained:"",c33Lower:10,c33Upper:30},{name:"#8",size:2.36,weightRetained:"",c33Lower:0,c33Upper:10},{name:"#16",size:1.18,weightRetained:"",c33Lower:0,c33Upper:5},{name:"Pan",size:0,weightRetained:"",c33Lower:"-",c33Upper:"-"}]},"Concrete Sand":{type:"Fine",sieves:[{name:'3/8"',size:9.5,weightRetained:"",c33Lower:100,c33Upper:100},{name:"#4",size:4.75,weightRetained:"",c33Lower:95,c33Upper:100},{name:"#8",size:2.36,weightRetained:"",c33Lower:80,c33Upper:100},{name:"#16",size:1.18,weightRetained:"",c33Lower:50,c33Upper:85},{name:"#30",size:.6,weightRetained:"",c33Lower:25,c33Upper:60},{name:"#50",size:.3,weightRetained:"",c33Lower:10,c33Upper:30},{name:"#100",size:.15,weightRetained:"",c33Lower:2,c33Upper:10},{name:"Pan",size:0,weightRetained:"",c33Lower:"-",c33Upper:"-"}]}};function wt(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}const St=(0,y.create)()((0,O.persist)((e,t)=>({aggregates:Nt,testHistory:[],defaultAggregates:["Concrete Sand","Keystone #7"],addAggregate:(t,a)=>e(e=>({aggregates:Object.assign({},e.aggregates,{[t]:a})})),updateAggregate:(t,a)=>e(e=>({aggregates:Object.assign({},e.aggregates,{[t]:a})})),deleteAggregate:t=>e(e=>{const a=e.aggregates;return{aggregates:(0,b.default)(a,[t].map(wt)),defaultAggregates:e.defaultAggregates.filter(e=>e!==t)}}),addTest:t=>e(e=>({testHistory:[t,...e.testHistory].slice(0,100)})),updateTest:(t,a)=>e(e=>({testHistory:e.testHistory.map(e=>e.id===t?Object.assign({},e,a):e)})),deleteTest:t=>e(e=>({testHistory:e.testHistory.filter(e=>e.id!==t)})),clearAllTests:()=>e({testHistory:[]}),setDefaultAggregates:t=>e({defaultAggregates:t.slice(0,8)}),getAggregate:e=>t().aggregates[e],getTest:e=>t().testHistory.find(t=>t.id===e)}),{name:"aggregate-gradation-storage",storage:(0,O.createJSONStorage)(()=>F.default)})),Ft=({navigation:e})=>{const{aggregates:t}=St(),a=Object.entries(t);return(0,J.jsx)(n.default,{className:"flex-1 bg-gray-50",children:(0,J.jsxs)(g.default,{className:"flex-1",children:[(0,J.jsxs)(n.default,{className:"px-4 py-6",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800 mb-3",children:"Available Aggregates"}),0===a.length?(0,J.jsxs)(n.default,{className:"bg-white rounded-lg p-6 items-center",children:[(0,J.jsx)(x.default,{name:"warning-outline",size:48,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-gray-500 mt-3 text-center",children:"No aggregates configured. Visit Admin Panel to add aggregates."})]}):(0,J.jsx)(n.default,{className:"gap-3",children:a.map(([t,a])=>(0,J.jsx)(o.default,{onPress:()=>(t=>{e.navigate("GradationTest",{aggregateName:t})})(t),className:"bg-white rounded-lg p-4 shadow-sm active:bg-gray-50",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800",children:t}),(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2 mt-1",children:[(0,J.jsx)(n.default,{className:"px-2 py-1 rounded "+("Fine"===a.type?"bg-green-100":"bg-blue-100"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("Fine"===a.type?"text-green-700":"text-blue-700"),children:a.type})}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-500",children:[a.sieves.length," sieves"]})]}),a.maxDecant&&(0,J.jsxs)(d.default,{className:"text-xs text-gray-500 mt-1",children:["Max Decant: ",a.maxDecant,"%"]})]}),(0,J.jsx)(n.default,{className:"w-10 h-10 bg-orange-100 rounded-full items-center justify-center",children:(0,J.jsx)(x.default,{name:"chevron-forward",size:20,color:"#ea580c"})})]})},t))})]}),(0,J.jsx)(n.default,{className:"px-4 pb-6",children:(0,J.jsx)(n.default,{className:"bg-blue-50 rounded-lg p-4",children:(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(x.default,{name:"information-circle",size:20,color:"#2563eb"}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-sm text-blue-900 font-medium mb-1",children:"About Gradation Testing"}),(0,J.jsx)(d.default,{className:"text-sm text-blue-800",children:"This tool helps you perform sieve analysis on aggregates to determine their gradation. Results are automatically checked against ASTM C33 specifications."})]})]})})})]})})};const Ct=({navigation:e,route:t})=>{const{aggregateName:a}=t.params,{aggregates:s,addTest:r}=St(),l=s[a],i=e=>`${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")}/${e.getFullYear()}`,[c,u]=(0,f.useState)(i(new Date)),[m,p]=(0,f.useState)(l.sieves.map(e=>Object.assign({},e,{weightRetained:""}))),[b,y]=(0,f.useState)(""),[j,N]=(0,f.useState)(!1),[w,S]=(0,f.useState)(!1),F=(0,f.useRef)([]),C=m.reduce((e,t)=>{const a=parseFloat(t.weightRetained);return e+(isNaN(a)?0:a)},0),v=e=>{const t=new Date;t.setDate(t.getDate()-e),u(i(t))};return(0,J.jsxs)(Z.default,{behavior:"height",className:"flex-1 bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsxs)(g.default,{className:"flex-1",keyboardShouldPersistTaps:"handled",children:[(0,J.jsxs)(n.default,{className:"bg-white p-4 border-b border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700 mb-2",children:"Test Date"}),(0,J.jsx)(h.default,{cursorColor:"#000000",value:c,onChangeText:u,placeholder:"MM/DD/YYYY",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-base"}),(0,J.jsxs)(n.default,{className:"flex-row gap-2 mt-2",children:[(0,J.jsx)(o.default,{onPress:()=>v(0),className:"bg-blue-100 px-3 py-1 rounded active:bg-blue-200",children:(0,J.jsx)(d.default,{className:"text-xs text-blue-700",children:"Today"})}),(0,J.jsx)(o.default,{onPress:()=>v(1),className:"bg-blue-100 px-3 py-1 rounded active:bg-blue-200",children:(0,J.jsx)(d.default,{className:"text-xs text-blue-700",children:"Yesterday"})}),(0,J.jsx)(o.default,{onPress:()=>v(7),className:"bg-blue-100 px-3 py-1 rounded active:bg-blue-200",children:(0,J.jsx)(d.default,{className:"text-xs text-blue-700",children:"Last Week"})})]}),(0,J.jsxs)(o.default,{onPress:()=>N(!j),className:"flex-row items-center mt-4",children:[(0,J.jsx)(n.default,{className:"w-5 h-5 rounded border-2 mr-2 items-center justify-center "+(j?"bg-orange-600 border-orange-600":"border-gray-400"),children:j&&(0,J.jsx)(x.default,{name:"checkmark",size:14,color:"white"})}),(0,J.jsx)(d.default,{className:"text-sm text-gray-700",children:"No Production"})]})]}),(0,J.jsxs)(n.default,{className:"bg-white mt-4 p-4",children:[(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-800 mb-3",children:"Sieve Data (grams)"}),m.map((e,t)=>(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700",children:e.name}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:e.size>0?`${e.size}mm`:""})]}),(0,J.jsx)(h.default,{cursorColor:"#000000",ref:e=>{e&&(F.current[t]=e)},value:e.weightRetained,onChangeText:e=>((e,t)=>{if(t&&!/^\d*\.?\d*$/.test(t))return;const a=[...m];a[e].weightRetained=t,p(a)})(t,e),placeholder:"0",keyboardType:"decimal-pad",returnKeyType:t<m.length-1?"next":"done",onSubmitEditing:()=>{t<m.length-1&&F.current[t+1]?.focus()},className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-base"})]},t)),"Fine"===l.type&&(0,J.jsxs)(n.default,{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700 mb-1",children:"Washed Weight (g)"}),(0,J.jsx)(h.default,{cursorColor:"#000000",value:b,onChangeText:y,placeholder:"0",keyboardType:"decimal-pad",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-base"})]}),(0,J.jsx)(n.default,{className:"mt-4 pt-4 border-t border-gray-200",children:(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-800",children:"Total Weight:"}),(0,J.jsxs)(d.default,{className:"text-lg font-bold text-orange-600",children:[C.toFixed(2)," g"]})]})})]}),(0,J.jsx)(n.default,{className:"p-4",children:(0,J.jsx)(n.default,{className:"bg-blue-50 rounded-lg p-3",children:(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(x.default,{name:"information-circle",size:18,color:"#2563eb"}),(0,J.jsx)(d.default,{className:"flex-1 text-sm text-blue-800",children:"Enter the weight retained on each sieve. Press Tab or Next to move between fields."})]})})})]}),(0,J.jsxs)(n.default,{className:"bg-white border-t border-gray-200 p-4 gap-3",children:[(0,J.jsx)(o.default,{onPress:()=>{if(!m.some(e=>e.weightRetained&&parseFloat(e.weightRetained)>0))return void Te.default.alert("Validation Error","Please enter at least one sieve weight");const t=function(e){const t=e.reduce((e,t)=>e+(parseFloat(t.weightRetained)||0),0);let a=0;return e.map(e=>{const s=parseFloat(e.weightRetained)||0,r=t>0?s/t*100:0;a+=r;const l=100-a;return Object.assign({},e,{percentRetained:r.toFixed(0),cumulativeRetained:a.toFixed(0),percentPassing:l.toFixed(0)})})}(m),s=function(e,t){if("Fine"!==e)return"N/A";const a=['3/8"',"#4","#8","#16","#30","#50","#100"];return(t.filter(e=>a.includes(e.name)).reduce((e,t)=>e+parseFloat(t.cumulativeRetained||"0"),0)/100).toFixed(2)}(l.type,t),o="Fine"===l.type&&b?function(e,t){const a=e.reduce((e,t)=>e+(parseFloat(t.weightRetained)||0),0),s=parseFloat(t.toString())||0;return a>0&&s<=a?((a-s)/a*100).toFixed(2):"0.00"}(t,parseFloat(b)):void 0,n=function(e){for(const t of e){const e=parseFloat(t.percentPassing||"0");if("-"!==t.c33Lower&&null!==t.c33Lower&&e<t.c33Lower)return!1;if("-"!==t.c33Upper&&null!==t.c33Upper&&e>t.c33Upper)return!1}return!0}(t),d={id:Date.now().toString(),timestamp:Date.now(),aggregateName:a,date:c,sieveData:t,totalWeight:C,washedWeight:parseFloat(b)||void 0,finenessModulus:s,decant:o,passC33:n};r(d),e.replace("GradationResults",{testId:d.id})},className:"bg-orange-600 rounded-lg py-3 items-center active:bg-orange-700",children:(0,J.jsx)(d.default,{className:"text-white font-semibold text-base",children:"Calculate Results"})}),(0,J.jsx)(o.default,{onPress:()=>{m.some(e=>e.weightRetained&&parseFloat(e.weightRetained)>0)?S(!0):e.goBack()},className:"border border-gray-300 rounded-lg py-3 items-center active:bg-gray-50",children:(0,J.jsx)(d.default,{className:"text-gray-700 font-medium text-base",children:"Cancel"})})]})]}),(0,J.jsx)(ve,{visible:w,title:"Discard Test Data?",message:"You have unsaved data. Are you sure you want to cancel?",confirmText:"Discard",cancelText:"Continue Editing",onConfirm:()=>{S(!1),e.goBack()},onCancel:()=>S(!1),confirmStyle:"destructive"})]})};var vt=a(26725);const At=({chartData:e,showC33Limits:t=!0})=>{const a=vt.default.get("window").width-48,s=300,r=20,l=30,o=50,i=50,c=a-i-l,u=s-r-o,m=e.filter(e=>null!==e.percentPassing&&void 0!==e.percentPassing);if(0===m.length)return(0,J.jsx)(n.default,{className:"bg-white rounded-lg p-4 items-center justify-center",style:{height:s},children:(0,J.jsx)(d.default,{className:"text-gray-500",children:"No data to display"})});const x=Math.min(...m.map(e=>e.size).filter(e=>e>0)),f=Math.max(...m.map(e=>e.size)),g=e=>{if(e<=0)return i;const t=Math.log10(x),a=Math.log10(f),s=Math.log10(e);return i+(s-t)/(a-t)*c},h=e=>s-o-e/100*u,p=m.map(e=>`${g(e.size)},${h(e.percentPassing)}`).join(" "),b=m.filter(e=>null!==e.c33Upper&&void 0!==e.c33Upper).map(e=>`${g(e.size)},${h(e.c33Upper)}`).join(" "),y=m.filter(e=>null!==e.c33Lower&&void 0!==e.c33Lower).map(e=>`${g(e.size)},${h(e.c33Lower)}`).join(" "),j=[0,25,50,75,100],N=m.map(e=>({name:e.sieve,x:g(e.size)}));return(0,J.jsxs)(n.default,{className:"bg-white rounded-lg p-4",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800 mb-2",children:"Gradation Curve"}),(0,J.jsxs)(be.default,{width:a,height:s,children:[(0,J.jsx)(be.Rect,{x:0,y:0,width:a,height:s,fill:"#fafafa"}),j.map(e=>{const t=h(e);return(0,J.jsx)(be.Line,{x1:i,y1:t,x2:a-l,y2:t,stroke:"#e0e0e0",strokeWidth:"1"},`grid-y-${e}`)}),N.map((e,t)=>(0,J.jsx)(be.Line,{x1:e.x,y1:r,x2:e.x,y2:s-o,stroke:"#e0e0e0",strokeWidth:"1"},`grid-x-${t}`)),t&&b&&(0,J.jsx)(be.Polyline,{points:b,fill:"none",stroke:"#ef4444",strokeWidth:"2",strokeDasharray:"4,4"}),t&&y&&(0,J.jsx)(be.Polyline,{points:y,fill:"none",stroke:"#ef4444",strokeWidth:"2",strokeDasharray:"4,4"}),(0,J.jsx)(be.Polyline,{points:p,fill:"none",stroke:"#ea580c",strokeWidth:"3"}),m.map((e,t)=>(0,J.jsx)(be.Circle,{cx:g(e.size),cy:h(e.percentPassing),r:"4",fill:"#ea580c",stroke:"#fff",strokeWidth:"2"},`point-${t}`)),j.map(e=>{const t=h(e);return(0,J.jsx)(be.Text,{x:i-10,y:t+4,fontSize:"12",fill:"#666",textAnchor:"end",children:e},`label-y-${e}`)}),N.map((e,t)=>(0,J.jsx)(be.Text,{x:e.x,y:s-o+20,fontSize:"10",fill:"#666",textAnchor:"middle",transform:`rotate(-45, ${e.x}, ${s-o+20})`,children:e.name},`label-x-${t}`)),(0,J.jsx)(be.Text,{x:i-35,y:150,fontSize:"14",fill:"#333",textAnchor:"middle",transform:`rotate(-90, ${i-35}, 150)`,children:"Percent Passing (%)"}),(0,J.jsx)(be.Text,{x:a/2,y:295,fontSize:"14",fill:"#333",textAnchor:"middle",children:"Sieve Size"})]}),(0,J.jsxs)(n.default,{className:"flex-row justify-center mt-3 gap-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2",children:[(0,J.jsx)(n.default,{className:"w-6 h-0.5 bg-orange-600"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:"Test Data"})]}),t&&(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2",children:[(0,J.jsx)(n.default,{className:"w-6 h-0.5 bg-red-500 border-dashed",style:{borderStyle:"dashed",borderWidth:1,borderColor:"#ef4444",height:0}}),(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:"C33 Limits"})]})]})]})},Pt=({navigation:e,route:t})=>{const{testId:a}=t.params,{getTest:s,deleteTest:r,aggregates:l}=St(),[i,c]=(0,f.useState)(!1),u=s(a);if(!u)return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50 items-center justify-center p-6",children:[(0,J.jsx)(x.default,{name:"warning-outline",size:64,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600 mt-4 text-center",children:"Test record not found"}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("AggregateGradation"),className:"bg-orange-600 px-6 py-3 rounded-lg mt-6",children:(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Back to Home"})})]});const m=l[u.aggregateName],h=u.sieveData.filter(e=>e.size>0).map(e=>{const t={size:e.size,sieve:e.name,percentPassing:parseFloat(e.percentPassing||"0")};return"-"!==e.c33Lower&&null!==e.c33Lower&&(t.c33Lower=e.c33Lower),"-"!==e.c33Upper&&null!==e.c33Upper&&(t.c33Upper=e.c33Upper),t}).reverse();return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsxs)(g.default,{className:"flex-1",children:[(0,J.jsx)(n.default,{className:"p-4 "+(u.passC33?"bg-green-100":"bg-red-100"),children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-center gap-2",children:[(0,J.jsx)(x.default,{name:u.passC33?"checkmark-circle":"close-circle",size:24,color:u.passC33?"#16a34a":"#dc2626"}),(0,J.jsxs)(d.default,{className:"text-lg font-bold "+(u.passC33?"text-green-700":"text-red-700"),children:[u.passC33?"PASSES":"FAILS"," C33 Specifications"]})]})}),(0,J.jsxs)(n.default,{className:"bg-white p-4 mt-4 mx-4 rounded-lg shadow-sm",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800 mb-3",children:"Test Summary"}),(0,J.jsxs)(n.default,{className:"gap-3",children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsx)(d.default,{className:"text-sm text-gray-600",children:"Total Weight:"}),(0,J.jsxs)(d.default,{className:"text-base font-semibold text-gray-800",children:[u.totalWeight.toFixed(2)," g"]})]}),u.finenessModulus&&(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsx)(d.default,{className:"text-sm text-gray-600",children:"Fineness Modulus:"}),(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-800",children:u.finenessModulus})]}),u.decant&&(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsx)(d.default,{className:"text-sm text-gray-600",children:"Decant:"}),(0,J.jsxs)(d.default,{className:"text-base font-semibold "+(m?.maxDecant&&parseFloat(u.decant)>m.maxDecant?"text-red-600":"text-gray-800"),children:[u.decant,"%",m?.maxDecant&&parseFloat(u.decant)>m.maxDecant&&" \u26a0\ufe0f"]})]}),u.washedWeight&&(0,J.jsxs)(n.default,{className:"flex-row justify-between items-center",children:[(0,J.jsx)(d.default,{className:"text-sm text-gray-600",children:"Washed Weight:"}),(0,J.jsxs)(d.default,{className:"text-base font-semibold text-gray-800",children:[u.washedWeight.toFixed(2)," g"]})]})]})]}),(0,J.jsx)(n.default,{className:"mx-4 mt-4",children:(0,J.jsx)(At,{chartData:h,showC33Limits:!0})}),(0,J.jsxs)(n.default,{className:"bg-white p-4 mt-4 mx-4 rounded-lg shadow-sm mb-6",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800 mb-3",children:"Sieve Analysis"}),(0,J.jsxs)(n.default,{className:"flex-row bg-gray-100 p-2 rounded-t-lg",children:[(0,J.jsx)(d.default,{className:"flex-1 text-xs font-semibold text-gray-700",children:"Sieve"}),(0,J.jsx)(d.default,{className:"w-16 text-xs font-semibold text-gray-700 text-right",children:"Retained"}),(0,J.jsx)(d.default,{className:"w-16 text-xs font-semibold text-gray-700 text-right",children:"% Ret"}),(0,J.jsx)(d.default,{className:"w-16 text-xs font-semibold text-gray-700 text-right",children:"% Pass"})]}),u.sieveData.map((e,t)=>{const a=e.percentPassing&&"-"!==e.c33Lower&&"-"!==e.c33Upper&&(parseFloat(e.percentPassing)<e.c33Lower||parseFloat(e.percentPassing)>e.c33Upper);return(0,J.jsxs)(n.default,{className:"flex-row p-2 border-b border-gray-200 "+(a?"bg-red-50":""),children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-sm text-gray-800 font-medium",children:e.name}),"-"!==e.c33Lower&&"-"!==e.c33Upper&&(0,J.jsxs)(d.default,{className:"text-xs text-gray-500",children:["C33: ",e.c33Lower,"-",e.c33Upper,"%"]})]}),(0,J.jsx)(d.default,{className:"w-16 text-sm text-gray-800 text-right",children:parseFloat(e.weightRetained).toFixed(0)}),(0,J.jsx)(d.default,{className:"w-16 text-sm text-gray-800 text-right",children:e.percentRetained||"-"}),(0,J.jsxs)(d.default,{className:"w-16 text-sm text-right font-medium "+(a?"text-red-600":"text-gray-800"),children:[e.percentPassing||"-",a&&" \u26a0\ufe0f"]})]},t)})]})]}),(0,J.jsxs)(n.default,{className:"bg-white border-t border-gray-200 p-4 gap-3",children:[(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsxs)(o.default,{onPress:async()=>{try{const e=`Aggregate Gradation Test Results\n      \nAggregate: ${u.aggregateName}\nDate: ${u.date}\nTotal Weight: ${u.totalWeight.toFixed(2)}g\n${u.finenessModulus?`Fineness Modulus: ${u.finenessModulus}`:""}\n${u.decant?`Decant: ${u.decant}%`:""}\nC33 Compliance: ${u.passC33?"PASS":"FAIL"}\n\nSieve Data:\n${u.sieveData.map(e=>`${e.name}: ${e.weightRetained}g (${e.percentPassing}% passing)`).join("\n")}`;await pe.default.share({message:e,title:"Gradation Test Results"})}catch(qa){console.error("Error sharing:",qa)}},className:"flex-1 bg-blue-600 rounded-lg py-3 items-center active:bg-blue-700 flex-row justify-center gap-2",children:[(0,J.jsx)(x.default,{name:"share-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Share"})]}),(0,J.jsxs)(o.default,{onPress:()=>{c(!0)},className:"flex-1 bg-red-600 rounded-lg py-3 items-center active:bg-red-700 flex-row justify-center gap-2",children:[(0,J.jsx)(x.default,{name:"trash-outline",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Delete"})]})]}),(0,J.jsx)(o.default,{onPress:()=>{e.navigate("GradationTest",{aggregateName:u.aggregateName})},className:"bg-orange-600 rounded-lg py-3 items-center active:bg-orange-700",children:(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"New Test"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("AggregateGradation"),className:"border border-gray-300 rounded-lg py-3 items-center active:bg-gray-50",children:(0,J.jsx)(d.default,{className:"text-gray-700 font-medium",children:"Back to Home"})})]}),(0,J.jsx)(ve,{visible:i,title:"Delete Test Record?",message:"This action cannot be undone. Are you sure you want to delete this test?",confirmText:"Delete",cancelText:"Cancel",onConfirm:()=>{r(a),c(!1),e.navigate("AggregateGradation"),Te.default.alert("Success","Test record deleted successfully")},onCancel:()=>c(!1),confirmStyle:"destructive"})]})},Tt=({navigation:e})=>{const{testHistory:t,aggregates:a,clearAllTests:s}=St(),[r,l]=(0,f.useState)(""),[i,c]=(0,f.useState)("all"),[u,m]=(0,f.useState)("all"),[p,b]=(0,f.useState)(!1),y=(0,f.useMemo)(()=>{const e=new Set(t.map(e=>e.aggregateName));return Array.from(e).sort()},[t]),j=(0,f.useMemo)(()=>t.filter(e=>{if(r){const t=r.toLowerCase();if(!(e.aggregateName.toLowerCase().includes(t)||e.date.includes(t)||e.id.includes(t)))return!1}return("all"===i||e.aggregateName===i)&&(!("pass"===u&&!e.passC33)&&("fail"!==u||!e.passC33))}),[t,r,i,u]),N=e=>{const t=new Date(e),a=(new Date).getTime()-t.getTime(),s=Math.floor(a/864e5);return 0===s?"Today":1===s?"Yesterday":s<7?`${s} days ago`:s<30?`${Math.floor(s/7)} weeks ago`:t.toLocaleDateString()};return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(n.default,{className:"bg-white p-4 border-b border-gray-200",children:(0,J.jsxs)(n.default,{className:"bg-gray-100 rounded-lg flex-row items-center px-3",children:[(0,J.jsx)(x.default,{name:"search",size:20,color:"#9ca3af"}),(0,J.jsx)(h.default,{value:r,onChangeText:l,placeholder:"Search by aggregate, date, or ID...",placeholderTextColor:"#9ca3af",cursorColor:"#000000",className:"flex-1 py-2 px-2 text-base"}),r.length>0&&(0,J.jsx)(o.default,{onPress:()=>l(""),children:(0,J.jsx)(x.default,{name:"close-circle",size:20,color:"#9ca3af"})})]})}),(0,J.jsxs)(n.default,{className:"bg-white p-4 border-b border-gray-200",children:[(0,J.jsx)(n.default,{className:"flex-row gap-3",children:(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-xs font-medium text-gray-600 mb-1",children:"Aggregate"}),(0,J.jsx)(g.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,children:(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>c("all"),className:"px-3 py-1.5 rounded-full "+("all"===i?"bg-orange-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("all"===i?"text-white":"text-gray-700"),children:"All"})}),y.map(e=>(0,J.jsx)(o.default,{onPress:()=>c(e),className:"px-3 py-1.5 rounded-full "+(i===e?"bg-orange-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+(i===e?"text-white":"text-gray-700"),children:e})},e))]})})]})}),(0,J.jsxs)(n.default,{className:"flex-row gap-2 mt-3",children:[(0,J.jsx)(o.default,{onPress:()=>m("all"),className:"px-4 py-1.5 rounded-full "+("all"===u?"bg-orange-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("all"===u?"text-white":"text-gray-700"),children:"All Tests"})}),(0,J.jsx)(o.default,{onPress:()=>m("pass"),className:"px-4 py-1.5 rounded-full "+("pass"===u?"bg-green-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("pass"===u?"text-white":"text-gray-700"),children:"Passed"})}),(0,J.jsx)(o.default,{onPress:()=>m("fail"),className:"px-4 py-1.5 rounded-full "+("fail"===u?"bg-red-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("fail"===u?"text-white":"text-gray-700"),children:"Failed"})})]}),(0,J.jsxs)(n.default,{className:"mt-3 flex-row justify-between items-center",children:[(0,J.jsxs)(d.default,{className:"text-sm text-gray-600",children:[j.length," ",1===j.length?"test":"tests"," found"]}),t.length>0&&(0,J.jsxs)(o.default,{onPress:()=>{b(!0)},className:"flex-row items-center gap-1",children:[(0,J.jsx)(x.default,{name:"trash-outline",size:16,color:"#ef4444"}),(0,J.jsx)(d.default,{className:"text-sm text-red-500 font-medium",children:"Clear All"})]})]})]}),(0,J.jsx)(g.default,{className:"flex-1",children:0===j.length?(0,J.jsxs)(n.default,{className:"flex-1 items-center justify-center p-8 mt-20",children:[(0,J.jsx)(x.default,{name:"document-text-outline",size:64,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600 mt-4 text-center",children:0===t.length?"No test records yet":"No tests match your filters"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-2 text-center",children:0===t.length?"Start a new test to see it here":"Try adjusting your search or filters"})]}):(0,J.jsx)(n.default,{className:"p-4 gap-3",children:j.map(t=>{const s=a[t.aggregateName];return(0,J.jsxs)(o.default,{onPress:()=>{return a=t.id,void e.navigate("GradationResults",{testId:a});var a},className:"bg-white rounded-lg p-4 shadow-sm active:bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between items-start mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800",children:t.aggregateName}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-500 mt-0.5",children:[t.date," \u2022 ",N(t.timestamp)]})]}),(0,J.jsx)(n.default,{className:"px-2 py-1 rounded "+(t.passC33?"bg-green-100":"bg-red-100"),children:(0,J.jsx)(d.default,{className:"text-xs font-semibold "+(t.passC33?"text-green-700":"text-red-700"),children:t.passC33?"PASS":"FAIL"})})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-4 mt-2",children:[s&&(0,J.jsxs)(n.default,{className:"flex-row items-center gap-1",children:[(0,J.jsx)(x.default,{name:"layers-outline",size:14,color:"#6b7280"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:s.type})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center gap-1",children:[(0,J.jsx)(x.default,{name:"scale-outline",size:14,color:"#6b7280"}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:[t.totalWeight.toFixed(0),"g"]})]}),t.finenessModulus&&(0,J.jsxs)(n.default,{className:"flex-row items-center gap-1",children:[(0,J.jsx)(x.default,{name:"analytics-outline",size:14,color:"#6b7280"}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:["FM: ",t.finenessModulus]})]}),t.decant&&(0,J.jsxs)(n.default,{className:"flex-row items-center gap-1",children:[(0,J.jsx)(x.default,{name:"water-outline",size:14,color:"#6b7280"}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:["D: ",t.decant,"%"]})]})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mt-3 pt-3 border-t border-gray-100",children:[(0,J.jsxs)(d.default,{className:"text-xs text-gray-500",children:["ID: ",t.id.slice(-8)]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:16,color:"#9ca3af"})]})]},t.id)})})}),(0,J.jsx)(ve,{visible:p,title:"Clear All Test Records?",message:"This will permanently delete all test records. This action cannot be undone.",confirmText:"Clear All",cancelText:"Cancel",onConfirm:()=>{s(),b(!1),Te.default.alert("Success","All test records have been cleared")},onCancel:()=>b(!1),confirmStyle:"destructive"})]})},Et=({navigation:e})=>{const{aggregates:t,deleteAggregate:a,addAggregate:s}=St(),[r,l]=(0,f.useState)(null),[i,c]=(0,f.useState)(!1),[u,m]=(0,f.useState)(null),h=Object.entries(t),p=Object.keys(Nt);return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsxs)(g.default,{className:"flex-1",children:[(0,J.jsxs)(n.default,{className:"p-4 gap-3",children:[(0,J.jsxs)(o.default,{onPress:()=>e.navigate("GradationAddEditAggregate",{}),className:"bg-orange-600 rounded-lg p-4 flex-row items-center justify-center gap-2 active:bg-orange-700",children:[(0,J.jsx)(x.default,{name:"add-circle",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Add New Aggregate"})]}),(0,J.jsxs)(o.default,{onPress:()=>{Te.default.alert("Restore Default Aggregates","This will restore all 4 default aggregate configurations. Custom aggregates will not be affected.",[{text:"Cancel",style:"cancel"},{text:"Restore",onPress:()=>{Object.entries(Nt).forEach(([e,t])=>{s(e,t)}),Te.default.alert("Success","Default aggregates restored")}}])},className:"bg-blue-600 rounded-lg p-4 flex-row items-center justify-center gap-2 active:bg-blue-700",children:[(0,J.jsx)(x.default,{name:"refresh",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Restore Default Aggregates"})]}),(0,J.jsx)(n.default,{className:"bg-yellow-50 rounded-lg p-3 border border-yellow-200",children:(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(x.default,{name:"information-circle",size:18,color:"#d97706"}),(0,J.jsxs)(d.default,{className:"flex-1 text-sm text-yellow-800",children:["Default aggregates are: ",p.join(", "),". You can delete and restore them as needed."]})]})})]}),(0,J.jsxs)(n.default,{className:"px-4 pb-6",children:[(0,J.jsxs)(d.default,{className:"text-lg font-semibold text-gray-800 mb-3",children:["Configured Aggregates (",h.length,")"]}),0===h.length?(0,J.jsxs)(n.default,{className:"bg-white rounded-lg p-6 items-center",children:[(0,J.jsx)(x.default,{name:"warning-outline",size:48,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-gray-500 mt-3 text-center",children:"No aggregates configured. Restore defaults to get started."})]}):(0,J.jsx)(n.default,{className:"gap-3",children:h.map(([t,a])=>{const s=r===t,i=p.includes(t);return(0,J.jsxs)(n.default,{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[(0,J.jsx)(o.default,{onPress:()=>(e=>{l(r===e?null:e)})(t),className:"p-4 active:bg-gray-50",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800",children:t}),i&&(0,J.jsx)(n.default,{className:"bg-blue-100 px-2 py-0.5 rounded",children:(0,J.jsx)(d.default,{className:"text-xs font-medium text-blue-700",children:"Default"})})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center gap-3 mt-1",children:[(0,J.jsx)(n.default,{className:"px-2 py-1 rounded "+("Fine"===a.type?"bg-green-100":"bg-blue-100"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("Fine"===a.type?"text-green-700":"text-blue-700"),children:a.type})}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600",children:[a.sieves.length," sieves"]}),a.maxDecant&&(0,J.jsxs)(d.default,{className:"text-sm text-gray-600",children:["Max Decant: ",a.maxDecant,"%"]})]})]}),(0,J.jsx)(x.default,{name:s?"chevron-up":"chevron-down",size:24,color:"#9ca3af"})]})}),s&&(0,J.jsxs)(n.default,{className:"border-t border-gray-200",children:[(0,J.jsxs)(n.default,{className:"p-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Sieve Configuration"}),(0,J.jsxs)(n.default,{className:"flex-row bg-gray-100 p-2 rounded-t-lg",children:[(0,J.jsx)(d.default,{className:"flex-1 text-xs font-semibold text-gray-700",children:"Sieve"}),(0,J.jsx)(d.default,{className:"w-20 text-xs font-semibold text-gray-700 text-right",children:"Size (mm)"}),(0,J.jsx)(d.default,{className:"w-24 text-xs font-semibold text-gray-700 text-right",children:"C33 Lower"}),(0,J.jsx)(d.default,{className:"w-24 text-xs font-semibold text-gray-700 text-right",children:"C33 Upper"})]}),a.sieves.map((e,t)=>(0,J.jsxs)(n.default,{className:"flex-row p-2 border-b border-gray-200",children:[(0,J.jsx)(d.default,{className:"flex-1 text-sm text-gray-800 font-medium",children:e.name}),(0,J.jsx)(d.default,{className:"w-20 text-sm text-gray-600 text-right",children:e.size>0?e.size:"-"}),(0,J.jsx)(d.default,{className:"w-24 text-sm text-gray-600 text-right",children:"-"!==e.c33Lower?`${e.c33Lower}%`:"-"}),(0,J.jsx)(d.default,{className:"w-24 text-sm text-gray-600 text-right",children:"-"!==e.c33Upper?`${e.c33Upper}%`:"-"})]},t))]}),(0,J.jsxs)(n.default,{className:"p-4 border-t border-gray-200 bg-gray-50 flex-row gap-3",children:[(0,J.jsxs)(o.default,{onPress:()=>e.navigate("GradationAddEditAggregate",{aggregateName:t}),className:"flex-1 bg-blue-600 rounded-lg py-2 px-4 flex-row items-center justify-center gap-2 active:bg-blue-700",children:[(0,J.jsx)(x.default,{name:"create-outline",size:18,color:"white"}),(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Edit"})]}),(0,J.jsxs)(o.default,{onPress:()=>(e=>{m(e),c(!0)})(t),className:"flex-1 bg-red-600 rounded-lg py-2 px-4 flex-row items-center justify-center gap-2 active:bg-red-700",children:[(0,J.jsx)(x.default,{name:"trash-outline",size:18,color:"white"}),(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Delete"})]})]})]})]},t)})})]}),(0,J.jsx)(n.default,{className:"px-4 pb-6",children:(0,J.jsx)(n.default,{className:"bg-blue-50 rounded-lg p-4",children:(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(x.default,{name:"information-circle",size:20,color:"#2563eb"}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-sm text-blue-900 font-medium mb-1",children:"About Aggregate Configuration"}),(0,J.jsx)(d.default,{className:"text-sm text-blue-800",children:"Each aggregate has specific sieve sizes and C33 specification limits (ASTM C33). The gradation test results are automatically checked against these limits."})]})]})})})]}),(0,J.jsx)(ve,{visible:i,title:"Delete Aggregate?",message:`Are you sure you want to delete "${u}"? This will not affect existing test records.`,confirmText:"Delete",cancelText:"Cancel",onConfirm:()=>{u&&(a(u),c(!1),m(null),Te.default.alert("Success","Aggregate configuration deleted"))},onCancel:()=>{c(!1),m(null)},confirmStyle:"destructive"})]})},zt=({navigation:e,route:t})=>{const{aggregateName:a}=t.params||{},{aggregates:s,addAggregate:r,updateAggregate:l}=St(),i=!!a,c=i?s[a]:null,[u,m]=(0,f.useState)(a||""),[b,y]=(0,f.useState)(c?.type||"Fine"),[j,N]=(0,f.useState)(c?.maxDecant?.toString()||""),[w,S]=(0,f.useState)(c?.maxFinenessModulus?.toString()||""),[F,C]=(0,f.useState)(!1),[v,A]=(0,f.useState)(null),[P,T]=(0,f.useState)({}),[E,z]=(0,f.useState)(i&&c?c.sieves:[{name:"Pan",size:0,weightRetained:"",c33Lower:"-",c33Upper:"-"}]),B=e=>{y(e)},D=()=>{const e=E.map(e=>e.name);return Object.keys(jt).filter(t=>"Pan"!==t&&!e.includes(t))},k=(e,t,a)=>{const s=`${e}-${t}`;if(T(e=>Object.assign({},e,{[s]:a})),""===a)return;const r=[...E];if("-"===a)r[e][t]="-";else{const s=parseFloat(a);isNaN(s)||(r[e][t]=s)}z(r)},I=(e,t)=>{const a=`${e}-${t}`,s=E[e][t],r="-"===s?"-":s?.toString()||"";A(a),T(e=>Object.assign({},e,{[a]:r}))},L=(e,t)=>{const a=`${e}-${t}`,s=P[a];if(A(null),!s||""===s.trim()){const e=[...E];return z(e),void T(e=>{const t=Object.assign({},e);return delete t[a],t})}const r=[...E];if("-"===s)r[e][t]="-";else{const a=parseFloat(s);isNaN(a)?r[e][t]=E[e][t]:r[e][t]=a}z(r),T(e=>{const t=Object.assign({},e);return delete t[a],t})},R=(e,t)=>{const a=`${e}-${t}`;if(v===a)return P[a]||"";const s=E[e][t];return"-"===s?"-":s?.toString()||""};return(0,J.jsxs)(Z.default,{behavior:"height",className:"flex-1 bg-gray-50",children:[(0,J.jsxs)(g.default,{className:"flex-1",keyboardShouldPersistTaps:"handled",children:[(0,J.jsxs)(n.default,{className:"bg-white p-4 mb-4",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800 mb-4",children:"Basic Information"}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700 mb-1",children:"Aggregate Name *"}),(0,J.jsx)(h.default,{cursorColor:"#000000",value:u,onChangeText:m,placeholder:"e.g., Concrete Sand",editable:!i,className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-base "+(i?"opacity-50":"")}),i&&(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-1",children:"Name cannot be changed after creation"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700 mb-2",children:"Aggregate Type *"}),(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsx)(o.default,{onPress:()=>B("Fine"),className:"flex-1 py-3 rounded-lg border-2 "+("Fine"===b?"bg-green-50 border-green-500":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-center font-semibold "+("Fine"===b?"text-green-700":"text-gray-600"),children:"Fine Aggregate"})}),(0,J.jsx)(o.default,{onPress:()=>B("Coarse"),className:"flex-1 py-3 rounded-lg border-2 "+("Coarse"===b?"bg-blue-50 border-blue-500":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-center font-semibold "+("Coarse"===b?"text-blue-700":"text-gray-600"),children:"Coarse Aggregate"})})]})]}),"Fine"===b&&(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700 mb-1",children:"Max Decant (%)"}),(0,J.jsx)(h.default,{cursorColor:"#000000",value:j,onChangeText:N,placeholder:"Optional",keyboardType:"decimal-pad",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-base"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-1",children:"Maximum allowable decant percentage for this aggregate"})]}),"Fine"===b&&(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700 mb-1",children:"Max Fineness Modulus"}),(0,J.jsx)(h.default,{cursorColor:"#000000",value:w,onChangeText:S,placeholder:"Optional",keyboardType:"decimal-pad",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-base"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-1",children:"Maximum allowable fineness modulus for this aggregate"})]})]}),(0,J.jsxs)(n.default,{className:"bg-white p-4 mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800",children:"Sieve Configuration & C33 Limits"}),(0,J.jsxs)(o.default,{onPress:()=>C(!0),className:"bg-blue-600 rounded-lg px-3 py-2 flex-row items-center gap-1 active:bg-blue-700",children:[(0,J.jsx)(x.default,{name:"add-circle",size:16,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-xs font-semibold",children:"Add Sieve"})]})]}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 mb-4",children:'Configure ASTM C33 cumulative passing percentage limits for each sieve. Use "-" for no limit.'}),(0,J.jsxs)(n.default,{className:"flex-row bg-gray-100 p-2 rounded-t-lg",children:[(0,J.jsx)(d.default,{className:"w-8 text-xs font-semibold text-gray-700"}),(0,J.jsx)(d.default,{className:"flex-1 text-xs font-semibold text-gray-700",children:"Sieve"}),(0,J.jsx)(d.default,{className:"w-24 text-xs font-semibold text-gray-700 text-center",children:"Lower %"}),(0,J.jsx)(d.default,{className:"w-24 text-xs font-semibold text-gray-700 text-center",children:"Upper %"})]}),E.map((e,t)=>(0,J.jsxs)(n.default,{className:"flex-row items-center p-2 border-b border-gray-200",children:[(0,J.jsx)(n.default,{className:"w-8",children:"Pan"!==e.name&&(0,J.jsx)(o.default,{onPress:()=>(e=>{const t=E[e];"Pan"!==t.name?Te.default.alert("Remove Sieve",`Remove ${t.name} sieve from this aggregate?`,[{text:"Cancel",style:"cancel"},{text:"Remove",style:"destructive",onPress:()=>{const t=E.filter((t,a)=>a!==e);z(t)}}]):Te.default.alert("Cannot Remove","Pan sieve is required and cannot be removed")})(t),className:"p-1",children:(0,J.jsx)(x.default,{name:"close-circle",size:20,color:"#ef4444"})})}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-800",children:e.name}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:e.size>0?`${e.size}mm`:"Pan"})]}),(0,J.jsx)(n.default,{className:"w-24 px-1",children:(0,J.jsx)(h.default,{cursorColor:"#000000",value:R(t,"c33Lower"),onChangeText:e=>k(t,"c33Lower",e),onFocus:()=>I(t,"c33Lower"),onBlur:()=>L(t,"c33Lower"),placeholder:"-",keyboardType:"decimal-pad",selectTextOnFocus:!0,className:"bg-gray-50 border border-gray-300 rounded px-2 py-1 text-sm text-center"})}),(0,J.jsx)(n.default,{className:"w-24 px-1",children:(0,J.jsx)(h.default,{cursorColor:"#000000",value:R(t,"c33Upper"),onChangeText:e=>k(t,"c33Upper",e),onFocus:()=>I(t,"c33Upper"),onBlur:()=>L(t,"c33Upper"),placeholder:"-",keyboardType:"decimal-pad",selectTextOnFocus:!0,className:"bg-gray-50 border border-gray-300 rounded px-2 py-1 text-sm text-center"})})]},t))]}),(0,J.jsx)(n.default,{className:"px-4 pb-6",children:(0,J.jsx)(n.default,{className:"bg-blue-50 rounded-lg p-3",children:(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(x.default,{name:"information-circle",size:18,color:"#2563eb"}),(0,J.jsx)(d.default,{className:"flex-1 text-sm text-blue-800",children:"C33 limits define the acceptable range for cumulative passing percentages. Tests will automatically check compliance against these limits."})]})})})]}),(0,J.jsxs)(n.default,{className:"bg-white border-t border-gray-200 p-4 gap-3",children:[(0,J.jsx)(o.default,{onPress:()=>{if(!u.trim())return void Te.default.alert("Error","Please enter an aggregate name");if(!i&&s[u])return void Te.default.alert("Error","An aggregate with this name already exists");const t={type:b,sieves:E,maxDecant:j?parseFloat(j):null,maxFinenessModulus:w?parseFloat(w):null};i?(l(u,t),Te.default.alert("Success","Aggregate updated successfully")):(r(u,t),Te.default.alert("Success","Aggregate added successfully")),e.goBack()},className:"bg-orange-600 rounded-lg py-3 items-center active:bg-orange-700",children:(0,J.jsx)(d.default,{className:"text-white font-semibold text-base",children:i?"Update Aggregate":"Add Aggregate"})}),(0,J.jsx)(o.default,{onPress:()=>e.goBack(),className:"border border-gray-300 rounded-lg py-3 items-center active:bg-gray-50",children:(0,J.jsx)(d.default,{className:"text-gray-700 font-medium text-base",children:"Cancel"})})]}),(0,J.jsx)(p.default,{visible:F,transparent:!0,animationType:"fade",onRequestClose:()=>C(!1),children:(0,J.jsx)(o.default,{className:"flex-1 items-center justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onPress:()=>C(!1),children:(0,J.jsxs)(o.default,{className:"bg-white rounded-2xl mx-5 w-80 max-h-96",onPress:e=>e.stopPropagation(),children:[(0,J.jsxs)(n.default,{className:"p-5 border-b border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900",children:"Add Sieve"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 mt-1",children:"Select a sieve to add to this aggregate"})]}),(0,J.jsx)(g.default,{className:"max-h-80",children:0===D().length?(0,J.jsxs)(n.default,{className:"p-8 items-center",children:[(0,J.jsx)(x.default,{name:"checkmark-circle",size:48,color:"#10b981"}),(0,J.jsx)(d.default,{className:"text-gray-600 mt-3 text-center",children:"All available sieves have been added"})]}):(0,J.jsx)(n.default,{className:"p-2",children:D().map(e=>(0,J.jsx)(o.default,{onPress:()=>(e=>{const t={name:e,size:jt[e],weightRetained:"",c33Lower:"-",c33Upper:"-"},a=[...E],s=a.findIndex(e=>"Pan"===e.name);if(-1!==s){let e=0;for(let r=0;r<s;r++)a[r].size>t.size&&(e=r+1);a.splice(e,0,t)}else a.push(t);z(a),C(!1)})(e),className:"p-4 border-b border-gray-200 active:bg-gray-50",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-800",children:e}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-500",children:[jt[e],"mm"]})]}),(0,J.jsx)(x.default,{name:"add-circle-outline",size:24,color:"#2563eb"})]})},e))})}),(0,J.jsx)(n.default,{className:"p-4 border-t border-gray-200",children:(0,J.jsx)(o.default,{onPress:()=>C(!1),className:"bg-gray-200 rounded-lg py-3 items-center active:bg-gray-300",children:(0,J.jsx)(d.default,{className:"text-gray-700 font-semibold",children:"Close"})})})]})})})]})},Bt=({navigation:e})=>{const{getAllAggregates:t,searchAggregates:a,isAggregateComplete:s}=D(),[r,l]=(0,f.useState)(""),[i,c]=(0,f.useState)("all"),[u,m]=(0,f.useState)("all"),p=r?a(r):t(),b=(0,f.useMemo)(()=>p.filter(e=>("all"===i||e.type===i)&&(!("complete"===u&&!s(e.id))&&("incomplete"!==u||!s(e.id)))),[p,i,u,s]),y=(0,f.useMemo)(()=>{const e=t();return{total:e.length,fine:e.filter(e=>"Fine"===e.type).length,coarse:e.filter(e=>"Coarse"===e.type).length,complete:e.filter(e=>s(e.id)).length,incomplete:e.filter(e=>!s(e.id)).length}},[t,s]);return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(n.default,{className:"bg-white p-4 border-b border-gray-200",children:(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-blue-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-blue-600",children:y.total}),(0,J.jsx)(d.default,{className:"text-xs text-blue-700",children:"Total"})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-green-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-green-600",children:y.fine}),(0,J.jsx)(d.default,{className:"text-xs text-green-700",children:"Fine"})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-purple-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-purple-600",children:y.coarse}),(0,J.jsx)(d.default,{className:"text-xs text-purple-700",children:"Coarse"})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-orange-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-orange-600",children:y.incomplete}),(0,J.jsx)(d.default,{className:"text-xs text-orange-700",children:"Incomplete"})]})]})}),(0,J.jsxs)(n.default,{className:"bg-white p-4 border-b border-gray-200 gap-3",children:[(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-100 rounded-lg flex-row items-center px-3",children:[(0,J.jsx)(x.default,{name:"search",size:20,color:"#9ca3af"}),(0,J.jsx)(h.default,{value:r,onChangeText:l,placeholder:"Search aggregates...",placeholderTextColor:"#9ca3af",cursorColor:"#000000",className:"flex-1 py-2 px-2 text-base"}),r.length>0&&(0,J.jsx)(o.default,{onPress:()=>l(""),children:(0,J.jsx)(x.default,{name:"close-circle",size:20,color:"#9ca3af"})})]}),(0,J.jsx)(o.default,{onPress:()=>{e.navigate("AggregateLibraryAddEdit",{})},className:"bg-blue-600 rounded-lg px-4 items-center justify-center active:bg-blue-700",children:(0,J.jsx)(x.default,{name:"add",size:24,color:"white"})})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>c("all"),className:"px-3 py-1.5 rounded-full "+("all"===i?"bg-gray-800":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("all"===i?"text-white":"text-gray-700"),children:"All Types"})}),(0,J.jsx)(o.default,{onPress:()=>c("Fine"),className:"px-3 py-1.5 rounded-full "+("Fine"===i?"bg-green-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("Fine"===i?"text-white":"text-gray-700"),children:"Fine"})}),(0,J.jsx)(o.default,{onPress:()=>c("Coarse"),className:"px-3 py-1.5 rounded-full "+("Coarse"===i?"bg-purple-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("Coarse"===i?"text-white":"text-gray-700"),children:"Coarse"})}),(0,J.jsx)(o.default,{onPress:()=>m("incomplete"===u?"all":"incomplete"),className:"px-3 py-1.5 rounded-full "+("incomplete"===u?"bg-orange-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("incomplete"===u?"text-white":"text-gray-700"),children:"Incomplete"})})]}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:[b.length," ",1===b.length?"aggregate":"aggregates"]})]}),(0,J.jsx)(g.default,{className:"flex-1",children:0===b.length?(0,J.jsxs)(n.default,{className:"flex-1 items-center justify-center p-8 mt-20",children:[(0,J.jsx)(x.default,{name:"flask-outline",size:64,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600 mt-4 text-center",children:0===p.length?"No aggregates yet":"No aggregates match your filters"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-2 text-center",children:0===p.length?"Tap + to add your first aggregate":"Try adjusting your search or filters"})]}):(0,J.jsx)(n.default,{className:"p-4 gap-3",children:b.map(t=>{const a=s(t.id);return(0,J.jsxs)(o.default,{onPress:()=>(t=>{e.navigate("AggregateLibraryDetail",{aggregateId:t.id})})(t),className:"bg-white rounded-lg p-4 shadow-sm active:bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-row items-start justify-between mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800",children:t.name}),t.source&&(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-0.5",children:t.source})]}),!a&&(0,J.jsx)(n.default,{className:"bg-orange-100 px-2 py-1 rounded",children:(0,J.jsx)(d.default,{className:"text-xs font-semibold text-orange-700",children:"INCOMPLETE"})})]}),(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-2 mt-2",children:[(0,J.jsx)(n.default,{className:"px-2 py-1 rounded "+("Fine"===t.type?"bg-green-100":"bg-purple-100"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("Fine"===t.type?"text-green-700":"text-purple-700"),children:t.type})}),t.colorFamily&&(0,J.jsx)(n.default,{className:"px-2 py-1 rounded bg-gray-100",children:(0,J.jsx)(d.default,{className:"text-xs font-medium text-gray-700",children:t.colorFamily})}),void 0!==t.finenessModulus&&(0,J.jsx)(n.default,{className:"px-2 py-1 rounded bg-blue-100",children:(0,J.jsxs)(d.default,{className:"text-xs font-medium text-blue-700",children:["FM: ",t.finenessModulus]})})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mt-3 pt-3 border-t border-gray-100",children:[(0,J.jsxs)(d.default,{className:"text-xs text-gray-500",children:["Updated ",new Date(t.updatedAt).toLocaleDateString()]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:16,color:"#9ca3af"})]})]},t.id)})})})]})},Dt=({navigation:e,route:t})=>{const{aggregateId:a}=t.params,{getAggregate:s,deleteAggregate:r,isAggregateComplete:l,toggleFavorite:i,duplicateAggregate:c,trackAccess:u}=D(),m=s(a);if(f.useEffect(()=>{a&&u(a)},[a,u]),!m)return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50 items-center justify-center p-8",children:[(0,J.jsx)(x.default,{name:"alert-circle-outline",size:64,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600 mt-4 text-center",children:"Aggregate not found"}),(0,J.jsx)(o.default,{onPress:()=>e.goBack(),className:"mt-6 bg-blue-600 rounded-lg px-6 py-3 active:bg-blue-700",children:(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Go Back"})})]});const h=l(a),p=(e,t,a)=>null===t||void 0===t?null:(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-0.5",children:e}),(0,J.jsxs)(d.default,{className:"text-base text-gray-900 font-medium",children:[t,a?` ${a}`:""]})]}),b=(e,t,a)=>a?null:(0,J.jsxs)(n.default,{className:"bg-white rounded-lg p-4 mb-3 shadow-sm",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-3",children:e}),t]}),y=!!(m.finenessModulus||m.dryRoddedUnitWeight||m.percentVoids||m.absorption||m.moistureContent||m.maxSize),j=!!(m.specificGravityBulkSSD||m.specificGravityBulkDry||m.specificGravityApparent),N=!!(m.laAbrasion||m.soundness||m.deleteriousMaterials||m.organicImpurities||m.clayLumps),w=!!(m.asrReactivity||m.chlorideContent||m.sulfateContent),S=!!(m.costPerTon||m.costPerYard||m.lastTestDate||m.certifications||m.notes);return(0,J.jsx)(n.default,{className:"flex-1 bg-gray-50",children:(0,J.jsxs)(g.default,{className:"flex-1",children:[(0,J.jsxs)(n.default,{className:"bg-white p-4 border-b border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-start justify-between mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-gray-900 mb-1",children:m.name}),m.source&&(0,J.jsx)(d.default,{className:"text-base text-gray-600",children:m.source})]}),!h&&(0,J.jsx)(n.default,{className:"bg-orange-100 px-3 py-1.5 rounded-lg",children:(0,J.jsx)(d.default,{className:"text-xs font-semibold text-orange-700",children:"INCOMPLETE"})})]}),(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-2 mt-3",children:[(0,J.jsx)(n.default,{className:"px-3 py-1.5 rounded-full "+("Fine"===m.type?"bg-green-100":"bg-purple-100"),children:(0,J.jsx)(d.default,{className:"text-sm font-semibold "+("Fine"===m.type?"text-green-700":"text-purple-700"),children:m.type})}),m.colorFamily&&(0,J.jsx)(n.default,{className:"px-3 py-1.5 rounded-full bg-gray-100",children:(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700",children:m.colorFamily})}),m.stockpileNumber&&(0,J.jsx)(n.default,{className:"px-3 py-1.5 rounded-full bg-blue-100",children:(0,J.jsx)(d.default,{className:"text-sm font-semibold text-blue-700",children:m.stockpileNumber})})]}),!h&&(0,J.jsx)(n.default,{className:"mt-4 bg-orange-50 rounded-lg p-3 border border-orange-200",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"warning",size:18,color:"#c2410c"}),(0,J.jsx)(d.default,{className:"flex-1 text-xs text-orange-700 ml-2",children:"This aggregate is missing required data. Tap Edit to complete the profile."})]})})]}),(0,J.jsxs)(n.default,{className:"p-4",children:[b("Physical Properties",(0,J.jsxs)(J.Fragment,{children:["Fine"===m.type&&p("Fineness Modulus",m.finenessModulus),p("Dry-Rodded Unit Weight",m.dryRoddedUnitWeight,"lb/ft\xb3"),p("Percent Voids",m.percentVoids,"%"),p("Absorption",m.absorption,"%"),p("Moisture Content",m.moistureContent,"%"),p("Maximum Size",m.maxSize,"in")]}),!y),b("Specific Gravity",(0,J.jsxs)(J.Fragment,{children:[p("Bulk (SSD)",m.specificGravityBulkSSD),p("Bulk (Dry)",m.specificGravityBulkDry),p("Apparent",m.specificGravityApparent)]}),!j),b("Performance Properties",(0,J.jsxs)(J.Fragment,{children:[p("LA Abrasion",m.laAbrasion,"%"),p("Soundness",m.soundness,"%"),p("Deleterious Materials",m.deleteriousMaterials,"%"),p("Organic Impurities",m.organicImpurities),p("Clay Lumps",m.clayLumps,"%")]}),!N),b("Chemical Properties",(0,J.jsxs)(J.Fragment,{children:[p("ASR Reactivity",m.asrReactivity),p("Chloride Content",m.chlorideContent,"%"),p("Sulfate Content",m.sulfateContent,"%")]}),!w),b("Production & Admin",(0,J.jsxs)(J.Fragment,{children:[p("Cost Per Ton",m.costPerTon,"$"),p("Cost Per Cubic Yard",m.costPerYard,"$"),p("Last Test Date",m.lastTestDate),p("Certifications",m.certifications),m.notes&&(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-0.5",children:"Notes"}),(0,J.jsx)(d.default,{className:"text-base text-gray-900",children:m.notes})]})]}),!S),(0,J.jsxs)(n.default,{className:"bg-gray-100 rounded-lg p-3 mt-2",children:[(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:["Created: ",new Date(m.createdAt).toLocaleDateString()," at ",new Date(m.createdAt).toLocaleTimeString()]}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-600 mt-1",children:["Last Updated: ",new Date(m.updatedAt).toLocaleDateString()," at ",new Date(m.updatedAt).toLocaleTimeString()]})]}),(0,J.jsxs)(n.default,{className:"gap-3 mt-6 mb-8",children:[(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsxs)(o.default,{onPress:()=>{e.navigate("AggregateLibraryAddEdit",{aggregateId:a})},className:"flex-1 bg-blue-600 rounded-lg py-4 items-center active:bg-blue-700 flex-row justify-center",children:[(0,J.jsx)(x.default,{name:"pencil",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Edit"})]}),(0,J.jsx)(o.default,{onPress:()=>{i(a)},className:"rounded-lg px-6 py-4 items-center flex-row "+(m.isFavorite?"bg-yellow-500 active:bg-yellow-600":"bg-gray-400 active:bg-gray-500"),children:(0,J.jsx)(x.default,{name:m.isFavorite?"star":"star-outline",size:20,color:"white"})})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsxs)(o.default,{onPress:async()=>{const t=await c(a);t&&Te.default.alert("Duplicate Created",`"${t.name}" has been created. Would you like to edit it now?`,[{text:"Not Now",style:"cancel"},{text:"Edit",onPress:()=>e.replace("AggregateLibraryAddEdit",{aggregateId:t.id})}])},className:"flex-1 bg-green-600 rounded-lg py-4 items-center active:bg-green-700 flex-row justify-center",children:[(0,J.jsx)(x.default,{name:"copy",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Duplicate"})]}),(0,J.jsx)(o.default,{onPress:()=>{Te.default.alert("Delete Aggregate",`Are you sure you want to delete "${m.name}"? This action cannot be undone.`,[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:()=>{r(a),e.goBack()}}])},className:"bg-red-600 rounded-lg px-6 py-4 items-center active:bg-red-700 flex-row",children:(0,J.jsx)(x.default,{name:"trash",size:20,color:"white"})})]})]})]})]})})};var kt=a(21213),It=a(2176),Lt=a(41632);const Rt=({onTranscriptionComplete:e,buttonSize:t=40,buttonColor:a="#3B82F6",style:s})=>{const[r,l]=(0,f.useState)(!1),[i,c]=(0,f.useState)(!1),[u,m]=(0,f.useState)(null),[g,h]=(0,f.useState)(null),p=async()=>{try{if(!u)return;l(!1),await u.stopAndUnloadAsync(),await It.setAudioModeAsync({allowsRecordingIOS:!1});const t=u.getURI();if(!t)return void h("No audio recorded");c(!0);const a=await(async e=>{try{const t=new FormData;t.append("file",{uri:e,type:"audio/m4a",name:"recording.m4a"}),t.append("model","gpt-4o-transcribe"),t.append("language","en");const a={NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.EXPO_PUBLIC_VIBECODE_OPENAI_API_KEY;if(!a)throw new Error("OPENAI_API_KEY is not set");const s={NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.OPENAI_BASE_URL?`${{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.OPENAI_BASE_URL}/audio/transcriptions`:"https://api.openai.com/v1/audio/transcriptions",r=await fetch(s,{method:"POST",headers:{Authorization:`Bearer ${a}`},body:t});if(!r.ok){const e=await r.text();throw new Error(`Transcription failed: ${e}`)}return(await r.json()).text}catch(g){throw console.error("Transcription error:",g),g}})(t);a&&a.trim()&&e(a.trim()),c(!1),m(null)}catch(t){console.error("Failed to process recording:",t),h("Failed to transcribe audio"),c(!1),m(null)}};return(0,J.jsxs)(n.default,{style:s,children:[(0,J.jsx)(o.default,{onPress:()=>{r?p():i||(async()=>{try{if(h(null),"granted"!==(await kt.requestPermissionsAsync()).status)return void h("Microphone permission denied");await It.setAudioModeAsync({allowsRecordingIOS:!0,playsInSilentModeIOS:!0});const{recording:e}=await kt.Recording.createAsync(Lt.RecordingOptionsPresets.HIGH_QUALITY);m(e),l(!0)}catch(e){console.error("Failed to start recording:",e),h("Failed to start recording")}})()},disabled:i,className:"items-center justify-center rounded-full active:opacity-80",style:{width:t,height:t,backgroundColor:r?"#EF4444":a},children:i?(0,J.jsx)(q.default,{color:"white",size:"small"}):(0,J.jsx)(x.default,{name:r?"stop":"mic",size:.5*t,color:"white"})}),r&&(0,J.jsx)(n.default,{className:"absolute -bottom-6 left-1/2 -ml-12 w-24",children:(0,J.jsx)(d.default,{className:"text-xs text-center text-red-600 font-semibold",children:"Recording..."})}),i&&(0,J.jsx)(n.default,{className:"absolute -bottom-6 left-1/2 -ml-16 w-32",children:(0,J.jsx)(d.default,{className:"text-xs text-center text-blue-600 font-semibold",children:"Transcribing..."})}),g&&(0,J.jsx)(n.default,{className:"absolute -bottom-6 left-1/2 -ml-20 w-40",children:(0,J.jsx)(d.default,{className:"text-xs text-center text-red-600 font-semibold",children:g})})]})},$t=["label","value","onChangeText","required","placeholder","multiline","enableVoiceInput"],Wt=e=>{let{label:t,value:a,onChangeText:s,required:r=!1,placeholder:l,multiline:o=!1,enableVoiceInput:i=!1}=e,c=(0,b.default)(e,$t);return(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-1",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700",children:t}),r&&(0,J.jsx)(d.default,{className:"text-red-500 ml-1",children:"*"})]}),i&&o&&(0,J.jsx)(Rt,{onTranscriptionComplete:e=>{a.trim()?s(`${a}\n${e}`):s(e)},buttonSize:32,buttonColor:"#3B82F6"})]}),(0,J.jsx)(h.default,Object.assign({value:a,onChangeText:s,placeholder:l,placeholderTextColor:"#9ca3af",multiline:o,numberOfLines:o?6:1,selectTextOnFocus:!0,cursorColor:"#000000",className:"bg-white border border-gray-300 rounded-lg px-3 py-2.5 text-base "+(o?"min-h-[120px]":"")},c)),i&&o&&(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-1",children:"Tap the microphone to record voice input"})]})},Ot=({warnings:e})=>0===e.length?null:(0,J.jsx)(n.default,{className:"mb-4",children:e.map((e,t)=>(0,J.jsxs)(n.default,{className:"rounded-lg p-3 mb-2 flex-row items-start "+("warning"===e.severity?"bg-yellow-50 border border-yellow-200":"bg-blue-50 border border-blue-200"),children:[(0,J.jsx)(x.default,{name:"warning"===e.severity?"warning":"information-circle",size:20,color:"warning"===e.severity?"#f59e0b":"#3b82f6",style:{marginTop:2}}),(0,J.jsxs)(n.default,{className:"flex-1 ml-2",children:[(0,J.jsx)(d.default,{className:"text-xs font-semibold mb-0.5 "+("warning"===e.severity?"text-yellow-900":"text-blue-900"),children:e.field}),(0,J.jsx)(d.default,{className:"text-xs "+("warning"===e.severity?"text-yellow-700":"text-blue-700"),children:e.message})]})]},t))}),Mt=({navigation:e,route:t})=>{const{aggregateId:a}=t.params,{getAggregate:s,addAggregate:r,updateAggregate:l}=D(),i=!!a,c=i?s(a):void 0,[u,m]=(0,f.useState)(c?.name||""),[p,b]=(0,f.useState)(c?.type||"Fine"),[y,j]=(0,f.useState)(c?.finenessModulus?.toString()||""),[N,w]=(0,f.useState)(c?.dryRoddedUnitWeight?.toString()||""),[S,F]=(0,f.useState)(c?.percentVoids?.toString()||""),[C,v]=(0,f.useState)(c?.absorption?.toString()||""),[A,P]=(0,f.useState)(c?.moistureContent?.toString()||""),[T,E]=(0,f.useState)(c?.maxSize?.toString()||""),[z,B]=(0,f.useState)(c?.specificGravityBulkSSD?.toString()||""),[k,I]=(0,f.useState)(c?.specificGravityBulkDry?.toString()||""),[L,R]=(0,f.useState)(c?.specificGravityApparent?.toString()||""),[$,W]=(0,f.useState)(c?.colorFamily||null),[O,M]=(0,f.useState)(c?.source||""),[U,H]=(0,f.useState)(c?.stockpileNumber||""),[V,G]=(0,f.useState)(c?.laAbrasion?.toString()||""),[q,Y]=(0,f.useState)(c?.soundness?.toString()||""),[_,Q]=(0,f.useState)(c?.deleteriousMaterials?.toString()||""),[X,K]=(0,f.useState)(c?.organicImpurities||""),[ee,te]=(0,f.useState)(c?.clayLumps?.toString()||""),[ae,se]=(0,f.useState)(c?.asrReactivity||null),[re,le]=(0,f.useState)(c?.chlorideContent?.toString()||""),[oe,ne]=(0,f.useState)(c?.sulfateContent?.toString()||""),[de,ie]=(0,f.useState)(c?.costPerTon?.toString()||""),[ce,ue]=(0,f.useState)(c?.costPerYard?.toString()||""),[me,xe]=(0,f.useState)(c?.lastTestDate||""),[fe,ge]=(0,f.useState)(c?.certifications||""),[he,pe]=(0,f.useState)(c?.notes||""),be=(0,f.useMemo)(()=>{const e=e=>{const t=parseFloat(e);return isNaN(t)?void 0:t};return(e=>{const t=[];return void 0!==e.dryRoddedUnitWeight&&(e.dryRoddedUnitWeight<50||e.dryRoddedUnitWeight>150)&&t.push({field:"Dry-Rodded Unit Weight",message:`${e.dryRoddedUnitWeight} lb/ft\xb3 is outside typical range (85-120 lb/ft\xb3). Please verify.`,severity:"warning"}),void 0!==e.percentVoids&&(e.percentVoids<0||e.percentVoids>100?t.push({field:"Percent Voids",message:"Percentage must be between 0 and 100.",severity:"warning"}):(e.percentVoids<20||e.percentVoids>60)&&t.push({field:"Percent Voids",message:`${e.percentVoids}% is outside typical range (30-50%). Please verify.`,severity:"info"})),void 0!==e.absorption&&(e.absorption<0||e.absorption>20)&&t.push({field:"Absorption",message:`${e.absorption}% is outside typical range (0.2-5%). Please verify.`,severity:"warning"}),[{value:e.sgBulkSSD,name:"SG Bulk SSD"},{value:e.sgBulkOvenDry,name:"SG Bulk Oven Dry"},{value:e.sgApparent,name:"SG Apparent"}].forEach(({value:e,name:a})=>{void 0!==e&&(e<1.5||e>4)&&t.push({field:a,message:`${e.toFixed(2)} is outside typical range (2.3-3.0). Please verify.`,severity:"warning"})}),void 0!==e.finenessModulus&&(e.finenessModulus<1.5||e.finenessModulus>4)&&t.push({field:"Fineness Modulus",message:`${e.finenessModulus.toFixed(2)} is outside typical range (2.3-3.1). Please verify.`,severity:"warning"}),t})({dryRoddedUnitWeight:e(N),percentVoids:e(S),absorption:e(C),sgBulkSSD:e(z),sgBulkOvenDry:e(k),sgApparent:e(L),finenessModulus:e(y)})},[N,S,C,z,k,L,y]),ye=(e,t,a,s={})=>(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center mb-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700",children:e}),s?.required&&(0,J.jsx)(d.default,{className:"text-red-500 ml-1",children:"*"})]}),(0,J.jsx)(h.default,{value:t,onChangeText:a,placeholder:s?.placeholder,placeholderTextColor:"#9ca3af",cursorColor:"#000000",keyboardType:s?.keyboardType||"default",multiline:s?.multiline,numberOfLines:s?.multiline?4:1,selectTextOnFocus:!0,className:"bg-white border border-gray-300 rounded-lg px-3 py-2.5 text-base "+(s?.multiline?"min-h-[80px]":"")})]}),je=(e,t,a)=>(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900",children:e}),a&&(0,J.jsx)(d.default,{className:"text-xs text-gray-600 mt-0.5",children:a})]}),t]});return(0,J.jsx)(Z.default,{className:"flex-1 bg-gray-50",behavior:void 0,keyboardVerticalOffset:90,children:(0,J.jsx)(g.default,{className:"flex-1",keyboardShouldPersistTaps:"handled",children:(0,J.jsxs)(n.default,{className:"p-4",children:[je("Basic Information",(0,J.jsxs)(J.Fragment,{children:[ye("Name",u,m,{required:!0,placeholder:"e.g., Keystone #7, Smith Quarry Sand"}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center mb-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700",children:"Type"}),(0,J.jsx)(d.default,{className:"text-red-500 ml-1",children:"*"})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsx)(o.default,{onPress:()=>b("Fine"),className:"flex-1 py-3 rounded-lg border-2 "+("Fine"===p?"bg-green-50 border-green-600":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-center font-semibold "+("Fine"===p?"text-green-700":"text-gray-700"),children:"Fine"})}),(0,J.jsx)(o.default,{onPress:()=>b("Coarse"),className:"flex-1 py-3 rounded-lg border-2 "+("Coarse"===p?"bg-purple-50 border-purple-600":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-center font-semibold "+("Coarse"===p?"text-purple-700":"text-gray-700"),children:"Coarse"})})]})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700 mb-1",children:"Color Family"}),(0,J.jsxs)(g.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,className:"flex-row gap-2",children:[["Brown","Red","Black","Grey","White","Mixed"].map(e=>(0,J.jsx)(o.default,{onPress:()=>W(e),className:"px-4 py-2 rounded-full border "+($===e?"bg-gray-800 border-gray-800":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-sm font-medium "+($===e?"text-white":"text-gray-700"),children:e})},e)),$&&(0,J.jsx)(o.default,{onPress:()=>W(null),className:"px-4 py-2 rounded-full bg-gray-200",children:(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700",children:"Clear"})})]})]}),ye("Source (Quarry/Supplier)",O,M,{placeholder:"e.g., Smith Quarry, ABC Materials"}),ye("Stockpile Number",U,H,{placeholder:"e.g., SP-4, A23"})]})),je("Physical Properties",(0,J.jsxs)(J.Fragment,{children:["Fine"===p&&ye("Fineness Modulus",y,j,{required:!0,keyboardType:"decimal-pad",placeholder:"e.g., 2.8"}),ye("Dry-Rodded Unit Weight",N,w,{required:!0,keyboardType:"decimal-pad",placeholder:"lb/ft\xb3"}),ye("Percent Voids",S,F,{required:!0,keyboardType:"decimal-pad",placeholder:"%"}),ye("Absorption",C,v,{required:!0,keyboardType:"decimal-pad",placeholder:"%"}),ye("Moisture Content",A,P,{keyboardType:"decimal-pad",placeholder:"%"}),ye("Maximum Size",T,E,{keyboardType:"decimal-pad",placeholder:"inches"})]})),je("Specific Gravity",(0,J.jsxs)(J.Fragment,{children:[ye("Bulk (SSD)",z,B,{required:!0,keyboardType:"decimal-pad",placeholder:"e.g., 2.65"}),ye("Bulk (Dry)",k,I,{required:!0,keyboardType:"decimal-pad",placeholder:"e.g., 2.62"}),ye("Apparent",L,R,{required:!0,keyboardType:"decimal-pad",placeholder:"e.g., 2.70"})]})),be.length>0&&(0,J.jsx)(n.default,{className:"mb-4",children:(0,J.jsx)(Ot,{warnings:be})}),je("Performance Properties",(0,J.jsxs)(J.Fragment,{children:[ye("LA Abrasion",V,G,{keyboardType:"decimal-pad",placeholder:"% (for coarse aggregates)"}),ye("Soundness",q,Y,{keyboardType:"decimal-pad",placeholder:"%"}),ye("Deleterious Materials",_,Q,{keyboardType:"decimal-pad",placeholder:"%"}),ye("Organic Impurities",X,K,{placeholder:"e.g., Pass, Fail, Light Straw"}),ye("Clay Lumps",ee,te,{keyboardType:"decimal-pad",placeholder:"%"})]})),je("Chemical Properties",(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700 mb-1",children:"ASR Reactivity"}),(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-2",children:[["Low","Moderate","High","Not Tested"].map(e=>(0,J.jsx)(o.default,{onPress:()=>se(e),className:"px-4 py-2 rounded-full border "+(ae===e?"bg-gray-800 border-gray-800":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-sm font-medium "+(ae===e?"text-white":"text-gray-700"),children:e})},e)),ae&&(0,J.jsx)(o.default,{onPress:()=>se(null),className:"px-4 py-2 rounded-full bg-gray-200",children:(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700",children:"Clear"})})]})]}),ye("Chloride Content",re,le,{keyboardType:"decimal-pad",placeholder:"%"}),ye("Sulfate Content",oe,ne,{keyboardType:"decimal-pad",placeholder:"%"})]})),je("Production & Admin",(0,J.jsxs)(J.Fragment,{children:[ye("Cost Per Ton",de,ie,{keyboardType:"decimal-pad",placeholder:"$"}),ye("Cost Per Cubic Yard",ce,ue,{keyboardType:"decimal-pad",placeholder:"$"}),ye("Last Test Date",me,xe,{placeholder:"YYYY-MM-DD or MM/DD/YYYY"}),ye("Certifications",fe,ge,{placeholder:"e.g., ASTM C33, AASHTO M6"}),(0,J.jsx)(Wt,{label:"Notes",value:he,onChangeText:pe,multiline:!0,enableVoiceInput:!0,placeholder:"Additional notes or comments",autoCapitalize:"sentences"})]})),(0,J.jsx)(o.default,{onPress:()=>{if(!u.trim())return void Te.default.alert("Required Field","Please enter an aggregate name");const t=e=>{const t=parseFloat(e);return isNaN(t)?void 0:t},s={name:u.trim(),type:p,finenessModulus:t(y),dryRoddedUnitWeight:t(N),percentVoids:t(S),absorption:t(C),moistureContent:t(A),maxSize:t(T),specificGravityBulkSSD:t(z),specificGravityBulkDry:t(k),specificGravityApparent:t(L),colorFamily:$,source:O.trim()||void 0,stockpileNumber:U.trim()||void 0,laAbrasion:t(V),soundness:t(q),deleteriousMaterials:t(_),organicImpurities:X.trim()||void 0,clayLumps:t(ee),asrReactivity:ae,chlorideContent:t(re),sulfateContent:t(oe),costPerTon:t(de),costPerYard:t(ce),lastTestDate:me.trim()||void 0,certifications:fe.trim()||void 0,notes:he.trim()||void 0};if(i)l(a,s);else{const e=Object.assign({},s,{id:Date.now().toString(),createdAt:Date.now(),updatedAt:Date.now()});r(e)}e.goBack()},className:"bg-blue-600 rounded-lg py-4 items-center active:bg-blue-700 mb-4",children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:i?"Update Aggregate":"Save Aggregate"})}),(0,J.jsx)(n.default,{className:"bg-blue-50 rounded-lg p-4 border border-blue-200 mb-8",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"information-circle",size:20,color:"#3b82f6"}),(0,J.jsx)(d.default,{className:"flex-1 text-xs text-blue-700 ml-2",children:"Incomplete aggregates can be saved and updated later. Required fields: Name, Type, Dry-Rodded Unit Weight, Percent Voids, Absorption, and all Specific Gravity values. Fine aggregates also require Fineness Modulus."})]})})]})})})},Ut=({navigation:e})=>{const{getAllAdmixes:t,searchAdmixes:a,isAdmixComplete:s}=L(),[r,l]=(0,f.useState)(""),[i,c]=(0,f.useState)("all"),[u,m]=(0,f.useState)("all"),p=r?a(r):t(),b=(0,f.useMemo)(()=>p.filter(e=>("all"===i||e.class===i)&&(!("complete"===u&&!s(e.id))&&("incomplete"!==u||!s(e.id)))),[p,i,u,s]),y=(0,f.useMemo)(()=>{const e=t();return{total:e.length,complete:e.filter(e=>s(e.id)).length,incomplete:e.filter(e=>!s(e.id)).length}},[t,s]),j={"Water Reducer":{bg:"bg-blue-100",text:"text-blue-700"},"High-Range Water Reducer":{bg:"bg-indigo-100",text:"text-indigo-700"},"Air Entrainer":{bg:"bg-cyan-100",text:"text-cyan-700"},Accelerator:{bg:"bg-red-100",text:"text-red-700"},Retarder:{bg:"bg-orange-100",text:"text-orange-700"},"Corrosion Inhibitor":{bg:"bg-yellow-100",text:"text-yellow-700"},"Shrinkage Reducer":{bg:"bg-green-100",text:"text-green-700"},"Viscosity Modifier":{bg:"bg-purple-100",text:"text-purple-700"},Other:{bg:"bg-gray-100",text:"text-gray-700"}};return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(n.default,{className:"bg-white p-4 border-b border-gray-200",children:(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-blue-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-blue-600",children:y.total}),(0,J.jsx)(d.default,{className:"text-xs text-blue-700",children:"Total"})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-green-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-green-600",children:y.complete}),(0,J.jsx)(d.default,{className:"text-xs text-green-700",children:"Complete"})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-orange-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-orange-600",children:y.incomplete}),(0,J.jsx)(d.default,{className:"text-xs text-orange-700",children:"Incomplete"})]})]})}),(0,J.jsxs)(n.default,{className:"bg-white p-4 border-b border-gray-200 gap-3",children:[(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-100 rounded-lg flex-row items-center px-3",children:[(0,J.jsx)(x.default,{name:"search",size:20,color:"#9ca3af"}),(0,J.jsx)(h.default,{value:r,onChangeText:l,placeholder:"Search admixes...",placeholderTextColor:"#9ca3af",cursorColor:"#000000",className:"flex-1 py-2 px-2 text-base"}),r.length>0&&(0,J.jsx)(o.default,{onPress:()=>l(""),children:(0,J.jsx)(x.default,{name:"close-circle",size:20,color:"#9ca3af"})})]}),(0,J.jsx)(o.default,{onPress:()=>{e.navigate("AdmixLibraryAddEdit",{})},className:"bg-blue-600 rounded-lg px-4 items-center justify-center active:bg-blue-700",children:(0,J.jsx)(x.default,{name:"add",size:24,color:"white"})})]}),(0,J.jsxs)(g.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>c("all"),className:"px-3 py-1.5 rounded-full "+("all"===i?"bg-gray-800":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("all"===i?"text-white":"text-gray-700"),children:"All Classes"})}),(0,J.jsx)(o.default,{onPress:()=>c("Water Reducer"),className:"px-3 py-1.5 rounded-full "+("Water Reducer"===i?"bg-blue-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("Water Reducer"===i?"text-white":"text-gray-700"),children:"WR"})}),(0,J.jsx)(o.default,{onPress:()=>c("High-Range Water Reducer"),className:"px-3 py-1.5 rounded-full "+("High-Range Water Reducer"===i?"bg-indigo-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("High-Range Water Reducer"===i?"text-white":"text-gray-700"),children:"HRWR"})}),(0,J.jsx)(o.default,{onPress:()=>c("Air Entrainer"),className:"px-3 py-1.5 rounded-full "+("Air Entrainer"===i?"bg-cyan-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("Air Entrainer"===i?"text-white":"text-gray-700"),children:"AE"})}),(0,J.jsx)(o.default,{onPress:()=>c("Accelerator"),className:"px-3 py-1.5 rounded-full "+("Accelerator"===i?"bg-red-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("Accelerator"===i?"text-white":"text-gray-700"),children:"Accel"})}),(0,J.jsx)(o.default,{onPress:()=>c("Retarder"),className:"px-3 py-1.5 rounded-full "+("Retarder"===i?"bg-orange-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("Retarder"===i?"text-white":"text-gray-700"),children:"Retard"})}),(0,J.jsx)(o.default,{onPress:()=>m("incomplete"===u?"all":"incomplete"),className:"px-3 py-1.5 rounded-full "+("incomplete"===u?"bg-orange-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("incomplete"===u?"text-white":"text-gray-700"),children:"Incomplete"})})]}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:[b.length," ",1===b.length?"admixture":"admixtures"]})]}),(0,J.jsx)(g.default,{className:"flex-1",children:0===b.length?(0,J.jsxs)(n.default,{className:"flex-1 items-center justify-center p-8 mt-20",children:[(0,J.jsx)(x.default,{name:"water-outline",size:64,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600 mt-4 text-center",children:0===p.length?"No admixtures yet":"No admixtures match your filters"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-2 text-center",children:0===p.length?"Tap + to add your first admixture":"Try adjusting your search or filters"})]}):(0,J.jsx)(n.default,{className:"p-4 gap-3",children:b.map(t=>{const a=s(t.id),r=j[t.class];return(0,J.jsxs)(o.default,{onPress:()=>(t=>{e.navigate("AdmixLibraryDetail",{admixId:t.id})})(t),className:"bg-white rounded-lg p-4 shadow-sm active:bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-row items-start justify-between mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800",children:t.name}),(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-0.5",children:t.manufacturer})]}),!a&&(0,J.jsx)(n.default,{className:"bg-orange-100 px-2 py-1 rounded",children:(0,J.jsx)(d.default,{className:"text-xs font-semibold text-orange-700",children:"INCOMPLETE"})})]}),(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-2 mt-2",children:[(0,J.jsx)(n.default,{className:`px-2 py-1 rounded ${r.bg}`,children:(0,J.jsx)(d.default,{className:`text-xs font-medium ${r.text}`,children:t.class})}),t.specificGravityDisplay&&(0,J.jsx)(n.default,{className:"px-2 py-1 rounded bg-gray-100",children:(0,J.jsxs)(d.default,{className:"text-xs font-medium text-gray-700",children:["SG: ",t.specificGravityDisplay]})}),void 0!==t.costPerGallon&&(0,J.jsx)(n.default,{className:"px-2 py-1 rounded bg-green-100",children:(0,J.jsxs)(d.default,{className:"text-xs font-medium text-green-700",children:["$",t.costPerGallon,"/gal"]})})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mt-3 pt-3 border-t border-gray-100",children:[(0,J.jsxs)(d.default,{className:"text-xs text-gray-500",children:["Updated ",new Date(t.updatedAt).toLocaleDateString()]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:16,color:"#9ca3af"})]})]},t.id)})})})]})};var Ht=a(79632),Vt=a(40484);const Gt=({navigation:e,route:t})=>{const{admixId:a}=t.params,{getAdmix:s,deleteAdmix:r,isAdmixComplete:l,toggleFavorite:i,duplicateAdmix:c,trackAccess:u}=L(),[m,h]=(0,f.useState)(null),b=s(a);if(f.useEffect(()=>{a&&u(a)},[a,u]),!b)return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50 items-center justify-center p-8",children:[(0,J.jsx)(x.default,{name:"alert-circle-outline",size:64,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600 mt-4 text-center",children:"Admixture not found"}),(0,J.jsx)(o.default,{onPress:()=>e.goBack(),className:"mt-6 bg-blue-600 rounded-lg px-6 py-3 active:bg-blue-700",children:(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Go Back"})})]});const y=l(a),j=async e=>{await Ht.default.canOpenURL(e)?await Ht.default.openURL(e):Te.default.alert("Error","Cannot open this URL")},N=(e,t,a)=>null===t||void 0===t?null:(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-0.5",children:e}),(0,J.jsxs)(d.default,{className:"text-base text-gray-900 font-medium",children:[t,a?` ${a}`:""]})]}),w=(e,t,a)=>a?null:(0,J.jsxs)(n.default,{className:"bg-white rounded-lg p-4 mb-3 shadow-sm",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-3",children:e}),t]}),S=!!(b.dosageRateRecommendations||b.costPerGallon||b.percentWater||b.notes),F=!(!b.technicalDataSheetUrl&&!b.safetyDataSheetUrl),C=!!(b.salesRepName||b.salesRepPhone||b.salesRepEmail);return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsxs)(g.default,{className:"flex-1",children:[(0,J.jsxs)(n.default,{className:"bg-white p-4 border-b border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-start justify-between mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-gray-900 mb-1",children:b.name}),(0,J.jsx)(d.default,{className:"text-base text-gray-600",children:b.manufacturer})]}),!y&&(0,J.jsx)(n.default,{className:"bg-orange-100 px-3 py-1.5 rounded-lg",children:(0,J.jsx)(d.default,{className:"text-xs font-semibold text-orange-700",children:"INCOMPLETE"})})]}),(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-2 mt-3",children:[(0,J.jsx)(n.default,{className:"px-3 py-1.5 rounded-full bg-blue-100",children:(0,J.jsx)(d.default,{className:"text-sm font-semibold text-blue-700",children:b.class})}),b.specificGravityDisplay&&(0,J.jsx)(n.default,{className:"px-3 py-1.5 rounded-full bg-gray-100",children:(0,J.jsxs)(d.default,{className:"text-sm font-semibold text-gray-700",children:["SG: ",b.specificGravityDisplay,b.specificGravityDisplay.includes("-")&&b.specificGravity&&(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:[" (avg: ",b.specificGravity.toFixed(3),")"]})]})})]}),!y&&(0,J.jsx)(n.default,{className:"mt-4 bg-orange-50 rounded-lg p-3 border border-orange-200",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"warning",size:18,color:"#c2410c"}),(0,J.jsx)(d.default,{className:"flex-1 text-xs text-orange-700 ml-2",children:"This admixture is missing required data. Tap Edit to complete the profile."})]})})]}),(0,J.jsxs)(n.default,{className:"p-4",children:[w("Product Information",(0,J.jsxs)(J.Fragment,{children:[b.dosageRateRecommendations&&(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-0.5",children:"Dosage Rate Recommendations"}),(0,J.jsx)(d.default,{className:"text-base text-gray-900",children:b.dosageRateRecommendations})]}),N("Cost Per Gallon",b.costPerGallon,"$"),N("Percent Water",b.percentWater,"%"),b.notes&&(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-0.5",children:"Notes"}),(0,J.jsx)(d.default,{className:"text-base text-gray-900",children:b.notes})]})]}),!S),w("Technical Documentation",(0,J.jsxs)(J.Fragment,{children:[b.technicalDataSheetUrl&&(0,J.jsxs)(o.default,{onPress:()=>j(b.technicalDataSheetUrl),className:"flex-row items-center justify-between bg-blue-50 rounded-lg p-3 mb-2 active:bg-blue-100",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center flex-1",children:[(0,J.jsx)(x.default,{name:"document-text",size:20,color:"#2563eb"}),(0,J.jsx)(d.default,{className:"text-blue-700 font-medium ml-2 flex-1",children:"Technical Data Sheet"})]}),(0,J.jsx)(x.default,{name:"open-outline",size:20,color:"#2563eb"})]}),b.safetyDataSheetUrl&&(0,J.jsxs)(o.default,{onPress:()=>j(b.safetyDataSheetUrl),className:"flex-row items-center justify-between bg-red-50 rounded-lg p-3 active:bg-red-100",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center flex-1",children:[(0,J.jsx)(x.default,{name:"shield-checkmark",size:20,color:"#dc2626"}),(0,J.jsx)(d.default,{className:"text-red-700 font-medium ml-2 flex-1",children:"Safety Data Sheet"})]}),(0,J.jsx)(x.default,{name:"open-outline",size:20,color:"#dc2626"})]})]}),!F),w("Sales Representative",(0,J.jsxs)(J.Fragment,{children:[N("Name",b.salesRepName),b.salesRepPhone&&(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-0.5",children:"Phone"}),(0,J.jsx)(o.default,{onPress:()=>{return e=b.salesRepPhone,void Ht.default.openURL(`tel:${e}`);var e},children:(0,J.jsx)(d.default,{className:"text-base text-blue-600 font-medium",children:b.salesRepPhone})})]}),b.salesRepEmail&&(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-0.5",children:"Email"}),(0,J.jsx)(o.default,{onPress:()=>{return e=b.salesRepEmail,void Ht.default.openURL(`mailto:${e}`);var e},children:(0,J.jsx)(d.default,{className:"text-base text-blue-600 font-medium",children:b.salesRepEmail})})]})]}),!C),b.photoUris&&b.photoUris.length>0&&(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-3",children:"Photos"}),(0,J.jsx)(g.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,className:"flex-row",contentContainerStyle:{gap:8},children:b.photoUris.map((e,t)=>(0,J.jsx)(o.default,{onPress:()=>h(t),className:"relative active:opacity-80",children:(0,J.jsx)(Vt.default,{source:{uri:e},className:"w-32 h-32 rounded-lg",resizeMode:"cover"})},t))})]}),(0,J.jsxs)(n.default,{className:"bg-gray-100 rounded-lg p-3 mt-2",children:[(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:["Created: ",new Date(b.createdAt).toLocaleDateString()," at ",new Date(b.createdAt).toLocaleTimeString()]}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-600 mt-1",children:["Last Updated: ",new Date(b.updatedAt).toLocaleDateString()," at ",new Date(b.updatedAt).toLocaleTimeString()]})]}),(0,J.jsxs)(n.default,{className:"gap-3 mt-6 mb-8",children:[(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsxs)(o.default,{onPress:()=>{e.navigate("AdmixLibraryAddEdit",{admixId:a})},className:"flex-1 bg-blue-600 rounded-lg py-4 items-center active:bg-blue-700 flex-row justify-center",children:[(0,J.jsx)(x.default,{name:"pencil",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Edit"})]}),(0,J.jsx)(o.default,{onPress:()=>{i(a)},className:"rounded-lg px-6 py-4 items-center flex-row "+(b.isFavorite?"bg-yellow-500 active:bg-yellow-600":"bg-gray-400 active:bg-gray-500"),children:(0,J.jsx)(x.default,{name:b.isFavorite?"star":"star-outline",size:20,color:"white"})})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsxs)(o.default,{onPress:async()=>{const t=await c(a);t&&Te.default.alert("Duplicate Created",`"${t.name}" has been created. Would you like to edit it now?`,[{text:"Not Now",style:"cancel"},{text:"Edit",onPress:()=>e.replace("AdmixLibraryAddEdit",{admixId:t.id})}])},className:"flex-1 bg-green-600 rounded-lg py-4 items-center active:bg-green-700 flex-row justify-center",children:[(0,J.jsx)(x.default,{name:"copy",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Duplicate"})]}),(0,J.jsx)(o.default,{onPress:()=>{Te.default.alert("Delete Admixture",`Are you sure you want to delete "${b.name}"? This action cannot be undone.`,[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:()=>{r(a),e.goBack()}}])},className:"bg-red-600 rounded-lg px-6 py-4 items-center active:bg-red-700 flex-row",children:(0,J.jsx)(x.default,{name:"trash",size:20,color:"white"})})]})]})]})]}),null!==m&&b.photoUris&&(0,J.jsx)(p.default,{visible:!0,animationType:"fade",transparent:!0,onRequestClose:()=>h(null),children:(0,J.jsxs)(n.default,{className:"flex-1 bg-black",children:[(0,J.jsx)(o.default,{onPress:()=>h(null),className:"absolute top-12 right-4 z-10 bg-black/50 rounded-full p-2",children:(0,J.jsx)(x.default,{name:"close",size:32,color:"white"})}),(0,J.jsx)(Vt.default,{source:{uri:b.photoUris[m]},className:"flex-1",resizeMode:"contain"}),(0,J.jsx)(n.default,{className:"absolute bottom-8 left-0 right-0 items-center",children:(0,J.jsxs)(d.default,{className:"text-white text-sm bg-black/50 px-4 py-2 rounded-full",children:[m+1," / ",b.photoUris.length]})})]})})]})},qt=e=>{const t=e.replace(/\D/g,"");return 0===t.length?"":t.length<=3?`(${t}`:t.length<=6?`(${t.slice(0,3)}) ${t.slice(3)}`:(t.length,`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`)},Yt=e=>{const t=e.trim();if(!t)return{display:"",calculated:void 0};const a=t.match(/^(\d+\.?\d*)\s*-\s*(\d+\.?\d*)$/);if(a){const e=parseFloat(a[1]),t=parseFloat(a[2]);if(!isNaN(e)&&!isNaN(t)){return{display:`${e}-${t}`,calculated:(e+t)/2}}}const s=parseFloat(t);return isNaN(s)?{display:t,calculated:void 0}:{display:t,calculated:s}};var _t=a(262);const Jt=({photoUris:e,onPhotosChange:t,maxPhotos:a=10})=>{const s=async()=>{if(e.length>=a)return void Te.default.alert("Limit Reached",`Maximum ${a} photos allowed.`);if(!await(async()=>{const{status:e}=await _t.requestMediaLibraryPermissionsAsync();return"granted"===e||(Te.default.alert("Permission Required","Please grant photo library access to add photos."),!1)})())return;const s=await _t.launchImageLibraryAsync({mediaTypes:["images"],allowsMultipleSelection:!0,quality:.8,selectionLimit:a-e.length});if(!s.canceled&&s.assets){const a=s.assets.map(e=>e.uri);t([...e,...a])}},r=async()=>{if(e.length>=a)return void Te.default.alert("Limit Reached",`Maximum ${a} photos allowed.`);const{status:s}=await _t.requestCameraPermissionsAsync();if("granted"!==s)return void Te.default.alert("Permission Required","Please grant camera access to take photos.");const r=await _t.launchCameraAsync({mediaTypes:["images"],quality:.8});!r.canceled&&r.assets&&r.assets[0]&&t([...e,r.assets[0].uri])};return(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-2",children:[(0,J.jsxs)(d.default,{className:"text-sm font-medium text-gray-700",children:["Photos (",e.length,"/",a,")"]}),e.length<a&&(0,J.jsxs)(o.default,{onPress:()=>{Te.default.alert("Add Photo","Choose a photo source",[{text:"Take Photo",onPress:r},{text:"Choose from Library",onPress:s},{text:"Cancel",style:"cancel"}])},className:"bg-blue-600 rounded-full px-3 py-1.5 flex-row items-center active:bg-blue-700",children:[(0,J.jsx)(x.default,{name:"camera",size:16,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-xs font-semibold ml-1",children:"Add Photo"})]})]}),0===e.length?(0,J.jsxs)(n.default,{className:"bg-gray-100 rounded-lg p-6 items-center justify-center border-2 border-dashed border-gray-300",children:[(0,J.jsx)(x.default,{name:"images-outline",size:40,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 mt-2",children:"No photos attached"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-1",children:'Tap "Add Photo" to attach images'})]}):(0,J.jsx)(g.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,className:"flex-row",contentContainerStyle:{gap:8},children:e.map((a,s)=>(0,J.jsxs)(n.default,{className:"relative",children:[(0,J.jsx)(Vt.default,{source:{uri:a},className:"w-24 h-24 rounded-lg",resizeMode:"cover"}),(0,J.jsx)(o.default,{onPress:()=>(a=>{const s=e.filter((e,t)=>t!==a);t(s)})(s),className:"absolute -top-2 -right-2 bg-red-600 rounded-full p-1 shadow-lg active:bg-red-700",children:(0,J.jsx)(x.default,{name:"close",size:16,color:"white"})})]},s))})]})},Qt=({navigation:e,route:t})=>{const{admixId:a}=t.params,{getAdmix:s,addAdmix:r,updateAdmix:l}=L(),{getAllContacts:i}=W(),c=!!a,u=c?s(a):void 0,[m,b]=(0,f.useState)(u?.name||""),[y,j]=(0,f.useState)(u?.manufacturer||""),[N,w]=(0,f.useState)(u?.class||"Water Reducer"),[S,F]=(0,f.useState)(u?.specificGravityDisplay||""),[C,v]=(0,f.useState)(u?.dosageRateRecommendations||""),[A,P]=(0,f.useState)(u?.costPerGallon?.toString()||""),[T,E]=(0,f.useState)(u?.percentWater?.toString()||""),[z,B]=(0,f.useState)(u?.technicalDataSheetUrl||""),[D,k]=(0,f.useState)(u?.safetyDataSheetUrl||""),[I,R]=(0,f.useState)(u?.salesRepName||""),[$,O]=(0,f.useState)(u?.salesRepPhone||""),[M,U]=(0,f.useState)(u?.salesRepEmail||""),[H,V]=(0,f.useState)(u?.notes||""),[G,q]=(0,f.useState)(u?.photoUris||[]),[Y,_]=(0,f.useState)(!1),[Q,X]=(0,f.useState)(!1),[K,ee]=(0,f.useState)(""),[te,ae]=(0,f.useState)(""),[se,re]=(0,f.useState)(""),[le,oe]=(0,f.useState)(""),[ne,de]=(0,f.useState)(""),[ie,ce]=(0,f.useState)(""),ue=(0,f.useMemo)(()=>{const e=e=>{const t=parseFloat(e);return isNaN(t)?void 0:t};return(e=>{const t=[];return void 0!==e.specificGravity&&(e.specificGravity<.8||e.specificGravity>2?t.push({field:"Specific Gravity",message:`Value ${e.specificGravity.toFixed(2)} is outside typical range (0.8-2.0). Please verify this is correct.`,severity:"warning"}):(e.specificGravity<1||e.specificGravity>1.5)&&t.push({field:"Specific Gravity",message:`Value ${e.specificGravity.toFixed(2)} is unusual but acceptable. Most admixtures are between 1.0-1.5.`,severity:"info"})),void 0!==e.costPerGallon&&(e.costPerGallon<0?t.push({field:"Cost Per Gallon",message:"Cost cannot be negative. Please check your entry.",severity:"warning"}):e.costPerGallon>100?t.push({field:"Cost Per Gallon",message:`$${e.costPerGallon.toFixed(2)} per gallon is unusually high. Please verify this is correct.`,severity:"warning"}):0===e.costPerGallon&&t.push({field:"Cost Per Gallon",message:"Cost is set to zero. Is this intentional?",severity:"info"})),void 0!==e.percentWater&&(e.percentWater<0||e.percentWater>100?t.push({field:"Percent Water",message:"Percentage must be between 0 and 100.",severity:"warning"}):e.percentWater>90&&t.push({field:"Percent Water",message:`${e.percentWater}% water content is very high. Please verify this is correct.`,severity:"info"})),t})({specificGravity:Yt(S).calculated,costPerGallon:e(A),percentWater:e(T)})},[S,A,T]),me=(e,t,a,s={})=>(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center mb-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700",children:e}),s?.required&&(0,J.jsx)(d.default,{className:"text-red-500 ml-1",children:"*"})]}),(0,J.jsx)(h.default,{value:t,onChangeText:a,placeholder:s?.placeholder,placeholderTextColor:"#9ca3af",cursorColor:"#000000",keyboardType:s?.keyboardType||"default",autoCapitalize:s?.autoCapitalize||"sentences",multiline:s?.multiline,numberOfLines:s?.multiline?6:1,selectTextOnFocus:!0,className:"bg-white border border-gray-300 rounded-lg px-3 py-2.5 text-base "+(s?.multiline?"min-h-[120px]":"")})]}),xe=(e,t,a)=>(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsxs)(n.default,{className:"mb-3",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900",children:e}),a&&(0,J.jsx)(d.default,{className:"text-xs text-gray-600 mt-0.5",children:a})]}),t]});return(0,J.jsxs)(Z.default,{className:"flex-1 bg-gray-50",behavior:void 0,keyboardVerticalOffset:90,children:[(0,J.jsx)(g.default,{className:"flex-1",keyboardShouldPersistTaps:"handled",children:(0,J.jsxs)(n.default,{className:"p-4",children:[xe("Basic Information",(0,J.jsxs)(J.Fragment,{children:[me("Name",m,b,{required:!0,placeholder:"e.g., Glenium 7500, WRDA 64"}),me("Manufacturer",y,j,{required:!0,placeholder:"e.g., BASF, GCP Applied Technologies"}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center mb-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700",children:"Class of Admixture"}),(0,J.jsx)(d.default,{className:"text-red-500 ml-1",children:"*"})]}),(0,J.jsx)(g.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,className:"flex-row gap-2",contentContainerStyle:{paddingBottom:4},children:["Water Reducer","High-Range Water Reducer","Air Entrainer","Accelerator","Retarder","Corrosion Inhibitor","Shrinkage Reducer","Viscosity Modifier","Other"].map(e=>(0,J.jsx)(o.default,{onPress:()=>w(e),className:"px-4 py-2.5 rounded-lg border "+(N===e?"bg-blue-600 border-blue-600":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-sm font-medium whitespace-nowrap "+(N===e?"text-white":"text-gray-700"),children:e})},e))})]}),me("Specific Gravity",S,e=>{const t=e.replace(/[^0-9.\-]/g,"");F(t)},{keyboardType:"default",placeholder:"e.g., 1.05 or 1.05-1.08"})]}),"Required fields marked with *"),xe("Product Information",(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Wt,{label:"Dosage Rate Recommendations",value:C,onChangeText:v,multiline:!0,enableVoiceInput:!0,placeholder:'Paste text from technical data sheet...\ne.g., "2-10 oz/cwt (130-650 mL/100 kg) of cementitious material"',autoCapitalize:"sentences"}),me("Cost Per Gallon",A,P,{keyboardType:"decimal-pad",placeholder:"$ per gallon"}),me("Percent Water",T,E,{keyboardType:"decimal-pad",placeholder:"% water content"})]}),"Optional product details"),ue.length>0&&(0,J.jsx)(n.default,{className:"mb-4",children:(0,J.jsx)(Ot,{warnings:ue})}),xe("Technical Documentation",(0,J.jsxs)(J.Fragment,{children:[me("Technical Data Sheet URL",z,B,{keyboardType:"url",placeholder:"https://...",autoCapitalize:"none"}),me("Safety Data Sheet URL",D,k,{keyboardType:"url",placeholder:"https://...",autoCapitalize:"none"})]}),"Links to product documentation"),xe("Sales Representative",(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(n.default,{className:"flex-row gap-2 mb-4",children:[(0,J.jsxs)(o.default,{onPress:()=>_(!0),className:"flex-1 bg-blue-50 border-2 border-blue-600 rounded-lg py-3 px-4 flex-row items-center justify-center active:bg-blue-100",children:[(0,J.jsx)(x.default,{name:"people",size:20,color:"#2563eb"}),(0,J.jsx)(d.default,{className:"text-blue-700 font-semibold ml-2",children:"Select Contact"})]}),(0,J.jsxs)(o.default,{onPress:()=>X(!0),className:"flex-1 bg-green-50 border-2 border-green-600 rounded-lg py-3 px-4 flex-row items-center justify-center active:bg-green-100",children:[(0,J.jsx)(x.default,{name:"person-add",size:20,color:"#16a34a"}),(0,J.jsx)(d.default,{className:"text-green-700 font-semibold ml-2",children:"Quick Add"})]})]}),me("Name",I,R,{placeholder:"e.g., John Smith"}),me("Phone",$,e=>{O(qt(e))},{keyboardType:"phone-pad",placeholder:"(555) 123-4567"}),me("Email",M,U,{keyboardType:"email-address",placeholder:"e.g., john.smith@company.com",autoCapitalize:"none"})]}),"Contact information for ordering or support"),xe("Additional Notes",(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(Wt,{label:"Notes",value:H,onChangeText:V,multiline:!0,enableVoiceInput:!0,placeholder:"Any additional information...",autoCapitalize:"sentences"})})),xe("Photo Attachments",(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(Jt,{photoUris:G,onPhotosChange:q,maxPhotos:10})}),"Attach product photos, labels, or documentation"),(0,J.jsx)(o.default,{onPress:()=>{const t=e=>{const t=parseFloat(e);return isNaN(t)?void 0:t},s=Yt(S),o={name:m.trim(),manufacturer:y.trim(),class:N,specificGravityDisplay:s.display||void 0,specificGravity:s.calculated,dosageRateRecommendations:C.trim()||void 0,costPerGallon:t(A),percentWater:t(T),technicalDataSheetUrl:z.trim()||void 0,safetyDataSheetUrl:D.trim()||void 0,salesRepName:I.trim()||void 0,salesRepPhone:$.trim()||void 0,salesRepEmail:M.trim()||void 0,notes:H.trim()||void 0,photoUris:G.length>0?G:void 0};if(c)l(a,o);else{const e=Object.assign({},o,{id:Date.now().toString(),createdAt:Date.now(),updatedAt:Date.now()});r(e)}e.goBack()},className:"bg-blue-600 rounded-lg py-4 items-center active:bg-blue-700 mb-4",children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:c?"Update Admixture":"Save Admixture"})}),(0,J.jsx)(n.default,{className:"bg-blue-50 rounded-lg p-4 border border-blue-200 mb-8",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"information-circle",size:20,color:"#3b82f6"}),(0,J.jsx)(d.default,{className:"flex-1 text-xs text-blue-700 ml-2",children:"Incomplete admixtures can be saved and updated later. Required fields: Name, Manufacturer, Class, and Specific Gravity. All other fields are optional."})]})})]})}),(0,J.jsx)(p.default,{visible:Y,animationType:"slide",presentationStyle:"pageSheet",onRequestClose:()=>_(!1),children:(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"bg-white p-4 border-b border-gray-200 flex-row items-center justify-between",children:[(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900",children:"Select Contact"}),(0,J.jsx)(o.default,{onPress:()=>_(!1),children:(0,J.jsx)(x.default,{name:"close",size:28,color:"#111827"})})]}),(0,J.jsx)(g.default,{className:"flex-1",children:0===i().length?(0,J.jsxs)(n.default,{className:"items-center justify-center p-8 mt-20",children:[(0,J.jsx)(x.default,{name:"people-outline",size:64,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600 mt-4 text-center",children:"No contacts yet"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-2 text-center",children:"Add contacts first to select them here"})]}):(0,J.jsx)(n.default,{className:"p-4 gap-3",children:i().map(e=>(0,J.jsxs)(o.default,{onPress:()=>(e=>{const{getContact:t}=W.getState(),a=t(e);a&&(R(a.name),O(a.phone||""),U(a.email||""),_(!1))})(e.id),className:"bg-white rounded-lg p-4 shadow-sm active:bg-gray-50",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800",children:e.name}),e.company&&(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-0.5",children:e.company}),e.role&&(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-0.5",children:e.role}),(e.phone||e.email)&&(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-3 mt-2 pt-2 border-t border-gray-100",children:[e.phone&&(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:e.phone}),e.email&&(0,J.jsx)(d.default,{className:"text-xs text-gray-600",children:e.email})]})]},e.id))})})]})}),(0,J.jsx)(p.default,{visible:Q,animationType:"slide",presentationStyle:"pageSheet",onRequestClose:()=>X(!1),children:(0,J.jsxs)(Z.default,{className:"flex-1 bg-gray-50",behavior:void 0,children:[(0,J.jsxs)(n.default,{className:"bg-white p-4 border-b border-gray-200 flex-row items-center justify-between",children:[(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900",children:"Quick Add Contact"}),(0,J.jsx)(o.default,{onPress:()=>X(!1),children:(0,J.jsx)(x.default,{name:"close",size:28,color:"#111827"})})]}),(0,J.jsx)(g.default,{className:"flex-1",keyboardShouldPersistTaps:"handled",children:(0,J.jsxs)(n.default,{className:"p-4",children:[me("Name",K,ee,{required:!0,placeholder:"e.g., John Smith"}),me("Company",te,ae,{placeholder:"e.g., BASF Construction Chemicals"}),me("Role",se,re,{placeholder:"e.g., Sales Representative"}),me("Phone",le,e=>{oe(qt(e))},{keyboardType:"phone-pad",placeholder:"(555) 123-4567"}),me("Email",ne,de,{keyboardType:"email-address",placeholder:"e.g., john.smith@company.com",autoCapitalize:"none"}),(0,J.jsx)(Wt,{label:"Notes",value:ie,onChangeText:ce,multiline:!0,enableVoiceInput:!0,placeholder:"Additional information...",autoCapitalize:"sentences"}),(0,J.jsx)(o.default,{onPress:()=>{const{addContact:e}=W.getState();if(!K.trim())return;const t={id:Date.now().toString(),name:K.trim(),company:te.trim()||void 0,role:se.trim()||void 0,phone:le.trim()||void 0,email:ne.trim()||void 0,notes:ie.trim()||void 0,createdAt:Date.now(),updatedAt:Date.now()};e(t),R(t.name),O(t.phone||""),U(t.email||""),ee(""),ae(""),re(""),oe(""),de(""),ce(""),X(!1)},disabled:!K.trim(),className:"rounded-lg py-4 items-center "+(K.trim()?"bg-green-600 active:bg-green-700":"bg-gray-300"),children:(0,J.jsx)(d.default,{className:"text-base font-semibold "+(K.trim()?"text-white":"text-gray-500"),children:"Add Contact & Use"})}),(0,J.jsx)(n.default,{className:"bg-blue-50 rounded-lg p-4 border border-blue-200 mt-4",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"information-circle",size:20,color:"#3b82f6"}),(0,J.jsx)(d.default,{className:"flex-1 text-xs text-blue-700 ml-2",children:"This will save the contact and automatically fill in the sales representative fields above."})]})})]})})]})})]})},Xt=({navigation:e})=>{const{getAllContacts:t,searchContacts:a,isContactComplete:s}=W(),[r,l]=(0,f.useState)(""),[i,c]=(0,f.useState)("all"),u=r?a(r):t(),m=(0,f.useMemo)(()=>u.filter(e=>!("complete"===i&&!s(e.id))&&("incomplete"!==i||!s(e.id))),[u,i,s]),p=(0,f.useMemo)(()=>{const e=t();return{total:e.length,complete:e.filter(e=>s(e.id)).length,incomplete:e.filter(e=>!s(e.id)).length}},[t,s]);return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(n.default,{className:"bg-white p-4 border-b border-gray-200",children:(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-blue-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-blue-600",children:p.total}),(0,J.jsx)(d.default,{className:"text-xs text-blue-700",children:"Total"})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-green-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-green-600",children:p.complete}),(0,J.jsx)(d.default,{className:"text-xs text-green-700",children:"Complete"})]}),(0,J.jsxs)(n.default,{className:"flex-1 bg-orange-50 rounded-lg p-3",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-orange-600",children:p.incomplete}),(0,J.jsx)(d.default,{className:"text-xs text-orange-700",children:"Incomplete"})]})]})}),(0,J.jsxs)(n.default,{className:"bg-white p-4 border-b border-gray-200 gap-3",children:[(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-100 rounded-lg flex-row items-center px-3",children:[(0,J.jsx)(x.default,{name:"search",size:20,color:"#9ca3af"}),(0,J.jsx)(h.default,{value:r,onChangeText:l,placeholder:"Search contacts...",placeholderTextColor:"#9ca3af",cursorColor:"#000000",className:"flex-1 py-2 px-2 text-base"}),r.length>0&&(0,J.jsx)(o.default,{onPress:()=>l(""),children:(0,J.jsx)(x.default,{name:"close-circle",size:20,color:"#9ca3af"})})]}),(0,J.jsx)(o.default,{onPress:()=>{e.navigate("ContactAddEdit",{})},className:"bg-blue-600 rounded-lg px-4 items-center justify-center active:bg-blue-700",children:(0,J.jsx)(x.default,{name:"add",size:24,color:"white"})})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>c("all"),className:"px-3 py-1.5 rounded-full "+("all"===i?"bg-gray-800":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("all"===i?"text-white":"text-gray-700"),children:"All"})}),(0,J.jsx)(o.default,{onPress:()=>c("incomplete"===i?"all":"incomplete"),className:"px-3 py-1.5 rounded-full "+("incomplete"===i?"bg-orange-600":"bg-gray-200"),children:(0,J.jsx)(d.default,{className:"text-xs font-medium "+("incomplete"===i?"text-white":"text-gray-700"),children:"Incomplete"})})]}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:[m.length," ",1===m.length?"contact":"contacts"]})]}),(0,J.jsx)(g.default,{className:"flex-1",children:0===m.length?(0,J.jsxs)(n.default,{className:"flex-1 items-center justify-center p-8 mt-20",children:[(0,J.jsx)(x.default,{name:"people-outline",size:64,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600 mt-4 text-center",children:0===u.length?"No contacts yet":"No contacts match your filters"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-2 text-center",children:0===u.length?"Tap + to add your first contact":"Try adjusting your search or filters"})]}):(0,J.jsx)(n.default,{className:"p-4 gap-3",children:m.map(t=>{const a=s(t.id);return(0,J.jsxs)(o.default,{onPress:()=>(t=>{e.navigate("ContactDetail",{contactId:t.id})})(t),className:"bg-white rounded-lg p-4 shadow-sm active:bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-row items-start justify-between mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-800",children:t.name}),t.company&&(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-0.5",children:t.company}),t.role&&(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-0.5",children:t.role})]}),!a&&(0,J.jsx)(n.default,{className:"bg-orange-100 px-2 py-1 rounded",children:(0,J.jsx)(d.default,{className:"text-xs font-semibold text-orange-700",children:"INCOMPLETE"})})]}),(t.phone||t.email)&&(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-3 mt-2 pt-2 border-t border-gray-100",children:[t.phone&&(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"call-outline",size:14,color:"#6b7280"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-600 ml-1",children:t.phone})]}),t.email&&(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"mail-outline",size:14,color:"#6b7280"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-600 ml-1",children:t.email})]})]}),(0,J.jsx)(n.default,{className:"flex-row items-center justify-end mt-2",children:(0,J.jsx)(x.default,{name:"chevron-forward",size:16,color:"#9ca3af"})})]},t.id)})})})]})},Kt=({navigation:e,route:t})=>{const{contactId:a}=t.params,{getContact:s,deleteContact:r,isContactComplete:l,toggleFavorite:i,duplicateContact:c,trackAccess:u}=W(),m=s(a);if(f.useEffect(()=>{a&&u(a)},[a,u]),!m)return(0,J.jsxs)(n.default,{className:"flex-1 bg-gray-50 items-center justify-center p-8",children:[(0,J.jsx)(x.default,{name:"alert-circle-outline",size:64,color:"#9ca3af"}),(0,J.jsx)(d.default,{className:"text-lg text-gray-600 mt-4 text-center",children:"Contact not found"}),(0,J.jsx)(o.default,{onPress:()=>e.goBack(),className:"mt-6 bg-blue-600 rounded-lg px-6 py-3 active:bg-blue-700",children:(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Go Back"})})]});const h=l(a);return(0,J.jsx)(n.default,{className:"flex-1 bg-gray-50",children:(0,J.jsxs)(g.default,{className:"flex-1",children:[(0,J.jsxs)(n.default,{className:"bg-white p-4 border-b border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-start justify-between mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-gray-900 mb-1",children:m.name}),m.company&&(0,J.jsx)(d.default,{className:"text-base text-gray-600",children:m.company}),m.role&&(0,J.jsx)(d.default,{className:"text-sm text-gray-500 mt-1",children:m.role})]}),!h&&(0,J.jsx)(n.default,{className:"bg-orange-100 px-3 py-1.5 rounded-lg",children:(0,J.jsx)(d.default,{className:"text-xs font-semibold text-orange-700",children:"INCOMPLETE"})})]}),!h&&(0,J.jsx)(n.default,{className:"mt-4 bg-orange-50 rounded-lg p-3 border border-orange-200",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"warning",size:18,color:"#c2410c"}),(0,J.jsx)(d.default,{className:"flex-1 text-xs text-orange-700 ml-2",children:"This contact is missing required data (phone and email). Tap Edit to complete the profile."})]})})]}),(0,J.jsxs)(n.default,{className:"p-4",children:[(0,J.jsxs)(n.default,{className:"bg-white rounded-lg p-4 mb-3 shadow-sm",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-3",children:"Contact Information"}),m.phone&&(0,J.jsxs)(o.default,{onPress:()=>{m.phone&&Ht.default.openURL(`tel:${m.phone}`)},className:"flex-row items-center justify-between bg-blue-50 rounded-lg p-3 mb-2 active:bg-blue-100",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center flex-1",children:[(0,J.jsx)(x.default,{name:"call",size:20,color:"#2563eb"}),(0,J.jsx)(d.default,{className:"text-blue-700 font-medium ml-3 flex-1",children:m.phone})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:20,color:"#2563eb"})]}),m.email&&(0,J.jsxs)(o.default,{onPress:()=>{m.email&&Ht.default.openURL(`mailto:${m.email}`)},className:"flex-row items-center justify-between bg-green-50 rounded-lg p-3 active:bg-green-100",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center flex-1",children:[(0,J.jsx)(x.default,{name:"mail",size:20,color:"#059669"}),(0,J.jsx)(d.default,{className:"text-green-700 font-medium ml-3 flex-1",children:m.email})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:20,color:"#059669"})]})]}),m.notes&&(0,J.jsxs)(n.default,{className:"bg-white rounded-lg p-4 mb-3 shadow-sm",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-3",children:"Notes"}),(0,J.jsx)(d.default,{className:"text-base text-gray-700",children:m.notes})]}),(0,J.jsxs)(n.default,{className:"bg-gray-100 rounded-lg p-3 mt-2",children:[(0,J.jsxs)(d.default,{className:"text-xs text-gray-600",children:["Created: ",new Date(m.createdAt).toLocaleDateString()," at ",new Date(m.createdAt).toLocaleTimeString()]}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-600 mt-1",children:["Last Updated: ",new Date(m.updatedAt).toLocaleDateString()," at ",new Date(m.updatedAt).toLocaleTimeString()]})]}),(0,J.jsxs)(n.default,{className:"gap-3 mt-6 mb-8",children:[(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsxs)(o.default,{onPress:()=>{e.navigate("ContactAddEdit",{contactId:a})},className:"flex-1 bg-blue-600 rounded-lg py-4 items-center active:bg-blue-700 flex-row justify-center",children:[(0,J.jsx)(x.default,{name:"pencil",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Edit"})]}),(0,J.jsx)(o.default,{onPress:()=>{i(a)},className:"rounded-lg px-6 py-4 items-center flex-row "+(m.isFavorite?"bg-yellow-500 active:bg-yellow-600":"bg-gray-400 active:bg-gray-500"),children:(0,J.jsx)(x.default,{name:m.isFavorite?"star":"star-outline",size:20,color:"white"})})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsxs)(o.default,{onPress:async()=>{const t=await c(a);t&&Te.default.alert("Duplicate Created",`"${t.name}" has been created. Would you like to edit it now?`,[{text:"Not Now",style:"cancel"},{text:"Edit",onPress:()=>e.replace("ContactAddEdit",{contactId:t.id})}])},className:"flex-1 bg-green-600 rounded-lg py-4 items-center active:bg-green-700 flex-row justify-center",children:[(0,J.jsx)(x.default,{name:"copy",size:20,color:"white"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold ml-2",children:"Duplicate"})]}),(0,J.jsx)(o.default,{onPress:()=>{Te.default.alert("Delete Contact",`Are you sure you want to delete "${m.name}"? This action cannot be undone.`,[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:()=>{r(a),e.goBack()}}])},className:"bg-red-600 rounded-lg px-6 py-4 items-center active:bg-red-700 flex-row",children:(0,J.jsx)(x.default,{name:"trash",size:20,color:"white"})})]})]})]})]})})},Zt=({navigation:e,route:t})=>{const{contactId:a}=t.params,{getContact:s,addContact:r,updateContact:l}=W(),i=!!a,c=i?s(a):void 0,[u,m]=(0,f.useState)(c?.name||""),[p,b]=(0,f.useState)(c?.company||""),[y,j]=(0,f.useState)(c?.role||""),[N,w]=(0,f.useState)(c?.phone||""),[S,F]=(0,f.useState)(c?.email||""),[C,v]=(0,f.useState)(c?.notes||""),A=(e,t,a,s={})=>(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center mb-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-medium text-gray-700",children:e}),s?.required&&(0,J.jsx)(d.default,{className:"text-red-500 ml-1",children:"*"})]}),(0,J.jsx)(h.default,{value:t,onChangeText:a,placeholder:s?.placeholder,placeholderTextColor:"#9ca3af",cursorColor:"#000000",keyboardType:s?.keyboardType||"default",autoCapitalize:s?.autoCapitalize||"sentences",multiline:s?.multiline,numberOfLines:s?.multiline?4:1,selectTextOnFocus:!0,className:"bg-white border border-gray-300 rounded-lg px-3 py-2.5 text-base "+(s?.multiline?"min-h-[80px]":"")})]});return(0,J.jsx)(Z.default,{className:"flex-1 bg-gray-50",behavior:void 0,keyboardVerticalOffset:90,children:(0,J.jsx)(g.default,{className:"flex-1",keyboardShouldPersistTaps:"handled",children:(0,J.jsxs)(n.default,{className:"p-4",children:[(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-3",children:"Basic Information"}),A("Name",u,m,{required:!0,placeholder:"e.g., John Smith",autoCapitalize:"words"}),A("Company",p,b,{placeholder:"e.g., BASF Corporation",autoCapitalize:"words"}),A("Role",y,j,{placeholder:"e.g., Admix Salesperson, Aggregate Supplier"})]}),(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-3",children:"Contact Information"}),A("Phone",N,e=>{w(qt(e))},{required:!0,keyboardType:"phone-pad",placeholder:"(555) 123-4567"}),A("Email",S,F,{required:!0,keyboardType:"email-address",placeholder:"john.smith@company.com",autoCapitalize:"none"})]}),(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-3",children:"Additional Notes"}),(0,J.jsx)(Wt,{label:"Notes",value:C,onChangeText:v,multiline:!0,enableVoiceInput:!0,placeholder:"Any additional information...",autoCapitalize:"sentences"})]}),(0,J.jsx)(o.default,{onPress:()=>{const t={name:u.trim(),company:p.trim()||void 0,role:y.trim()||void 0,phone:N.trim()||void 0,email:S.trim()||void 0,notes:C.trim()||void 0};if(i)l(a,t);else{const e=Object.assign({},t,{id:Date.now().toString(),createdAt:Date.now(),updatedAt:Date.now()});r(e)}e.goBack()},className:"bg-blue-600 rounded-lg py-4 items-center active:bg-blue-700 mb-4",children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:i?"Update Contact":"Save Contact"})}),(0,J.jsx)(n.default,{className:"bg-blue-50 rounded-lg p-4 border border-blue-200 mb-8",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"information-circle",size:20,color:"#3b82f6"}),(0,J.jsx)(d.default,{className:"flex-1 text-xs text-blue-700 ml-2",children:"Incomplete contacts can be saved and updated later. Required fields: Name, Phone, and Email. All other fields are optional."})]})})]})})})};var ea=a(61171);const ta=(0,y.create)()((0,O.persist)((e,t)=>({logs:[],issueCodes:[],departments:[],addLog:t=>{const a=`log-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,s=Object.assign({},t,{id:a,createdAt:Date.now(),updatedAt:Date.now()});return e(e=>({logs:[...e.logs,s]})),a},updateLog:(t,a)=>{e(e=>({logs:e.logs.map(e=>e.id===t?Object.assign({},e,a,{updatedAt:Date.now()}):e)}))},deleteLog:t=>{e(e=>({logs:e.logs.filter(e=>e.id!==t)}))},getLog:e=>t().logs.find(t=>t.id===e),getLogsByDepartment:e=>t().logs.filter(t=>t.department===e).sort((e,t)=>t.date-e.date),getLogsByDateRange:(e,a,s)=>t().logs.filter(t=>{const r=t.date>=e&&t.date<=a,l=!s||t.department===s;return r&&l}).sort((e,t)=>t.date-e.date),addIssueToLog:(t,a)=>{const s=`issue-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r=Object.assign({},a,{id:s,createdAt:Date.now(),updatedAt:Date.now()});e(e=>({logs:e.logs.map(e=>e.id===t?Object.assign({},e,{issues:[...e.issues||[],r],updatedAt:Date.now()}):e)}))},updateIssue:(t,a,s)=>{e(e=>({logs:e.logs.map(e=>e.id===t?Object.assign({},e,{issues:(e.issues||[]).map(e=>e.id===a?Object.assign({},e,s,{updatedAt:Date.now()}):e),updatedAt:Date.now()}):e)}))},deleteIssue:(t,a)=>{e(e=>({logs:e.logs.map(e=>e.id===t?Object.assign({},e,{issues:(e.issues||[]).filter(e=>e.id!==a),updatedAt:Date.now()}):e)}))},resolveIssue:(t,a,s,r)=>{e(e=>({logs:e.logs.map(e=>e.id===t?Object.assign({},e,{issues:(e.issues||[]).map(e=>e.id===a?Object.assign({},e,{status:"Resolved",resolvedBy:s,resolvedAt:Date.now(),actionTaken:r,updatedAt:Date.now()}):e),updatedAt:Date.now()}):e)}))},addProductionItem:(t,a)=>{const s=`item-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r=Object.assign({},a,{id:s});e(e=>({logs:e.logs.map(e=>e.id===t?Object.assign({},e,{productionItems:[...e.productionItems||[],r],updatedAt:Date.now()}):e)}))},updateProductionItem:(t,a,s)=>{e(e=>({logs:e.logs.map(e=>e.id===t?Object.assign({},e,{productionItems:(e.productionItems||[]).map(e=>e.id===a?Object.assign({},e,s):e),updatedAt:Date.now()}):e)}))},deleteProductionItem:(t,a)=>{e(e=>({logs:e.logs.map(e=>e.id===t?Object.assign({},e,{productionItems:(e.productionItems||[]).filter(e=>e.id!==a),updatedAt:Date.now()}):e)}))},addIssueCode:t=>{const a=`code-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,s=Object.assign({},t,{id:a,createdAt:Date.now(),updatedAt:Date.now()});e(e=>({issueCodes:[...e.issueCodes,s]}))},updateIssueCode:(t,a)=>{e(e=>({issueCodes:e.issueCodes.map(e=>e.id===t?Object.assign({},e,a,{updatedAt:Date.now()}):e)}))},deleteIssueCode:t=>{e(e=>({issueCodes:e.issueCodes.filter(e=>e.id!==t)}))},getIssueCodeByCode:e=>t().issueCodes.find(t=>t.code===e),getIssueCodesByDepartment:e=>e?t().issueCodes.filter(t=>!t.department||t.department===e):t().issueCodes,addDepartment:t=>{const a={id:`dept-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:t,isActive:!0,createdAt:Date.now(),updatedAt:Date.now()};e(e=>({departments:[...e.departments,a]}))},toggleDepartmentActive:t=>{e(e=>({departments:e.departments.map(e=>e.id===t?Object.assign({},e,{isActive:!e.isActive,updatedAt:Date.now()}):e)}))},getActiveDepartments:()=>t().departments.filter(e=>e.isActive),getMetrics:(e,a,s)=>{const r=t().getLogsByDateRange(a,s,e),l=r.length,o=r.flatMap(e=>e.issues||[]),n=o.length,d={Open:0,"In Progress":0,Resolved:0,Deferred:0,Rejected:0};o.forEach(e=>{e&&d[e.status]++});const i={Critical:0,Major:0,Minor:0,Observation:0};o.forEach(e=>{e&&i[e.severity]++});const c={};o.forEach(e=>{e&&e.issueCode&&(c[e.issueCode]||(c[e.issueCode]={title:e.issueTitle,count:0}),c[e.issueCode].count++)});const u=Object.entries(c).map(([e,t])=>({code:parseInt(e),title:t.title,count:t.count})).sort((e,t)=>t.count-e.count),m=l>0?n/l:0,x=i.Critical,f=n>0?d.Resolved/n*100:0;return{department:e,startDate:a,endDate:s,totalLogs:l,totalIssues:n,issuesByStatus:d,issuesBySeverity:i,issuesByCode:u,averageIssuesPerLog:m,criticalIssueCount:x,resolutionRate:f}},clearAllData:()=>{e({logs:[],issueCodes:[],departments:[]})},initializeDefaultData:()=>{const e=t();if(0===e.departments.length){["Flexicore","Wall Panels","Extruded","Precast"].forEach(t=>{e.addDepartment(t)})}if(0===e.issueCodes.length){[{code:101,title:"Concrete Segregation",severity:"Major",description:"Separation of coarse aggregates from concrete mix",applicableProducts:["Beams","Hollow Core Slabs","Solid Slabs","Stadia","Columns","Wall Panels","Stairs"]},{code:102,title:"Surface Defects",severity:"Minor",description:"Minor surface imperfections or blemishes",applicableProducts:["Beams","Hollow Core Slabs","Solid Slabs","Stadia","Columns","Wall Panels","Stairs"]},{code:103,title:"Honeycomb",severity:"Critical",description:"Voids in concrete due to incomplete consolidation",applicableProducts:["Beams","Hollow Core Slabs","Solid Slabs","Columns","Wall Panels"]},{code:201,title:"Dimensional Variance",severity:"Major",description:"Product dimensions outside tolerance",applicableProducts:["Beams","Hollow Core Slabs","Solid Slabs","Stadia","Columns","Wall Panels","Stairs"]},{code:202,title:"Cracking",severity:"Critical",description:"Structural or surface cracks in product",applicableProducts:["Beams","Hollow Core Slabs","Solid Slabs","Stadia","Columns","Wall Panels","Stairs"]},{code:203,title:"Spalling",severity:"Major",description:"Flaking or chipping of concrete surface",applicableProducts:["Beams","Hollow Core Slabs","Solid Slabs","Columns","Wall Panels"]},{code:301,title:"Color Variation",severity:"Minor",description:"Inconsistent coloring in finished product",applicableProducts:["Wall Panels"]},{code:302,title:"Embedded Items Misplaced",severity:"Major",description:"Inserts, anchors, or embeds not in correct position",applicableProducts:["Beams","Hollow Core Slabs","Solid Slabs","Columns","Wall Panels"]},{code:401,title:"Form Damage",severity:"Observation",description:"Mold or form showing signs of wear or damage",applicableProducts:["Beams","Hollow Core Slabs","Solid Slabs","Stadia","Columns","Wall Panels","Stairs"]},{code:402,title:"Release Agent Issue",severity:"Minor",description:"Problem with form release application",applicableProducts:["Beams","Hollow Core Slabs","Solid Slabs","Stadia","Columns","Wall Panels","Stairs"]}].forEach(t=>{e.addIssueCode(t)})}}}),{name:"quality-log-storage",storage:(0,O.createJSONStorage)(()=>F.default)}));function aa({navigation:e}){const t=ta(e=>e.initializeDefaultData),a=ta(e=>e.departments),s=ta(e=>e.logs),r=G(e=>e.currentUser),l="admin"===r?.role;(0,f.useEffect)(()=>{t()},[]);const i=a.filter(e=>e.isActive),c={Flexicore:{bg:"#DBEAFE",text:"#1E40AF",icon:"#3B82F6"},"Wall Panels":{bg:"#D1FAE5",text:"#065F46",icon:"#10B981"},Extruded:{bg:"#FEF3C7",text:"#92400E",icon:"#F59E0B"},Precast:{bg:"#E0E7FF",text:"#3730A3",icon:"#6366F1"}};return(0,J.jsx)(ea.SafeAreaView,{className:"flex-1 bg-gray-50",children:(0,J.jsx)(g.default,{className:"flex-1",children:(0,J.jsxs)(n.default,{className:"p-6",children:[(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-3xl font-bold text-gray-900",children:"Quality Logs"}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("QualityLogSearch"),className:"bg-blue-600 rounded-full p-2",children:(0,J.jsx)(x.default,{name:"search",size:24,color:"#FFFFFF"})})]}),(0,J.jsx)(d.default,{className:"text-base text-gray-600",children:"Track quality issues and metrics by department"})]}),(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-3",children:"Departments"}),0===i.length?(0,J.jsx)(n.default,{className:"bg-white rounded-2xl p-6 shadow-sm",children:(0,J.jsx)(d.default,{className:"text-gray-600 text-center",children:"No active departments. Contact admin to set up departments."})}):(0,J.jsx)(n.default,{className:"gap-3",children:i.map(t=>{const a=(e=>{const t=s.filter(t=>t.department===e),a=t.reduce((e,t)=>e+(t.issues?.length||0),0),r=t.reduce((e,t)=>e+(t.issues?.filter(e=>"Open"===e.status).length||0),0),l=t.reduce((e,t)=>e+(t.issues?.filter(e=>"Critical"===e.severity).length||0),0);return{totalLogs:t.length,totalIssues:a,openIssues:r,criticalIssues:l}})(t.name),r=c[t.name];return(0,J.jsxs)(o.default,{onPress:()=>e.navigate("QualityLogList",{department:t.name}),className:"bg-white rounded-2xl p-5 shadow-sm active:opacity-70",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-3",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-3",children:[(0,J.jsx)(n.default,{className:"rounded-full p-2",style:{backgroundColor:r.bg},children:(0,J.jsx)(x.default,{name:"business",size:24,color:r.icon})}),(0,J.jsx)(d.default,{className:"text-xl font-semibold",style:{color:r.text},children:t.name})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:24,color:"#9CA3AF"})]}),(0,J.jsxs)(n.default,{className:"flex-row gap-4 mt-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-gray-900",children:a.totalLogs}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:"Total Logs"})]}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-blue-600",children:a.totalIssues}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:"Issues"})]}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-orange-600",children:a.openIssues}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:"Open"})]}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-2xl font-bold text-red-600",children:a.criticalIssues}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:"Critical"})]})]})]},t.id)})})]}),(0,J.jsxs)(n.default,{className:"mb-6",children:[(0,J.jsx)(d.default,{className:"text-lg font-semibold text-gray-900 mb-3",children:"Quick Actions"}),(0,J.jsxs)(n.default,{className:"gap-3",children:[(0,J.jsxs)(o.default,{onPress:()=>e.navigate("QualityLogMetrics"),className:"bg-white rounded-2xl p-5 shadow-sm active:opacity-70 flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-3",children:[(0,J.jsx)(n.default,{className:"bg-purple-100 rounded-full p-2",children:(0,J.jsx)(x.default,{name:"stats-chart",size:24,color:"#9333EA"})}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-900",children:"View Metrics"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-500",children:"Analytics and trends"})]})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:24,color:"#9CA3AF"})]}),l&&(0,J.jsxs)(o.default,{onPress:()=>e.navigate("IssueCodeLibrary"),className:"bg-white rounded-2xl p-5 shadow-sm active:opacity-70 flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-3",children:[(0,J.jsx)(n.default,{className:"bg-indigo-100 rounded-full p-2",children:(0,J.jsx)(x.default,{name:"code-slash",size:24,color:"#4F46E5"})}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-900",children:"Issue Code Library"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-500",children:"Manage issue codes"})]})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:24,color:"#9CA3AF"})]})]})]})]})})})}var sa=a(92365);function ra({navigation:e,route:t}){const{department:a}=t.params,s=ta(e=>e.getLogsByDepartment),r=(ta(e=>e.deleteLog),s(a));return(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:(0,J.jsx)(g.default,{style:{flex:1},keyboardShouldPersistTaps:"handled",onScrollBeginDrag:()=>sa.default.dismiss(),children:(0,J.jsxs)(n.default,{style:{padding:24},children:[(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsxs)(d.default,{style:{fontSize:28,fontWeight:"700",color:"#111827",marginBottom:8},children:[a," Logs"]}),(0,J.jsxs)(d.default,{style:{fontSize:16,color:"#6B7280"},children:[r.length," ",1===r.length?"entry":"entries"]})]}),(0,J.jsxs)(o.default,{onPress:()=>e.navigate("QualityLogAddEdit",{department:a}),style:{backgroundColor:"#3B82F6",borderRadius:16,padding:16,flexDirection:"row",alignItems:"center",justifyContent:"center",marginBottom:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},children:[(0,J.jsx)(x.default,{name:"add-circle",size:24,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600",marginLeft:8},children:"Create New Log Entry"})]}),0===r.length?(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:16,padding:32,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:1},children:[(0,J.jsx)(x.default,{name:"document-text-outline",size:48,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827",marginTop:12},children:"No Log Entries Yet"}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:8,textAlign:"center"},children:"Create your first log entry to track quality issues and production data."})]}):(0,J.jsx)(n.default,{style:{gap:12},children:r.map(t=>{const a=(e=>{switch(e){case"Good":return{bg:"#D1FAE5",text:"#065F46"};case"Issues Found":return{bg:"#FED7AA",text:"#9A3412"};case"Critical Issues":return{bg:"#FEE2E2",text:"#991B1B"};default:return{bg:"#F3F4F6",text:"#374151"}}})(t.overallStatus),s=t.issues?.filter(e=>"Open"===e.status).length||0,r=t.issues?.filter(e=>"Critical"===e.severity).length||0;return(0,J.jsxs)(o.default,{onPress:()=>e.navigate("QualityLogDetail",{logId:t.id}),style:{backgroundColor:"#FFFFFF",borderRadius:16,padding:16,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:1},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:12},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:8,marginBottom:4},children:[(0,J.jsx)(x.default,{name:"calendar-outline",size:16,color:"#6B7280"}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#111827"},children:(l=t.date,new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}))})]}),(0,J.jsx)(n.default,{style:{backgroundColor:a.bg,alignSelf:"flex-start",paddingHorizontal:12,paddingVertical:4,borderRadius:12,marginTop:8},children:(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:a.text},children:t.overallStatus})})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:24,color:"#9CA3AF"})]}),t.productionItems&&t.productionItems.length>0&&(0,J.jsxs)(n.default,{style:{marginBottom:12},children:[(0,J.jsxs)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#6B7280",marginBottom:6},children:["Production: ",t.productionItems.length," ",1===t.productionItems.length?"item":"items"]}),(0,J.jsxs)(n.default,{style:{gap:4},children:[t.productionItems.slice(0,2).map(e=>(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:4},children:[(0,J.jsx)(n.default,{style:{width:4,height:4,borderRadius:2,backgroundColor:"#9CA3AF"}}),(0,J.jsxs)(d.default,{style:{fontSize:13,color:"#6B7280"},children:[e.jobName,e.pieceNumber?` - ${e.pieceNumber}`:""]})]},e.id)),t.productionItems.length>2&&(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#9CA3AF",marginTop:2},children:["+",t.productionItems.length-2," more"]})]})]}),t.issues&&t.issues.length>0&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:16,marginTop:8,paddingTop:12,borderTopWidth:1,borderTopColor:"#F3F4F6"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:4},children:[(0,J.jsx)(x.default,{name:"alert-circle-outline",size:16,color:"#6B7280"}),(0,J.jsxs)(d.default,{style:{fontSize:13,color:"#6B7280"},children:[t.issues.length," ",1===t.issues.length?"issue":"issues"]})]}),s>0&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:4},children:[(0,J.jsx)(x.default,{name:"time-outline",size:16,color:"#F59E0B"}),(0,J.jsxs)(d.default,{style:{fontSize:13,color:"#F59E0B",fontWeight:"600"},children:[s," open"]})]}),r>0&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:4},children:[(0,J.jsx)(x.default,{name:"warning",size:16,color:"#EF4444"}),(0,J.jsxs)(d.default,{style:{fontSize:13,color:"#EF4444",fontWeight:"600"},children:[r," critical"]})]})]})]},t.id);var l})})]})})})}function la({navigation:e,route:t}){const{logId:a}=t.params,s=ta(e=>e.getLog),r=ta(e=>e.deleteLog),[l,i]=(ta(e=>e.resolveIssue),(0,f.useState)(!1)),c=s(a);if(!c)return(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:(0,J.jsxs)(n.default,{style:{flex:1,alignItems:"center",justifyContent:"center",padding:24},children:[(0,J.jsx)(x.default,{name:"alert-circle-outline",size:64,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827",marginTop:16},children:"Log Not Found"}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:8,textAlign:"center"},children:"The quality log you are looking for does not exist."}),(0,J.jsx)(o.default,{onPress:()=>e.goBack(),style:{marginTop:24,backgroundColor:"#3B82F6",paddingHorizontal:24,paddingVertical:12,borderRadius:12},children:(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},children:"Go Back"})})]})});const u=e=>new Date(e).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),m=e=>new Date(e).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),h={Good:{bg:"#D1FAE5",text:"#065F46"},"Issues Found":{bg:"#FED7AA",text:"#9A3412"},"Critical Issues":{bg:"#FEE2E2",text:"#991B1B"}}[c.overallStatus]||{bg:"#F3F4F6",text:"#6B7280"};return(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:(0,J.jsx)(g.default,{style:{flex:1},children:(0,J.jsxs)(n.default,{style:{padding:24},children:[(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,J.jsx)(d.default,{style:{fontSize:28,fontWeight:"700",color:"#111827"},children:c.department}),(0,J.jsx)(o.default,{onPress:()=>{Te.default.alert("Delete Log Entry","Are you sure you want to delete this log entry? This action cannot be undone.",[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:()=>{r(a),e.goBack()}}])},style:{backgroundColor:"#FEE2E2",padding:8,borderRadius:8},children:(0,J.jsx)(x.default,{name:"trash-outline",size:20,color:"#991B1B"})})]}),(0,J.jsx)(d.default,{style:{fontSize:16,color:"#6B7280",marginBottom:12},children:u(c.date)}),(0,J.jsx)(n.default,{style:{backgroundColor:h.bg,alignSelf:"flex-start",paddingHorizontal:16,paddingVertical:8,borderRadius:12},children:(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:h.text},children:c.overallStatus})})]}),c.productionItems&&c.productionItems.length>0&&(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:"Production Items"}),(0,J.jsx)(n.default,{style:{backgroundColor:"#EFF6FF",paddingHorizontal:12,paddingVertical:4,borderRadius:12},children:(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#1E40AF"},children:c.productionItems.length})})]}),(0,J.jsx)(n.default,{style:{gap:12},children:c.productionItems.map(e=>(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:16,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:8,marginBottom:8},children:[(0,J.jsx)(x.default,{name:"cube-outline",size:20,color:"#3B82F6"}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#111827"},children:e.jobName})]}),e.jobNumber&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:16,marginTop:8},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:4},children:[(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:"Job #:"}),(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"500",color:"#111827"},children:e.jobNumber})]}),e.pieceNumber&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:4},children:[(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:"Piece:"}),(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"500",color:"#111827"},children:e.pieceNumber})]})]}),e.productType&&(0,J.jsx)(n.default,{style:{marginTop:8},children:(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#6B7280"},children:["Type: ",e.productType]})})]},e.id))})]}),(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:"Quality Issues"}),(0,J.jsx)(n.default,{style:{backgroundColor:0===(c.issues?.length??0)?"#D1FAE5":"#FED7AA",paddingHorizontal:12,paddingVertical:4,borderRadius:12},children:(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:0===(c.issues?.length??0)?"#065F46":"#9A3412"},children:c.issues?.length??0})})]}),0===(c.issues?.length??0)?(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:24,alignItems:"center",borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(x.default,{name:"checkmark-circle",size:48,color:"#10B981"}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#111827",marginTop:12},children:"No Issues Reported"}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:4},children:"All production items passed quality checks"})]}):(0,J.jsx)(n.default,{style:{gap:12},children:c.issues?.map(e=>{const t=(e=>{switch(e){case"Open":return{bg:"#FEF3C7",text:"#92400E"};case"In Progress":return{bg:"#DBEAFE",text:"#1E40AF"};case"Resolved":return{bg:"#D1FAE5",text:"#065F46"};case"Deferred":return{bg:"#E5E7EB",text:"#374151"};case"Rejected":return{bg:"#FEE2E2",text:"#991B1B"};default:return{bg:"#F3F4F6",text:"#6B7280"}}})(e.status),a=(e=>{switch(e){case"Critical":return{bg:"#FEE2E2",text:"#991B1B",icon:"#EF4444"};case"Major":return{bg:"#FED7AA",text:"#9A3412",icon:"#F97316"};case"Minor":return{bg:"#FEF3C7",text:"#92400E",icon:"#F59E0B"};case"Observation":return{bg:"#E0E7FF",text:"#3730A3",icon:"#6366F1"};default:return{bg:"#F3F4F6",text:"#6B7280",icon:"#9CA3AF"}}})(e.severity);return(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:16,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",marginBottom:12},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:8,marginBottom:4},children:[(0,J.jsx)(n.default,{style:{backgroundColor:a.bg,paddingHorizontal:8,paddingVertical:2,borderRadius:6},children:(0,J.jsx)(d.default,{style:{fontSize:11,fontWeight:"600",color:a.text},children:e.severity})}),(0,J.jsx)(n.default,{style:{backgroundColor:"#F3F4F6",paddingHorizontal:8,paddingVertical:2,borderRadius:6},children:(0,J.jsxs)(d.default,{style:{fontSize:11,fontWeight:"600",color:"#4B5563"},children:["#",e.issueCode]})})]}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#111827",marginTop:4},children:e.issueTitle})]}),(0,J.jsx)(n.default,{style:{backgroundColor:t.bg,paddingHorizontal:12,paddingVertical:6,borderRadius:8},children:(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:t.text},children:e.status})})]}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#4B5563",marginBottom:12,lineHeight:20},children:e.issueDescription}),e.location&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:6,marginBottom:8},children:[(0,J.jsx)(x.default,{name:"location-outline",size:16,color:"#6B7280"}),(0,J.jsx)(d.default,{style:{fontSize:13,color:"#6B7280"},children:e.location})]}),"Resolved"===e.status&&e.actionTaken&&(0,J.jsxs)(n.default,{style:{backgroundColor:"#F0FDF4",borderRadius:8,padding:12,marginTop:12,borderWidth:1,borderColor:"#BBF7D0"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:6,marginBottom:6},children:[(0,J.jsx)(x.default,{name:"checkmark-circle",size:16,color:"#16A34A"}),(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#16A34A"},children:"Resolved"})]}),(0,J.jsx)(d.default,{style:{fontSize:13,color:"#166534",marginBottom:4},children:e.actionTaken}),e.resolvedBy&&(0,J.jsxs)(d.default,{style:{fontSize:11,color:"#4D7C0F"},children:["By ",e.resolvedBy," \u2022 ",m(e.resolvedAt||e.updatedAt)]})]})]},e.id)})})]}),c.notes&&(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827",marginBottom:12},children:"Notes"}),(0,J.jsx)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:16,borderWidth:1,borderColor:"#E5E7EB"},children:(0,J.jsx)(d.default,{style:{fontSize:14,color:"#4B5563",lineHeight:20},children:c.notes})})]}),(0,J.jsxs)(n.default,{style:{paddingTop:16,borderTopWidth:1,borderTopColor:"#E5E7EB"},children:[(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#9CA3AF"},children:["Created by ",c.createdBy]}),(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#9CA3AF",marginTop:4},children:[u(c.createdAt)," at ",m(c.createdAt)]}),c.updatedAt!==c.createdAt&&(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#9CA3AF",marginTop:4},children:["Last updated: ",u(c.updatedAt)," at ",m(c.updatedAt)]})]})]})})})}function oa({navigation:e,route:t}){const{logId:a,department:s}=t.params||{},r=(0,i.useSafeAreaInsets)(),l=ta(e=>e.getLog),c=ta(e=>e.addLog),u=ta(e=>e.updateLog),m=ta(e=>e.getIssueCodesByDepartment),b=G(e=>e.currentUser),y=a?l(a):null,j=!!y,[N,w]=(0,f.useState)(y?.department||s||"Flexicore"),[S,F]=(0,f.useState)(y?.date||Date.now()),[C,v]=(0,f.useState)(y?.productionItems||[]),[A,P]=(0,f.useState)(y?.issues||[]),[T,E]=(0,f.useState)(y?.overallStatus||"Good"),[z,B]=(0,f.useState)(y?.notes||""),[D,k]=(0,f.useState)(!1),[I,L]=(0,f.useState)(!1),[R,$]=(0,f.useState)(!1),[W,O]=(0,f.useState)(""),[M,U]=(0,f.useState)(""),[H,V]=(0,f.useState)(""),[q,Y]=(0,f.useState)(""),[_,Q]=(0,f.useState)(""),[X,K]=(0,f.useState)(""),[Z,ee]=(0,f.useState)(""),[te,ae]=(0,f.useState)(""),[se,re]=(0,f.useState)("Open"),[le,oe]=(0,f.useState)("Minor"),[ne,de]=(0,f.useState)(""),ie=m(N),ce=()=>{b&&(j&&a?u(a,{department:N,date:S,productionItems:C,issues:A,overallStatus:T,notes:z||void 0}):c({department:N,date:S,productionItems:C,issues:A,overallStatus:T,notes:z||void 0,createdBy:b.email}),e.goBack())};return(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(g.default,{style:{flex:1},keyboardShouldPersistTaps:"handled",contentContainerStyle:{padding:24,paddingBottom:r.bottom+100},children:[(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Department"}),(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827"},children:N})]}),(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827"},children:"Production Items"}),(0,J.jsxs)(o.default,{onPress:()=>k(!0),style:{backgroundColor:"#3B82F6",flexDirection:"row",alignItems:"center",gap:6,paddingHorizontal:12,paddingVertical:8,borderRadius:8},children:[(0,J.jsx)(x.default,{name:"add",size:18,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:14,fontWeight:"600"},children:"Add Item"})]})]}),0===C.length?(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:24,alignItems:"center",borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(x.default,{name:"cube-outline",size:32,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:8},children:"No production items added yet"})]}):(0,J.jsx)(n.default,{style:{gap:8},children:C.map((e,t)=>(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:12,flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#111827"},children:e.jobName}),e.pieceNumber&&(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#6B7280",marginTop:2},children:["Piece: ",e.pieceNumber]})]}),(0,J.jsx)(o.default,{onPress:()=>v(C.filter((e,a)=>a!==t)),style:{backgroundColor:"#FEE2E2",padding:8,borderRadius:8},children:(0,J.jsx)(x.default,{name:"trash-outline",size:16,color:"#EF4444"})})]},e.id))})]}),(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827"},children:"Quality Issues"}),(0,J.jsxs)(o.default,{onPress:()=>L(!0),style:{backgroundColor:"#F59E0B",flexDirection:"row",alignItems:"center",gap:6,paddingHorizontal:12,paddingVertical:8,borderRadius:8},children:[(0,J.jsx)(x.default,{name:"add",size:18,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:14,fontWeight:"600"},children:"Add Issue"})]})]}),0===A.length?(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:24,alignItems:"center",borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(x.default,{name:"checkmark-circle-outline",size:32,color:"#10B981"}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:8},children:"No issues reported"})]}):(0,J.jsx)(n.default,{style:{gap:8},children:A.map((e,t)=>(0,J.jsx)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:12,borderWidth:1,borderColor:"#E5E7EB"},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",marginBottom:8},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:6,marginBottom:4},children:[(0,J.jsxs)(d.default,{style:{fontSize:11,fontWeight:"600",color:"#6B7280"},children:["#",e.issueCode]}),(0,J.jsx)(d.default,{style:{fontSize:11,fontWeight:"600",color:"#9333EA"},children:e.severity})]}),(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#111827",marginBottom:4},children:e.issueTitle}),(0,J.jsx)(d.default,{style:{fontSize:13,color:"#6B7280"},numberOfLines:2,children:e.issueDescription})]}),(0,J.jsx)(o.default,{onPress:()=>P(A.filter((e,a)=>a!==t)),style:{backgroundColor:"#FEE2E2",padding:8,borderRadius:8,marginLeft:8},children:(0,J.jsx)(x.default,{name:"trash-outline",size:16,color:"#EF4444"})})]})},e.id))})]}),(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Overall Status"}),(0,J.jsx)(n.default,{style:{flexDirection:"row",gap:12},children:["Good","Issues Found","Critical Issues"].map(e=>(0,J.jsx)(o.default,{onPress:()=>E(e),style:{flex:1,backgroundColor:T===e?"#3B82F6":"#FFFFFF",paddingVertical:12,borderRadius:12,alignItems:"center",borderWidth:1,borderColor:T===e?"#3B82F6":"#E5E7EB"},children:(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:T===e?"#FFFFFF":"#6B7280",textAlign:"center"},children:e})},e))})]}),(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Notes (Optional)"}),(0,J.jsx)(h.default,{value:z,onChangeText:B,placeholder:"Add any additional notes...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",multiline:!0,numberOfLines:4,textAlignVertical:"top",style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB",minHeight:100}})]})]}),(0,J.jsx)(n.default,{style:{position:"absolute",bottom:0,left:0,right:0,backgroundColor:"#FFFFFF",padding:16,paddingBottom:r.bottom+16,borderTopWidth:1,borderTopColor:"#E5E7EB"},children:(0,J.jsx)(o.default,{onPress:()=>{b?0!==C.length?ce():Te.default.alert("Warning","Are you sure you want to save without any production items?",[{text:"Cancel",style:"cancel"},{text:"Save Anyway",onPress:()=>ce()}]):Te.default.alert("Error","You must be logged in to create a log")},style:{backgroundColor:"#10B981",paddingVertical:16,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},children:j?"Update Log Entry":"Create Log Entry"})})}),(0,J.jsx)(p.default,{visible:D,animationType:"slide",transparent:!0,children:(0,J.jsx)(n.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"flex-end"},children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderTopLeftRadius:24,borderTopRightRadius:24,padding:24,paddingBottom:r.bottom+24},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:"Add Production Item"}),(0,J.jsx)(o.default,{onPress:()=>k(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsx)(g.default,{style:{maxHeight:400},keyboardShouldPersistTaps:"handled",children:(0,J.jsxs)(n.default,{style:{gap:16},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Job Name *"}),(0,J.jsx)(h.default,{value:W,onChangeText:O,placeholder:"Enter job name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Job Number"}),(0,J.jsx)(h.default,{value:M,onChangeText:U,placeholder:"Enter job number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Piece Number"}),(0,J.jsx)(h.default,{value:H,onChangeText:V,placeholder:"Enter piece number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Product Type"}),(0,J.jsx)(h.default,{value:q,onChangeText:Y,placeholder:"e.g., Hollow Core Slab, Wall Panel",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]})]})}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12,marginTop:24},children:[(0,J.jsx)(o.default,{onPress:()=>k(!1),style:{flex:1,backgroundColor:"#F3F4F6",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#6B7280",fontSize:16,fontWeight:"600"},children:"Cancel"})}),(0,J.jsx)(o.default,{onPress:()=>{if(!W.trim())return void Te.default.alert("Error","Please enter a job name");const e={id:`temp-${Date.now()}`,jobName:W,jobNumber:M||void 0,pieceNumber:H||void 0,productType:q||void 0,pourDate:S,department:N};v([...C,e]),O(""),U(""),V(""),Y(""),k(!1)},style:{flex:1,backgroundColor:"#3B82F6",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},children:"Add"})})]})]})})}),(0,J.jsx)(p.default,{visible:I,animationType:"slide",transparent:!0,children:(0,J.jsx)(n.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"flex-end"},children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderTopLeftRadius:24,borderTopRightRadius:24,padding:24,paddingBottom:r.bottom+24},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:"Add Quality Issue"}),(0,J.jsx)(o.default,{onPress:()=>L(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsx)(g.default,{style:{maxHeight:500},keyboardShouldPersistTaps:"handled",children:(0,J.jsxs)(n.default,{style:{gap:16},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Issue Code *"}),(0,J.jsxs)(o.default,{onPress:()=>$(!0),style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,borderWidth:1,borderColor:"#E5E7EB",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,J.jsx)(d.default,{style:{fontSize:14,color:X?"#111827":"#9CA3AF"},children:X?`#${X} - ${Z}`:"Select issue code"}),(0,J.jsx)(x.default,{name:"chevron-down",size:20,color:"#6B7280"})]})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Description *"}),(0,J.jsx)(h.default,{value:te,onChangeText:ae,placeholder:"Describe the quality issue in detail...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",multiline:!0,numberOfLines:4,textAlignVertical:"top",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB",minHeight:80}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Location"}),(0,J.jsx)(h.default,{value:ne,onChangeText:de,placeholder:"e.g., Bay 3, Line 2",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Severity"}),(0,J.jsx)(n.default,{style:{flexDirection:"row",gap:8},children:["Critical","Major","Minor","Observation"].map(e=>(0,J.jsx)(o.default,{onPress:()=>oe(e),style:{flex:1,backgroundColor:le===e?"#9333EA":"#F3F4F6",paddingVertical:10,borderRadius:8,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:11,fontWeight:"600",color:le===e?"#FFFFFF":"#6B7280"},children:e})},e))})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Status"}),(0,J.jsx)(n.default,{style:{flexDirection:"row",gap:8,flexWrap:"wrap"},children:["Open","In Progress","Resolved","Deferred"].map(e=>(0,J.jsx)(o.default,{onPress:()=>re(e),style:{backgroundColor:se===e?"#3B82F6":"#F3F4F6",paddingVertical:8,paddingHorizontal:12,borderRadius:8},children:(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:se===e?"#FFFFFF":"#6B7280"},children:e})},e))})]})]})}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12,marginTop:24},children:[(0,J.jsx)(o.default,{onPress:()=>L(!1),style:{flex:1,backgroundColor:"#F3F4F6",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#6B7280",fontSize:16,fontWeight:"600"},children:"Cancel"})}),(0,J.jsx)(o.default,{onPress:()=>{if(!X||!Z.trim()||!te.trim())return void Te.default.alert("Error","Please fill in all required fields");const e={issueCodeId:_||`code-${X}`,issueCode:Number(X),issueTitle:Z,issueDescription:te,status:se,severity:le,location:ne||void 0};P([...A,Object.assign({},e,{id:`temp-${Date.now()}`,createdAt:Date.now(),updatedAt:Date.now()})]),Q(""),K(""),ee(""),ae(""),re("Open"),oe("Minor"),de(""),L(!1),"Critical"===le?E("Critical Issues"):"Good"===T&&E("Issues Found")},style:{flex:1,backgroundColor:"#F59E0B",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},children:"Add Issue"})})]})]})})}),(0,J.jsx)(p.default,{visible:R,animationType:"slide",transparent:!0,children:(0,J.jsx)(n.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"flex-end"},children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderTopLeftRadius:24,borderTopRightRadius:24,padding:24,paddingBottom:r.bottom+24,maxHeight:"70%"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:"Select Issue Code"}),(0,J.jsx)(o.default,{onPress:()=>$(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsx)(g.default,{style:{flex:1},children:0===ie.length?(0,J.jsxs)(n.default,{style:{padding:32,alignItems:"center"},children:[(0,J.jsx)(x.default,{name:"alert-circle-outline",size:48,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:16,color:"#6B7280",marginTop:12,textAlign:"center"},children:"No issue codes available. Contact admin to add issue codes."})]}):(0,J.jsx)(n.default,{style:{gap:8},children:ie.map(e=>(0,J.jsxs)(o.default,{onPress:()=>(e=>{Q(e.id),K(e.code),ee(e.title),oe(e.severity),$(!1)})(e),style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:16,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[(0,J.jsxs)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#111827"},children:["#",e.code]}),(0,J.jsx)(n.default,{style:{backgroundColor:"Critical"===e.severity?"#FEE2E2":"Major"===e.severity?"#FED7AA":"Minor"===e.severity?"#FEF3C7":"#E0E7FF",paddingHorizontal:8,paddingVertical:4,borderRadius:6},children:(0,J.jsx)(d.default,{style:{fontSize:11,fontWeight:"600",color:"Critical"===e.severity?"#991B1B":"Major"===e.severity?"#9A3412":"Minor"===e.severity?"#92400E":"#3730A3"},children:e.severity})})]}),(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"500",color:"#111827",marginBottom:4},children:e.title}),(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},numberOfLines:2,children:e.description})]},e.id))})})]})})})]})})}function na({navigation:e}){const t=ta(e=>e.departments),a=ta(e=>e.logs),[s,r]=(ta(e=>e.getMetrics),(0,f.useState)(null)),l=(Date.now(),{totalLogs:a.length,totalIssues:a.reduce((e,t)=>e+(t.issues?.length??0),0),criticalIssues:a.reduce((e,t)=>e+(t.issues?.filter(e=>"Critical"===e.severity).length??0),0),openIssues:a.reduce((e,t)=>e+(t.issues?.filter(e=>"Open"===e.status).length??0),0)});return(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:(0,J.jsx)(g.default,{style:{flex:1},children:(0,J.jsxs)(n.default,{style:{padding:24},children:[(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:28,fontWeight:"700",color:"#111827",marginBottom:8},children:"Quality Metrics"}),(0,J.jsx)(d.default,{style:{fontSize:16,color:"#6B7280"},children:"Last 30 days"})]}),(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:16,padding:20,marginBottom:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},children:[(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827",marginBottom:16},children:"Overall Summary"}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",flexWrap:"wrap",gap:16},children:[(0,J.jsxs)(n.default,{style:{flex:1,minWidth:120},children:[(0,J.jsx)(d.default,{style:{fontSize:32,fontWeight:"700",color:"#3B82F6"},children:l.totalLogs}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:4},children:"Total Logs"})]}),(0,J.jsxs)(n.default,{style:{flex:1,minWidth:120},children:[(0,J.jsx)(d.default,{style:{fontSize:32,fontWeight:"700",color:"#F59E0B"},children:l.totalIssues}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:4},children:"Total Issues"})]}),(0,J.jsxs)(n.default,{style:{flex:1,minWidth:120},children:[(0,J.jsx)(d.default,{style:{fontSize:32,fontWeight:"700",color:"#EF4444"},children:l.criticalIssues}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:4},children:"Critical"})]}),(0,J.jsxs)(n.default,{style:{flex:1,minWidth:120},children:[(0,J.jsx)(d.default,{style:{fontSize:32,fontWeight:"700",color:"#8B5CF6"},children:l.openIssues}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:4},children:"Open Issues"})]})]})]}),(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827",marginBottom:16},children:"By Department"}),(0,J.jsx)(n.default,{style:{gap:12,marginBottom:24},children:t.filter(e=>e.isActive).map(e=>{const t=a.filter(t=>t.department===e.name),s=t.reduce((e,t)=>e+(t.issues?.length??0),0),r=t.reduce((e,t)=>e+(t.issues?.filter(e=>"Critical"===e.severity).length??0),0);return(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:16,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#111827",marginBottom:12},children:e.name}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:16},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:24,fontWeight:"700",color:"#3B82F6"},children:t.length}),(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:"Logs"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:24,fontWeight:"700",color:"#F59E0B"},children:s}),(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:"Issues"})]}),r>0&&(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:24,fontWeight:"700",color:"#EF4444"},children:r}),(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:"Critical"})]})]})]},e.id)})}),(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:16,padding:32,alignItems:"center",borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(x.default,{name:"bar-chart-outline",size:48,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#111827",marginTop:12},children:"Detailed Analytics"}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:8,textAlign:"center"},children:"Charts and trend analysis will be displayed here"})]})]})})})}function da({navigation:e}){const t=ta(e=>e.logs),[a,s]=(0,f.useState)(""),[r,l]=(0,f.useState)(""),[i,c]=(0,f.useState)(""),[u,m]=(0,f.useState)(""),[p,b]=(0,f.useState)(""),[y,j]=(0,f.useState)([]),[N,w]=(0,f.useState)(!1);return(0,J.jsxs)(ea.SafeAreaView,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(n.default,{className:"bg-white border-b border-gray-200 px-4 py-3",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-3",children:[(0,J.jsx)(o.default,{onPress:()=>e.goBack(),className:"p-2",children:(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#111827"})}),(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900 flex-1 ml-2",children:"Search Quality Logs"}),(0,J.jsx)(o.default,{onPress:()=>{s(""),l(""),c(""),m(""),b(""),j([]),w(!1)},className:"px-3 py-2",children:(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-600",children:"Clear"})})]})}),(0,J.jsxs)(g.default,{className:"flex-1",children:[(0,J.jsxs)(n.default,{className:"bg-white border-b border-gray-200 p-4 gap-4",children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Job Number"}),(0,J.jsx)(h.default,{value:a,onChangeText:s,placeholder:"Enter job number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"number-pad",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Job Name"}),(0,J.jsx)(h.default,{value:r,onChangeText:l,placeholder:"Enter job name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Mark Number"}),(0,J.jsx)(h.default,{value:i,onChangeText:c,placeholder:"e.g., M1, H105",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"ID Number"}),(0,J.jsx)(h.default,{value:u,onChangeText:m,placeholder:"Enter ID number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Issue Code"}),(0,J.jsx)(h.default,{value:p,onChangeText:b,placeholder:"Code number or title",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsx)(o.default,{onPress:()=>{if(!(a.trim()||r.trim()||i.trim()||u.trim()||p.trim()))return j([]),void w(!1);const e=[];t.forEach(t=>{let s=!1,l="";if(t.extrudedEntries&&t.extrudedEntries.length>0&&t.extrudedEntries.forEach(e=>{let t=!0;if(a.trim()){const s=a.trim().toLowerCase();e.jobNumber.toLowerCase().includes(s)?l="Job Number":t=!1}if(r.trim()&&t){const a=r.trim().toLowerCase();(e.jobName||"").toLowerCase().includes(a)?l="Job Name":t=!1}if(i.trim()&&t){const a=i.trim().toLowerCase();e.markNumber.toLowerCase().includes(a)?l="Mark Number":t=!1}if(u.trim()&&t){const a=u.trim().toLowerCase();e.idNumber.toLowerCase().includes(a)?l="ID Number":t=!1}if(p.trim()&&t){const a=p.trim().toLowerCase(),s=e.issueCode?.toString()||"",r=e.issueTitle||"";s.includes(a)||r.toLowerCase().includes(a)?l="Issue Code":t=!1}t&&!s&&(s=!0)}),!s&&t.productionItems&&t.productionItems.length>0&&t.productionItems.forEach(e=>{let t=!0;if(a.trim()){const s=a.trim().toLowerCase();(e.jobNumber||"").toLowerCase().includes(s)?l="Job Number":t=!1}if(r.trim()&&t){const a=r.trim().toLowerCase();e.jobName.toLowerCase().includes(a)?l="Job Name":t=!1}if(i.trim()&&t){const a=i.trim().toLowerCase();(e.markNumber||"").toLowerCase().includes(a)?l="Mark Number":t=!1}t&&!s&&(s=!0)}),!s&&p.trim()&&t.issues&&t.issues.length>0){const e=p.trim().toLowerCase();t.issues.forEach(t=>{const a=t.issueCode?.toString()||"",r=t.issueTitle||"";(a.includes(e)||r.toLowerCase().includes(e))&&(s=!0,l="Issue Code")})}s&&e.push({log:t,matchedField:l})}),e.sort((e,t)=>t.log.date-e.log.date),j(e),w(!0)},className:"bg-blue-600 rounded-lg py-3 items-center",children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Search"})})]}),N?0===y.length?(0,J.jsxs)(n.default,{className:"items-center justify-center p-8 mt-12",children:[(0,J.jsx)(x.default,{name:"document-text-outline",size:64,color:"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-base mt-4 text-center font-semibold",children:"No Matches Found"}),(0,J.jsx)(d.default,{className:"text-gray-400 text-sm mt-2 text-center px-4",children:"No quality logs match your search criteria"})]}):(0,J.jsxs)(n.default,{className:"p-4 gap-3",children:[(0,J.jsxs)(d.default,{className:"text-sm font-semibold text-gray-500 mb-1",children:["Found ",y.length," ",1===y.length?"result":"results"]}),y.map((t,a)=>{const s=(e=>{switch(e){case"Good":return{bg:"#D1FAE5",text:"#065F46"};case"Issues Found":return{bg:"#FED7AA",text:"#9A3412"};case"Critical Issues":return{bg:"#FEE2E2",text:"#991B1B"};default:return{bg:"#F3F4F6",text:"#374151"}}})(t.log.overallStatus),r=(e=>{switch(e){case"Flexicore":return{bg:"#DBEAFE",text:"#1E40AF"};case"Wall Panels":return{bg:"#D1FAE5",text:"#065F46"};case"Extruded":return{bg:"#FEF3C7",text:"#92400E"};case"Precast":return{bg:"#E0E7FF",text:"#3730A3"};default:return{bg:"#F3F4F6",text:"#6B7280"}}})(t.log.department),l=t.log.issues?.filter(e=>"Open"===e.status).length||0,i=t.log.issues?.filter(e=>"Critical"===e.severity).length||0;return(0,J.jsxs)(o.default,{onPress:()=>e.navigate("QualityLogDetail",{logId:t.log.id}),className:"bg-white rounded-xl p-4 border border-gray-200 active:bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-3",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2",children:[(0,J.jsx)(x.default,{name:"calendar-outline",size:16,color:"#6B7280"}),(0,J.jsx)(d.default,{className:"text-base font-bold text-gray-900",children:(c=t.log.date,new Date(c).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}))})]}),(0,J.jsx)(n.default,{style:{backgroundColor:r.bg},className:"px-3 py-1 rounded-full",children:(0,J.jsx)(d.default,{style:{color:r.text},className:"text-xs font-bold",children:t.log.department})})]}),(0,J.jsx)(n.default,{style:{backgroundColor:s.bg},className:"self-start px-3 py-1 rounded-full mb-3",children:(0,J.jsx)(d.default,{style:{color:s.text},className:"text-xs font-bold",children:t.log.overallStatus})}),t.matchedField&&(0,J.jsxs)(n.default,{className:"flex-row items-center mb-2",children:[(0,J.jsx)(x.default,{name:"checkmark-circle",size:14,color:"#10B981"}),(0,J.jsxs)(d.default,{className:"text-xs text-gray-600 ml-1",children:["Matched: ",t.matchedField]})]}),t.log.extrudedEntries&&t.log.extrudedEntries.length>0?(0,J.jsxs)(n.default,{className:"flex-row items-center mb-2",children:[(0,J.jsx)(x.default,{name:"cube-outline",size:14,color:"#6B7280"}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600 ml-2",children:[t.log.extrudedEntries.length," extruded ",1===t.log.extrudedEntries.length?"entry":"entries"]})]}):t.log.productionItems&&t.log.productionItems.length>0?(0,J.jsxs)(n.default,{className:"flex-row items-center mb-2",children:[(0,J.jsx)(x.default,{name:"cube-outline",size:14,color:"#6B7280"}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600 ml-2",children:[t.log.productionItems.length," production ",1===t.log.productionItems.length?"item":"items"]})]}):null,t.log.issues&&t.log.issues.length>0&&(0,J.jsxs)(n.default,{className:"flex-row gap-4 mt-3 pt-3 border-t border-gray-100",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-1",children:[(0,J.jsx)(x.default,{name:"alert-circle-outline",size:16,color:"#6B7280"}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600",children:[t.log.issues.length," ",1===t.log.issues.length?"issue":"issues"]})]}),l>0&&(0,J.jsxs)(n.default,{className:"flex-row items-center gap-1",children:[(0,J.jsx)(x.default,{name:"time-outline",size:16,color:"#F59E0B"}),(0,J.jsxs)(d.default,{className:"text-sm text-amber-600 font-semibold",children:[l," open"]})]}),i>0&&(0,J.jsxs)(n.default,{className:"flex-row items-center gap-1",children:[(0,J.jsx)(x.default,{name:"warning",size:16,color:"#EF4444"}),(0,J.jsxs)(d.default,{className:"text-sm text-red-600 font-semibold",children:[i," critical"]})]})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center justify-center mt-3 pt-3 border-t border-gray-100",children:[(0,J.jsx)(d.default,{className:"text-xs text-blue-600 font-medium",children:"Tap to view details"}),(0,J.jsx)(x.default,{name:"chevron-forward",size:14,color:"#3B82F6",style:{marginLeft:4}})]})]},`${t.log.id}-${a}`);var c})]}):(0,J.jsxs)(n.default,{className:"items-center justify-center p-8 mt-12",children:[(0,J.jsx)(x.default,{name:"search-outline",size:64,color:"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-base mt-4 text-center font-semibold",children:"Search Quality Logs"}),(0,J.jsx)(d.default,{className:"text-gray-400 text-sm mt-2 text-center px-4",children:"Fill in one or more fields above and tap Search to find quality log entries"})]})]})]})}function ia({navigation:e}){const t=(0,i.useSafeAreaInsets)(),a=ta(e=>e.issueCodes),s=ta(e=>e.addIssueCode),r=ta(e=>e.deleteIssueCode),l=ne(e=>e.products),[c,u]=(0,f.useState)(!1),[m,b]=(0,f.useState)(""),[y,j]=(0,f.useState)(""),[N,w]=(0,f.useState)(""),[S,F]=(0,f.useState)("Minor"),[C,v]=(0,f.useState)(),[A,P]=(0,f.useState)([]),T=e=>{s({code:e,title:y,description:N,severity:S,department:C,applicableProducts:A}),b(""),j(""),w(""),F("Minor"),v(void 0),P([]),u(!1)};return(0,J.jsxs)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:[(0,J.jsx)(g.default,{style:{flex:1},children:(0,J.jsxs)(n.default,{style:{padding:24},children:[(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:28,fontWeight:"700",color:"#111827",marginBottom:8},children:"Issue Code Library"}),(0,J.jsx)(d.default,{style:{fontSize:16,color:"#6B7280"},children:"Manage standard issue codes for quality logging"})]}),(0,J.jsxs)(o.default,{onPress:()=>u(!0),style:{backgroundColor:"#3B82F6",borderRadius:16,padding:16,flexDirection:"row",alignItems:"center",justifyContent:"center",marginBottom:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},children:[(0,J.jsx)(x.default,{name:"add-circle",size:24,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600",marginLeft:8},children:"Add Issue Code"})]}),0===a.length?(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:16,padding:32,alignItems:"center",borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(x.default,{name:"code-slash-outline",size:48,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827",marginTop:12},children:"No Issue Codes Yet"}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:8,textAlign:"center"},children:"Add your first issue code to start standardizing quality issue tracking."})]}):(0,J.jsx)(n.default,{style:{gap:12},children:a.sort((e,t)=>e.code-t.code).map(e=>{const t=(e=>{switch(e){case"Critical":return{bg:"#FEE2E2",text:"#991B1B"};case"Major":return{bg:"#FED7AA",text:"#9A3412"};case"Minor":return{bg:"#FEF3C7",text:"#92400E"};case"Observation":return{bg:"#E0E7FF",text:"#3730A3"}}})(e.severity);return(0,J.jsx)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:16,borderWidth:1,borderColor:"#E5E7EB"},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",marginBottom:12},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:8,marginBottom:6},children:[(0,J.jsx)(n.default,{style:{backgroundColor:"#F3F4F6",paddingHorizontal:12,paddingVertical:4,borderRadius:8},children:(0,J.jsxs)(d.default,{style:{fontSize:16,fontWeight:"700",color:"#111827"},children:["#",e.code]})}),(0,J.jsx)(n.default,{style:{backgroundColor:t.bg,paddingHorizontal:8,paddingVertical:4,borderRadius:6},children:(0,J.jsx)(d.default,{style:{fontSize:11,fontWeight:"600",color:t.text},children:e.severity})}),e.department&&(0,J.jsx)(n.default,{style:{backgroundColor:"#E0E7FF",paddingHorizontal:8,paddingVertical:4,borderRadius:6},children:(0,J.jsx)(d.default,{style:{fontSize:11,fontWeight:"600",color:"#3730A3"},children:e.department})})]}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#111827",marginBottom:6},children:e.title}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",lineHeight:20},children:e.description}),e.applicableProducts&&e.applicableProducts.length>0&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",marginTop:8,flexWrap:"wrap",gap:4},children:[(0,J.jsx)(x.default,{name:"cube-outline",size:14,color:"#6366F1"}),(0,J.jsx)(d.default,{style:{fontSize:13,color:"#6366F1",fontWeight:"500"},children:"Products:"}),e.applicableProducts.map((t,a)=>(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#6366F1"},children:[t,a<e.applicableProducts.length-1?",":""]},a))]})]}),(0,J.jsx)(o.default,{onPress:()=>{return t=e.id,void Te.default.alert("Delete Issue Code","Are you sure you want to delete this issue code?",[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:()=>r(t)}]);var t},style:{backgroundColor:"#FEE2E2",padding:8,borderRadius:8,marginLeft:8},children:(0,J.jsx)(x.default,{name:"trash-outline",size:16,color:"#EF4444"})})]})},e.id)})})]})}),(0,J.jsx)(p.default,{visible:c,animationType:"slide",transparent:!0,children:(0,J.jsx)(n.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"flex-end"},children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderTopLeftRadius:24,borderTopRightRadius:24,padding:24,paddingBottom:t.bottom+24},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:"Add Issue Code"}),(0,J.jsx)(o.default,{onPress:()=>u(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsx)(g.default,{style:{maxHeight:500},keyboardShouldPersistTaps:"handled",children:(0,J.jsxs)(n.default,{style:{gap:16},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Issue Code Number *"}),(0,J.jsx)(h.default,{value:m,onChangeText:b,placeholder:"e.g., 101",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"number-pad",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Title *"}),(0,J.jsx)(h.default,{value:y,onChangeText:j,placeholder:"e.g., Concrete Segregation",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Description *"}),(0,J.jsx)(h.default,{value:N,onChangeText:w,placeholder:"Describe the issue in detail...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",multiline:!0,numberOfLines:3,textAlignVertical:"top",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB",minHeight:80}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Severity *"}),(0,J.jsx)(n.default,{style:{flexDirection:"row",gap:8},children:["Critical","Major","Minor","Observation"].map(e=>(0,J.jsx)(o.default,{onPress:()=>F(e),style:{flex:1,backgroundColor:S===e?"#9333EA":"#F3F4F6",paddingVertical:10,borderRadius:8,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:11,fontWeight:"600",color:S===e?"#FFFFFF":"#6B7280"},children:e})},e))})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Department (Optional)"}),(0,J.jsx)(n.default,{style:{flexDirection:"row",gap:8,flexWrap:"wrap"},children:["Flexicore","Wall Panels","Extruded","Precast"].map(e=>(0,J.jsx)(o.default,{onPress:()=>v(C===e?void 0:e),style:{backgroundColor:C===e?"#3B82F6":"#F3F4F6",paddingVertical:8,paddingHorizontal:12,borderRadius:8},children:(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:C===e?"#FFFFFF":"#6B7280"},children:e})},e))}),(0,J.jsx)(d.default,{style:{fontSize:12,color:"#9CA3AF",marginTop:6},children:"Leave unselected for global availability"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Applicable Products"}),(0,J.jsx)(n.default,{style:{flexDirection:"row",flexWrap:"wrap",gap:8},children:l.map(e=>{const t=A.includes(e.name);return(0,J.jsx)(o.default,{onPress:()=>{P(t?A.filter(t=>t!==e.name):[...A,e.name])},style:{backgroundColor:t?"#6366F1":"#F3F4F6",paddingVertical:8,paddingHorizontal:12,borderRadius:8},children:(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:t?"#FFFFFF":"#6B7280"},children:e.name})},e.id)})}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginTop:8},children:[(0,J.jsx)(d.default,{style:{fontSize:12,color:"#9CA3AF"},children:"Select products this issue applies to"}),(0,J.jsxs)(o.default,{onPress:()=>e.navigate("ProductLibrary"),style:{flexDirection:"row",alignItems:"center",gap:4},children:[(0,J.jsx)(x.default,{name:"add-circle-outline",size:16,color:"#3B82F6"}),(0,J.jsx)(d.default,{style:{fontSize:12,color:"#3B82F6",fontWeight:"500"},children:"Manage Products"})]})]})]})]})}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12,marginTop:24},children:[(0,J.jsx)(o.default,{onPress:()=>u(!1),style:{flex:1,backgroundColor:"#F3F4F6",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#6B7280",fontSize:16,fontWeight:"600"},children:"Cancel"})}),(0,J.jsx)(o.default,{onPress:()=>{if(!m.trim()||!y.trim()||!N.trim())return void Te.default.alert("Error","Please fill in all required fields");const e=parseInt(m);isNaN(e)?Te.default.alert("Error","Issue code must be a number"):0!==A.length?T(e):Te.default.alert("Warning","No products selected. This issue code will not have tolerance references.",[{text:"Cancel",style:"cancel"},{text:"Save Anyway",onPress:()=>T(e)}])},style:{flex:1,backgroundColor:"#3B82F6",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},children:"Add Code"})})]})]})})})]})}function ca({navigation:e}){const t=(0,i.useSafeAreaInsets)(),a=ne(e=>e.products),s=ne(e=>e.initialize),r=ne(e=>e.addProduct),l=ne(e=>e.updateProduct),c=ne(e=>e.deleteProduct),u=ne(e=>e.addSubProduct),m=ne(e=>e.updateSubProduct),b=ne(e=>e.deleteSubProduct);(0,f.useEffect)(()=>{s()},[]);const[y,j]=(0,f.useState)(!1),[N,w]=(0,f.useState)(null),[S,F]=(0,f.useState)(null),[C,v]=(0,f.useState)(null),[A,P]=(0,f.useState)(!1),[T,E]=(0,f.useState)(null),[z,B]=(0,f.useState)(null),[D,k]=(0,f.useState)(""),[I,L]=(0,f.useState)(""),[R,$]=(0,f.useState)([]),[W,O]=(0,f.useState)(""),[M,U]=(0,f.useState)(""),[H,V]=(0,f.useState)(""),[G,q]=(0,f.useState)(""),[Y,_]=(0,f.useState)(""),[Q,X]=(0,f.useState)(null),[K,ee]=(0,f.useState)(""),[te,ae]=(0,f.useState)(""),[se,re]=(0,f.useState)(""),[le,oe]=(0,f.useState)("");(0,f.useEffect)(()=>{const e=parseFloat(Y);if(!isNaN(e)&&e>0){X(4*e)}else X(null)},[Y]);const[de,ie]=(0,f.useState)("Beams"),[ce,ue]=(0,f.useState)(""),[me,xe]=(0,f.useState)([]),[fe,ge]=(0,f.useState)(!1),[he,pe]=(0,f.useState)(null),[be,ye]=(0,f.useState)(""),[je,Ne]=(0,f.useState)(""),[we,Se]=(0,f.useState)(""),[Fe,Ce]=(0,f.useState)(""),ve=()=>{a.find(e=>e.name===de&&e.id!==N)?Te.default.alert("Error",`A product of type "${de}" already exists. Please edit the existing one.`):(N?l(N,{name:de,description:ce,tolerances:me}):r({name:de,description:ce,tolerances:me,isActive:!0}),Ae(),j(!1))},Ae=()=>{ie("Beams"),ue(""),xe([]),w(null)},Pe=e=>{B(e),k(""),L(""),$([]),O(""),U(""),V(""),q(""),_(""),X(null),ee(""),ae(""),re(""),oe(""),E(null),P(!0)};return(0,J.jsxs)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:[(0,J.jsx)(g.default,{style:{flex:1},children:(0,J.jsxs)(n.default,{style:{padding:24},children:[(0,J.jsxs)(n.default,{style:{marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:28,fontWeight:"700",color:"#111827",marginBottom:8},children:"Product Library"}),(0,J.jsx)(d.default,{style:{fontSize:16,color:"#6B7280"},children:"Manage product types and their tolerances"})]}),(0,J.jsxs)(o.default,{onPress:()=>{Ae(),j(!0)},style:{backgroundColor:"#3B82F6",borderRadius:16,padding:16,flexDirection:"row",alignItems:"center",justifyContent:"center",marginBottom:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},children:[(0,J.jsx)(x.default,{name:"add-circle",size:24,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600",marginLeft:8},children:"Add Product Type"})]}),0===a.length?(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:16,padding:32,alignItems:"center",borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(x.default,{name:"cube-outline",size:48,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827",marginTop:12},children:"No Products Yet"}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:8,textAlign:"center"},children:"Add your first product type to start tracking tolerances."})]}):(0,J.jsx)(n.default,{style:{gap:12},children:a.sort((e,t)=>e.name.localeCompare(t.name)).map(e=>{const t=S===e.id;return(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,borderWidth:1,borderColor:"#E5E7EB",overflow:"hidden"},children:[(0,J.jsx)(o.default,{onPress:()=>F(t?null:e.id),style:{padding:16},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827",marginBottom:4},children:e.name}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280"},children:e.description}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",marginTop:8,gap:6},children:[(0,J.jsx)(x.default,{name:"resize-outline",size:14,color:"#6366F1"}),(0,J.jsxs)(d.default,{style:{fontSize:13,color:"#6366F1",fontWeight:"500"},children:[e.tolerances.length," ",1===e.tolerances.length?"tolerance":"tolerances"]})]})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:8,alignItems:"center"},children:[(0,J.jsx)(o.default,{onPress:()=>(e=>{const t=a.find(t=>t.id===e);t&&(w(e),ie(t.name),ue(t.description||""),xe([...t.tolerances]),j(!0))})(e.id),style:{backgroundColor:"#EFF6FF",padding:8,borderRadius:8},children:(0,J.jsx)(x.default,{name:"pencil",size:16,color:"#3B82F6"})}),(0,J.jsx)(o.default,{onPress:()=>{return t=e.id,void Te.default.alert("Delete Product","Are you sure you want to delete this product? This action cannot be undone.",[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:()=>c(t)}]);var t},style:{backgroundColor:"#FEE2E2",padding:8,borderRadius:8},children:(0,J.jsx)(x.default,{name:"trash-outline",size:16,color:"#EF4444"})}),(0,J.jsx)(x.default,{name:t?"chevron-up":"chevron-down",size:20,color:"#6B7280"})]})]})}),t&&(0,J.jsxs)(n.default,{style:{padding:16,paddingTop:0},children:[e.subProducts&&e.subProducts.length>0&&(0,J.jsxs)(n.default,{style:{marginBottom:16,paddingTop:16,borderTopWidth:1,borderTopColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[(0,J.jsxs)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151"},children:["Sub-Products (",e.subProducts.length,"):"]}),(0,J.jsxs)(o.default,{onPress:()=>Pe(e.id),style:{backgroundColor:"#10B981",paddingHorizontal:10,paddingVertical:6,borderRadius:6,flexDirection:"row",alignItems:"center",gap:4},children:[(0,J.jsx)(x.default,{name:"add",size:16,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:12,fontWeight:"600"},children:"Add Sub-Product"})]})]}),(0,J.jsx)(n.default,{style:{gap:8},children:e.subProducts.map(t=>{const s=C===t.id;return(0,J.jsxs)(n.default,{style:{backgroundColor:"#F3F4F6",borderRadius:8,borderWidth:1,borderColor:"#D1D5DB",overflow:"hidden"},children:[(0,J.jsx)(o.default,{onPress:()=>v(s?null:t.id),style:{padding:12},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:"#111827",marginBottom:2},children:t.name}),t.description&&(0,J.jsx)(d.default,{style:{fontSize:13,color:"#6B7280"},children:t.description}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",marginTop:6,gap:8,flexWrap:"wrap"},children:[t.deadLoad&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:3},children:[(0,J.jsx)(x.default,{name:"scale-outline",size:12,color:"#8B5CF6"}),(0,J.jsxs)(d.default,{style:{fontSize:11,color:"#8B5CF6",fontWeight:"500"},children:["DL: ",t.deadLoad]})]}),t.fc28Day&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:3},children:[(0,J.jsx)(x.default,{name:"cube-outline",size:12,color:"#F59E0B"}),(0,J.jsxs)(d.default,{style:{fontSize:11,color:"#F59E0B",fontWeight:"500"},children:["f'c: ",t.fc28Day," psi"]})]}),t.fciRelease&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:3},children:[(0,J.jsx)(x.default,{name:"flash-outline",size:12,color:"#EF4444"}),(0,J.jsxs)(d.default,{style:{fontSize:11,color:"#EF4444",fontWeight:"500"},children:["f'ci: ",t.fciRelease," psi"]})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:3},children:[(0,J.jsx)(x.default,{name:"resize-outline",size:12,color:"#10B981"}),(0,J.jsxs)(d.default,{style:{fontSize:11,color:"#10B981",fontWeight:"500"},children:[t.tolerances.length," ",1===t.tolerances.length?"tolerance":"tolerances"]})]})]})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:6,alignItems:"center"},children:[(0,J.jsx)(o.default,{onPress:()=>((e,t)=>{const s=a.find(t=>t.id===e),r=s?.subProducts?.find(e=>e.id===t);r&&(B(e),E(t),k(r.name),L(r.description||""),$([...r.tolerances]),O(r.area?.toString()||""),U(r.effectiveWebWidth?.toString()||""),V(r.momentOfInertia?.toString()||""),q(r.distanceToBottomFiber?.toString()||""),_(r.deadLoad||""),X(r.deadLoadPerLinearFoot||null),ee(r.fc28Day?.toString()||""),ae(r.fciRelease?.toString()||""),re(r.fpu?.toString()||""),oe(r.crossSectionComponent||""),P(!0))})(e.id,t.id),style:{backgroundColor:"#DBEAFE",padding:6,borderRadius:6},children:(0,J.jsx)(x.default,{name:"pencil",size:14,color:"#2563EB"})}),(0,J.jsx)(o.default,{onPress:()=>{return a=e.id,s=t.id,void Te.default.alert("Delete Sub-Product","Are you sure you want to delete this sub-product?",[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:()=>b(a,s)}]);var a,s},style:{backgroundColor:"#FEE2E2",padding:6,borderRadius:6},children:(0,J.jsx)(x.default,{name:"trash-outline",size:14,color:"#DC2626"})}),(0,J.jsx)(x.default,{name:s?"chevron-up":"chevron-down",size:18,color:"#6B7280"})]})]})}),s&&(0,J.jsxs)(n.default,{style:{padding:12,paddingTop:0,borderTopWidth:1,borderTopColor:"#D1D5DB"},children:[t.crossSectionComponent&&(0,J.jsxs)(n.default,{style:{marginBottom:12,backgroundColor:"#F9FAFB",padding:12,borderRadius:6,alignItems:"center"},children:[(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#4B5563",marginBottom:8,textAlign:"center"},children:"Cross Section (Cores & Webs)"}),"8048"===t.name&&(0,J.jsx)(Le,{scale:4,showDimensions:!1}),"1048"===t.name&&(0,J.jsx)(Re,{scale:4,showDimensions:!1}),"1247"===t.name&&(0,J.jsx)($e,{scale:4,showDimensions:!1}),"1250"===t.name&&(0,J.jsx)(We,{scale:4,showDimensions:!1}),"1648"===t.name&&(0,J.jsx)(Oe,{scale:4,showDimensions:!1}),"1650"===t.name&&(0,J.jsx)(Me,{scale:4,showDimensions:!1})]}),(t.area||t.effectiveWebWidth||t.momentOfInertia||t.distanceToBottomFiber)&&(0,J.jsxs)(n.default,{style:{marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#4B5563",marginBottom:8},children:"Cross-Section Properties:"}),(0,J.jsxs)(n.default,{style:{gap:6},children:[t.area&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",backgroundColor:"#FFFFFF",padding:8,borderRadius:6},children:[(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:"A (Area):"}),(0,J.jsxs)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#10B981"},children:[t.area," in\xb2"]})]}),t.effectiveWebWidth&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",backgroundColor:"#FFFFFF",padding:8,borderRadius:6},children:[(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#6B7280"},children:["B",(0,J.jsx)(d.default,{style:{fontSize:9},children:"w"})," (Effective Web Width):"]}),(0,J.jsxs)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#10B981"},children:[t.effectiveWebWidth," in"]})]}),t.momentOfInertia&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",backgroundColor:"#FFFFFF",padding:8,borderRadius:6},children:[(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#6B7280"},children:["I",(0,J.jsx)(d.default,{style:{fontSize:9},children:"g"})," (Moment of Inertia):"]}),(0,J.jsxs)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#10B981"},children:[t.momentOfInertia," in\u2074"]})]}),t.distanceToBottomFiber&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",backgroundColor:"#FFFFFF",padding:8,borderRadius:6},children:[(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#6B7280"},children:["Y",(0,J.jsx)(d.default,{style:{fontSize:9},children:"b"})," (Distance to Bottom):"]}),(0,J.jsxs)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#10B981"},children:[t.distanceToBottomFiber," in"]})]})]})]}),(t.deadLoad||t.deadLoadPerLinearFoot||t.fc28Day||t.fciRelease||t.fpu)&&(0,J.jsxs)(n.default,{style:{marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#4B5563",marginBottom:8},children:"Strength Characteristics:"}),(0,J.jsxs)(n.default,{style:{gap:6},children:[t.deadLoad&&(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",padding:8,borderRadius:6},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between"},children:[(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:"Dead Load:"}),(0,J.jsxs)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#8B5CF6"},children:[t.deadLoad," psf"]})]}),t.deadLoadPerLinearFoot&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",marginTop:4},children:[(0,J.jsx)(d.default,{style:{fontSize:11,color:"#9CA3AF"},children:"Per Linear Foot:"}),(0,J.jsxs)(d.default,{style:{fontSize:11,fontWeight:"600",color:"#A78BFA"},children:[t.deadLoadPerLinearFoot.toFixed(1)," plf"]})]})]}),t.fc28Day&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",backgroundColor:"#FFFFFF",padding:8,borderRadius:6},children:[(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:"f'c (28-day):"}),(0,J.jsxs)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#F59E0B"},children:[t.fc28Day," psi"]})]}),t.fciRelease&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",backgroundColor:"#FFFFFF",padding:8,borderRadius:6},children:[(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:"f'ci (Release):"}),(0,J.jsxs)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#EF4444"},children:[t.fciRelease," psi"]})]}),t.fpu&&(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",backgroundColor:"#FFFFFF",padding:8,borderRadius:6},children:[(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#6B7280"},children:["f'",(0,J.jsx)(d.default,{style:{fontSize:9},children:"pu"})," (Strand Strength):"]}),(0,J.jsxs)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#EC4899"},children:[t.fpu," ksi"]})]})]})]}),(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#4B5563",marginBottom:8},children:"Tolerances:"}),0===t.tolerances.length?(0,J.jsx)(d.default,{style:{fontSize:12,color:"#9CA3AF",fontStyle:"italic"},children:"No tolerances defined"}):(0,J.jsx)(n.default,{style:{gap:6},children:t.tolerances.map((e,t)=>(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",padding:10,borderRadius:6,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between"},children:[(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#111827"},children:e.dimension}),(0,J.jsxs)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#10B981"},children:[e.min," to ",e.max]})]}),e.notes&&(0,J.jsx)(d.default,{style:{fontSize:11,color:"#6B7280",marginTop:4},children:e.notes})]},t))})]})]},t.id)})})]}),(!e.subProducts||0===e.subProducts.length)&&(0,J.jsx)(n.default,{style:{marginBottom:16,paddingTop:16,borderTopWidth:1,borderTopColor:"#E5E7EB"},children:(0,J.jsxs)(o.default,{onPress:()=>Pe(e.id),style:{backgroundColor:"#F0FDF4",padding:12,borderRadius:8,borderWidth:1,borderColor:"#86EFAC",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:6},children:[(0,J.jsx)(x.default,{name:"add-circle",size:18,color:"#10B981"}),(0,J.jsx)(d.default,{style:{color:"#10B981",fontSize:13,fontWeight:"600"},children:"Add Sub-Product Type"})]})}),(0,J.jsxs)(n.default,{style:{borderTopWidth:1,borderTopColor:"#E5E7EB",paddingTop:16},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:12},children:"Product Tolerances:"}),0===e.tolerances.length?(0,J.jsx)(d.default,{style:{fontSize:13,color:"#9CA3AF",fontStyle:"italic"},children:"No tolerances defined"}):(0,J.jsx)(n.default,{style:{gap:8},children:e.tolerances.map((e,t)=>(0,J.jsxs)(n.default,{style:{backgroundColor:"#F9FAFB",padding:12,borderRadius:8,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:4},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#111827"},children:e.dimension}),(0,J.jsxs)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#6366F1"},children:[e.min," to ",e.max]})]}),e.notes&&(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280",marginTop:4},children:e.notes})]},t))})]})]})]},e.id)})})]})}),(0,J.jsx)(p.default,{visible:y&&!fe,animationType:"slide",transparent:!0,children:(0,J.jsx)(Z.default,{behavior:void 0,style:{flex:1},keyboardVerticalOffset:0,children:(0,J.jsx)(o.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"flex-end"},onPress:sa.default.dismiss,children:(0,J.jsx)(o.default,{onPress:e=>e.stopPropagation(),children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderTopLeftRadius:24,borderTopRightRadius:24,padding:24,paddingBottom:t.bottom+24,maxHeight:"90%"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:N?"Edit Product":"Add Product Type"}),(0,J.jsx)(o.default,{onPress:()=>j(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsx)(g.default,{style:{maxHeight:500},keyboardShouldPersistTaps:"handled",children:(0,J.jsxs)(n.default,{style:{gap:16},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Product Type *"}),(0,J.jsx)(n.default,{style:{flexDirection:"row",flexWrap:"wrap",gap:8},children:["Beams","Hollow Core Slabs","Solid Slabs","Stadia","Columns","Wall Panels","Stairs"].map(e=>(0,J.jsx)(o.default,{onPress:()=>ie(e),style:{backgroundColor:de===e?"#3B82F6":"#F3F4F6",paddingVertical:8,paddingHorizontal:12,borderRadius:8},children:(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:de===e?"#FFFFFF":"#6B7280"},children:e})},e))})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Description *"}),(0,J.jsx)(h.default,{value:ce,onChangeText:ue,placeholder:"Brief description of this product type...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",multiline:!0,numberOfLines:2,textAlignVertical:"top",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB",minHeight:60}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151"},children:"Tolerances"}),(0,J.jsxs)(o.default,{onPress:()=>{ye(""),Ne(""),Se(""),Ce(""),pe(null),ge(!0)},style:{backgroundColor:"#10B981",paddingHorizontal:10,paddingVertical:6,borderRadius:6,flexDirection:"row",alignItems:"center",gap:4},children:[(0,J.jsx)(x.default,{name:"add",size:16,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:12,fontWeight:"600"},children:"Add"})]})]}),0===me.length?(0,J.jsx)(n.default,{style:{backgroundColor:"#F9FAFB",padding:16,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:"#E5E7EB"},children:(0,J.jsx)(d.default,{style:{fontSize:13,color:"#9CA3AF"},children:"No tolerances added yet"})}):(0,J.jsx)(n.default,{style:{gap:8},children:me.map((e,t)=>(0,J.jsx)(n.default,{style:{backgroundColor:"#F9FAFB",padding:12,borderRadius:8,borderWidth:1,borderColor:"#E5E7EB"},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#111827",marginBottom:2},children:[e.dimension,": ",e.min," to ",e.max]}),e.notes&&(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:e.notes})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:8},children:[(0,J.jsx)(o.default,{onPress:()=>(e=>{const t=me[e];ye(t.dimension),Ne(t.min),Se(t.max),Ce(t.notes||""),pe(e),ge(!0)})(t),style:{padding:4},children:(0,J.jsx)(x.default,{name:"pencil",size:16,color:"#3B82F6"})}),(0,J.jsx)(o.default,{onPress:()=>(e=>{xe(me.filter((t,a)=>a!==e))})(t),style:{padding:4},children:(0,J.jsx)(x.default,{name:"trash-outline",size:16,color:"#EF4444"})})]})]})},t))})]})]})}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12,marginTop:24},children:[(0,J.jsx)(o.default,{onPress:()=>j(!1),style:{flex:1,backgroundColor:"#F3F4F6",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#6B7280",fontSize:16,fontWeight:"600"},children:"Cancel"})}),(0,J.jsx)(o.default,{onPress:()=>{ce.trim()?0!==me.length?ve():Te.default.alert("Warning","Are you sure you want to save without any tolerances?",[{text:"Cancel",style:"cancel"},{text:"Save Anyway",onPress:()=>ve()}]):Te.default.alert("Error","Description is required")},style:{flex:1,backgroundColor:"#3B82F6",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},children:N?"Update":"Save"})})]})]})})})})}),(0,J.jsx)(p.default,{visible:fe,animationType:"slide",transparent:!0,children:(0,J.jsx)(Z.default,{behavior:void 0,style:{flex:1},keyboardVerticalOffset:0,children:(0,J.jsx)(o.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"flex-end"},onPress:sa.default.dismiss,children:(0,J.jsx)(o.default,{onPress:e=>e.stopPropagation(),children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderTopLeftRadius:24,borderTopRightRadius:24,padding:24,paddingBottom:t.bottom+24},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:null!==he?"Edit Tolerance":"Add Tolerance"}),(0,J.jsx)(o.default,{onPress:()=>ge(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsxs)(n.default,{style:{gap:16},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Dimension *"}),(0,J.jsx)(h.default,{value:be,onChangeText:ye,placeholder:"e.g., Length, Width, Thickness",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Min Value *"}),(0,J.jsx)(h.default,{value:je,onChangeText:Ne,placeholder:"e.g., -1/8, 0",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Max Value *"}),(0,J.jsx)(h.default,{value:we,onChangeText:Se,placeholder:"e.g., +1/8, +1/4",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Notes (Optional)"}),(0,J.jsx)(h.default,{value:Fe,onChangeText:Ce,placeholder:"Additional details...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",multiline:!0,numberOfLines:2,textAlignVertical:"top",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB",minHeight:60}})]})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12,marginTop:24},children:[(0,J.jsx)(o.default,{onPress:()=>ge(!1),style:{flex:1,backgroundColor:"#F3F4F6",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#6B7280",fontSize:16,fontWeight:"600"},children:"Cancel"})}),(0,J.jsx)(o.default,{onPress:()=>{if(!be.trim()||!je.trim()||!we.trim())return void Te.default.alert("Error","Dimension, min value, and max value are required");const e={dimension:be.trim(),min:je.trim(),max:we.trim(),notes:Fe.trim()||void 0};A?$(null!==he?R.map((t,a)=>a===he?e:t):[...R,e]):xe(null!==he?me.map((t,a)=>a===he?e:t):[...me,e]),ye(""),Ne(""),Se(""),Ce(""),pe(null),ge(!1)},style:{flex:1,backgroundColor:"#10B981",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},children:null!==he?"Update":"Add"})})]})]})})})})}),(0,J.jsx)(p.default,{visible:A&&!fe,animationType:"slide",transparent:!0,children:(0,J.jsx)(Z.default,{behavior:void 0,style:{flex:1},keyboardVerticalOffset:0,children:(0,J.jsx)(o.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"flex-end"},onPress:sa.default.dismiss,children:(0,J.jsx)(o.default,{onPress:e=>e.stopPropagation(),children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderTopLeftRadius:24,borderTopRightRadius:24,padding:24,paddingBottom:t.bottom+24,maxHeight:"90%"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:T?"Edit Sub-Product":"Add Sub-Product"}),(0,J.jsx)(o.default,{onPress:()=>P(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsx)(g.default,{style:{maxHeight:500},keyboardShouldPersistTaps:"handled",children:(0,J.jsxs)(n.default,{style:{gap:16},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Sub-Product Name *"}),(0,J.jsx)(h.default,{value:D,onChangeText:k,placeholder:"e.g., 8048, 1048, 1247, 1250",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Description"}),(0,J.jsx)(h.default,{value:I,onChangeText:L,placeholder:"Brief description...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",multiline:!0,numberOfLines:2,textAlignVertical:"top",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB",minHeight:60}})]}),(0,J.jsxs)(n.default,{style:{backgroundColor:"#F0FDF4",padding:12,borderRadius:12,borderWidth:1,borderColor:"#86EFAC"},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#065F46",marginBottom:12},children:"Cross-Section Properties"}),(0,J.jsxs)(n.default,{style:{marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151",marginBottom:4},children:"A - Area (in\xb2)"}),(0,J.jsx)(d.default,{style:{fontSize:11,color:"#6B7280",marginBottom:6},children:"Area of concrete in the cross-section"}),(0,J.jsx)(h.default,{value:W,onChangeText:O,placeholder:"e.g., 293, 373",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",keyboardType:"decimal-pad",style:{backgroundColor:"#FFFFFF",borderRadius:8,padding:10,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{style:{marginBottom:12},children:[(0,J.jsxs)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151",marginBottom:4},children:["B",(0,J.jsx)(d.default,{style:{fontSize:10},children:"w"})," - Effective Web Width (in)"]}),(0,J.jsx)(d.default,{style:{fontSize:11,color:"#6B7280",marginBottom:6},children:"Effective web width"}),(0,J.jsx)(h.default,{value:M,onChangeText:U,placeholder:"e.g., 24.5, 28.2",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",keyboardType:"decimal-pad",style:{backgroundColor:"#FFFFFF",borderRadius:8,padding:10,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{style:{marginBottom:12},children:[(0,J.jsxs)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151",marginBottom:4},children:["I",(0,J.jsx)(d.default,{style:{fontSize:10},children:"g"})," - Moment of Inertia (in\u2074)"]}),(0,J.jsx)(d.default,{style:{fontSize:11,color:"#6B7280",marginBottom:6},children:"Moment of inertia of the cross-section"}),(0,J.jsx)(h.default,{value:H,onChangeText:V,placeholder:"e.g., 5107, 10780",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",keyboardType:"decimal-pad",style:{backgroundColor:"#FFFFFF",borderRadius:8,padding:10,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsxs)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151",marginBottom:4},children:["Y",(0,J.jsx)(d.default,{style:{fontSize:10},children:"b"})," - Distance to Bottom Fiber (in)"]}),(0,J.jsx)(d.default,{style:{fontSize:11,color:"#6B7280",marginBottom:6},children:"Distance from neutral axis to extreme bottom fiber"}),(0,J.jsx)(h.default,{value:G,onChangeText:q,placeholder:"e.g., 4.0, 6.0",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",keyboardType:"decimal-pad",style:{backgroundColor:"#FFFFFF",borderRadius:8,padding:10,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]})]}),(0,J.jsxs)(n.default,{style:{backgroundColor:"#F0F9FF",padding:12,borderRadius:12,borderWidth:1,borderColor:"#BFDBFE"},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#1E40AF",marginBottom:12},children:"Strength Characteristics"}),(0,J.jsxs)(n.default,{style:{marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151",marginBottom:4},children:"Dead Load (psf)"}),(0,J.jsx)(d.default,{style:{fontSize:11,color:"#6B7280",marginBottom:6},children:"Pounds per square foot"}),(0,J.jsx)(h.default,{value:Y,onChangeText:_,placeholder:"e.g., 65, 80, 95",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",keyboardType:"decimal-pad",style:{backgroundColor:"#FFFFFF",borderRadius:8,padding:10,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}}),null!==Q&&(0,J.jsxs)(n.default,{style:{marginTop:8,backgroundColor:"#F0F9FF",padding:8,borderRadius:6,borderWidth:1,borderColor:"#BFDBFE"},children:[(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#1E40AF",fontWeight:"600"},children:["Per Linear Foot: ",Q.toFixed(1)," plf"]}),(0,J.jsx)(d.default,{style:{fontSize:10,color:"#6B7280",marginTop:2},children:"Based on 4 ft (48 in) width"})]})]}),(0,J.jsxs)(n.default,{style:{marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151",marginBottom:6},children:"f'c - 28-Day Strength (psi)"}),(0,J.jsx)(h.default,{value:K,onChangeText:ee,placeholder:"e.g., 5000, 6000",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",keyboardType:"numeric",style:{backgroundColor:"#FFFFFF",borderRadius:8,padding:10,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{style:{marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151",marginBottom:6},children:"f'ci - Release Strength (psi)"}),(0,J.jsx)(h.default,{value:te,onChangeText:ae,placeholder:"e.g., 3500, 4000",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",keyboardType:"numeric",style:{backgroundColor:"#FFFFFF",borderRadius:8,padding:10,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{style:{marginBottom:12},children:[(0,J.jsxs)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151",marginBottom:4},children:["f'",(0,J.jsx)(d.default,{style:{fontSize:10},children:"pu"})," - Ultimate Tensile Strength (ksi)"]}),(0,J.jsx)(d.default,{style:{fontSize:11,color:"#6B7280",marginBottom:6},children:"Ultimate tensile strength of the strand"}),(0,J.jsx)(h.default,{value:se,onChangeText:re,placeholder:"e.g., 270",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",selectionColor:"#3B82F6",keyboardType:"decimal-pad",style:{backgroundColor:"#FFFFFF",borderRadius:8,padding:10,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151"},children:"Tolerances"}),(0,J.jsxs)(o.default,{onPress:()=>{ye(""),Ne(""),Se(""),Ce(""),pe(null),ge(!0)},style:{backgroundColor:"#10B981",paddingHorizontal:10,paddingVertical:6,borderRadius:6,flexDirection:"row",alignItems:"center",gap:4},children:[(0,J.jsx)(x.default,{name:"add",size:16,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:12,fontWeight:"600"},children:"Add"})]})]}),0===R.length?(0,J.jsx)(n.default,{style:{backgroundColor:"#F9FAFB",padding:16,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:"#E5E7EB"},children:(0,J.jsx)(d.default,{style:{fontSize:13,color:"#9CA3AF"},children:"No tolerances added yet"})}):(0,J.jsx)(n.default,{style:{gap:8},children:R.map((e,t)=>(0,J.jsx)(n.default,{style:{backgroundColor:"#F9FAFB",padding:12,borderRadius:8,borderWidth:1,borderColor:"#E5E7EB"},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#111827",marginBottom:2},children:[e.dimension,": ",e.min," to ",e.max]}),e.notes&&(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:e.notes})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:8},children:[(0,J.jsx)(o.default,{onPress:()=>{ye(e.dimension),Ne(e.min),Se(e.max),Ce(e.notes||""),pe(t),ge(!0)},style:{padding:4},children:(0,J.jsx)(x.default,{name:"pencil",size:16,color:"#3B82F6"})}),(0,J.jsx)(o.default,{onPress:()=>$(R.filter((e,a)=>a!==t)),style:{padding:4},children:(0,J.jsx)(x.default,{name:"trash-outline",size:16,color:"#EF4444"})})]})]})},t))})]})]})}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12,marginTop:24},children:[(0,J.jsx)(o.default,{onPress:()=>P(!1),style:{flex:1,backgroundColor:"#F3F4F6",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#6B7280",fontSize:16,fontWeight:"600"},children:"Cancel"})}),(0,J.jsx)(o.default,{onPress:()=>{if(!z||!D.trim())return void Te.default.alert("Error","Sub-product name is required");const e={name:D,description:I,tolerances:R,area:W?parseFloat(W):void 0,effectiveWebWidth:M?parseFloat(M):void 0,momentOfInertia:H?parseFloat(H):void 0,distanceToBottomFiber:G?parseFloat(G):void 0,deadLoad:Y||void 0,deadLoadPerLinearFoot:Q||void 0,fc28Day:K?parseInt(K):void 0,fciRelease:te?parseInt(te):void 0,fpu:se?parseFloat(se):void 0,crossSectionComponent:le||void 0};T?m(z,T,e):u(z,Object.assign({},e,{isActive:!0})),P(!1),B(null),E(null),k(""),L(""),$([]),O(""),U(""),V(""),q(""),_(""),X(null),ee(""),ae(""),re(""),oe("")},style:{flex:1,backgroundColor:"#10B981",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},children:T?"Update":"Save"})})]})]})})})})})]})}function ua({navigation:e}){const t=fe(e=>e.projects),a=fe(e=>e.searchProjects),[s,r]=(0,f.useState)(""),l=s?a(s):t;return(0,J.jsxs)(ea.SafeAreaView,{className:"flex-1 bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between px-4 py-3 bg-white border-b border-gray-200",children:[(0,J.jsx)(o.default,{onPress:()=>e.goBack(),className:"p-2",children:(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#111827"})}),(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900",children:"Project Library"}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("ProjectLibraryAddEdit",{}),className:"p-2",children:(0,J.jsx)(x.default,{name:"add-circle",size:28,color:"#3B82F6"})})]}),(0,J.jsxs)(n.default,{className:"px-4 py-3 bg-white border-b border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center bg-gray-100 rounded-lg px-3 py-2 mb-3",children:[(0,J.jsx)(x.default,{name:"search",size:20,color:"#6B7280"}),(0,J.jsx)(h.default,{value:s,onChangeText:r,placeholder:"Search by job # or name...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"flex-1 ml-2 text-base text-gray-900"}),s.length>0&&(0,J.jsx)(o.default,{onPress:()=>r(""),children:(0,J.jsx)(x.default,{name:"close-circle",size:20,color:"#6B7280"})})]}),(0,J.jsxs)(o.default,{onPress:()=>e.navigate("ProjectLibraryExportImport"),className:"flex-row items-center justify-center bg-blue-50 border border-blue-200 rounded-lg py-2 px-3",children:[(0,J.jsx)(x.default,{name:"cloud-upload-outline",size:18,color:"#3B82F6"}),(0,J.jsx)(d.default,{className:"text-blue-600 text-sm font-semibold ml-2",children:"Export / Import"})]})]}),(0,J.jsx)(g.default,{className:"flex-1",children:0===l.length?(0,J.jsxs)(n.default,{className:"flex-1 items-center justify-center p-8 mt-12",children:[(0,J.jsx)(x.default,{name:"folder-open-outline",size:64,color:"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-base mt-4 text-center",children:s?"No projects found":"No projects yet"}),!s&&(0,J.jsx)(d.default,{className:"text-gray-400 text-sm mt-2 text-center",children:"Tap the + button to add your first project"})]}):(0,J.jsx)(n.default,{className:"p-4 gap-3",children:l.map(t=>{const a=(e=>e.pieceCountByType.reduce((e,t)=>e+t.count,0))(t);return(0,J.jsxs)(o.default,{onPress:()=>e.navigate("ProjectLibraryDetail",{projectId:t.id}),className:"bg-white rounded-xl p-4 border border-gray-200 active:bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-row justify-between items-start mb-2",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-base font-bold text-blue-600 mb-1",children:t.jobNumber}),(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-900",children:t.jobName})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:20,color:"#3B82F6"})]}),t.location&&(0,J.jsxs)(n.default,{className:"flex-row items-center mt-2",children:[(0,J.jsx)(x.default,{name:"location-outline",size:14,color:"#6B7280"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 ml-1",numberOfLines:1,children:t.location})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mt-3 pt-3 border-t border-gray-100",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"cube-outline",size:16,color:"#6B7280"}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600 ml-1",children:[a," ",1===a?"piece":"pieces"]})]}),t.projectManager&&(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"person-outline",size:16,color:"#6B7280"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 ml-1",children:t.projectManager})]})]})]},t.id)})})})]})}function ma({navigation:e,route:t}){const{projectId:a}=t.params,s=fe(e=>e.getProjectById),r=fe(e=>e.deleteProject),l=s(a);if(!l)return(0,J.jsx)(ea.SafeAreaView,{className:"flex-1 bg-gray-50 items-center justify-center",children:(0,J.jsx)(d.default,{className:"text-gray-500",children:"Project not found"})});const i=l.pieceCountByType.reduce((e,t)=>e+t.count,0);return(0,J.jsxs)(ea.SafeAreaView,{className:"flex-1 bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between px-4 py-3 bg-white border-b border-gray-200",children:[(0,J.jsx)(o.default,{onPress:()=>e.goBack(),className:"p-2",children:(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#111827"})}),(0,J.jsx)(d.default,{className:"text-lg font-bold text-gray-900",children:"Project Details"}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>e.navigate("ProjectLibraryAddEdit",{projectId:a}),className:"p-2",children:(0,J.jsx)(x.default,{name:"create-outline",size:24,color:"#3B82F6"})}),(0,J.jsx)(o.default,{onPress:()=>{Te.default.alert("Delete Project",`Are you sure you want to delete "${l.jobNumber} - ${l.jobName}"?`,[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:()=>{r(a),e.goBack()}}])},className:"p-2",children:(0,J.jsx)(x.default,{name:"trash-outline",size:24,color:"#EF4444"})})]})]}),(0,J.jsx)(g.default,{className:"flex-1",children:(0,J.jsxs)(n.default,{className:"p-4 gap-4",children:[(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-500 mb-2",children:"JOB INFORMATION"}),(0,J.jsxs)(n.default,{className:"gap-3",children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-1",children:"Job Number"}),(0,J.jsx)(d.default,{className:"text-lg font-bold text-blue-600",children:l.jobNumber})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mb-1",children:"Job Name"}),(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-900",children:l.jobName})]})]})]}),l.location&&(0,J.jsx)(o.default,{onPress:()=>{if(!l.location)return;const e=encodeURIComponent(l.location),t=`https://www.google.com/maps/search/?api=1&query=${e}`;Ht.default.canOpenURL(t).then(a=>{a?Ht.default.openURL(t):Ht.default.openURL(`https://www.google.com/maps/search/?api=1&query=${e}`)})},className:"bg-white rounded-xl p-4 border border-gray-200 active:bg-gray-50",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-500 mb-2",children:"LOCATION"}),(0,J.jsx)(d.default,{className:"text-base text-gray-900 mb-1",children:l.location}),(0,J.jsxs)(n.default,{className:"flex-row items-center mt-1",children:[(0,J.jsx)(x.default,{name:"map-outline",size:14,color:"#3B82F6"}),(0,J.jsx)(d.default,{className:"text-sm text-blue-600 ml-1 font-medium",children:"Open in Maps"})]})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:20,color:"#3B82F6"})]})}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-500 mb-3",children:"TEAM"}),(0,J.jsxs)(n.default,{className:"gap-3",children:[l.salesperson&&(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"w-24",children:(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:"Salesperson"})}),(0,J.jsx)(d.default,{className:"text-base text-gray-900 flex-1",children:l.salesperson})]}),l.projectManager&&(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"w-24",children:(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:"PM"})}),(0,J.jsx)(d.default,{className:"text-base text-gray-900 flex-1",children:l.projectManager})]}),l.assignedEngineer&&(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"w-24",children:(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:"Engineer"})}),(0,J.jsx)(d.default,{className:"text-base text-gray-900 flex-1",children:l.assignedEngineer})]}),l.assignedDrafter&&(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(n.default,{className:"w-24",children:(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:"Drafter"})}),(0,J.jsx)(d.default,{className:"text-base text-gray-900 flex-1",children:l.assignedDrafter})]}),!l.salesperson&&!l.projectManager&&!l.assignedEngineer&&!l.assignedDrafter&&(0,J.jsx)(d.default,{className:"text-gray-400 text-sm italic",children:"No team members assigned"})]})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-3",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-500",children:"PIECE COUNT"}),(0,J.jsx)(n.default,{className:"bg-blue-100 px-3 py-1 rounded-full",children:(0,J.jsxs)(d.default,{className:"text-base font-bold text-blue-700",children:[i," Total"]})})]}),l.pieceCountByType.length>0?(0,J.jsx)(n.default,{className:"gap-2",children:l.pieceCountByType.map((e,t)=>(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center flex-1",children:[(0,J.jsx)(x.default,{name:"cube-outline",size:16,color:"#6B7280"}),(0,J.jsx)(d.default,{className:"text-base text-gray-900 ml-2",children:e.productType})]}),(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-700",children:e.count})]},t))}):(0,J.jsx)(d.default,{className:"text-gray-400 text-sm italic",children:"No piece counts added"})]}),(0,J.jsxs)(n.default,{className:"bg-gray-100 rounded-xl p-3",children:[(0,J.jsxs)(d.default,{className:"text-xs text-gray-500",children:["Created ",new Date(l.createdAt).toLocaleDateString()," by ",l.createdBy]}),l.updatedAt!==l.createdAt&&(0,J.jsxs)(d.default,{className:"text-xs text-gray-500 mt-1",children:["Last updated ",new Date(l.updatedAt).toLocaleDateString()]})]})]})})]})}function xa(e){const t=e.replace(/\D/g,"");if(t.length>6){for(let e=0;e<=t.length-6;e++){const a=t.substring(e,e+6);if(a[1]===a[2])return a}return t.substring(0,6)}return t}function fa(e){if(!e||!e.trim())return{isValid:!1,error:"Job number is required"};const t=xa(e);if(6!==t.length)return{isValid:!1,error:`Job number must be exactly 6 digits (found ${t.length})`,cleaned:t};const a=t[1],s=t[2];return a!==s?{isValid:!1,error:`Invalid format: 2nd and 3rd digits must match (found ${a} and ${s})`,cleaned:t}:{isValid:!0,cleaned:t}}function ga({navigation:e,route:t}){const{projectId:a,prefilledJobNumber:s,prefilledJobName:r,returnScreen:l}=t.params,i=!!a,c=G(e=>e.currentUser),u=fe(e=>e.getProjectById),m=fe(e=>e.addProject),p=fe(e=>e.updateProject),b=a?u(a):null,[y,j]=(0,f.useState)(b?.jobNumber||s||""),[N,w]=(0,f.useState)(b?.jobName||r||""),[S,F]=(0,f.useState)(b?.location||""),[C,v]=(0,f.useState)(b?.salesperson||""),[A,P]=(0,f.useState)(b?.projectManager||""),[T,E]=(0,f.useState)(b?.assignedEngineer||""),[z,B]=(0,f.useState)(b?.assignedDrafter||""),[D,k]=(0,f.useState)(b?.pieceCountByType||[]),[I,L]=(0,f.useState)(""),[R,$]=(0,f.useState)(""),W=D.reduce((e,t)=>e+t.count,0);return(0,J.jsxs)(ea.SafeAreaView,{className:"flex-1 bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between px-4 py-3 bg-white border-b border-gray-200",children:[(0,J.jsx)(o.default,{onPress:()=>e.goBack(),className:"p-2",children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#111827"})}),(0,J.jsxs)(n.default,{className:"flex-1 items-center",children:[(0,J.jsx)(d.default,{className:"text-lg font-bold text-gray-900",children:i?"Edit Project":"New Project"}),"current"===l&&!i&&(0,J.jsx)(d.default,{className:"text-xs text-gray-500",children:"Creating from job entry"})]}),(0,J.jsx)(o.default,{onPress:()=>{if(!y.trim()||!N.trim())return void Te.default.alert("Required Fields","Job Number and Job Name are required.");const t=fa(y);if(!t.isValid)return void Te.default.alert("Invalid Job Number",`${t.error}\n\nJob number must be:\n\u2022 Exactly 6 digits\n\u2022 2nd and 3rd digits must match\n\nExample: 255096, 144523, 366789`,[{text:"OK"}]);if(!c)return void Te.default.alert("Error","You must be logged in");const s={jobNumber:t.cleaned||y.trim(),jobName:N.trim(),location:S.trim()||void 0,salesperson:C.trim()||void 0,projectManager:A.trim()||void 0,assignedEngineer:T.trim()||void 0,assignedDrafter:z.trim()||void 0,pieceCountByType:D,createdBy:c.email};i?p(a,s):m(s),e.goBack()},className:"p-2",children:(0,J.jsx)(d.default,{className:"text-base font-semibold text-blue-600",children:"Save"})})]}),(0,J.jsx)(Z.default,{behavior:"height",className:"flex-1",children:(0,J.jsx)(g.default,{className:"flex-1",keyboardShouldPersistTaps:"handled",children:(0,J.jsxs)(n.default,{className:"p-4 gap-4",children:["current"===l&&!i&&(0,J.jsx)(n.default,{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-2",children:(0,J.jsxs)(n.default,{className:"flex-row items-start",children:[(0,J.jsx)(x.default,{name:"information-circle",size:20,color:"#3B82F6",style:{marginRight:8,marginTop:2}}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-blue-900 mb-1",children:"Quick Project Creation"}),(0,J.jsx)(d.default,{className:"text-sm text-blue-700",children:"After saving, you'll return to your previous screen with the job information filled in."})]})]})}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-500 mb-3",children:"JOB INFORMATION"}),(0,J.jsxs)(n.default,{className:"gap-4",children:[(0,J.jsxs)(n.default,{children:[(0,J.jsxs)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:["Job Number ",(0,J.jsx)(d.default,{className:"text-red-500",children:"*"})]}),(0,J.jsx)(h.default,{value:y,onChangeText:j,placeholder:"6 digits (e.g., 255096)",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"number-pad",maxLength:10,className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"}),(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-1",children:"Format: 6 digits, 2nd and 3rd must match"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsxs)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:["Job Name ",(0,J.jsx)(d.default,{className:"text-red-500",children:"*"})]}),(0,J.jsx)(h.default,{value:N,onChangeText:w,placeholder:"Enter job name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Location"}),(0,J.jsx)(h.default,{value:S,onChangeText:F,placeholder:"Enter project address",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",multiline:!0,numberOfLines:2,className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]})]})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-500 mb-3",children:"TEAM"}),(0,J.jsxs)(n.default,{className:"gap-4",children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Salesperson"}),(0,J.jsx)(h.default,{value:C,onChangeText:v,placeholder:"Enter salesperson name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Project Manager"}),(0,J.jsx)(h.default,{value:A,onChangeText:P,placeholder:"Enter PM name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Assigned Engineer"}),(0,J.jsx)(h.default,{value:T,onChangeText:E,placeholder:"Enter engineer name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Assigned Drafter"}),(0,J.jsx)(h.default,{value:z,onChangeText:B,placeholder:"Enter drafter name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]})]})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-3",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-500",children:"PIECE COUNT BY TYPE"}),W>0&&(0,J.jsx)(n.default,{className:"bg-blue-100 px-2 py-1 rounded",children:(0,J.jsxs)(d.default,{className:"text-xs font-bold text-blue-700",children:[W," Total"]})})]}),D.length>0&&(0,J.jsx)(n.default,{className:"gap-2 mb-4",children:D.map((e,t)=>(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between bg-gray-50 rounded-lg p-3",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-base font-medium text-gray-900",children:e.productType}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600",children:[e.count," pieces"]})]}),(0,J.jsx)(o.default,{onPress:()=>(e=>{k(D.filter((t,a)=>a!==e))})(t),className:"p-2",children:(0,J.jsx)(x.default,{name:"trash-outline",size:20,color:"#EF4444"})})]},t))}),(0,J.jsxs)(n.default,{className:"border-t border-gray-200 pt-3",children:[(0,J.jsx)(d.default,{className:"text-xs font-semibold text-gray-500 mb-2",children:"ADD PIECE COUNT"}),(0,J.jsxs)(n.default,{className:"gap-3",children:[(0,J.jsx)(h.default,{value:I,onChangeText:L,placeholder:"Product type (e.g., Beam, Column)",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-base text-gray-900"}),(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(h.default,{value:R,onChangeText:$,placeholder:"Count",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"number-pad",className:"flex-1 bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-base text-gray-900"}),(0,J.jsx)(o.default,{onPress:()=>{if(!I.trim())return void Te.default.alert("Missing Product Type","Please enter a product type.");const e=parseInt(R);!e||e<1?Te.default.alert("Invalid Count","Please enter a valid piece count."):(k([...D,{productType:I.trim(),count:e}]),L(""),$(""))},className:"bg-blue-600 rounded-lg px-4 py-2 justify-center items-center",children:(0,J.jsx)(d.default,{className:"text-white font-semibold",children:"Add"})})]})]})]})]})]})})})]})}function ha({navigation:e}){const t=fe(e=>e.projects),a=fe(e=>e.exportProjects),s=fe(e=>e.importProjects),r=fe(e=>e.clearAllProjects),[l,i]=(0,f.useState)(""),[c,u]=(0,f.useState)(null);return(0,J.jsxs)(ea.SafeAreaView,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(n.default,{className:"bg-white border-b border-gray-200 px-4 py-3",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsx)(o.default,{onPress:()=>e.goBack(),className:"p-2",children:(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#111827"})}),(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900 flex-1 ml-2",children:"Export / Import Projects"})]})}),(0,J.jsx)(g.default,{className:"flex-1",children:(0,J.jsxs)(n.default,{className:"p-4 gap-6",children:[c&&(0,J.jsx)(n.default,{className:"rounded-lg p-4 "+("success"===c.type?"bg-green-100":"bg-red-100"),children:(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2",children:[(0,J.jsx)(x.default,{name:"success"===c.type?"checkmark-circle":"alert-circle",size:20,color:"success"===c.type?"#065F46":"#991B1B"}),(0,J.jsx)(d.default,{className:"flex-1 text-sm font-medium "+("success"===c.type?"text-green-800":"text-red-800"),children:c.text}),(0,J.jsx)(o.default,{onPress:()=>u(null),children:(0,J.jsx)(x.default,{name:"close",size:20,color:"#6B7280"})})]})}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-3 mb-3",children:[(0,J.jsx)(n.default,{className:"bg-blue-100 rounded-full p-2",children:(0,J.jsx)(x.default,{name:"arrow-up-circle",size:24,color:"#3B82F6"})}),(0,J.jsx)(d.default,{className:"text-lg font-bold text-gray-900",children:"Export Projects"})]}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600 mb-4",children:["Export all ",t.length," projects as JSON data. You can share this data or save it as a backup."]}),(0,J.jsx)(o.default,{onPress:async()=>{try{const e=a();await Ee.setStringAsync(e),u({type:"success",text:"Projects exported to clipboard!"}),setTimeout(()=>{pe.default.share({message:e,title:"Project Library Export"}).catch(()=>{})},500)}catch(qa){u({type:"error",text:`Export failed: ${qa}`})}},disabled:0===t.length,className:"rounded-lg py-3 items-center "+(0===t.length?"bg-gray-300":"bg-blue-600"),children:(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2",children:[(0,J.jsx)(x.default,{name:"share-outline",size:20,color:"#FFFFFF"}),(0,J.jsxs)(d.default,{className:"text-white text-base font-semibold",children:["Export ",t.length," ",1===t.length?"Project":"Projects"]})]})}),0===t.length&&(0,J.jsx)(d.default,{className:"text-xs text-gray-500 mt-2 text-center",children:"No projects to export"})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-3 mb-3",children:[(0,J.jsx)(n.default,{className:"bg-green-100 rounded-full p-2",children:(0,J.jsx)(x.default,{name:"arrow-down-circle",size:24,color:"#10B981"})}),(0,J.jsx)(d.default,{className:"text-lg font-bold text-gray-900",children:"Import Projects"})]}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 mb-4",children:"Paste JSON data below to import projects. Existing projects (same job number) will be skipped."}),(0,J.jsx)(h.default,{value:l,onChangeText:i,placeholder:"Paste JSON data here...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",multiline:!0,numberOfLines:8,className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-sm text-gray-900 mb-3",style:{minHeight:150,textAlignVertical:"top"}}),(0,J.jsxs)(n.default,{className:"gap-2",children:[(0,J.jsx)(o.default,{onPress:async()=>{try{const e=await Ee.getStringAsync();i(e),u({type:"success",text:"Pasted from clipboard"})}catch(qa){u({type:"error",text:"Failed to paste from clipboard"})}},className:"bg-gray-600 rounded-lg py-3 items-center",children:(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2",children:[(0,J.jsx)(x.default,{name:"clipboard-outline",size:20,color:"#FFFFFF"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Paste from Clipboard"})]})}),(0,J.jsx)(o.default,{onPress:()=>{if(!l.trim())return void u({type:"error",text:"Please paste JSON data to import"});const e=s(l);e.success?(u({type:"success",text:e.message}),i("")):u({type:"error",text:e.message})},disabled:!l.trim(),className:"rounded-lg py-3 items-center "+(l.trim()?"bg-green-600":"bg-gray-300"),children:(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2",children:[(0,J.jsx)(x.default,{name:"download-outline",size:20,color:"#FFFFFF"}),(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Import Projects"})]})})]})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-xl p-4 border-2 border-red-200",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-3 mb-3",children:[(0,J.jsx)(n.default,{className:"bg-red-100 rounded-full p-2",children:(0,J.jsx)(x.default,{name:"warning",size:24,color:"#EF4444"})}),(0,J.jsx)(d.default,{className:"text-lg font-bold text-red-900",children:"Danger Zone"})]}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 mb-4",children:"Permanently delete all projects from the library. This action cannot be undone."}),(0,J.jsx)(o.default,{onPress:()=>{Te.default.alert("Clear All Projects",`Are you sure you want to delete all ${t.length} projects? This action cannot be undone.`,[{text:"Cancel",style:"cancel"},{text:"Delete All",style:"destructive",onPress:()=>{r(),u({type:"success",text:"All projects cleared"})}}])},disabled:0===t.length,className:"rounded-lg py-3 items-center border-2 "+(0===t.length?"bg-gray-100 border-gray-300":"bg-red-50 border-red-600"),children:(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2",children:[(0,J.jsx)(x.default,{name:"trash-outline",size:20,color:0===t.length?"#9CA3AF":"#DC2626"}),(0,J.jsx)(d.default,{className:"text-base font-semibold "+(0===t.length?"text-gray-400":"text-red-600"),children:"Clear All Projects"})]})})]}),(0,J.jsx)(n.default,{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:(0,J.jsxs)(n.default,{className:"flex-row items-start gap-3",children:[(0,J.jsx)(x.default,{name:"information-circle",size:24,color:"#3B82F6"}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-blue-900 mb-2",children:"How to use Export/Import"}),(0,J.jsx)(d.default,{className:"text-xs text-blue-800 mb-1",children:"\u2022 Export creates a JSON backup of all your projects"}),(0,J.jsx)(d.default,{className:"text-xs text-blue-800 mb-1",children:"\u2022 Share exported data via email, messages, or save to files"}),(0,J.jsx)(d.default,{className:"text-xs text-blue-800 mb-1",children:"\u2022 Import merges new projects without duplicating existing ones"}),(0,J.jsx)(d.default,{className:"text-xs text-blue-800",children:"\u2022 Use this to backup data or transfer between devices"})]})]})})]})})]})}const pa={Precast:["BL1","BL3","BL4","BL6","FTE1","FTE2","FTW1","FTW2","Columns","STAD","STAIRS"],Extruded:["1","2","3","4","5","6"],"Wall Panels":[],Flexicore:[]},ba={NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.EXPO_PUBLIC_ELIPLAN_API_URL||"",ya={NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.EXPO_PUBLIC_ELIPLAN_API_KEY||"",ja={NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.EXPO_PUBLIC_ELIPLAN_USERNAME||"",Na={NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.EXPO_PUBLIC_ELIPLAN_PASSWORD||"";function wa(){return!(!ba||!ya&&!ja)}function Sa(e){if(!e)return null;const t=e.toLowerCase().trim();return t.includes("precast")?"Precast":t.includes("extrud")?"Extruded":t.includes("wall")||t.includes("panel")?"Wall Panels":t.includes("flexicore")||t.includes("flexi")?"Flexicore":null}function Fa(e){if(!e)return"Scheduled";const t=e.toLowerCase().trim();return t.includes("progress")||t.includes("active")?"In Progress":t.includes("complete")||t.includes("done")?"Completed":t.includes("delay")?"Delayed":t.includes("cancel")?"Cancelled":"Scheduled"}const Ca=(0,y.create)()((0,O.persist)((e,t)=>({pourEntries:[],schedules:[],forms:[],lastSyncTime:null,addForm:t=>{const a=`form-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,s=Object.assign({},t,{id:a});return e(e=>({forms:[...e.forms,s]})),a},updateForm:(t,a)=>{e(e=>({forms:e.forms.map(e=>e.id===t?Object.assign({},e,a):e)}))},deleteForm:t=>{e(e=>({forms:e.forms.filter(e=>e.id!==t)}))},getForm:e=>t().forms.find(t=>t.id===e),getFormsByDepartment:e=>t().forms.filter(t=>t.department===e&&t.isActive).sort((e,t)=>e.name.localeCompare(t.name)),addPourEntry:t=>{const a=`pour-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,s=Object.assign({},t,{id:a,createdAt:Date.now(),updatedAt:Date.now()});return e(e=>({pourEntries:[...e.pourEntries,s]})),a},updatePourEntry:(t,a)=>{e(e=>({pourEntries:e.pourEntries.map(e=>e.id===t?Object.assign({},e,a,{updatedAt:Date.now()}):e)}))},deletePourEntry:t=>{e(e=>({pourEntries:e.pourEntries.filter(e=>e.id!==t)}))},getPourEntry:e=>t().pourEntries.find(t=>t.id===e),getPourEntriesByDate:(e,a)=>{const s=new Date(e);s.setHours(0,0,0,0);const r=new Date(e);return r.setHours(23,59,59,999),t().pourEntries.filter(e=>{const t=e.scheduledDate,l=t>=s.getTime()&&t<=r.getTime(),o=!a||e.department===a;return l&&o}).sort((e,t)=>e.scheduledTime&&t.scheduledTime?e.scheduledTime.localeCompare(t.scheduledTime):e.createdAt-t.createdAt)},getPourEntriesByFormBed:e=>t().pourEntries.filter(t=>t.formBedId===e).sort((e,t)=>t.scheduledDate-e.scheduledDate),getPourEntriesByDateRange:(e,a)=>t().pourEntries.filter(t=>t.scheduledDate>=e&&t.scheduledDate<=a).sort((e,t)=>e.scheduledDate-t.scheduledDate),getScheduleForDate:(e,a)=>{const s=t().getPourEntriesByDate(e,a);if(0===s.length)return;const r=s.reduce((e,t)=>e+(t.concreteYards||0),0);return{id:`schedule-${e}-${a}`,date:e,department:a,pourEntries:s,totalYards:r,createdBy:s[0]?.createdBy||"system",createdAt:Date.now(),updatedAt:Date.now()}},getTotalYardsForDate:(e,a)=>t().getPourEntriesByDate(e,a).reduce((e,t)=>e+(t.concreteYards||0),0),syncWithEliPlan:async(a,s)=>{try{const r=await async function(e,t){if(!wa())throw new Error("EliPlan API is not configured. Please add credentials to .env file.");try{const a=e.toISOString().split("T")[0],s=new URLSearchParams(Object.assign({date:a},t?.department&&{department:t.department},void 0!==t?.includeCompleted&&{includeCompleted:t.includeCompleted.toString()})),r={"Content-Type":"application/json"};if(ya)r.Authorization=`Bearer ${ya}`;else if(ja&&Na){const e=btoa(`${ja}:${Na}`);r.Authorization=`Basic ${e}`}const l=await fetch(`${ba}/schedule?${s.toString()}`,{method:"GET",headers:r,signal:AbortSignal.timeout(3e4)});if(!l.ok)throw new Error(`EliPlan API error: ${l.status} ${l.statusText}`);const o=await l.json();if(!o.success)throw new Error(o.error||o.message||"Unknown error from EliPlan API");return o.data||[]}catch(qa){throw console.error("Error fetching EliPlan schedule:",qa),qa}}(a),l=t();let o=0;for(const e of r){const t=Sa(e.department);if(!t){console.warn(`Skipping item with unmapped department: ${e.department}`);continue}let a,r=e.workstation||"Unknown";const n=l.forms.find(e=>e.department===t&&e.name.toLowerCase()===r.toLowerCase());if(n)a=n.id,r=n.name;else{if(!e.workstation){console.warn(`Skipping item without workstation: Job ${e.jobNumber}`);continue}a=l.addForm({name:e.workstation,department:t,isActive:!0,notes:"Auto-created from EliPlan"})}const d=l.pourEntries.find(t=>t.jobNumber===e.jobNumber&&t.scheduledDate===new Date(e.scheduledDate).getTime()&&t.formBedId===a);d?l.updatePourEntry(d.id,{jobName:e.jobName||e.customerName,markNumbers:e.markNumber,pieceCount:e.pieceCount,productType:e.productDescription||e.productCode,dimensions:e.dimensions,mixDesign:e.concreteGrade||e.mixDesignId,concreteYards:e.concreteVolume,scheduledTime:e.scheduledStartTime,status:Fa(e.status),foreman:e.foreman,notes:e.notes?`${e.notes} (Synced from EliPlan)`:"Synced from EliPlan"}):(l.addPourEntry({formBedId:a,formBedName:r,department:t,jobNumber:e.jobNumber,jobName:e.jobName||e.customerName,markNumbers:e.markNumber,pieceCount:e.pieceCount,productType:e.productDescription||e.productCode,dimensions:e.dimensions,mixDesign:e.concreteGrade||e.mixDesignId,concreteYards:e.concreteVolume,scheduledDate:new Date(e.scheduledDate).getTime(),scheduledTime:e.scheduledStartTime,status:Fa(e.status),foreman:e.foreman,notes:e.notes?`${e.notes} (Synced from EliPlan)`:"Synced from EliPlan",createdBy:s}),o++)}return e({lastSyncTime:Date.now()}),{success:!0,imported:o}}catch(qa){return console.error("EliPlan sync error:",qa),{success:!1,imported:0,error:qa instanceof Error?qa.message:"Unknown sync error"}}},clearAllData:()=>{e({pourEntries:[],schedules:[],forms:[]})},initializeDefaultForms:()=>{const e=t();if(0===e.forms.length){["Precast","Extruded","Wall Panels","Flexicore"].forEach(t=>{pa[t].forEach(a=>{e.addForm({name:a,department:t,isActive:!0})})})}else{const t=e.forms.filter(e=>"Extruded"===e.department);["1","2","3","4","5","6"].forEach(a=>{t.some(e=>e.name===a)||e.addForm({name:a,department:"Extruded",isActive:!0})})}}}),{name:"pour-schedule-storage",storage:(0,O.createJSONStorage)(()=>F.default)}));function va({jobNumber:e,jobName:t,onJobNumberChange:a,onJobNameChange:s,onJobSelect:r,disabled:l=!1,jobNumberLabel:i="Job #",jobNameLabel:u="Job Name",required:m=!1,theme:p="light",enableCreatePrompt:b=!0}){const y=(0,c.useNavigation)(),{findByJobNumber:j,searchByJobName:N}=ge(),[w,S]=(0,f.useState)(!1),[F,C]=(0,f.useState)([]),[v,A]=(0,f.useState)(null),[P,T]=(0,f.useState)(""),[E,z]=(0,f.useState)("");(0,c.useFocusEffect)(f.useCallback(()=>{if(P&&e.trim()===P){const e=j(P);e&&!t&&(s(e.jobName),r&&r(e.jobNumber,e.jobName))}},[P,e,t]));const B=e=>{if(!b||!e.trim()||e===P)return;const a=e.trim();if(!fa(a).isValid)return;j(a)||(T(a),Te.default.alert("Job Not Found",`"${a}" is not in the Project Library.\n\nWould you like to create a new project with this job number?`,[{text:"Not Now",style:"cancel"},{text:"Create Project",onPress:()=>{y.navigate("ProjectLibraryAddEdit",{prefilledJobNumber:a,prefilledJobName:t.trim()||void 0,returnScreen:"current"})}}]))};(0,f.useEffect)(()=>{if("number"===v&&e.trim()){const a=j(e);a&&a.jobName!==t&&(s(a.jobName),T(e.trim()),r&&r(a.jobNumber,a.jobName))}},[e,v]),(0,f.useEffect)(()=>{if("name"===v&&t.trim().length>=2){const e=N(t);e.length>0?(C(e),S(!0)):S(!1)}else S(!1)},[t,v]);const D="dark"===p,k=D?{backgroundColor:"#1F2937",borderColor:"#374151",textColor:"#FFFFFF",placeholderColor:"#6B7280"}:{backgroundColor:"#F9FAFB",borderColor:"#E5E7EB",textColor:"#111827",placeholderColor:"#9CA3AF"},I=D?"#9CA3AF":"#374151";return(0,J.jsxs)(n.default,{children:[(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsxs)(d.default,{style:{fontSize:14,fontWeight:"600",color:I,marginBottom:8},children:[i," ",m&&(0,J.jsx)(d.default,{style:{color:"#EF4444"},children:"*"})]}),(0,J.jsx)(h.default,{value:e,onChangeText:e=>{a(e),E&&z("")},onFocus:()=>A("number"),onBlur:()=>{setTimeout(()=>{A(null),e.trim()&&(e=>{if(!e.trim())return;const t=fa(e);if(!t.isValid)return z(t.error||"Invalid job number format"),void Te.default.alert("Invalid Job Number",`${t.error}\n\nJob number must be:\n\u2022 Exactly 6 digits\n\u2022 2nd and 3rd digits must match\n\nExample: 255096, 144523, 366789`,[{text:"OK",onPress:()=>{t.cleaned&&t.cleaned.length}}]);z(""),B(t.cleaned||e)})(e)},300)},placeholder:"Enter 6-digit job number",placeholderTextColor:k.placeholderColor,editable:!l,keyboardType:"number-pad",maxLength:10,cursorColor:"#000000",style:{backgroundColor:k.backgroundColor,borderWidth:1,borderColor:E?"#EF4444":k.borderColor,borderRadius:12,padding:12,fontSize:16,color:k.textColor}}),E&&(0,J.jsxs)(n.default,{className:"flex-row items-start mt-2",children:[(0,J.jsx)(x.default,{name:"alert-circle",size:16,color:"#EF4444",style:{marginRight:4,marginTop:1}}),(0,J.jsx)(d.default,{style:{fontSize:12,color:"#EF4444",flex:1},children:E})]}),!E&&"number"===v&&(0,J.jsx)(d.default,{style:{fontSize:11,color:I,marginTop:4,opacity:.6},children:"Format: 6 digits, 2nd and 3rd must match (e.g., 255096)"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:I,marginBottom:8},children:u}),(0,J.jsxs)(n.default,{className:"relative",children:[(0,J.jsx)(h.default,{value:t,onChangeText:s,onFocus:()=>A("name"),onBlur:()=>setTimeout(()=>A(null),200),placeholder:"Enter or search job name",placeholderTextColor:k.placeholderColor,editable:!l,cursorColor:"#000000",style:{backgroundColor:k.backgroundColor,borderWidth:1,borderColor:k.borderColor,borderRadius:12,padding:12,fontSize:16,color:k.textColor}}),w&&F.length>0&&(0,J.jsx)(n.default,{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-60",children:(0,J.jsx)(g.default,{keyboardShouldPersistTaps:"handled",children:F.map((e,t)=>(0,J.jsx)(o.default,{onPress:()=>(e=>{a(e.jobNumber),s(e.jobName),S(!1),A(null),r&&r(e.jobNumber,e.jobName)})(e),className:"px-3 py-3 border-b border-gray-100 active:bg-gray-50",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsx)(d.default,{className:"text-sm font-bold text-blue-600 mb-1",children:e.jobNumber}),(0,J.jsx)(d.default,{className:"text-base text-gray-900",children:e.jobName})]}),(0,J.jsx)(x.default,{name:"arrow-forward",size:16,color:"#3B82F6"})]})},t))})})]}),"name"===v&&t.trim().length>=1&&t.trim().length<2&&(0,J.jsx)(d.default,{style:{fontSize:12,color:I,marginTop:4,opacity:.7},children:"Type at least 2 characters to see suggestions"})]})]})}var Aa=a(63627);function Pa({navigation:e,route:t}){const a=(0,i.useSafeAreaInsets)(),s=G(e=>e.currentUser),r=Ca(e=>e.forms),l=Ca(e=>e.getFormsByDepartment),c=Ca(e=>e.getPourEntriesByDate),u=Ca(e=>e.addPourEntry),m=Ca(e=>e.updatePourEntry),b=Ca(e=>e.deletePourEntry),y=Ca(e=>e.getTotalYardsForDate),j=Ca(e=>e.initializeDefaultForms);Ca(e=>e.syncWithEliPlan),Ca(e=>e.lastSyncTime);(0,f.useEffect)(()=>{j()},[]);const N=t.params?.date?new Date(t.params.date).getTime():Date.now(),w=t.params?.department,[S,F]=(0,f.useState)(N),[C,v]=(0,f.useState)(w),[A,P]=(0,f.useState)(!1),[T,E]=(0,f.useState)(!1),[z,B]=(0,f.useState)(null),[D,k]=(0,f.useState)(!1),[I,L]=(0,f.useState)(""),[R,$]=(0,f.useState)(w),[W,O]=(0,f.useState)(w||"Precast"),[M,U]=(0,f.useState)(""),[H,V]=(0,f.useState)(""),[q,Y]=(0,f.useState)(""),[_,Q]=(0,f.useState)(""),[X,K]=(0,f.useState)(""),[Z,ee]=(0,f.useState)(""),[te,ae]=(0,f.useState)(""),[se,re]=(0,f.useState)(""),[le,oe]=(0,f.useState)(""),[ne,de]=(0,f.useState)(""),[ie,ce]=(0,f.useState)(""),[ue,me]=(0,f.useState)("Scheduled"),[xe,fe]=(0,f.useState)(""),[ge,he]=(0,f.useState)("");(0,f.useLayoutEffect)(()=>{e.setOptions({headerLeft:()=>(0,J.jsx)(o.default,{onPress:()=>{C?v(null):e.goBack()},style:{marginLeft:4},children:(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#111827"})})})},[e,C]),(0,f.useEffect)(()=>{void 0===t.params?.department&&null!==C&&v(null)},[t.params]);const pe=["Precast","Extruded","Wall Panels","Flexicore"],be=e=>{switch(e){case"Precast":return{bg:"#EFF6FF",color:"#1E40AF",accent:"#3B82F6"};case"Extruded":return{bg:"#F0FDF4",color:"#166534",accent:"#10B981"};case"Wall Panels":return{bg:"#FEF3C7",color:"#92400E",accent:"#F59E0B"};case"Flexicore":return{bg:"#FCE7F3",color:"#831843",accent:"#EC4899"}}},ye=()=>{B(null),U(""),V(""),Y(""),Q(""),K(""),ee(""),ae(""),re(""),oe(""),de(""),ce(""),me("Scheduled"),fe(""),he("")},je=e=>{const t=new Date(S);t.setDate(t.getDate()+e),F(t.getTime())},Ne=()=>{const e=new Date;e.setHours(0,0,0,0);const t=new Date(S);t.setHours(0,0,0,0);const a=t.getTime()-e.getTime(),s=Math.round(a/864e5);return 0===s?"Today":-1===s?"Yesterday":1===s?"Tomorrow":null},we=()=>{const e=new Date(S),t=`${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")}/${e.getFullYear()}`;L(t),k(!0)},Se=e=>{const t=new Date;t.setHours(0,0,0,0),t.setDate(t.getDate()+e),F(t.getTime()),k(!1)},Fe=c(S);y(S),Ca(e=>e.pourEntries);if(!C)return(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:(0,J.jsx)(g.default,{style:{flex:1},children:(0,J.jsxs)(n.default,{style:{padding:12},children:[(0,J.jsxs)(n.default,{style:{marginBottom:12,flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"700",color:"#111827",marginBottom:2},children:"Daily Pour Schedule"}),(0,J.jsx)(d.default,{style:{fontSize:13,color:"#6B7280"},children:"Select a department to view and manage"})]}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("ScheduleSearch"),style:{backgroundColor:"#3B82F6",borderRadius:10,padding:12,marginLeft:8},children:(0,J.jsx)(x.default,{name:"search",size:22,color:"#FFFFFF"})})]}),(0,J.jsxs)(n.default,{style:{marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:"#6B7280",marginBottom:6},children:"Schedule Date"}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,J.jsx)(o.default,{onPress:()=>je(-1),style:{backgroundColor:"#FFFFFF",borderRadius:8,padding:8,borderWidth:1,borderColor:"#E5E7EB"},children:(0,J.jsx)(x.default,{name:"chevron-back",size:18,color:"#111827"})}),(0,J.jsxs)(n.default,{style:{flex:1,marginHorizontal:8,alignItems:"center"},children:[(0,J.jsx)(o.default,{onPress:we,children:(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:"#111827"},children:new Date(S).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})}),Ne()&&(0,J.jsx)(o.default,{onPress:()=>F(Date.now()),children:(0,J.jsx)(d.default,{style:{fontSize:11,color:"#3B82F6",fontWeight:"500"},children:Ne()})})]}),(0,J.jsx)(o.default,{onPress:()=>je(1),style:{backgroundColor:"#FFFFFF",borderRadius:8,padding:8,borderWidth:1,borderColor:"#E5E7EB"},children:(0,J.jsx)(x.default,{name:"chevron-forward",size:18,color:"#111827"})})]})]}),(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#111827",marginBottom:8},children:"Select Department"}),(0,J.jsx)(n.default,{style:{gap:8},children:pe.map(e=>{const t=Fe.filter(t=>t.department===e),a=t.reduce((e,t)=>e+(t.concreteYards||0),0),s=be(e),r=l(e);return(0,J.jsxs)(o.default,{onPress:()=>{v(e),O(e),$(e)},style:{backgroundColor:"#FFFFFF",borderRadius:10,padding:12,borderWidth:1.5,borderColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,J.jsx)(d.default,{style:{fontSize:17,fontWeight:"700",color:s.color},children:e}),(0,J.jsx)(x.default,{name:"chevron-forward",size:20,color:s.accent})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:14},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:10,color:"#6B7280",marginBottom:1},children:"Forms"}),(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:"#111827"},children:r.length})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:10,color:"#6B7280",marginBottom:1},children:"Pours Today"}),(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:"#111827"},children:t.length})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:10,color:"#6B7280",marginBottom:1},children:"Yards"}),(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:s.accent},children:a.toFixed(1)})]})]})]},e)})})]})})});const Ce=Fe.filter(e=>e.department===C),ve=y(S,C),Ae=be(C);return(0,J.jsxs)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:[(0,J.jsx)(g.default,{style:{flex:1},children:(0,J.jsxs)(n.default,{style:{padding:10},children:[(0,J.jsx)(n.default,{style:{marginBottom:8},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"700",color:Ae.color},children:C}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:6,alignItems:"center"},children:[(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:6,paddingHorizontal:8,paddingVertical:4,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(d.default,{style:{fontSize:10,color:"#6B7280"},children:"Pours"}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"700",color:"#111827",textAlign:"center"},children:Ce.length})]}),(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:6,paddingHorizontal:8,paddingVertical:4,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(d.default,{style:{fontSize:10,color:"#6B7280"},children:"Yards"}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"700",color:Ae.accent,textAlign:"center"},children:ve.toFixed(1)})]})]})]})}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:8,backgroundColor:"#FFFFFF",borderRadius:8,padding:8,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(o.default,{onPress:()=>je(-1),style:{padding:4},children:(0,J.jsx)(x.default,{name:"chevron-back",size:20,color:"#111827"})}),(0,J.jsxs)(n.default,{style:{alignItems:"center"},children:[(0,J.jsx)(o.default,{onPress:we,children:(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#111827"},children:new Date(S).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})}),Ne()&&(0,J.jsx)(o.default,{onPress:()=>F(Date.now()),children:(0,J.jsx)(d.default,{style:{fontSize:10,color:"#3B82F6",fontWeight:"500"},children:Ne()})})]}),(0,J.jsx)(o.default,{onPress:()=>je(1),style:{padding:4},children:(0,J.jsx)(x.default,{name:"chevron-forward",size:20,color:"#111827"})})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:6,marginBottom:10},children:[(0,J.jsxs)(o.default,{onPress:()=>{ye(),P(!0)},style:{flex:1,backgroundColor:"#3B82F6",borderRadius:8,padding:10,flexDirection:"row",alignItems:"center",justifyContent:"center"},children:[(0,J.jsx)(x.default,{name:"add-circle",size:18,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:13,fontWeight:"600",marginLeft:4},children:"Add Piece"})]}),(0,J.jsxs)(o.default,{onPress:()=>e.navigate("ScheduleScanner",{date:new Date(S).toISOString(),department:C}),style:{flex:1,backgroundColor:"#8B5CF6",borderRadius:8,padding:10,flexDirection:"row",alignItems:"center",justifyContent:"center"},children:[(0,J.jsx)(x.default,{name:"scan",size:18,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:13,fontWeight:"600",marginLeft:4},children:"Scan"})]})]}),(()=>{const e=l(C),t=Fe.filter(e=>e.department===C),a=be(C);return 0===e.length?(0,J.jsxs)(n.default,{style:{padding:20,alignItems:"center",backgroundColor:"#FFFFFF",borderRadius:10},children:[(0,J.jsx)(x.default,{name:"construct-outline",size:28,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:13,color:"#6B7280",marginTop:6},children:"No forms configured for this department"})]}):(0,J.jsx)(n.default,{style:{gap:6},children:e.map(e=>{const s=t.filter(t=>t.formBedId===e.id);return(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:8,padding:8,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:s.length>0?6:0},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#111827"},children:e.name}),e.capacity&&(0,J.jsxs)(d.default,{style:{fontSize:11,color:"#6B7280"},children:["Cap: ",e.capacity]})]}),(0,J.jsx)(n.default,{style:{backgroundColor:s.length>0?a.bg:"#F3F4F6",paddingHorizontal:8,paddingVertical:3,borderRadius:6},children:(0,J.jsx)(d.default,{style:{fontSize:11,fontWeight:"600",color:s.length>0?a.color:"#6B7280"},children:s.length})})]}),s.length>0&&(0,J.jsx)(n.default,{style:{gap:4},children:s.map(e=>{const t=(e=>{switch(e){case"Scheduled":return{bg:"#EFF6FF",text:"#1E40AF"};case"In Progress":return{bg:"#FEF3C7",text:"#92400E"};case"Completed":return{bg:"#F0FDF4",text:"#166534"};case"Delayed":return{bg:"#FEF2F2",text:"#991B1B"};case"Cancelled":return{bg:"#F3F4F6",text:"#6B7280"}}})(e.status);return(0,J.jsx)(n.default,{style:{backgroundColor:"#F9FAFB",borderRadius:6,padding:8,borderWidth:1,borderColor:"#E5E7EB"},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between"},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:6,marginBottom:3},children:[(0,J.jsxs)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#111827"},children:["#",e.jobNumber]}),(0,J.jsx)(n.default,{style:{backgroundColor:t.bg,paddingHorizontal:5,paddingVertical:1,borderRadius:4},children:(0,J.jsx)(d.default,{style:{fontSize:9,fontWeight:"600",color:t.text},children:e.status})})]}),e.jobName&&(0,J.jsx)(d.default,{style:{fontSize:12,color:"#374151",marginBottom:2},children:e.jobName}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",flexWrap:"wrap",gap:6},children:[e.markNumbers&&(0,J.jsx)(d.default,{style:{fontSize:11,color:"#6B7280"},children:e.markNumbers}),e.idNumber&&(0,J.jsxs)(d.default,{style:{fontSize:11,color:"#6B7280"},children:["ID: ",e.idNumber]}),e.concreteYards&&(0,J.jsxs)(d.default,{style:{fontSize:11,color:a.accent,fontWeight:"600"},children:[e.concreteYards,"yd\xb3"]}),e.scheduledTime&&(0,J.jsx)(d.default,{style:{fontSize:11,color:"#6B7280"},children:e.scheduledTime})]})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:6},children:[(0,J.jsx)(o.default,{onPress:()=>(e=>{B(e.id),O(e.department),U(e.formBedId),V(e.jobNumber),Y(e.jobName||""),Q(e.idNumber||""),K(e.markNumbers||""),ee(e.pieceCount?.toString()||""),ae(e.productType||""),re(e.dimensions||""),oe(e.mixDesign||""),de(e.concreteYards?.toString()||""),ce(e.scheduledTime||""),me(e.status),fe(e.foreman||""),he(e.notes||""),P(!0)})(e),style:{padding:2},children:(0,J.jsx)(x.default,{name:"pencil",size:14,color:"#3B82F6"})}),(0,J.jsx)(o.default,{onPress:()=>{return t=e.id,void Te.default.alert("Delete Pour Entry","Are you sure you want to delete this pour entry?",[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:()=>b(t)}]);var t},style:{padding:2},children:(0,J.jsx)(x.default,{name:"trash-outline",size:14,color:"#EF4444"})})]})]})},e.id)})})]},e.id)})})})()]})}),(0,J.jsx)(p.default,{visible:A,animationType:"slide",transparent:!0,children:(0,J.jsx)(n.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"flex-end"},children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderTopLeftRadius:24,borderTopRightRadius:24,padding:24,paddingBottom:a.bottom+24,maxHeight:"90%"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:24},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:z?"Edit Piece":"Add Piece"}),(0,J.jsx)(o.default,{onPress:()=>P(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsx)(g.default,{style:{maxHeight:500},keyboardShouldPersistTaps:"handled",children:(0,J.jsxs)(n.default,{style:{gap:16},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Form/Bed *"}),(0,J.jsx)(n.default,{style:{flexDirection:"row",flexWrap:"wrap",gap:8},children:l(W).map(e=>(0,J.jsx)(o.default,{onPress:()=>U(e.id),style:{backgroundColor:M===e.id?"#10B981":"#F3F4F6",paddingVertical:8,paddingHorizontal:12,borderRadius:8},children:(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:M===e.id?"#FFFFFF":"#6B7280"},children:e.name})},e.id))})]}),(0,J.jsx)(va,{jobNumber:H,jobName:q,onJobNumberChange:V,onJobNameChange:Y,required:!0}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"ID #"}),(0,J.jsx)(h.default,{value:_,onChangeText:Q,placeholder:"ID number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Mark #s"}),(0,J.jsx)(h.default,{value:X,onChangeText:K,placeholder:"e.g., M1-M5",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Dimensions"}),(0,J.jsx)(h.default,{value:se,onChangeText:re,placeholder:"e.g., 8x4x6",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Mix Design"}),(0,J.jsx)(h.default,{value:le,onChangeText:oe,placeholder:"e.g., 6000 PSI",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Concrete (yds\xb3)"}),(0,J.jsx)(h.default,{value:ne,onChangeText:de,placeholder:"0.0",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"decimal-pad",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Scheduled Time"}),(0,J.jsx)(h.default,{value:ie,onChangeText:ce,placeholder:"e.g., 8:00 AM",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Status"}),(0,J.jsx)(n.default,{style:{flexDirection:"row",flexWrap:"wrap",gap:6},children:["Scheduled","In Progress","Completed"].map(e=>(0,J.jsx)(o.default,{onPress:()=>me(e),style:{backgroundColor:ue===e?"#6366F1":"#F3F4F6",paddingVertical:6,paddingHorizontal:10,borderRadius:8},children:(0,J.jsx)(d.default,{style:{fontSize:11,fontWeight:"600",color:ue===e?"#FFFFFF":"#6B7280"},children:e})},e))})]})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Foreman"}),(0,J.jsx)(h.default,{value:xe,onChangeText:fe,placeholder:"Enter foreman name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB"}})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Notes"}),(0,J.jsx)(h.default,{value:ge,onChangeText:he,placeholder:"Additional notes...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",multiline:!0,numberOfLines:3,textAlignVertical:"top",style:{backgroundColor:"#F9FAFB",borderRadius:12,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB",minHeight:80}})]})]})}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12,marginTop:24},children:[(0,J.jsx)(o.default,{onPress:()=>P(!1),style:{flex:1,backgroundColor:"#F3F4F6",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#6B7280",fontSize:16,fontWeight:"600"},children:"Cancel"})}),(0,J.jsx)(o.default,{onPress:()=>{if(!M||!H.trim())return void Te.default.alert("Error","Form/Bed and Job Number are required");const e=r.find(e=>e.id===M);if(!e)return void Te.default.alert("Error","Selected form/bed not found");if(!s)return void Te.default.alert("Error","You must be logged in");const t={formBedId:M,formBedName:e.name,department:e.department,jobNumber:H.trim(),jobName:q.trim()||void 0,idNumber:_.trim()||void 0,markNumbers:X.trim()||void 0,pieceCount:1,productType:te.trim()||void 0,dimensions:se.trim()||void 0,mixDesign:le.trim()||void 0,concreteYards:ne?parseFloat(ne):void 0,scheduledDate:S,scheduledTime:ie.trim()||void 0,status:ue,foreman:xe.trim()||void 0,notes:ge.trim()||void 0,createdBy:s.email};z?m(z,t):u(t),ye(),P(!1)},style:{flex:1,backgroundColor:"#3B82F6",paddingVertical:12,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},children:z?"Update":"Add"})})]})]})})}),(0,J.jsx)(p.default,{visible:D,animationType:"slide",transparent:!0,children:(0,J.jsx)(n.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:24,padding:24,width:"85%",maxWidth:400},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:"Select Date"}),(0,J.jsx)(o.default,{onPress:()=>k(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:8,marginBottom:20},children:[(0,J.jsx)(o.default,{onPress:()=>Se(-1),style:{flex:1,backgroundColor:"#F3F4F6",borderRadius:8,padding:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151"},children:"Yesterday"})}),(0,J.jsx)(o.default,{onPress:()=>Se(0),style:{flex:1,backgroundColor:"#3B82F6",borderRadius:8,padding:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#FFFFFF"},children:"Today"})}),(0,J.jsx)(o.default,{onPress:()=>Se(1),style:{flex:1,backgroundColor:"#F3F4F6",borderRadius:8,padding:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151"},children:"Tomorrow"})})]}),(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Or select from calendar:"}),(0,J.jsx)(Aa.Calendar,{current:new Date(S).toISOString().split("T")[0],onDayPress:e=>{const t=new Date(e.year,e.month-1,e.day);F(t.getTime()),k(!1)},markedDates:{[new Date(S).toISOString().split("T")[0]]:{selected:!0,selectedColor:"#3B82F6"}},theme:{backgroundColor:"#ffffff",calendarBackground:"#ffffff",textSectionTitleColor:"#6B7280",selectedDayBackgroundColor:"#3B82F6",selectedDayTextColor:"#ffffff",todayTextColor:"#3B82F6",dayTextColor:"#111827",textDisabledColor:"#D1D5DB",monthTextColor:"#111827",textMonthFontWeight:"600",textDayFontSize:15,textMonthFontSize:17},style:{borderRadius:12,marginBottom:20}}),(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Or type a date:"}),(0,J.jsx)(h.default,{value:I,onChangeText:L,placeholder:"MM/DD/YYYY",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"numbers-and-punctuation",style:{backgroundColor:"#F9FAFB",borderWidth:1,borderColor:"#D1D5DB",borderRadius:8,padding:12,fontSize:16,color:"#111827",marginBottom:20}}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12},children:[(0,J.jsx)(o.default,{onPress:()=>k(!1),style:{flex:1,backgroundColor:"#F3F4F6",borderRadius:8,padding:14,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:"#374151"},children:"Cancel"})}),(0,J.jsx)(o.default,{onPress:()=>{const e=I.split("/");if(3!==e.length)return void Te.default.alert("Invalid Date","Please enter date in MM/DD/YYYY format");const t=parseInt(e[0])-1,a=parseInt(e[1]),s=parseInt(e[2]);if(isNaN(t)||isNaN(a)||isNaN(s))return void Te.default.alert("Invalid Date","Please enter valid numbers for date");if(t<0||t>11||a<1||a>31||s<1900||s>2100)return void Te.default.alert("Invalid Date","Please enter a valid date");const r=new Date(s,t,a);F(r.getTime()),k(!1)},style:{flex:1,backgroundColor:"#3B82F6",borderRadius:8,padding:14,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:"#FFFFFF"},children:"Go to Date"})})]})]})})})]})}function Ta({navigation:e}){const t=Ca(e=>e.pourEntries),[a,s]=(0,f.useState)(""),[r,l]=(0,f.useState)(""),[i,c]=(0,f.useState)("contains"),[u,m]=(0,f.useState)(""),[p,b]=(0,f.useState)(""),[y,j]=(0,f.useState)(!1),[N,w]=(0,f.useState)(new Set),[S,F]=(0,f.useState)(new Set),[C,v]=(0,f.useState)(!1),[A,P]=(0,f.useState)(null),[T,E]=(0,f.useState)(null),[z,B]=(0,f.useState)(null),[D,k]=(0,f.useState)([]),[I,L]=(0,f.useState)(!1),R=e=>{const t=new Set(S);t.has(e)?t.delete(e):t.add(e),F(t)},$=()=>{w(new Set),F(new Set),v(!1),P(null),E(null)},W=()=>{let e=0;return N.size>0&&e++,S.size>0&&e++,C&&(A||T)&&e++,e},O=e=>0===e.daysFromNow?"Today":1===e.daysFromNow?"Tomorrow":-1===e.daysFromNow?"Yesterday":e.daysFromNow>0?`In ${e.daysFromNow} days`:`${Math.abs(e.daysFromNow)} days ago`;return(0,J.jsxs)(ea.SafeAreaView,{className:"flex-1 bg-gray-50",children:[(0,J.jsx)(n.default,{className:"bg-white border-b border-gray-200 px-4 py-3",children:(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-3",children:[(0,J.jsx)(o.default,{onPress:()=>e.goBack(),className:"p-2",children:(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#111827"})}),(0,J.jsx)(d.default,{className:"text-xl font-bold text-gray-900 flex-1 ml-2",children:"Search Schedule"}),(0,J.jsx)(o.default,{onPress:()=>{s(""),l(""),c("contains"),m(""),b(""),k([]),L(!1),$()},className:"px-3 py-2",children:(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-600",children:"Clear"})})]})}),(0,J.jsxs)(g.default,{className:"flex-1",children:[(0,J.jsxs)(n.default,{className:"bg-white border-b border-gray-200 px-4 py-3",children:[(0,J.jsxs)(o.default,{onPress:()=>j(!y),className:"flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center gap-2",children:[(0,J.jsx)(x.default,{name:"options-outline",size:20,color:"#3B82F6"}),(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-900",children:"Advanced Filters"}),W()>0&&(0,J.jsx)(n.default,{className:"bg-blue-600 rounded-full px-2 py-0.5",children:(0,J.jsx)(d.default,{className:"text-white text-xs font-bold",children:W()})})]}),(0,J.jsx)(x.default,{name:y?"chevron-up":"chevron-down",size:20,color:"#6B7280"})]}),y&&(0,J.jsxs)(n.default,{className:"mt-4 gap-4",children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Department"}),(0,J.jsx)(n.default,{className:"flex-row flex-wrap gap-2",children:["Precast","Extruded","Wall Panels","Flexicore"].map(e=>(0,J.jsx)(o.default,{onPress:()=>(e=>{const t=new Set(N);t.has(e)?t.delete(e):t.add(e),w(t)})(e),className:"px-3 py-2 rounded-lg border "+(N.has(e)?"bg-blue-600 border-blue-600":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-sm font-medium "+(N.has(e)?"text-white":"text-gray-700"),children:e})},e))})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Status"}),(0,J.jsxs)(n.default,{className:"flex-row flex-wrap gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>R("scheduled"),className:"px-3 py-2 rounded-lg border "+(S.has("scheduled")?"bg-blue-600 border-blue-600":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-sm font-medium "+(S.has("scheduled")?"text-white":"text-gray-700"),children:"Scheduled"})}),(0,J.jsx)(o.default,{onPress:()=>R("in-progress"),className:"px-3 py-2 rounded-lg border "+(S.has("in-progress")?"bg-blue-600 border-blue-600":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-sm font-medium "+(S.has("in-progress")?"text-white":"text-gray-700"),children:"Today"})}),(0,J.jsx)(o.default,{onPress:()=>R("poured"),className:"px-3 py-2 rounded-lg border "+(S.has("poured")?"bg-blue-600 border-blue-600":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-sm font-medium "+(S.has("poured")?"text-white":"text-gray-700"),children:"Poured"})})]})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-2",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700",children:"Date Range"}),(0,J.jsx)(o.default,{onPress:()=>v(!C),className:"px-3 py-1 rounded-full "+(C?"bg-blue-600":"bg-gray-300"),children:(0,J.jsx)(d.default,{className:"text-xs font-semibold "+(C?"text-white":"text-gray-600"),children:C?"ON":"OFF"})})]}),C&&(0,J.jsxs)(n.default,{className:"flex-row gap-2",children:[(0,J.jsx)(o.default,{onPress:()=>{const e=new Date,t=new Date(e.getTime()-2592e6);P(t),E(e)},className:"flex-1 bg-gray-100 border border-gray-300 rounded-lg py-2 items-center",children:(0,J.jsx)(d.default,{className:"text-xs text-gray-600 font-medium",children:"Last 30 Days"})}),(0,J.jsx)(o.default,{onPress:()=>{const e=new Date,t=new Date(e.getTime()+2592e6);P(e),E(t)},className:"flex-1 bg-gray-100 border border-gray-300 rounded-lg py-2 items-center",children:(0,J.jsx)(d.default,{className:"text-xs text-gray-600 font-medium",children:"Next 30 Days"})})]}),C&&(A||T)&&(0,J.jsx)(n.default,{className:"mt-2 bg-blue-50 border border-blue-200 rounded-lg p-2",children:(0,J.jsxs)(d.default,{className:"text-xs text-blue-800",children:[A?A.toLocaleDateString():"No start"," \u2192 ",T?T.toLocaleDateString():"No end"]})})]}),W()>0&&(0,J.jsx)(o.default,{onPress:$,className:"bg-gray-100 border border-gray-300 rounded-lg py-2 items-center",children:(0,J.jsx)(d.default,{className:"text-gray-700 text-sm font-semibold",children:"Clear All Filters"})})]})]}),(0,J.jsxs)(n.default,{className:"bg-white border-b border-gray-200 p-4 gap-4",children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Job Number"}),(0,J.jsx)(h.default,{value:a,onChangeText:s,placeholder:"Enter job number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"number-pad",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Job Name"}),(0,J.jsx)(h.default,{value:r,onChangeText:l,placeholder:"Enter job name",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"}),(0,J.jsxs)(n.default,{className:"flex-row gap-2 mt-2",children:[(0,J.jsx)(o.default,{onPress:()=>c("equals"),className:"flex-1 rounded-lg py-2 border "+("equals"===i?"bg-blue-600 border-blue-600":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-center text-sm font-semibold "+("equals"===i?"text-white":"text-gray-700"),children:"Equals"})}),(0,J.jsx)(o.default,{onPress:()=>c("contains"),className:"flex-1 rounded-lg py-2 border "+("contains"===i?"bg-blue-600 border-blue-600":"bg-white border-gray-300"),children:(0,J.jsx)(d.default,{className:"text-center text-sm font-semibold "+("contains"===i?"text-white":"text-gray-700"),children:"Contains"})})]})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Mark Number"}),(0,J.jsx)(h.default,{value:u,onChangeText:m,placeholder:"e.g., M1, H105",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"ID Number"}),(0,J.jsx)(h.default,{value:p,onChangeText:b,placeholder:"Enter ID number",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",className:"bg-gray-50 border border-gray-300 rounded-lg px-3 py-3 text-base text-gray-900"})]}),(0,J.jsx)(o.default,{onPress:()=>{if(!(a.trim()||r.trim()||u.trim()||p.trim()))return k([]),void L(!1);const e=new Date;e.setHours(0,0,0,0);const s=e.getTime(),l=[];t.forEach(e=>{let t=!0;if(a.trim()){const s=a.trim().toLowerCase();e.jobNumber.toLowerCase().includes(s)||(t=!1)}if(r.trim()&&t){const a=r.trim().toLowerCase(),s=(e.jobName||"").toLowerCase();"equals"===i?s!==a&&(t=!1):s.includes(a)||(t=!1)}if(u.trim()&&t){const a=u.trim().toLowerCase();(e.markNumbers||"").toLowerCase().includes(a)||(t=!1)}if(p.trim()&&t){const a=p.trim().toLowerCase();(e.idNumber||"").toLowerCase().includes(a)||(t=!1)}if(t){const a=new Date(e.scheduledDate);a.setHours(0,0,0,0);const r=a.getTime(),o=Math.floor((r-s)/864e5);let n;if(n=r<s?"poured":r===s?"in-progress":"scheduled",N.size>0&&!N.has(e.department)&&(t=!1),S.size>0&&!S.has(n)&&(t=!1),C&&t){if(A){const e=new Date(A);e.setHours(0,0,0,0),r<e.getTime()&&(t=!1)}if(T&&t){const e=new Date(T);e.setHours(0,0,0,0),r>e.getTime()&&(t=!1)}}t&&l.push({entry:e,scheduledDate:a,status:n,daysFromNow:o})}}),l.sort((e,t)=>Math.abs(e.daysFromNow)-Math.abs(t.daysFromNow)),k(l),L(!0)},className:"bg-blue-600 rounded-lg py-3 items-center",children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Search"})})]}),I?0===D.length?(0,J.jsxs)(n.default,{className:"items-center justify-center p-8 mt-12",children:[(0,J.jsx)(x.default,{name:"document-text-outline",size:64,color:"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-base mt-4 text-center font-semibold",children:"No Matches Found"}),(0,J.jsx)(d.default,{className:"text-gray-400 text-sm mt-2 text-center px-4",children:"No pieces match your search criteria"})]}):(0,J.jsxs)(n.default,{className:"p-4 gap-3",children:[(0,J.jsxs)(d.default,{className:"text-sm font-semibold text-gray-500 mb-1",children:["Found ",D.length," ",1===D.length?"result":"results"]}),D.map((t,a)=>{const s=(e=>{switch(e){case"scheduled":return{bg:"#DBEAFE",text:"#1E40AF",label:"Scheduled"};case"in-progress":return{bg:"#FEF3C7",text:"#92400E",label:"Today"};case"poured":return{bg:"#D1FAE5",text:"#065F46",label:"Poured"};default:return{bg:"#F3F4F6",text:"#6B7280",label:e}}})(t.status);return(0,J.jsxs)(o.default,{onPress:()=>(t=>{e.navigate("DailyPourSchedule",{date:t.scheduledDate.toISOString(),department:t.entry.department})})(t),className:"bg-white rounded-xl p-4 border border-gray-200 active:bg-gray-50",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center justify-between mb-3",children:[(0,J.jsx)(d.default,{className:"text-lg font-bold text-blue-600",children:t.entry.jobNumber}),(0,J.jsx)(n.default,{style:{backgroundColor:s.bg},className:"px-3 py-1 rounded-full",children:(0,J.jsx)(d.default,{style:{color:s.text},className:"text-xs font-bold",children:s.label})})]}),t.entry.jobName&&(0,J.jsx)(d.default,{className:"text-base font-semibold text-gray-900 mb-2",children:t.entry.jobName}),(0,J.jsxs)(n.default,{className:"gap-2 mb-3",children:[t.entry.idNumber&&(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"key-outline",size:14,color:"#6B7280"}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600 ml-2",children:["ID: ",t.entry.idNumber]})]}),t.entry.markNumbers&&(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"bookmark-outline",size:14,color:"#6B7280"}),(0,J.jsxs)(d.default,{className:"text-sm text-gray-600 ml-2",children:["Mark: ",t.entry.markNumbers]})]}),(0,J.jsx)(n.default,{className:"flex-row items-center",children:(0,J.jsxs)(d.default,{className:"text-sm text-gray-600",children:["Form: ",t.entry.formBedName]})}),(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"business-outline",size:14,color:"#6B7280"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-600 ml-2",children:t.entry.department})]})]}),(0,J.jsxs)(n.default,{className:"border-t border-gray-100 pt-3 flex-row items-center justify-between",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:"calendar-outline",size:16,color:"#6B7280"}),(0,J.jsx)(d.default,{className:"text-sm text-gray-700 ml-2 font-medium",children:t.scheduledDate.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]}),(0,J.jsx)(d.default,{className:"text-xs font-semibold text-gray-500",children:O(t)})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center justify-center mt-2 pt-2 border-t border-gray-100",children:[(0,J.jsx)(d.default,{className:"text-xs text-blue-600 font-medium",children:"Tap to view in schedule"}),(0,J.jsx)(x.default,{name:"chevron-forward",size:14,color:"#3B82F6",style:{marginLeft:4}})]})]},`${t.entry.id}-${a}`)})]}):(0,J.jsxs)(n.default,{className:"items-center justify-center p-8 mt-12",children:[(0,J.jsx)(x.default,{name:"search-outline",size:64,color:"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-gray-500 text-base mt-4 text-center font-semibold",children:"Search for Pieces"}),(0,J.jsx)(d.default,{className:"text-gray-400 text-sm mt-2 text-center px-4",children:"Fill in one or more fields above and tap Search to find pieces"})]})]})]})}function Ea(){const e=(0,c.useNavigation)(),t=(0,c.useRoute)(),[a,s]=((0,i.useSafeAreaInsets)(),(0,f.useState)(null)),[r,l]=(0,f.useState)(!1),[u,m]=(0,f.useState)([]),[h,p]=(0,f.useState)(!1),b=t.params?.date?new Date(t.params.date):new Date,y=t.params?.department,j=async()=>{try{console.log("[Scanner Screen] Starting capture...");const{status:a}=await _t.requestCameraPermissionsAsync();if("granted"!==a)return void Te.default.alert("Camera Permission Required","Please grant camera permission to scan schedules.",[{text:"OK"}]);const r=await _t.launchCameraAsync({mediaTypes:["images"],allowsEditing:!1,quality:1,exif:!0});if(r.canceled)return void console.log("[Scanner Screen] User canceled camera");const o=r.assets[0];if(o?.uri){console.log("[Scanner Screen] Photo captured, URI:",o.uri),s(o.uri),l(!0);try{console.log("[Scanner Screen] Starting AI parsing...");const t=await async function(e,t){try{let s;console.log("[Schedule Scanner] Starting image conversion...");try{if(e.startsWith("data:image"))console.log("[Schedule Scanner] Image is already base64 data URI"),s=e.split(",")[1]||e;else{console.log("[Schedule Scanner] Fetching image from:",e.substring(0,100));const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch image: ${t.status}`);const a=await t.blob();console.log("[Schedule Scanner] Original blob size:",a.size,"type:",a.type),console.log("[Schedule Scanner] Converting to base64 without compression..."),s=await new Promise((e,t)=>{const s=new FileReader;s.onloadend=()=>{try{const t=s.result,a=t.split(",")[1]||t;console.log("[Schedule Scanner] Base64 conversion complete, length:",a.length),e(a)}catch(a){t(new Error(`Base64 conversion error: ${a}`))}},s.onerror=()=>t(new Error("FileReader error")),s.readAsDataURL(a)})}}catch(a){throw console.error("[Schedule Scanner] Fetch/conversion error:",a),new Error(`Failed to load image: ${a instanceof Error?a.message:"Unknown error"}`)}const r=`You are a PRECISION OCR system for a precast concrete plant's production schedule. Your task is MAXIMUM ACCURACY data extraction.\n\n${t?.date?`Expected Date: ${t.date.toLocaleDateString()}`:""}\n${t?.department?`Department: ${t.department}`:""}\n\n\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f CRITICAL: YOUR RESPONSE WILL BE REJECTED IF:\n1. Number of entries \u2260 highest Position number\n2. Any ID numbers are duplicated\n3. You made assumptions or corrections instead of reading exactly what's printed\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nCRITICAL ACCURACY REQUIREMENTS:\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n\u26a0\ufe0f ZERO TOLERANCE FOR ERRORS:\n- Every digit, letter, and symbol must be EXACTLY as printed\n- Do NOT make assumptions, inferences, or corrections\n- Do NOT auto-complete patterns (job numbers, marks, IDs are often non-sequential)\n- When uncertain about a character, examine it 3 times before deciding\n- IGNORE all handwritten notes, highlighter marks, pen marks - ONLY read printed text\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nEXTRACTION METHOD (READ THIS CAREFULLY):\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nSTEP 1: COUNT ROWS \u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f ABSOLUTELY CRITICAL - DO THIS FIRST\n- Look at the "Pos" (Position) column on the far left\n- Find the HIGHEST position number visible (e.g., if highest is 15, you need 15 entries)\n- This is your target count - you MUST extract EXACTLY this many rows\n- NUMBER OF ENTRIES IN YOUR JSON = HIGHEST POSITION NUMBER (no exceptions)\n- If you cannot see all rows clearly, adjust photo or increase confidence threshold\n\nSTEP 2: EXTRACT EACH ROW LEFT TO RIGHT\nFor EACH row from position 1 to the highest position, read across the columns in this exact order:\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Column 1: POSITION (Pos)                                     \u2502\n\u2502 \u2022 Sequential number: 1, 2, 3, 4...                          \u2502\n\u2502 \u2022 This is your row counter                                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Column 2: JOB NUMBER                                         \u2502\n\u2502 \u2022 May have letter prefix (E, D, etc.) - REMOVE the letters  \u2502\n\u2502 \u2022 Extract ONLY the numeric digits                            \u2502\n\u2502 \u2022 Examples:                                                  \u2502\n\u2502   - "E255096" \u2192 "255096"                                     \u2502\n\u2502   - "255096" \u2192 "255096"                                      \u2502\n\u2502   - "D123456" \u2192 "123456"                                     \u2502\n\u2502 \u2022 Typically 5-6 digits                                       \u2502\n\u2502 \u2022 DO NOT assume all rows have same job number               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Column 3: MARK NUMBER                                        \u2502\n\u2502 \u2022 Format: Letter(s) + Number                                 \u2502\n\u2502 \u2022 Examples: H1, H2, M1, M2, DT1, G1                         \u2502\n\u2502 \u2022 Read EXACTLY as printed - case sensitive                   \u2502\n\u2502 \u2022 DO NOT assume sequential (might jump: H1, H3, H5...)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Column 4: ID NUMBER \u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f MOST CRITICAL - UNIQUE VALUES    \u2502\n\u2502 \u2022 Usually 6-7 digits                                         \u2502\n\u2502 \u2022 EVERY DIGIT MATTERS - this is the most critical data       \u2502\n\u2502 \u2022 Read digit by digit, left to right, VERY SLOWLY            \u2502\n\u2502 \u2022 Triple-check each digit:                                   \u2502\n\u2502   - Is it a 1 or 7? Look at the shape carefully             \u2502\n\u2502   - Is it a 0 or 8? Check if it's closed or open            \u2502\n\u2502   - Is it a 3 or 8? Look at the curves                      \u2502\n\u2502   - Is it a 5 or 6? Check the top and bottom                \u2502\n\u2502   - Is it a 2 or Z? Numbers only, no letters                \u2502\n\u2502 \u2022 \u26a0\ufe0f CRITICAL RULE: Every ID number MUST be DIFFERENT        \u2502\n\u2502 \u2022 If you see duplicate IDs, you MADE AN ERROR - go back     \u2502\n\u2502 \u2022 Check each ID against all others before finalizing         \u2502\n\u2502 \u2022 DO NOT assume sequential or patterns - read what's there  \u2502\n\u2502 \u2022 DO NOT auto-correct or fix what looks "wrong"             \u2502\n\u2502 \u2022 When in doubt, mark lower confidence - never guess         \u2502\n\u2502 \u2022 This field WILL BE VALIDATED - duplicates = rejection      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Column 5: LENGTH 1                                           \u2502\n\u2502 \u2022 Format: feet'-inches fraction"                             \u2502\n\u2502 \u2022 Examples:                                                  \u2502\n\u2502   - "28'-6 1/2"" (28 feet, 6 and a half inches)            \u2502\n\u2502   - "30'-0"" (30 feet, 0 inches)                           \u2502\n\u2502   - "25'-3 3/4"" (25 feet, 3 and three-quarters inches)    \u2502\n\u2502 \u2022 Keep exact spacing and formatting                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Column 6: LENGTH 2                                           \u2502\n\u2502 \u2022 Same format as LENGTH 1                                    \u2502\n\u2502 \u2022 Often identical to LENGTH 1, but NOT always                \u2502\n\u2502 \u2022 Read independently - don't copy from LENGTH 1              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Column 7: WIDTH                                              \u2502\n\u2502 \u2022 Number in inches (no units shown, just number)             \u2502\n\u2502 \u2022 Examples: 48, 24, 12, 36                                   \u2502\n\u2502 \u2022 Extract as integer number                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Column 8: ANGLE                                              \u2502\n\u2502 \u2022 Number in degrees (no degree symbol, just number)          \u2502\n\u2502 \u2022 Usually 0, but can be 2, 5, etc.                          \u2502\n\u2502 \u2022 Extract as number                                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Column 9: CUTBACK                                            \u2502\n\u2502 \u2022 Format: feet'-inches fraction" or "feet inches"            \u2502\n\u2502 \u2022 Examples:                                                  \u2502\n\u2502   - "0'-6"" (0 feet, 6 inches)                             \u2502\n\u2502   - "1'-3 1/2"" (1 foot, 3 and a half inches)              \u2502\n\u2502   - "0 ft 6 in" (alternative format)                         \u2502\n\u2502 \u2022 Keep exact formatting as shown                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nCONFIDENCE SCORING:\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nFor each entry, assign confidence 0.0 to 1.0:\n\u2022 1.0 = Crystal clear, 100% certain\n\u2022 0.9 = Very clear, high confidence\n\u2022 0.8 = Clear but minor ambiguity\n\u2022 0.7 = Readable but some blur or uncertainty\n\u2022 0.6 = Difficult to read, made best guess\n\u2022 <0.6 = Very uncertain\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nDATA VALIDATION RULES:\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nFIELDS THAT CAN HAVE IDENTICAL VALUES (across multiple rows):\n\u2713 Job Number - multiple pieces can have same job\n\u2713 Mark Number - marks can repeat\n\u2713 Length 1 - lengths can be identical\n\u2713 Length 2 - lengths can be identical\n\u2713 Width - widths can be identical\n\u2713 Angle - angles can be identical\n\u2713 Cutback - cutbacks can be identical\n\nFIELD THAT MUST BE UNIQUE:\n\u26a0\ufe0f ID NUMBER - EVERY ID MUST BE DIFFERENT\n   If you see duplicate IDs, you made a reading error. Go back and read more carefully.\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nQUALITY CHECKS BEFORE SUBMITTING (DO NOT SKIP):\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nMANDATORY CHECKS - YOUR RESPONSE WILL BE REJECTED IF ANY FAIL:\n\n\u2713 CRITICAL #1: Count the entries in your JSON array\n   \u2022 Does this number = the highest Position number you saw?\n   \u2022 If not, you're missing entries - find them and add them\n\n\u2713 CRITICAL #2: Check all ID numbers for duplicates\n   \u2022 List out all ID numbers\n   \u2022 Are there any duplicates?\n   \u2022 If yes, you made a reading error - go back and reread each ID very carefully\n\n\u2713 All ID numbers have 6-7 digits?\n\u2713 All job numbers are numeric only (letters removed)?\n\u2713 All mark numbers have letter + number format?\n\u2713 All measurements use correct format with feet' and inches"?\n\u2713 Did you read each row independently without copying patterns?\n\u2713 Did you extract EXACTLY what's printed (no corrections or assumptions)?\n\nBEFORE YOU RETURN YOUR RESPONSE:\n- Count your entries one more time\n- Scan all IDs for duplicates one more time\n- If either check fails, FIX IT NOW\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nOUTPUT FORMAT:\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nReturn ONLY valid JSON (no markdown, no explanation):\n\n{\n  "date": "date from schedule header if visible, or null",\n  "entries": [\n    {\n      "position": 1,\n      "jobNumber": "255096",\n      "markNumber": "H1",\n      "idNumber": "1234567",\n      "length1": "28'-6 1/2"",\n      "length2": "28'-6 1/2"",\n      "width": 48,\n      "angle": 0,\n      "cutback": "0'-6"",\n      "confidence": 0.95\n    }\n  ]\n}\n\nUse null for any field that is truly blank or unreadable.\n\nBEGIN EXTRACTION NOW:`;console.log("[Schedule Scanner] Starting API call...");const l=!0,o=l?"https://us-central1-precast-qc-tools-web-app.cloudfunctions.net/openaiVisionProxy":"undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}?.OPENAI_BASE_URL?`${{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.OPENAI_BASE_URL}/chat/completions`:"https://api.openai.com.proxy.vibecodeapp.com/v1/chat/completions",n=l?"not-needed-for-cloud-function":"vibecode-proxy-key";console.log("[Schedule Scanner] Platform:",l?"web":"native"),console.log("[Schedule Scanner] API URL:",o);const d={model:"gpt-4o",messages:[{role:"user",content:[{type:"text",text:r},{type:"image_url",image_url:{url:`data:image/jpeg;base64,${s}`,detail:"high"}}]}],temperature:0,max_tokens:8e3},i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)};l||(i.headers.Authorization=`Bearer ${n}`);const c=await fetch(o,i);if(!c.ok){const e=await c.text();throw console.error("[Schedule Scanner] API Error:",c.status,e),new Error(`API request failed: ${c.status} ${e}`)}const u=await c.json(),m=u.choices?.[0]?.message?.content;if(!m)throw new Error("No response from AI");console.log("[Schedule Scanner] Successfully parsed schedule image");let x=m.match(/\{[\s\S]*\}/);const f=x?x[0]:m,g=JSON.parse(f);let h=(g.entries||[]).map(e=>Object.assign({},e,{jobNumber:e.jobNumber?xa(e.jobNumber):""}));if(console.log("[Schedule Scanner] Validation checks:"),h.length>0){const e=[];for(const t of h)t.position&&"number"===typeof t.position&&e.push(t.position);if(e.length>0){const t=Math.max(...e);console.log(`[Schedule Scanner] Entry count: ${h.length}, Highest position: ${t}`),h.length!==t&&console.warn(`[Schedule Scanner] WARNING: Entry count mismatch! Found ${h.length} entries but highest Position is ${t}`)}}const p=[];for(const e of h)e.idNumber&&"string"===typeof e.idNumber&&""!==e.idNumber.trim()&&p.push(e.idNumber.trim());if(p.length>0){const e=new Set(p);if(console.log(`[Schedule Scanner] Total IDs: ${p.length}, Unique IDs: ${e.size}`),e.size!==p.length){const e=[],t=new Set;for(const a of p)t.has(a)&&(e.includes(a)||e.push(a)),t.add(a);console.warn(`[Schedule Scanner] WARNING: Duplicate ID numbers found: ${e.join(", ")}`)}}return{success:!0,entries:h,date:g.date,rawText:m}}catch(qa){return console.error("Schedule parsing error:",qa),{success:!1,entries:[],error:qa instanceof Error?qa.message:"Failed to parse schedule"}}}(o.uri,{date:b});console.log("[Scanner Screen] Parse result:",t),l(!1),t.success&&t.entries.length>0?(console.log("[Scanner Screen] Successfully parsed",t.entries.length,"entries"),m(t.entries),p(!0)):(console.error("[Scanner Screen] No entries found or parse failed:",t.error),Te.default.alert("No Data Found",t.error||"Could not extract schedule entries from the image. Please try again with better lighting or a clearer photo.",[{text:"Retry",onPress:()=>{s(null),l(!1)}},{text:"Cancel",onPress:()=>e.goBack()}]))}catch(t){console.error("[Scanner Screen] Parse error:",t),l(!1),s(null);const a=t instanceof Error?t.message:"Unknown error";Te.default.alert("Processing Error",`Failed to process image: ${a}`,[{text:"Retry",onPress:j},{text:"Cancel",onPress:()=>e.goBack()}])}}}catch(qa){console.error("[Scanner Screen] Capture error:",qa),l(!1),s(null);const t=qa instanceof Error?qa.message:"Unknown error";Te.default.alert("Camera Error",`Failed to capture image: ${t}`,[{text:"OK"}])}},N=()=>{try{console.log("[Scanner Screen] Importing",u.length,"entries"),console.log("[Scanner Screen] Date:",b.toISOString()),console.log("[Scanner Screen] Department:",y),e.navigate("ScheduleReview",{entries:u,date:b.toISOString(),department:y})}catch(qa){console.error("[Scanner Screen] Navigation error:",qa),Te.default.alert("Navigation Error","Failed to navigate to review screen. Please try again.",[{text:"OK"}])}},w=()=>{s(null),p(!1),m([])};return a||h?r?(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#111827"},children:(0,J.jsxs)(n.default,{style:{flex:1,justifyContent:"center",alignItems:"center",padding:32},children:[a&&(0,J.jsx)(Vt.default,{source:{uri:a},style:{width:"100%",height:300,borderRadius:12,marginBottom:32},resizeMode:"contain"}),(0,J.jsx)(q.default,{size:"large",color:"#3b82f6"}),(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:18,fontWeight:"600",marginTop:16,textAlign:"center"},children:"Analyzing Schedule..."}),(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginTop:8,textAlign:"center"},children:"Extracting entries from image"})]})}):h&&u.length>0?(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#111827"},children:(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:16,paddingVertical:12,borderBottomWidth:1,borderBottomColor:"#1f2937"},children:[(0,J.jsx)(o.default,{onPress:w,children:(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#fff"})}),(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:18,fontWeight:"600"},children:"Scan Results"}),(0,J.jsx)(n.default,{style:{width:24}})]}),(0,J.jsxs)(g.default,{style:{flex:1},contentContainerStyle:{padding:16},children:[a&&(0,J.jsx)(n.default,{style:{marginBottom:16},children:(0,J.jsx)(Vt.default,{source:{uri:a},style:{width:"100%",height:200,borderRadius:12},resizeMode:"contain"})}),(0,J.jsxs)(n.default,{style:{backgroundColor:"#1f2937",borderRadius:12,padding:16,marginBottom:16},children:[(0,J.jsxs)(d.default,{style:{color:"#3b82f6",fontSize:18,fontWeight:"700",marginBottom:8},children:["Found ",u.length," ",1===u.length?"Entry":"Entries"]}),(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14},children:"Review the entries below and import to your schedule"})]}),u.map((e,t)=>(0,J.jsxs)(n.default,{style:{backgroundColor:"#1f2937",borderRadius:12,padding:16,marginBottom:12},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,J.jsxs)(d.default,{style:{color:"#fff",fontSize:16,fontWeight:"600"},children:["Entry ",t+1]}),e.position&&(0,J.jsxs)(d.default,{style:{color:"#3b82f6",fontSize:14,fontWeight:"600"},children:["Position ",e.position]})]}),e.jobNumber&&(0,J.jsxs)(d.default,{style:{color:"#d1d5db",fontSize:14,marginBottom:4},children:["\ud83d\udccb Job: ",e.jobNumber]}),e.markNumber&&(0,J.jsxs)(d.default,{style:{color:"#d1d5db",fontSize:14,marginBottom:4},children:["\ud83c\udff7\ufe0f Mark: ",e.markNumber]}),e.idNumber&&(0,J.jsxs)(d.default,{style:{color:"#d1d5db",fontSize:14,marginBottom:4},children:["\ud83d\udd22 ID: ",e.idNumber]}),e.length1&&(0,J.jsxs)(d.default,{style:{color:"#d1d5db",fontSize:14,marginBottom:4},children:["\ud83d\udccf Length 1: ",e.length1]}),e.length2&&(0,J.jsxs)(d.default,{style:{color:"#d1d5db",fontSize:14,marginBottom:4},children:["\ud83d\udccf Length 2: ",e.length2]}),void 0!==e.width&&(0,J.jsxs)(d.default,{style:{color:"#d1d5db",fontSize:14,marginBottom:4},children:["\u2194\ufe0f Width: ",e.width,'"']}),void 0!==e.angle&&(0,J.jsxs)(d.default,{style:{color:"#d1d5db",fontSize:14,marginBottom:4},children:["\ud83d\udcd0 Angle: ",e.angle,"\xb0"]}),e.cutback&&(0,J.jsxs)(d.default,{style:{color:"#d1d5db",fontSize:14},children:["\u2702\ufe0f Cutback: ",e.cutback]})]},t))]}),(0,J.jsxs)(n.default,{style:{padding:16,borderTopWidth:1,borderTopColor:"#1f2937",gap:12},children:[(0,J.jsx)(o.default,{onPress:N,style:{backgroundColor:"#3b82f6",paddingVertical:16,borderRadius:12,alignItems:"center"},children:(0,J.jsxs)(d.default,{style:{color:"#fff",fontSize:16,fontWeight:"600"},children:["Import ",u.length," ",1===u.length?"Entry":"Entries"]})}),(0,J.jsx)(o.default,{onPress:w,style:{backgroundColor:"#374151",paddingVertical:16,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:16,fontWeight:"600"},children:"Retake Photo"})})]})]})}):null:(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#111827"},children:(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:16,paddingVertical:12,borderBottomWidth:1,borderBottomColor:"#1f2937"},children:[(0,J.jsx)(o.default,{onPress:()=>e.goBack(),children:(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#fff"})}),(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:18,fontWeight:"600"},children:"Scan Schedule"}),(0,J.jsx)(n.default,{style:{width:24}})]}),(0,J.jsxs)(n.default,{style:{flex:1,justifyContent:"center",alignItems:"center",padding:32},children:[(0,J.jsx)(x.default,{name:"camera-outline",size:96,color:"#3b82f6",style:{marginBottom:24}}),(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:24,fontWeight:"700",textAlign:"center",marginBottom:16},children:"Take a Photo of Your Schedule"}),(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:16,textAlign:"center",marginBottom:32,lineHeight:24},children:"Use your phone's native camera for the sharpest results. Frame the Position through Cutback columns."}),(0,J.jsxs)(n.default,{style:{backgroundColor:"#1f2937",borderRadius:12,padding:20,marginBottom:32,width:"100%"},children:[(0,J.jsx)(d.default,{style:{color:"#3b82f6",fontSize:16,fontWeight:"600",marginBottom:12},children:"Tips for Best Results:"}),(0,J.jsxs)(n.default,{style:{gap:8},children:[(0,J.jsx)(d.default,{style:{color:"#d1d5db",fontSize:14},children:"\u2022 Get as close as possible to the schedule"}),(0,J.jsx)(d.default,{style:{color:"#d1d5db",fontSize:14},children:"\u2022 Hold phone steady and wait for focus"}),(0,J.jsx)(d.default,{style:{color:"#d1d5db",fontSize:14},children:"\u2022 Use flash in low light conditions"}),(0,J.jsx)(d.default,{style:{color:"#d1d5db",fontSize:14},children:"\u2022 Frame Position through Cutback columns"})]})]}),(0,J.jsx)(o.default,{onPress:j,style:{backgroundColor:"#3b82f6",paddingHorizontal:32,paddingVertical:16,borderRadius:12,width:"100%",alignItems:"center"},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",gap:8},children:[(0,J.jsx)(x.default,{name:"camera",size:24,color:"#fff"}),(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:18,fontWeight:"600"},children:"Open Camera"})]})})]})]})})}function za(){const e=(0,c.useNavigation)(),t=(0,c.useRoute)(),a=Ca(e=>e.addPourEntry),s=Ca(e=>e.forms),r=(Ca(e=>e.getFormsByDepartment),fe(e=>e.projects)),l=fe(e=>e.addProject),[i,u]=(0,f.useState)(t.params.entries),[m,b]=(0,f.useState)(null),[y,j]=(0,f.useState)(!1),[N,w]=(0,f.useState)(new Date(t.params.date)),S=t.params.department,F=S?s.filter(e=>e.department===S&&e.isActive):s.filter(e=>e.isActive),C=(e,t,a)=>{const s=[...i];s[e]=Object.assign({},s[e],{[t]:a}),u(s)},v=()=>{let t=0;const r=[],l=new Date(N);l.setHours(0,0,0,0);const o=l.getTime();i.forEach(e=>{const n=s.find(t=>t.name===e.formBed||t.id===e.formBed),d=n?.department||"Precast";r.push(`Entry: Job ${e.jobNumber}\n  formBed: "${e.formBed}"\n  form found: ${n?"YES":"NO"}\n  formBedId: "${n?.id||e.formBed}"\n  formBedName: "${n?.name||e.formBed}"\n  department: "${d}"\n  scheduledDate: ${o} (${l.toLocaleString()})`),a({formBedId:n?.id||e.formBed||"",formBedName:n?.name||e.formBed||"",department:d,scheduledDate:o,scheduledTime:e.scheduledTime||void 0,jobNumber:e.jobNumber,jobName:e.jobName||void 0,idNumber:e.idNumber||void 0,markNumbers:e.markNumber||void 0,pieceCount:1,productType:e.productType||void 0,concreteYards:e.concreteYards||void 0,mixDesign:e.mixDesign||void 0,notes:e.notes||void 0,status:"Scheduled",foreman:void 0,createdBy:"Scanner"}),t++});const n=l.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});Te.default.alert("Import Successful! \u2713",`${t} ${1===t?"piece":"pieces"} imported to:\n\n\ud83d\udcc5 Date: ${n}\n`+(S?`\ud83c\udfed Department: ${S}\n\n`:"\n")+"You'll be taken to the schedule to view your entries.",[{text:"View Schedule",onPress:()=>{e.navigate("DailyPourSchedule",{date:N.toISOString(),department:S||void 0})}}])},A=()=>{if(null===m)return null;const e=i[m];return(0,J.jsxs)(n.default,{style:{flex:1,backgroundColor:"#111827",padding:16},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:18,fontWeight:"600"},children:"Edit Entry"}),(0,J.jsx)(o.default,{onPress:()=>b(null),style:{padding:8},children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#9ca3af"})})]}),(0,J.jsx)(g.default,{children:(0,J.jsxs)(n.default,{style:{gap:16},children:[(0,J.jsxs)(n.default,{style:{backgroundColor:"#374151",padding:12,borderRadius:8,marginBottom:4},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:8},children:[(0,J.jsx)(x.default,{name:"layers",size:20,color:"#60a5fa",style:{marginRight:8}}),(0,J.jsx)(d.default,{style:{color:"#60a5fa",fontSize:14,fontWeight:"600"},children:"Assign Current Form/Bed"})]}),(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:12},children:"Where is this piece actually being poured today?"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Select Form / Bed *"}),(0,J.jsx)(n.default,{style:{backgroundColor:"#1f2937",borderRadius:8,padding:12,maxHeight:200},children:(0,J.jsx)(g.default,{nestedScrollEnabled:!0,children:F.map(t=>(0,J.jsx)(o.default,{onPress:()=>C(m,"formBed",t.name),style:{padding:12,backgroundColor:e.formBed===t.name?"#3b82f6":"#374151",borderRadius:8,marginBottom:8},children:(0,J.jsxs)(d.default,{style:{color:"#fff",fontSize:14,fontWeight:e.formBed===t.name?"600":"400"},children:[t.name," (",t.department,")"]})},t.id))})}),e.formBed&&(0,J.jsxs)(n.default,{style:{backgroundColor:"#065f46",padding:10,borderRadius:8,marginTop:8,flexDirection:"row",alignItems:"center"},children:[(0,J.jsx)(x.default,{name:"checkmark-circle",size:18,color:"#10b981",style:{marginRight:8}}),(0,J.jsxs)(d.default,{style:{color:"#10b981",fontSize:13,fontWeight:"600"},children:["Assigned to: ",e.formBed]})]}),!e.formBed&&(0,J.jsxs)(n.default,{style:{backgroundColor:"#78350f",padding:10,borderRadius:8,marginTop:8,flexDirection:"row",alignItems:"center"},children:[(0,J.jsx)(x.default,{name:"alert-circle",size:18,color:"#f59e0b",style:{marginRight:8}}),(0,J.jsx)(d.default,{style:{color:"#f59e0b",fontSize:13},children:"Required: Select a form/bed above"})]})]}),(0,J.jsx)(n.default,{children:(0,J.jsx)(va,{jobNumber:e.jobNumber,jobName:e.jobName||"",onJobNumberChange:e=>C(m,"jobNumber",e),onJobNameChange:e=>C(m,"jobName",e),required:!0,jobNumberLabel:"Job Number",jobNameLabel:"Job Name",theme:"dark"})}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"ID Number"}),(0,J.jsx)(h.default,{value:e.idNumber||"",onChangeText:e=>C(m,"idNumber",e),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16},placeholder:"ID from schedule",placeholderTextColor:"#6b7280",cursorColor:"#000000"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Mark Number"}),(0,J.jsx)(h.default,{value:e.markNumber||"",onChangeText:e=>C(m,"markNumber",e),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16},placeholder:"e.g., M1, M2",placeholderTextColor:"#6b7280",cursorColor:"#000000"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Length 1"}),(0,J.jsx)(h.default,{value:e.length1||"",onChangeText:e=>C(m,"length1",e),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16},placeholder:"e.g., 28'-6 1/2 inches",placeholderTextColor:"#6b7280",cursorColor:"#000000"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Length 2"}),(0,J.jsx)(h.default,{value:e.length2||"",onChangeText:e=>C(m,"length2",e),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16},placeholder:"e.g., 28'-6 1/2 inches",placeholderTextColor:"#6b7280",cursorColor:"#000000"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Width (inches)"}),(0,J.jsx)(h.default,{value:e.width?.toString()||"",onChangeText:e=>C(m,"width",parseFloat(e)||void 0),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16},placeholder:"e.g., 48",placeholderTextColor:"#6b7280",cursorColor:"#000000",keyboardType:"decimal-pad"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Angle (degrees)"}),(0,J.jsx)(h.default,{value:e.angle?.toString()||"",onChangeText:e=>C(m,"angle",parseFloat(e)||void 0),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16},placeholder:"e.g., 0",placeholderTextColor:"#6b7280",cursorColor:"#000000",keyboardType:"decimal-pad"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Cutback"}),(0,J.jsx)(h.default,{value:e.cutback||"",onChangeText:e=>C(m,"cutback",e),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16},placeholder:"e.g., 0 ft 6 in",placeholderTextColor:"#6b7280",cursorColor:"#000000"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Product Type"}),(0,J.jsx)(h.default,{value:e.productType||"",onChangeText:e=>C(m,"productType",e),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16},placeholder:"e.g., Beam, Slab",placeholderTextColor:"#6b7280",cursorColor:"#000000"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Concrete Yards"}),(0,J.jsx)(h.default,{value:e.concreteYards?.toString()||"",onChangeText:e=>C(m,"concreteYards",parseFloat(e)||0),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16},placeholder:"0.0",placeholderTextColor:"#6b7280",cursorColor:"#000000",keyboardType:"decimal-pad"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Mix Design"}),(0,J.jsx)(h.default,{value:e.mixDesign||"",onChangeText:e=>C(m,"mixDesign",e),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16},placeholder:"e.g., 6000 PSI",placeholderTextColor:"#6b7280",cursorColor:"#000000"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Scheduled Time"}),(0,J.jsx)(h.default,{value:e.scheduledTime||"",onChangeText:e=>C(m,"scheduledTime",e),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16},placeholder:"e.g., 8:00 AM",placeholderTextColor:"#6b7280",cursorColor:"#000000"})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,marginBottom:8},children:"Notes"}),(0,J.jsx)(h.default,{value:e.notes||"",onChangeText:e=>C(m,"notes",e),style:{backgroundColor:"#1f2937",color:"#fff",padding:12,borderRadius:8,fontSize:16,height:80},placeholder:"Additional notes",placeholderTextColor:"#6b7280",cursorColor:"#000000",multiline:!0,textAlignVertical:"top"})]}),void 0!==e.confidence&&(0,J.jsx)(n.default,{style:{backgroundColor:"#1f2937",padding:12,borderRadius:8},children:(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:14},children:["AI Confidence: ",(0,J.jsxs)(d.default,{style:{color:e.confidence>.7?"#10b981":"#f59e0b",fontWeight:"600"},children:[Math.round(100*e.confidence),"%"]})]})})]})}),(0,J.jsx)(o.default,{onPress:()=>b(null),style:{backgroundColor:"#3b82f6",padding:16,borderRadius:12,alignItems:"center",marginTop:16},children:(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:16,fontWeight:"600"},children:"Done Editing"})})]})};return null!==m?(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#111827"},edges:["top","left","right"],children:A()}):(0,J.jsxs)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#111827"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:"#374151"},children:[(0,J.jsx)(o.default,{onPress:()=>e.goBack(),children:(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#fff"})}),(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:18,fontWeight:"600"},children:"Review Entries"}),(0,J.jsx)(n.default,{style:{width:24}})]}),(0,J.jsxs)(n.default,{style:{padding:16,paddingBottom:8},children:[S&&(0,J.jsxs)(n.default,{style:{backgroundColor:"#1f2937",padding:12,borderRadius:8,marginBottom:12,borderWidth:1,borderColor:"#3b82f6"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,J.jsx)(x.default,{name:"business",size:18,color:"#60a5fa",style:{marginRight:8}}),(0,J.jsxs)(d.default,{style:{color:"#60a5fa",fontSize:14,fontWeight:"600"},children:["Importing to: ",S]})]}),(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:12,marginTop:4},children:"Only showing forms from this department"})]}),(0,J.jsxs)(d.default,{style:{color:"#fff",fontSize:16,fontWeight:"600",marginBottom:4},children:[i.length," ",1===i.length?"piece":"pieces"," scanned"]}),(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14},children:"Assign current Form/Bed for each piece"}),i.filter(e=>!e.formBed).length>0&&(0,J.jsxs)(n.default,{style:{backgroundColor:"#374151",padding:12,borderRadius:8,marginTop:8,flexDirection:"row",alignItems:"center"},children:[(0,J.jsx)(x.default,{name:"alert-circle",size:20,color:"#f59e0b",style:{marginRight:8}}),(0,J.jsxs)(d.default,{style:{color:"#f59e0b",fontSize:13,flex:1},children:[i.filter(e=>!e.formBed).length," ",1===i.filter(e=>!e.formBed).length?"piece needs":"pieces need"," bed assignment"]})]})]}),(0,J.jsx)(n.default,{style:{paddingHorizontal:16,paddingBottom:8},children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#1f2937",borderRadius:12,padding:14},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:8},children:[(0,J.jsx)(x.default,{name:"calendar",size:18,color:"#60a5fa",style:{marginRight:8}}),(0,J.jsx)(d.default,{style:{color:"#60a5fa",fontSize:14,fontWeight:"600"},children:"Pour Date"})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,J.jsx)(o.default,{onPress:()=>{const e=new Date(N);e.setDate(e.getDate()-1),w(e)},style:{padding:8,backgroundColor:"#374151",borderRadius:8},children:(0,J.jsx)(x.default,{name:"chevron-back",size:20,color:"#fff"})}),(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:15,fontWeight:"600",flex:1,textAlign:"center"},children:N.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})}),(0,J.jsx)(o.default,{onPress:()=>{const e=new Date(N);e.setDate(e.getDate()+1),w(e)},style:{padding:8,backgroundColor:"#374151",borderRadius:8},children:(0,J.jsx)(x.default,{name:"chevron-forward",size:20,color:"#fff"})})]}),(0,J.jsx)(o.default,{onPress:()=>w(new Date),style:{marginTop:8,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#60a5fa",fontSize:13},children:"Today"})})]})}),(0,J.jsx)(n.default,{style:{paddingHorizontal:16,paddingBottom:8},children:(0,J.jsxs)(o.default,{onPress:()=>j(!0),style:{backgroundColor:"#8B5CF6",padding:14,borderRadius:12,flexDirection:"row",alignItems:"center",justifyContent:"center"},children:[(0,J.jsx)(x.default,{name:"copy",size:20,color:"#fff",style:{marginRight:8}}),(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:15,fontWeight:"600"},children:"Assign All to Same Bed"})]})}),(0,J.jsxs)(g.default,{style:{flex:1,padding:16,paddingTop:8},children:[i.map((e,t)=>(0,J.jsxs)(n.default,{style:{backgroundColor:"#1f2937",padding:16,borderRadius:12,marginBottom:12},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(n.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:4},children:e.formBed?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(x.default,{name:"checkmark-circle",size:18,color:"#10b981",style:{marginRight:6}}),(0,J.jsx)(d.default,{style:{color:"#10b981",fontSize:16,fontWeight:"600"},children:e.formBed})]}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(x.default,{name:"alert-circle",size:18,color:"#f59e0b",style:{marginRight:6}}),(0,J.jsx)(d.default,{style:{color:"#f59e0b",fontSize:16,fontWeight:"600"},children:"Bed Not Assigned"})]})}),(0,J.jsxs)(d.default,{style:{color:"#3b82f6",fontSize:15,fontWeight:"600",marginBottom:2},children:["Job ",e.jobNumber,e.markNumber?` \u2022 ${e.markNumber}`:""]}),(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:13},children:e.idNumber?`ID: ${e.idNumber}`:`Piece ${t+1}`})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:8},children:[(0,J.jsx)(o.default,{onPress:()=>b(t),style:{padding:8,backgroundColor:e.formBed?"#374151":"#78350f",borderRadius:8},children:(0,J.jsx)(x.default,{name:e.formBed?"create-outline":"add-circle",size:20,color:e.formBed?"#3b82f6":"#f59e0b"})}),(0,J.jsx)(o.default,{onPress:()=>(e=>{Te.default.alert("Remove Entry","Are you sure you want to remove this entry?",[{text:"Cancel",style:"cancel"},{text:"Remove",style:"destructive",onPress:()=>{const t=i.filter((t,a)=>a!==e);u(t),m===e&&b(null)}}])})(t),style:{padding:8,backgroundColor:"#374151",borderRadius:8},children:(0,J.jsx)(x.default,{name:"trash-outline",size:20,color:"#ef4444"})})]})]}),(0,J.jsxs)(n.default,{style:{gap:4},children:[e.markNumber&&(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:13},children:["\ud83c\udff7\ufe0f Mark: ",e.markNumber]}),e.jobName&&(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:13},children:["\ud83d\udccb ",e.jobName]}),e.length1&&(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:13},children:["\ud83d\udccf Length 1: ",e.length1]}),e.length2&&(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:13},children:["\ud83d\udccf Length 2: ",e.length2]}),void 0!==e.width&&(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:13},children:["\u2194\ufe0f Width: ",e.width,'"']}),void 0!==e.angle&&(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:13},children:["\ud83d\udcd0 Angle: ",e.angle,"\xb0"]}),e.cutback&&(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:13},children:["\u2702\ufe0f Cutback: ",e.cutback]}),e.concreteYards&&(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:13},children:["\ud83c\udfd7\ufe0f ",e.concreteYards," yd\xb3"]}),e.mixDesign&&(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:13},children:["\ud83e\uddea ",e.mixDesign]}),e.scheduledTime&&(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:13},children:["\u23f0 ",e.scheduledTime]})]}),void 0!==e.confidence&&(0,J.jsx)(n.default,{style:{marginTop:8,paddingTop:8,borderTopWidth:1,borderTopColor:"#374151"},children:(0,J.jsxs)(d.default,{style:{color:e.confidence>.7?"#10b981":"#f59e0b",fontSize:12},children:[Math.round(100*e.confidence),"% confidence"]})})]},t)),0===i.length&&(0,J.jsxs)(n.default,{style:{alignItems:"center",padding:32},children:[(0,J.jsx)(x.default,{name:"document-outline",size:64,color:"#374151",style:{marginBottom:16}}),(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:16,textAlign:"center"},children:"No entries to review"})]})]}),i.length>0&&(0,J.jsx)(n.default,{style:{padding:16,borderTopWidth:1,borderTopColor:"#374151",gap:12},children:(0,J.jsx)(o.default,{onPress:()=>{if(0===i.length)return void Te.default.alert("No Entries","There are no entries to import.");const e=i.filter(e=>!e.formBed||!e.formBed.trim());if(e.length>0)return void Te.default.alert("Missing Form/Bed Assignments",`${e.length} ${1===e.length?"entry needs":"entries need"} a Form/Bed assigned. Please assign forms to all entries before importing.`,[{text:"OK"}]);const t=new Set(r.map(e=>e.jobNumber)),a=new Set,s=[];if(i.forEach(e=>{t.has(e.jobNumber)||a.has(e.jobNumber)||(a.add(e.jobNumber),s.push({jobNumber:e.jobNumber,jobName:e.jobName}))}),s.length>0){const e=s.map(e=>`  \u2022 ${e.jobNumber}${e.jobName?` (${e.jobName})`:""}`).join("\n");return void Te.default.alert("Job(s) Not Found",`The following job ${1===s.length?"number is":"numbers are"} not in the Project Library:\n\n${e}\n\nDo you want to create ${1===s.length?"it":"them"}?`,[{text:"No",style:"cancel",onPress:()=>{}},{text:"Yes, Create",onPress:()=>{s.forEach(e=>{l({jobNumber:e.jobNumber,jobName:e.jobName||`Job ${e.jobNumber}`,location:"",salesperson:"",projectManager:"",assignedEngineer:"",assignedDrafter:"",pieceCountByType:[],createdBy:"Scanner"})}),v()}}])}v()},style:{backgroundColor:"#10b981",padding:16,borderRadius:12,alignItems:"center"},children:(0,J.jsxs)(d.default,{style:{color:"#fff",fontSize:16,fontWeight:"600"},children:["Import All ",i.length," ",1===i.length?"Entry":"Entries"]})})}),(0,J.jsx)(p.default,{visible:y,animationType:"slide",transparent:!0,onRequestClose:()=>j(!1),children:(0,J.jsx)(n.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"flex-end"},children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#111827",borderTopLeftRadius:24,borderTopRightRadius:24,maxHeight:"70%"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:20,borderBottomWidth:1,borderBottomColor:"#374151"},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:18,fontWeight:"600",marginBottom:4},children:"Assign All to Same Bed"}),(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:14},children:[i.length," pieces will be assigned"]})]}),(0,J.jsx)(o.default,{onPress:()=>j(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#9ca3af"})})]}),(0,J.jsx)(g.default,{style:{padding:16},children:F.map(e=>(0,J.jsx)(o.default,{onPress:()=>(e=>{const t=i.map(t=>Object.assign({},t,{formBed:e}));u(t),j(!1),Te.default.alert("Beds Assigned \u2713",`All ${i.length} pieces assigned to ${e}.\n\nNext: Click "Import All" button below to save these entries.`,[{text:"Got it"}])})(e.name),style:{backgroundColor:"#1f2937",padding:16,borderRadius:12,marginBottom:12,borderWidth:2,borderColor:"#374151"},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:16,fontWeight:"600",marginBottom:4},children:e.name}),(0,J.jsxs)(d.default,{style:{color:"#9ca3af",fontSize:14},children:[e.department,e.capacity?` \u2022 ${e.capacity}`:""]})]}),(0,J.jsx)(x.default,{name:"arrow-forward",size:20,color:"#3b82f6"})]})},e.id))}),(0,J.jsx)(n.default,{style:{padding:16,borderTopWidth:1,borderTopColor:"#374151"},children:(0,J.jsx)(o.default,{onPress:()=>j(!1),style:{backgroundColor:"#374151",padding:14,borderRadius:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:16,fontWeight:"600"},children:"Cancel"})})})]})})})]})}var Ba=a(62358);async function Da(e){try{let a;console.log("[Product Tag Scanner] Starting image conversion, URI:",e);try{const t=await fetch(e);if(console.log("[Product Tag Scanner] Fetch response status:",t.status),!t.ok)throw new Error(`Failed to fetch image: ${t.status}`);const s=await t.blob();console.log("[Product Tag Scanner] Original blob size:",s.size,"type:",s.type);const r=await async function(e){return new Promise((t,a)=>{const s=new Image,r=document.createElement("canvas"),l=r.getContext("2d");s.onload=()=>{const e=1600;let o=s.width,n=s.height;o>n&&o>e?(n=n*e/o,o=e):n>e&&(o=o*e/n,n=e),r.width=o,r.height=n,l?(l.drawImage(s,0,0,o,n),r.toBlob(e=>{e?t(e):a(new Error("Failed to compress image"))},"image/jpeg",.85)):a(new Error("Failed to get canvas context"))},s.onerror=()=>a(new Error("Failed to load image for compression")),s.src=URL.createObjectURL(e)})}(s);console.log("[Product Tag Scanner] Compressed blob size:",r.size,"reduction:",Math.round(100*(1-r.size/s.size))+"%"),a=await new Promise((e,t)=>{const a=new FileReader;a.onloadend=()=>{const t=a.result;console.log("[Product Tag Scanner] FileReader complete, data length:",t.length);const s=t.split(",")[1]||t;e(s)},a.onerror=e=>{console.error("[Product Tag Scanner] FileReader error:",e),t(e)},a.readAsDataURL(r)})}catch(t){if(console.error("[Product Tag Scanner] Fetch/conversion error:",t),!e.startsWith("data:"))throw new Error(`Failed to load image: ${t instanceof Error?t.message:"Unknown error"}`);console.log("[Product Tag Scanner] Image is already a data URL, extracting base64..."),a=e.split(",")[1]||e}console.log("[Product Tag Scanner] Base64 conversion complete, length:",a.length);const s='You are analyzing a product tag from a precast concrete hollow-core plank. Extract ALL the following information from the tag.\n\nFIELD EXTRACTION RULES (CRITICAL - FOLLOW EXACTLY):\n\n1. JOB NUMBER (Project Number):\n   - Usually a 6-digit number like "255096"\n   - Extract as-is, numeric only\n\n2. MARK NUMBER:\n   - Format like "H105", "M1", "M2", etc.\n   - Include the letter prefix (H, M, etc.)\n\n3. SPAN:\n   - Format like "28\'-5"" or "33\'-2.5""\n   - First number is FEET\n   - Second number (after apostrophe) is INCHES as DECIMAL (e.g., 5" means 5.0 inches, 2.5" means 2.5 inches)\n   - Return as separate feet and inches values\n\n4. ID NUMBER:\n   - Usually a 7-digit number like "1350951"\n   - Extract as-is\n\n5. WIDTH (from "8 x 48" pattern):\n   - Look for pattern like "8 x 48" or "8 X 48"\n   - Extract ONLY the second number (48) - this is the width\n   - The first number (8) should be IGNORED for now\n\n6. STRAND PATTERN:\n   - Look for a 2-3 digit number like "126" or "107" or "77" or "148"\n   - ALWAYS append "-70" to this number\n   - Example: if you see "126", return "126-70"\n   - Example: if you see "107", return "107-70"\n\n7. POUR DATE:\n   - Format on tag is MM.DD.YYYY (e.g., "09.12.2025" means September 12th, 2025)\n   - Simply convert dots to forward slashes\n   - Example: "09.12.2025" \u2192 "09/12/2025" (September 12th, 2025)\n   - Example: "12.09.2025" \u2192 "12/09/2025" (December 9th, 2025)\n   - IMPORTANT: First number is MONTH, second is DAY, third is YEAR - just replace dots with slashes\n\n8. IGNORE THESE:\n   - Any "E" or "D" letter standing alone (skip it)\n   - Any "#" followed by numbers at the top (internal tracking)\n   - The first number in the "8 x 48" pattern (the height)\n\nLAYOUT EXAMPLE:\nThe tag typically shows:\n- Top: tracking number (ignore)\n- Job Number: 6 digits (255096)\n- Letter E or D (ignore)\n- Mark Number: letter+digits (H105)\n- Span: feet\'inches" format (28\'-5")\n- ID Number: 7 digits (1350951)\n- Size: "8 x 48" pattern (extract only 48)\n- Strand number: 2-3 digits (126) \u2192 convert to "126-70"\n- Pour Date: MM.DD.YYYY (09.12.2025) \u2192 convert to MM/DD/YYYY (09/12/2025)\n\nReturn ONLY a valid JSON object with this structure:\n{\n  "projectNumber": "255096",\n  "markNumber": "H105",\n  "idNumber": "1350951",\n  "span": {\n    "feet": 28,\n    "inches": 5.0\n  },\n  "pourDate": "09/12/2025",\n  "strandPattern": "126-70",\n  "productWidth": 48\n}\n\nIMPORTANT:\n- Return null for any field you cannot find\n- Be precise with numbers - don\'t guess\n- Always append "-70" to the strand pattern number\n- Pour date format: MM.DD.YYYY on tag \u2192 MM/DD/YYYY in output (just replace dots with slashes)\n- For span inches: if you see "5"", that means 5.0 inches (decimal)\n- Extract ONLY the width (second number) from "8 x 48" pattern\n\nReturn ONLY the JSON, no other text.';console.log("[Product Tag Scanner] Starting API call...");const r=!0,l=r?"https://us-central1-precast-qc-tools-web-app.cloudfunctions.net/openaiVisionProxy":"undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}?.OPENAI_BASE_URL?`${{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"Precast Quality Tools",slug:"precast-quality-tools",scheme:"precastqc",version:"1.0.0",orientation:"portrait",userInterfaceStyle:"light",newArchEnabled:!0,platforms:["ios","android","web"],web:{},sdkVersion:"53.0.0"},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.OPENAI_BASE_URL}/chat/completions`:"https://api.openai.com.proxy.vibecodeapp.com/v1/chat/completions",o=r?"not-needed-for-cloud-function":"vibecode-proxy-key";console.log("[Product Tag Scanner] Platform:",r?"web":"native"),console.log("[Product Tag Scanner] API URL:",l),console.log("[Product Tag Scanner] Making fetch request...");const n=new AbortController,d=setTimeout(()=>n.abort(),3e4),i={model:"gpt-4o-mini",messages:[{role:"user",content:[{type:"text",text:s},{type:"image_url",image_url:{url:`data:image/jpeg;base64,${a}`,detail:"high"}}]}],temperature:.1,max_tokens:300},c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i),signal:n.signal};r||(c.headers.Authorization=`Bearer ${o}`);const u=await fetch(l,c);if(clearTimeout(d),console.log("[Product Tag Scanner] Fetch completed, status:",u.status),console.log("[Product Tag Scanner] Response headers:",Object.fromEntries(u.headers.entries())),!u.ok){const e=await u.text();throw console.error("[Product Tag Scanner] API Error:",u.status,e),alert(`API Error (${u.status}): ${e.substring(0,200)}`),new Error(`API request failed: ${u.status} ${e}`)}const m=await u.json();console.log("[Product Tag Scanner] Full API response:",JSON.stringify(m,null,2));const x=m.choices?.[0]?.message?.content;if(!x)throw new Error("No response from AI");console.log("[Product Tag Scanner] Raw AI response:",x);let f=x.match(/\{[\s\S]*\}/);const g=f?f[0]:x,h=JSON.parse(g);return console.log("[Product Tag Scanner] Parsed data:",h),{success:!0,data:h,rawText:x}}catch(qa){console.error("Product tag parsing error:",qa);{const t=qa instanceof Error?qa.message:String(qa);alert(`Scanner Error: ${t}`)}return qa instanceof Error&&"AbortError"===qa.name?{success:!1,error:"Request timed out after 30 seconds. Please try again."}:qa instanceof Error&&qa.message.includes("401")?{success:!1,error:"OpenAI API authentication failed. Please check your API key configuration."}:{success:!1,error:qa instanceof Error?qa.message:"Failed to parse product tag"}}}function ka(){const e=(0,c.useNavigation)(),t=(0,c.useRoute)(),[a,s]=((0,i.useSafeAreaInsets)(),(0,Ba.useCameraPermissions)()),[r,l]=(0,f.useState)("back"),[o,u]=(0,f.useState)(!1),[m,x]=(0,f.useState)(null),[g,h]=(0,f.useState)(!1),[p,b]=(0,f.useState)(0),[y,j]=(0,f.useState)(!1),N=((0,f.useRef)(null),(0,f.useRef)(!1)),{onDataScanned:w}=t.params;(0,f.useEffect)(()=>{N.current||S()},[]);const S=async()=>{if(N.current)console.log("[Scanner] Already processing (ref check), skipping camera launch");else if(g||y)console.log("[Scanner] Already processing or completed, skipping camera launch");else{N.current=!0,j(!0),h(!0);try{console.log("[Scanner] Launching camera...");const t=await _t.launchCameraAsync({mediaTypes:["images"],allowsEditing:!1,quality:.7,exif:!0,base64:!0});if(t.canceled)return console.log("[Scanner] User canceled camera"),N.current=!1,j(!1),h(!1),void e.goBack();const a=t.assets[0];if(a?.uri){console.log("[Scanner] Photo captured:",a.uri),console.log("[Scanner] Has base64:",!!a.base64),x(a.uri),console.log("[Scanner] Parsing product tag...");const t=a.base64?`data:image/jpeg;base64,${a.base64}`:a.uri;console.log("[Scanner] Using image data type:",a.base64?"base64":"uri");const s=await Da(t);h(!1),s.success&&s.data?(console.log("[Scanner] Successfully parsed data:",s.data),w(s.data),N.current=!1,e.goBack()):(console.log("[Scanner] Failed to parse data"),N.current=!1,j(!1),Te.default.alert("No Data Found","Could not extract information from the product tag. Please try again with better lighting or a clearer photo.",[{text:"Retry",onPress:()=>{j(!1),x(null),S()}},{text:"Cancel",onPress:()=>e.goBack()}]))}}catch(qa){console.error("[Scanner] Capture error:",qa),N.current=!1,h(!1),j(!1),Te.default.alert("Error","Failed to capture or process image. Please try again."),e.goBack()}}};return(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#111827"},children:(0,J.jsxs)(n.default,{style:{flex:1,justifyContent:"center",alignItems:"center",padding:32},children:[m&&(0,J.jsx)(Vt.default,{source:{uri:m},style:{width:"100%",height:"50%",borderRadius:12,marginBottom:32,opacity:.5},resizeMode:"contain"}),(0,J.jsx)(q.default,{size:"large",color:"#3b82f6",style:{marginBottom:16}}),(0,J.jsx)(d.default,{style:{color:"#fff",fontSize:18,fontWeight:"600",marginBottom:8},children:m?"Reading Product Tag...":"Opening Camera..."}),(0,J.jsx)(d.default,{style:{color:"#9ca3af",fontSize:14,textAlign:"center"},children:m?"AI is extracting information from the tag":"Please allow camera access when prompted"})]})})}function Ia({onLoginSuccess:e,onRequestAccess:t}){const a=(0,i.useSafeAreaInsets)(),[s,r]=(0,f.useState)(""),[l,c]=(0,f.useState)(""),[u,m]=(0,f.useState)(""),[g,p]=(0,f.useState)(!1),[b,y]=(0,f.useState)(!1),j=G(e=>e.login),N=async()=>{if(s.trim())if(l){p(!0),m("");try{const t=await j(s.trim(),l);t.success?e(t.requiresPasswordChange||!1):(m(t.error||"Login failed. Please try again."),c(""))}catch(t){m("An unexpected error occurred")}finally{p(!1)}}else m("Please enter your password");else m("Please enter your email address")};return(0,J.jsx)(Z.default,{behavior:"height",className:"flex-1 bg-gradient-to-br from-blue-500 to-blue-600",style:{backgroundColor:"#3B82F6"},children:(0,J.jsxs)(n.default,{className:"flex-1 justify-center px-6",style:{paddingTop:a.top,paddingBottom:a.bottom},children:[(0,J.jsxs)(n.default,{className:"items-center mb-8",children:[(0,J.jsx)(n.default,{className:"bg-white rounded-full p-6 shadow-lg",children:(0,J.jsx)(x.default,{name:"construct",size:64,color:"#3B82F6"})}),(0,J.jsx)(d.default,{className:"text-white text-4xl font-bold mb-2 text-center mt-6",children:"Precast Quality Tools"}),(0,J.jsx)(d.default,{className:"text-blue-100 text-base text-center",children:"Sign in to continue"})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-2xl p-6 shadow-2xl",children:[(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3.5 text-base text-gray-900",placeholder:"your@email.com",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:s,onChangeText:e=>{r(e),m("")},keyboardType:"email-address",autoCapitalize:"none",autoCorrect:!1,autoComplete:"email",textContentType:"emailAddress",returnKeyType:"next"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Password"}),(0,J.jsxs)(n.default,{className:"relative",children:[(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3.5 pr-12 text-base text-gray-900",placeholder:"Enter password",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:l,onChangeText:e=>{c(e),m("")},secureTextEntry:!b,autoCapitalize:"none",autoCorrect:!1,autoComplete:"password",textContentType:"password",onSubmitEditing:N,returnKeyType:"go"}),(0,J.jsx)(o.default,{onPress:()=>y(!b),className:"absolute right-4 top-3.5",children:(0,J.jsx)(x.default,{name:b?"eye-off-outline":"eye-outline",size:22,color:"#6B7280"})})]})]}),u?(0,J.jsx)(n.default,{className:"bg-red-50 border border-red-200 rounded-xl p-3 mb-4",children:(0,J.jsx)(d.default,{className:"text-red-700 text-sm",children:u})}):null,(0,J.jsx)(o.default,{onPress:N,disabled:g,className:"bg-blue-500 rounded-xl py-4 items-center active:bg-blue-600 mb-3",style:{opacity:g?.6:1},children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:g?"Signing in...":"Sign In"})}),(0,J.jsx)(o.default,{onPress:t,className:"py-2 items-center active:opacity-70",children:(0,J.jsx)(d.default,{className:"text-blue-600 text-sm font-medium",children:"Request Access"})})]}),(0,J.jsx)(d.default,{className:"text-blue-100 text-xs mt-8 text-center",children:"For authorized use only"})]})})}function La({onBack:e,onSuccess:t}){const a=(0,i.useSafeAreaInsets)(),[s,r]=(0,f.useState)(""),[l,c]=(0,f.useState)(""),[u,m]=(0,f.useState)(""),[p,b]=(0,f.useState)(""),[y,j]=(0,f.useState)(""),[N,w]=(0,f.useState)(!1),S=G(e=>e.requestAccess),F=async()=>{if(s.trim())if(l.trim())if(u.trim())if(p.trim())if((e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(p.trim())){w(!0),j("");try{const e=await S({firstName:s.trim(),lastName:l.trim(),company:u.trim(),email:p.trim().toLowerCase()});e.success?t():j(e.error||"Failed to submit request. Please try again.")}catch(e){j("An unexpected error occurred")}finally{w(!1)}}else j("Please enter a valid email address");else j("Please enter your email address");else j("Please enter your company name");else j("Please enter your last name");else j("Please enter your first name")};return(0,J.jsx)(Z.default,{behavior:"height",className:"flex-1 bg-gradient-to-br from-blue-500 to-blue-600",style:{backgroundColor:"#3B82F6"},children:(0,J.jsxs)(n.default,{className:"flex-1",style:{paddingTop:a.top,paddingBottom:a.bottom},children:[(0,J.jsx)(n.default,{className:"px-6 py-4",children:(0,J.jsxs)(o.default,{onPress:e,className:"flex-row items-center active:opacity-70",children:[(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#FFFFFF"}),(0,J.jsx)(d.default,{className:"text-white text-base font-medium ml-2",children:"Back to Login"})]})}),(0,J.jsxs)(g.default,{className:"flex-1 px-6",contentContainerStyle:{paddingBottom:40},keyboardShouldPersistTaps:"handled",children:[(0,J.jsxs)(n.default,{className:"items-center mb-8 mt-4",children:[(0,J.jsx)(n.default,{className:"bg-white rounded-full p-6 shadow-lg",children:(0,J.jsx)(x.default,{name:"person-add",size:48,color:"#3B82F6"})}),(0,J.jsx)(d.default,{className:"text-white text-3xl font-bold mb-2 text-center mt-6",children:"Request Access"}),(0,J.jsx)(d.default,{className:"text-blue-100 text-base text-center",children:"Fill out the form to request access to Precast Quality Tools"})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-2xl p-6 shadow-2xl",children:[(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"First Name"}),(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3.5 text-base text-gray-900",placeholder:"John",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:s,onChangeText:e=>{r(e),j("")},autoCapitalize:"words",autoCorrect:!1,returnKeyType:"next"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Last Name"}),(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3.5 text-base text-gray-900",placeholder:"Doe",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:l,onChangeText:e=>{c(e),j("")},autoCapitalize:"words",autoCorrect:!1,returnKeyType:"next"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Company"}),(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3.5 text-base text-gray-900",placeholder:"Acme Precast Inc.",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:u,onChangeText:e=>{m(e),j("")},autoCapitalize:"words",autoCorrect:!1,returnKeyType:"next"})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3.5 text-base text-gray-900",placeholder:"your@email.com",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:p,onChangeText:e=>{b(e),j("")},keyboardType:"email-address",autoCapitalize:"none",autoCorrect:!1,onSubmitEditing:F,returnKeyType:"go"})]}),y?(0,J.jsx)(n.default,{className:"bg-red-50 border border-red-200 rounded-xl p-3 mb-4",children:(0,J.jsx)(d.default,{className:"text-red-700 text-sm",children:y})}):null,(0,J.jsx)(n.default,{className:"bg-blue-50 border border-blue-200 rounded-xl p-3 mb-4",children:(0,J.jsx)(d.default,{className:"text-blue-700 text-sm",children:"An admin will review your request and send login credentials to your email if approved."})}),(0,J.jsx)(o.default,{onPress:F,disabled:N,className:"bg-blue-500 rounded-xl py-4 items-center active:bg-blue-600",style:{opacity:N?.6:1},children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:N?"Submitting...":"Submit Request"})})]})]})]})})}function Ra(e){const t=/[A-Z]/.test(e),a=/[a-z]/.test(e),s=/[0-9]/.test(e),r=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),l=[];return t||l.push("Password must contain at least one uppercase letter"),a||l.push("Password must contain at least one lowercase letter"),s||l.push("Password must contain at least one number"),r||l.push("Password must contain at least one special character"),{isValid:0===l.length,errors:l,hasUpper:t,hasLower:a,hasNumber:s,hasSpecial:r}}function $a({onBack:e}){const t=(0,i.useSafeAreaInsets)(),[a,s]=(0,f.useState)([]),[r,l]=(0,f.useState)(!0),[c,u]=(0,f.useState)(null),[m,h]=(0,f.useState)(""),[p,b]=(0,f.useState)(!1),[y,j]=(0,f.useState)(!1),[N,w]=(0,f.useState)(!1),S=G(e=>e.getPendingRequests),F=G(e=>e.approveRequest),C=G(e=>e.denyRequest);(0,f.useEffect)(()=>{v()},[]);const v=async()=>{l(!0);const e=await S();s(e),l(!1)},A=e=>{u(e);const t=function(){const e="ABCDEFGHJKLMNPQRSTUVWXYZ",t="abcdefghijkmnopqrstuvwxyz",a="23456789",s="!@#$%^&*",r=[e[Math.floor(24*Math.random())],t[Math.floor(25*Math.random())],a[Math.floor(8*Math.random())],s[Math.floor(8*Math.random())]],l=e+t+a+s;for(let o=0;o<4;o++)r.push(l[Math.floor(65*Math.random())]);return r.sort(()=>Math.random()-.5).join("")}();h(t),b(!0)};return(0,J.jsxs)(n.default,{className:"flex-1 bg-white",style:{paddingTop:t.top},children:[(0,J.jsxs)(n.default,{className:"px-6 py-4 border-b border-gray-200",children:[(0,J.jsxs)(o.default,{onPress:e,className:"flex-row items-center mb-3 active:opacity-70",children:[(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#111827"}),(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-medium ml-2",children:"Back"})]}),(0,J.jsx)(d.default,{className:"text-gray-900 text-2xl font-bold",children:"Access Requests"}),(0,J.jsx)(d.default,{className:"text-gray-600 text-sm mt-1",children:"Review and approve pending access requests"})]}),r?(0,J.jsx)(n.default,{className:"flex-1 items-center justify-center",children:(0,J.jsx)(q.default,{size:"large",color:"#3B82F6"})}):0===a.length?(0,J.jsxs)(n.default,{className:"flex-1 items-center justify-center px-6",children:[(0,J.jsx)(n.default,{className:"bg-gray-100 rounded-full p-6 mb-4",children:(0,J.jsx)(x.default,{name:"checkmark-circle",size:64,color:"#10B981"})}),(0,J.jsx)(d.default,{className:"text-gray-900 text-xl font-semibold mb-2",children:"All Caught Up!"}),(0,J.jsx)(d.default,{className:"text-gray-600 text-base text-center",children:"There are no pending access requests at this time."})]}):(0,J.jsx)(g.default,{className:"flex-1 px-6 py-4",children:a.map(e=>{return(0,J.jsxs)(n.default,{className:"bg-white border border-gray-200 rounded-2xl p-4 mb-4 shadow-sm",children:[(0,J.jsxs)(n.default,{className:"flex-row items-start mb-3",children:[(0,J.jsx)(n.default,{className:"bg-blue-100 rounded-full p-3 mr-3",children:(0,J.jsx)(x.default,{name:"person",size:24,color:"#3B82F6"})}),(0,J.jsxs)(n.default,{className:"flex-1",children:[(0,J.jsxs)(d.default,{className:"text-gray-900 text-lg font-semibold",children:[e.firstName," ",e.lastName]}),(0,J.jsx)(d.default,{className:"text-gray-600 text-sm",children:e.email})]})]}),(0,J.jsxs)(n.default,{className:"bg-gray-50 rounded-xl p-3 mb-3",children:[(0,J.jsx)(d.default,{className:"text-gray-600 text-xs font-semibold mb-1",children:"COMPANY"}),(0,J.jsx)(d.default,{className:"text-gray-900 text-base",children:e.company})]}),(0,J.jsxs)(d.default,{className:"text-gray-500 text-xs mb-3",children:["Requested ",(t=e.requestedAt,new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}))]}),(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsx)(o.default,{onPress:()=>A(e.id),className:"flex-1 bg-green-500 rounded-xl py-3 items-center active:bg-green-600",children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Approve"})}),(0,J.jsx)(o.default,{onPress:()=>{return t=e.id,u(t),void j(!0);var t},className:"flex-1 bg-red-500 rounded-xl py-3 items-center active:bg-red-600",children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Deny"})})]})]},e.id);var t})}),p&&(0,J.jsx)(Z.default,{behavior:"height",className:"absolute inset-0",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},children:(0,J.jsx)(o.default,{onPress:()=>{N||(sa.default.dismiss(),b(!1))},className:"flex-1",children:(0,J.jsx)(n.default,{className:"flex-1 justify-center px-6",children:(0,J.jsx)(o.default,{onPress:e=>e.stopPropagation(),children:(0,J.jsxs)(n.default,{className:"bg-white rounded-2xl p-6 shadow-2xl",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-xl font-bold mb-4",children:"Approve Access Request"}),(0,J.jsx)(d.default,{className:"text-gray-600 text-sm mb-4",children:"A temporary password has been generated. The user will be required to change it on first login."}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Temporary Password"}),(0,J.jsx)(n.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3.5",children:(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-mono",children:m})})]}),(0,J.jsx)(n.default,{className:"bg-blue-50 border border-blue-200 rounded-xl p-3 mb-4",children:(0,J.jsx)(d.default,{className:"text-blue-700 text-xs",children:"The user will receive an email with their temporary password."})}),(0,J.jsxs)(n.default,{className:"flex-row gap-3",children:[(0,J.jsx)(o.default,{onPress:()=>{N||b(!1)},disabled:N,className:"flex-1 bg-gray-200 rounded-xl py-3 items-center active:bg-gray-300",style:{opacity:N?.5:1},children:(0,J.jsx)(d.default,{className:"text-gray-900 text-base font-semibold",children:"Cancel"})}),(0,J.jsx)(o.default,{onPress:async()=>{if(c){w(!0);try{await F(c,m),b(!1),u(null),h(""),v()}catch(e){}finally{w(!1)}}},disabled:N,className:"flex-1 bg-green-500 rounded-xl py-3 items-center active:bg-green-600",style:{opacity:N?.6:1},children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:N?"Approving...":"Confirm"})})]})]})})})})}),(0,J.jsx)(ve,{visible:y,title:"Deny Access Request",message:"Are you sure you want to deny this access request? This action cannot be undone.",confirmText:"Deny",cancelText:"Cancel",onConfirm:async()=>{if(c){w(!0);try{await C(c),j(!1),u(null),v()}catch(e){}finally{w(!1)}}},onCancel:()=>j(!1),confirmStyle:"destructive"})]})}function Wa({onSuccess:e}){const t=(0,i.useSafeAreaInsets)(),[a,s]=(0,f.useState)(""),[r,l]=(0,f.useState)(""),[c,u]=(0,f.useState)(!1),[m,p]=(0,f.useState)(!1),[b,y]=(0,f.useState)(""),[j,N]=(0,f.useState)(!1),w=G(e=>e.currentUser),S=G(e=>e.changePassword),F=async()=>{if(!a)return void y("Please enter a new password");if(!r)return void y("Please confirm your password");if(a!==r)return void y("Passwords do not match");const t=Ra(a);if(t.isValid){N(!0),y("");try{const t=await S(a);t.success?e():y(t.error||"Failed to change password")}catch(s){y("An unexpected error occurred")}finally{N(!1)}}else y(t.errors[0])},C=Ra(a);return(0,J.jsx)(Z.default,{behavior:"height",className:"flex-1 bg-white",children:(0,J.jsx)(n.default,{className:"flex-1",style:{paddingTop:t.top,paddingBottom:t.bottom},children:(0,J.jsxs)(g.default,{className:"flex-1 px-6",contentContainerStyle:{paddingTop:40,paddingBottom:40},keyboardShouldPersistTaps:"handled",children:[(0,J.jsxs)(n.default,{className:"items-center mb-8",children:[(0,J.jsx)(n.default,{className:"bg-blue-100 rounded-full p-6 mb-4",children:(0,J.jsx)(x.default,{name:"lock-closed",size:48,color:"#3B82F6"})}),(0,J.jsx)(d.default,{className:"text-gray-900 text-3xl font-bold mb-2 text-center",children:"Change Password"}),(0,J.jsxs)(d.default,{className:"text-gray-600 text-base text-center",children:["Welcome, ",w?.firstName,"! Please set a new password to continue."]})]}),(0,J.jsxs)(n.default,{className:"bg-blue-50 border border-blue-200 rounded-2xl p-4 mb-6",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-sm font-semibold mb-3",children:"Password Requirements:"}),(0,J.jsxs)(n.default,{className:"space-y-2",children:[(0,J.jsxs)(n.default,{className:"flex-row items-center mb-2",children:[(0,J.jsx)(x.default,{name:C.hasUpper?"checkmark-circle":"ellipse-outline",size:20,color:C.hasUpper?"#10B981":"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-gray-700 text-sm ml-2",style:{color:C.hasUpper?"#10B981":"#6B7280"},children:"At least one uppercase letter"})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center mb-2",children:[(0,J.jsx)(x.default,{name:C.hasLower?"checkmark-circle":"ellipse-outline",size:20,color:C.hasLower?"#10B981":"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-gray-700 text-sm ml-2",style:{color:C.hasLower?"#10B981":"#6B7280"},children:"At least one lowercase letter"})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center mb-2",children:[(0,J.jsx)(x.default,{name:C.hasNumber?"checkmark-circle":"ellipse-outline",size:20,color:C.hasNumber?"#10B981":"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-gray-700 text-sm ml-2",style:{color:C.hasNumber?"#10B981":"#6B7280"},children:"At least one number"})]}),(0,J.jsxs)(n.default,{className:"flex-row items-center",children:[(0,J.jsx)(x.default,{name:C.hasSpecial?"checkmark-circle":"ellipse-outline",size:20,color:C.hasSpecial?"#10B981":"#9CA3AF"}),(0,J.jsx)(d.default,{className:"text-gray-700 text-sm ml-2",style:{color:C.hasSpecial?"#10B981":"#6B7280"},children:"At least one special character"})]})]})]}),(0,J.jsxs)(n.default,{className:"bg-white rounded-2xl",children:[(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"New Password"}),(0,J.jsxs)(n.default,{className:"relative",children:[(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3.5 pr-12 text-base text-gray-900",placeholder:"Enter new password",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:a,onChangeText:e=>{s(e),y("")},secureTextEntry:!c,autoCapitalize:"none",autoCorrect:!1,autoComplete:"password-new",textContentType:"newPassword",returnKeyType:"next"}),(0,J.jsx)(o.default,{onPress:()=>u(!c),className:"absolute right-4 top-3.5",children:(0,J.jsx)(x.default,{name:c?"eye-off-outline":"eye-outline",size:22,color:"#6B7280"})})]})]}),(0,J.jsxs)(n.default,{className:"mb-4",children:[(0,J.jsx)(d.default,{className:"text-sm font-semibold text-gray-700 mb-2",children:"Confirm Password"}),(0,J.jsxs)(n.default,{className:"relative",children:[(0,J.jsx)(h.default,{className:"bg-gray-50 border border-gray-300 rounded-xl px-4 py-3.5 pr-12 text-base text-gray-900",placeholder:"Re-enter new password",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",value:r,onChangeText:e=>{l(e),y("")},secureTextEntry:!m,autoCapitalize:"none",autoCorrect:!1,autoComplete:"password-new",textContentType:"newPassword",onSubmitEditing:F,returnKeyType:"go"}),(0,J.jsx)(o.default,{onPress:()=>p(!m),className:"absolute right-4 top-3.5",children:(0,J.jsx)(x.default,{name:m?"eye-off-outline":"eye-outline",size:22,color:"#6B7280"})})]})]}),b?(0,J.jsx)(n.default,{className:"bg-red-50 border border-red-200 rounded-xl p-3 mb-4",children:(0,J.jsx)(d.default,{className:"text-red-700 text-sm",children:b})}):null,(0,J.jsx)(o.default,{onPress:F,disabled:j,className:"bg-blue-500 rounded-xl py-4 items-center active:bg-blue-600",style:{opacity:j?.6:1},children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:j?"Changing Password...":"Change Password"})})]})]})})})}const Oa=(0,y.create)()((0,O.persist)((e,t)=>({yardLocations:[],yardedPieces:[],addYardLocation:t=>{const a=`location-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,s=Object.assign({},t,{id:a});return e(e=>({yardLocations:[...e.yardLocations,s]})),a},updateYardLocation:(t,a)=>{e(e=>({yardLocations:e.yardLocations.map(e=>e.id===t?Object.assign({},e,a):e)}))},deleteYardLocation:t=>{e(e=>({yardLocations:e.yardLocations.filter(e=>e.id!==t)}))},getYardLocation:e=>t().yardLocations.find(t=>t.id===e),getAllActiveYardLocations:()=>t().yardLocations.filter(e=>e.isActive).sort((e,t)=>e.name.localeCompare(t.name)),addYardedPiece:t=>{const a=`yarded-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,s=Object.assign({},t,{id:a,createdAt:Date.now(),updatedAt:Date.now()});return e(e=>({yardedPieces:[...e.yardedPieces,s]})),a},updateYardedPiece:(t,a)=>{e(e=>({yardedPieces:e.yardedPieces.map(e=>e.id===t?Object.assign({},e,a,{updatedAt:Date.now()}):e)}))},deleteYardedPiece:t=>{e(e=>({yardedPieces:e.yardedPieces.filter(e=>e.id!==t)}))},getYardedPiece:e=>t().yardedPieces.find(t=>t.id===e),getYardedPieceByPourEntryId:e=>t().yardedPieces.find(t=>t.pourEntryId===e),getYardedPiecesByLocation:e=>t().yardedPieces.filter(t=>t.yardLocationId===e&&!t.isShipped).sort((e,t)=>t.yardedDate-e.yardedDate),getYardedPiecesByDepartment:e=>t().yardedPieces.filter(t=>t.department===e&&!t.isShipped).sort((e,t)=>t.yardedDate-e.yardedDate),getYardedPiecesByJobNumber:e=>t().yardedPieces.filter(t=>t.jobNumber===e).sort((e,t)=>t.yardedDate-e.yardedDate),searchYardedPieces:e=>{let a=t().yardedPieces;if(e.includeShipped||(a=a.filter(e=>!e.isShipped)),e.department&&(a=a.filter(t=>t.department===e.department)),e.jobNumber){const t=e.jobNumber.toLowerCase();a=a.filter(e=>e.jobNumber.toLowerCase().includes(t)||e.jobName?.toLowerCase().includes(t))}return e.craneBay&&(a=a.filter(a=>{const s=t().getYardLocation(a.yardLocationId);return s?.craneBay===e.craneBay})),e.dateRange&&(a=a.filter(t=>t.pourDate>=e.dateRange.start&&t.pourDate<=e.dateRange.end)),a.sort((e,t)=>t.yardedDate-e.yardedDate)},markAsShipped:(t,a)=>{e(e=>({yardedPieces:e.yardedPieces.map(e=>e.id===t?Object.assign({},e,{isShipped:!0,shippedDate:Date.now(),shippedBy:a,updatedAt:Date.now()}):e)}))},markAsUnshipped:t=>{e(e=>({yardedPieces:e.yardedPieces.map(e=>e.id===t?Object.assign({},e,{isShipped:!1,shippedDate:void 0,shippedBy:void 0,updatedAt:Date.now()}):e)}))},clearAllData:()=>{e({yardLocations:[],yardedPieces:[]})},initializeDefaultLocations:()=>{const e=t();if(0===e.yardLocations.length){["Crane Bay 1","Crane Bay 2","Crane Bay 3"].forEach(t=>{e.addYardLocation({name:t,craneBay:t,isActive:!0})})}}}),{name:"yard-location-storage",storage:(0,O.createJSONStorage)(()=>F.default)}));function Ma({navigation:e}){const t=Oa(e=>e.yardedPieces),a=Oa(e=>e.initializeDefaultLocations);(0,f.useEffect)(()=>{a()},[]);return(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:(0,J.jsx)(g.default,{style:{flex:1},children:(0,J.jsxs)(n.default,{style:{padding:16},children:[(0,J.jsxs)(n.default,{style:{marginBottom:20},children:[(0,J.jsx)(d.default,{style:{fontSize:28,fontWeight:"700",color:"#111827",marginBottom:4},children:"Yard Maps"}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280"},children:"Track and locate yarded pieces by department"})]}),(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:16,padding:20,marginBottom:24,borderWidth:2,borderColor:"#E5E7EB",borderStyle:"dashed",minHeight:200,alignItems:"center",justifyContent:"center"},children:[(0,J.jsx)(x.default,{name:"map-outline",size:64,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#6B7280",marginTop:12},children:"General Yard Map"}),(0,J.jsx)(d.default,{style:{fontSize:13,color:"#9CA3AF",marginTop:4,textAlign:"center"},children:"Visual yard map coming soon"})]}),(0,J.jsxs)(n.default,{style:{marginBottom:16},children:[(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827",marginBottom:12},children:"Select Yarding Department"}),(0,J.jsx)(n.default,{style:{gap:10},children:["Precast","Extruded","Wall Panels","Flexicore"].map(a=>{const s=(e=>{switch(e){case"Precast":return{bg:"#EFF6FF",color:"#1E40AF",accent:"#3B82F6"};case"Extruded":return{bg:"#F0FDF4",color:"#166534",accent:"#10B981"};case"Wall Panels":return{bg:"#FEF3C7",color:"#92400E",accent:"#F59E0B"};case"Flexicore":return{bg:"#FCE7F3",color:"#831843",accent:"#EC4899"}}})(a),r=(e=>{const a=t.filter(t=>t.department===e&&!t.isShipped);return{totalPieces:a.length,uniqueJobs:new Set(a.map(e=>e.jobNumber)).size}})(a);return(0,J.jsx)(o.default,{onPress:()=>e.navigate("YardDepartment",{department:a}),style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:16,borderWidth:1.5,borderColor:"#E5E7EB",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:1},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:8},children:[(0,J.jsx)(n.default,{style:{backgroundColor:s.bg,padding:8,borderRadius:8,marginRight:12},children:(0,J.jsx)(x.default,{name:"cube",size:24,color:s.accent})}),(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"700",color:s.color},children:a})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:16,marginLeft:48},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:11,color:"#6B7280",marginBottom:2},children:"Pieces in Yard"}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:s.accent},children:r.totalPieces})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:11,color:"#6B7280",marginBottom:2},children:"Active Jobs"}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#111827"},children:r.uniqueJobs})]})]})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:24,color:s.accent})]})},a)})})]}),(0,J.jsxs)(n.default,{style:{marginTop:8},children:[(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827",marginBottom:12},children:"Quick Actions"}),(0,J.jsx)(n.default,{style:{gap:10},children:(0,J.jsxs)(o.default,{onPress:()=>e.navigate("YardSearch"),style:{backgroundColor:"#3B82F6",borderRadius:12,padding:16,flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,J.jsx)(x.default,{name:"search",size:24,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#FFFFFF",marginLeft:12},children:"Search Yard"})]}),(0,J.jsx)(x.default,{name:"chevron-forward",size:20,color:"#FFFFFF"})]})})]})]})})})}function Ua({navigation:e,route:t}){const{department:a}=t.params,[s,r]=(0,f.useState)(Date.now()),[l,i]=(0,f.useState)(!1),[c,u]=(0,f.useState)(""),[m,b]=(0,f.useState)(""),y=Ca(e=>e.getPourEntriesByDate),j=Oa(e=>e.getYardedPieceByPourEntryId),N=(e=>{switch(e){case"Precast":return{bg:"#EFF6FF",color:"#1E40AF",accent:"#3B82F6"};case"Extruded":return{bg:"#F0FDF4",color:"#166534",accent:"#10B981"};case"Wall Panels":return{bg:"#FEF3C7",color:"#92400E",accent:"#F59E0B"};case"Flexicore":return{bg:"#FCE7F3",color:"#831843",accent:"#EC4899"}}})(a),w=e=>{const t=new Date(s);t.setDate(t.getDate()+e),r(t.getTime())},S=()=>{const e=new Date;e.setHours(0,0,0,0);const t=new Date(s);t.setHours(0,0,0,0);const a=t.getTime()-e.getTime(),r=Math.round(a/864e5);return 0===r?"Today":-1===r?"Yesterday":1===r?"Tomorrow":null},F=e=>{const t=new Date;t.setHours(0,0,0,0),t.setDate(t.getDate()+e),r(t.getTime()),i(!1)},C=y(s,a),v=m.trim()?C.filter(e=>e.jobNumber.toLowerCase().includes(m.toLowerCase())||e.jobName?.toLowerCase().includes(m.toLowerCase())||e.idNumber?.toLowerCase().includes(m.toLowerCase())||e.markNumbers?.toLowerCase().includes(m.toLowerCase())):C,A=v.reduce((e,t)=>(e[t.formBedId]||(e[t.formBedId]={formBedName:t.formBedName,entries:[]}),e[t.formBedId].entries.push(t),e),{});return(0,J.jsxs)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:[(0,J.jsx)(g.default,{style:{flex:1},children:(0,J.jsxs)(n.default,{style:{padding:16},children:[(0,J.jsx)(n.default,{style:{marginBottom:16},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:8},children:[(0,J.jsx)(n.default,{style:{backgroundColor:N.bg,padding:10,borderRadius:10,marginRight:12},children:(0,J.jsx)(x.default,{name:"cube",size:28,color:N.accent})}),(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:24,fontWeight:"700",color:N.color},children:a}),(0,J.jsx)(d.default,{style:{fontSize:13,color:"#6B7280"},children:"Select pieces to assign yard locations"})]})]})}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:16,backgroundColor:"#FFFFFF",borderRadius:10,padding:12,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(o.default,{onPress:()=>w(-1),style:{padding:4},children:(0,J.jsx)(x.default,{name:"chevron-back",size:22,color:"#111827"})}),(0,J.jsxs)(n.default,{style:{alignItems:"center"},children:[(0,J.jsx)(o.default,{onPress:()=>{const e=new Date(s),t=`${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")}/${e.getFullYear()}`;u(t),i(!0)},children:(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:"#111827"},children:new Date(s).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})}),S()&&(0,J.jsx)(o.default,{onPress:()=>r(Date.now()),children:(0,J.jsx)(d.default,{style:{fontSize:11,color:N.accent,fontWeight:"500"},children:S()})})]}),(0,J.jsx)(o.default,{onPress:()=>w(1),style:{padding:4},children:(0,J.jsx)(x.default,{name:"chevron-forward",size:22,color:"#111827"})})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFFFFF",borderRadius:10,padding:12,borderWidth:1,borderColor:"#E5E7EB",marginBottom:16},children:[(0,J.jsx)(x.default,{name:"search",size:20,color:"#6B7280"}),(0,J.jsx)(h.default,{value:m,onChangeText:b,placeholder:"Search by job, ID, or mark number...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{flex:1,marginLeft:8,fontSize:14,color:"#111827"}}),m.length>0&&(0,J.jsx)(o.default,{onPress:()=>b(""),children:(0,J.jsx)(x.default,{name:"close-circle",size:20,color:"#6B7280"})})]}),0===v.length?(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:32,alignItems:"center"},children:[(0,J.jsx)(x.default,{name:"calendar-outline",size:48,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:"#6B7280",marginTop:12},children:m.trim()?"No pieces found":"No pieces scheduled"}),(0,J.jsx)(d.default,{style:{fontSize:13,color:"#9CA3AF",marginTop:4,textAlign:"center"},children:m.trim()?"Try a different search term":"Select a different date to view scheduled pieces"})]}):(0,J.jsx)(n.default,{style:{gap:12},children:Object.entries(A).map(([t,{formBedName:s,entries:r}])=>(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:12,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:12,paddingBottom:8,borderBottomWidth:1,borderBottomColor:"#F3F4F6"},children:[(0,J.jsx)(x.default,{name:"layers-outline",size:20,color:N.accent}),(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:N.color,marginLeft:8,flex:1},children:s}),(0,J.jsx)(n.default,{style:{backgroundColor:N.bg,paddingHorizontal:10,paddingVertical:4,borderRadius:6},children:(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:N.color},children:r.length})})]}),(0,J.jsx)(n.default,{style:{gap:8},children:r.map(t=>{const s=!!j(t.id);return(0,J.jsx)(o.default,{onPress:()=>e.navigate("YardProductSelection",{pourEntryId:t.id,department:a}),style:{backgroundColor:s?"#F0FDF4":"#F9FAFB",borderRadius:8,padding:12,borderWidth:1,borderColor:s?"#10B981":"#E5E7EB"},children:(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:4},children:[(0,J.jsxs)(d.default,{style:{fontSize:15,fontWeight:"600",color:"#111827"},children:["#",t.jobNumber]}),s&&(0,J.jsx)(n.default,{style:{backgroundColor:"#10B981",paddingHorizontal:6,paddingVertical:2,borderRadius:4,marginLeft:8},children:(0,J.jsx)(d.default,{style:{fontSize:10,fontWeight:"600",color:"#FFFFFF"},children:"YARDED"})})]}),t.jobName&&(0,J.jsx)(d.default,{style:{fontSize:13,color:"#374151",marginBottom:4},children:t.jobName}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",flexWrap:"wrap",gap:8},children:[t.idNumber&&(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#6B7280"},children:["ID: ",t.idNumber]}),t.markNumbers&&(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:t.markNumbers}),t.dimensions&&(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:t.dimensions})]})]}),(0,J.jsx)(x.default,{name:s?"checkmark-circle":"chevron-forward",size:24,color:s?"#10B981":N.accent})]})},t.id)})})]},t))})]})}),(0,J.jsx)(p.default,{visible:l,animationType:"slide",transparent:!0,children:(0,J.jsx)(n.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},children:(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:24,padding:24,width:"85%",maxWidth:400},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"600",color:"#111827"},children:"Select Date"}),(0,J.jsx)(o.default,{onPress:()=>i(!1),children:(0,J.jsx)(x.default,{name:"close",size:24,color:"#6B7280"})})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:8,marginBottom:20},children:[(0,J.jsx)(o.default,{onPress:()=>F(-1),style:{flex:1,backgroundColor:"#F3F4F6",borderRadius:8,padding:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151"},children:"Yesterday"})}),(0,J.jsx)(o.default,{onPress:()=>F(0),style:{flex:1,backgroundColor:N.accent,borderRadius:8,padding:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#FFFFFF"},children:"Today"})}),(0,J.jsx)(o.default,{onPress:()=>F(1),style:{flex:1,backgroundColor:"#F3F4F6",borderRadius:8,padding:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#374151"},children:"Tomorrow"})})]}),(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Or enter a date:"}),(0,J.jsx)(h.default,{value:c,onChangeText:u,placeholder:"MM/DD/YYYY",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",keyboardType:"numbers-and-punctuation",style:{backgroundColor:"#F9FAFB",borderWidth:1,borderColor:"#D1D5DB",borderRadius:8,padding:12,fontSize:16,color:"#111827",marginBottom:20}}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:12},children:[(0,J.jsx)(o.default,{onPress:()=>i(!1),style:{flex:1,backgroundColor:"#F3F4F6",borderRadius:8,padding:14,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:"#374151"},children:"Cancel"})}),(0,J.jsx)(o.default,{onPress:()=>{const e=c.split("/");if(3!==e.length)return;const t=parseInt(e[0])-1,a=parseInt(e[1]),s=parseInt(e[2]);if(isNaN(t)||isNaN(a)||isNaN(s)||t<0||t>11||a<1||a>31||s<1900||s>2100)return;const l=new Date(s,t,a);r(l.getTime()),i(!1)},style:{flex:1,backgroundColor:N.accent,borderRadius:8,padding:14,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:"#FFFFFF"},children:"Go to Date"})})]})]})})})]})}function Ha({navigation:e,route:t}){const{pourEntryId:a,department:s}=t.params,r=(0,i.useSafeAreaInsets)(),l=G(e=>e.currentUser),c=Ca(e=>e.getPourEntry),u=Oa(e=>e.yardLocations),m=Oa(e=>e.addYardLocation),p=Oa(e=>e.addYardedPiece),b=Oa(e=>e.updateYardedPiece),y=Oa(e=>e.getYardedPieceByPourEntryId),j=c(a),N=y(a),[w,S]=(0,f.useState)(N?.yardLocationId||""),[F,C]=(0,f.useState)(""),[v,A]=(0,f.useState)(""),[P,T]=(0,f.useState)(""),[E,z]=(0,f.useState)(N?.notes||""),[B,D]=(0,f.useState)(!1);if((0,f.useEffect)(()=>{N&&(S(N.yardLocationId),z(N.notes||""))},[N]),!j)return(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:(0,J.jsxs)(n.default,{style:{flex:1,alignItems:"center",justifyContent:"center",padding:20},children:[(0,J.jsx)(x.default,{name:"alert-circle-outline",size:64,color:"#EF4444"}),(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827",marginTop:16},children:"Piece Not Found"}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:8,textAlign:"center"},children:"The piece you're trying to yard could not be found."}),(0,J.jsx)(o.default,{onPress:()=>e.goBack(),style:{backgroundColor:"#3B82F6",borderRadius:10,paddingHorizontal:24,paddingVertical:12,marginTop:20},children:(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:15,fontWeight:"600"},children:"Go Back"})})]})});const k=u.filter(e=>e.isActive).sort((e,t)=>e.name.localeCompare(t.name));return(0,J.jsxs)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:[(0,J.jsx)(g.default,{style:{flex:1},children:(0,J.jsxs)(n.default,{style:{padding:16},children:[(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:16,marginBottom:20,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280",marginBottom:8},children:"ASSIGNING TO YARD"}),(0,J.jsxs)(d.default,{style:{fontSize:20,fontWeight:"700",color:"#111827",marginBottom:8},children:["Job #",j.jobNumber]}),j.jobName&&(0,J.jsx)(d.default,{style:{fontSize:15,color:"#374151",marginBottom:8},children:j.jobName}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",flexWrap:"wrap",gap:8},children:[j.idNumber&&(0,J.jsx)(n.default,{style:{backgroundColor:"#F3F4F6",paddingHorizontal:10,paddingVertical:4,borderRadius:6},children:(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#6B7280"},children:["ID: ",j.idNumber]})}),j.markNumbers&&(0,J.jsx)(n.default,{style:{backgroundColor:"#F3F4F6",paddingHorizontal:10,paddingVertical:4,borderRadius:6},children:(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:j.markNumbers})}),j.dimensions&&(0,J.jsx)(n.default,{style:{backgroundColor:"#F3F4F6",paddingHorizontal:10,paddingVertical:4,borderRadius:6},children:(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:j.dimensions})}),(0,J.jsx)(n.default,{style:{backgroundColor:"#EFF6FF",paddingHorizontal:10,paddingVertical:4,borderRadius:6},children:(0,J.jsx)(d.default,{style:{fontSize:12,color:"#3B82F6",fontWeight:"600"},children:j.formBedName})})]})]}),(0,J.jsxs)(n.default,{style:{marginBottom:20},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,J.jsx)(d.default,{style:{fontSize:18,fontWeight:"600",color:"#111827"},children:"Select Yard Location"}),(0,J.jsxs)(o.default,{onPress:()=>D(!B),style:{backgroundColor:B?"#F3F4F6":"#3B82F6",borderRadius:8,paddingHorizontal:12,paddingVertical:6,flexDirection:"row",alignItems:"center"},children:[(0,J.jsx)(x.default,{name:B?"close":"add",size:18,color:B?"#6B7280":"#FFFFFF"}),(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:B?"#6B7280":"#FFFFFF",marginLeft:4},children:B?"Cancel":"Add New"})]})]}),B&&(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:16,marginBottom:12,borderWidth:1,borderColor:"#3B82F6"},children:[(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Crane Bay *"}),(0,J.jsx)(h.default,{value:F,onChangeText:C,placeholder:"e.g., Crane Bay 1",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:8,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB",marginBottom:12}}),(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Row"}),(0,J.jsx)(h.default,{value:v,onChangeText:A,placeholder:"e.g., 38",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:8,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB",marginBottom:12}}),(0,J.jsx)(d.default,{style:{fontSize:14,fontWeight:"600",color:"#374151",marginBottom:8},children:"Position"}),(0,J.jsx)(h.default,{value:P,onChangeText:T,placeholder:"e.g., A",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",style:{backgroundColor:"#F9FAFB",borderRadius:8,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB",marginBottom:12}}),(0,J.jsx)(o.default,{onPress:()=>{if(!F.trim())return void Te.default.alert("Error","Crane Bay is required");const e=[F.trim(),v.trim()?`Row ${v.trim()}`:"",P.trim()?`Pos ${P.trim()}`:""].filter(Boolean).join(", "),t=m({name:e,craneBay:F.trim(),row:v.trim()||void 0,position:P.trim()||void 0,isActive:!0});S(t),D(!1),C(""),A(""),T("")},style:{backgroundColor:"#3B82F6",borderRadius:8,padding:12,alignItems:"center"},children:(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:14,fontWeight:"600"},children:"Add Location"})})]}),0===k.length?(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:20,alignItems:"center"},children:[(0,J.jsx)(x.default,{name:"location-outline",size:40,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:14,color:"#6B7280",marginTop:8},children:"No yard locations available"}),(0,J.jsx)(d.default,{style:{fontSize:12,color:"#9CA3AF",marginTop:4},children:"Add a new location above"})]}):(0,J.jsx)(n.default,{style:{gap:8},children:k.map(e=>(0,J.jsxs)(o.default,{onPress:()=>S(e.id),style:{backgroundColor:w===e.id?"#EFF6FF":"#FFFFFF",borderRadius:10,padding:14,borderWidth:2,borderColor:w===e.id?"#3B82F6":"#E5E7EB",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsx)(d.default,{style:{fontSize:15,fontWeight:"600",color:w===e.id?"#1E40AF":"#111827"},children:e.name}),e.notes&&(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280",marginTop:2},children:e.notes})]}),w===e.id&&(0,J.jsx)(x.default,{name:"checkmark-circle",size:24,color:"#3B82F6"})]},e.id))})]}),(0,J.jsxs)(n.default,{style:{marginBottom:20},children:[(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#111827",marginBottom:8},children:"Notes (Optional)"}),(0,J.jsx)(h.default,{value:E,onChangeText:z,placeholder:"Add any notes about this piece...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",multiline:!0,numberOfLines:3,textAlignVertical:"top",style:{backgroundColor:"#FFFFFF",borderRadius:10,padding:12,fontSize:14,color:"#111827",borderWidth:1,borderColor:"#E5E7EB",minHeight:80}})]})]})}),(0,J.jsx)(n.default,{style:{padding:16,paddingBottom:r.bottom+16,backgroundColor:"#FFFFFF",borderTopWidth:1,borderTopColor:"#E5E7EB"},children:(0,J.jsxs)(o.default,{onPress:()=>{if(!w)return void Te.default.alert("Error","Please select a yard location");if(!l)return void Te.default.alert("Error","You must be logged in");u.find(e=>e.id===w)?N?(b(N.id,{yardLocationId:w,notes:E.trim()||void 0}),Te.default.alert("Success","Yard location updated successfully",[{text:"OK",onPress:()=>e.goBack()}])):(p({pourEntryId:j.id,yardLocationId:w,jobNumber:j.jobNumber,jobName:j.jobName,idNumber:j.idNumber,markNumbers:j.markNumbers,department:j.department,formBedName:j.formBedName,productType:j.productType,dimensions:j.dimensions,yardedDate:Date.now(),yardedBy:l.email,pourDate:j.scheduledDate,isShipped:!1,notes:E.trim()||void 0}),Te.default.alert("Success","Piece assigned to yard location",[{text:"OK",onPress:()=>e.goBack()}])):Te.default.alert("Error","Selected location not found")},style:{backgroundColor:"#10B981",borderRadius:12,padding:16,alignItems:"center",flexDirection:"row",justifyContent:"center"},children:[(0,J.jsx)(x.default,{name:"checkmark-circle",size:24,color:"#FFFFFF"}),(0,J.jsx)(d.default,{style:{color:"#FFFFFF",fontSize:16,fontWeight:"600",marginLeft:8},children:N?"Update Yard Location":"Assign to Yard"})]})})]})}function Va({navigation:e}){const[t,a]=(0,f.useState)(""),[s,r]=(0,f.useState)(null),l=Oa(e=>e.yardedPieces),i=Oa(e=>e.getYardLocation),c=e=>{switch(e){case"Precast":return{bg:"#EFF6FF",color:"#1E40AF",accent:"#3B82F6"};case"Extruded":return{bg:"#F0FDF4",color:"#166534",accent:"#10B981"};case"Wall Panels":return{bg:"#FEF3C7",color:"#92400E",accent:"#F59E0B"};case"Flexicore":return{bg:"#FCE7F3",color:"#831843",accent:"#EC4899"}}},u=l.filter(e=>{if(e.isShipped)return!1;const a=!s||e.department===s;if(!t.trim())return a;const r=t.toLowerCase();return a&&(e.jobNumber.toLowerCase().includes(r)||e.jobName?.toLowerCase().includes(r)||e.idNumber?.toLowerCase().includes(r)||e.markNumbers?.toLowerCase().includes(r))});return(0,J.jsx)(ea.SafeAreaView,{style:{flex:1,backgroundColor:"#F9FAFB"},children:(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(n.default,{style:{backgroundColor:"#FFFFFF",padding:16,borderBottomWidth:1,borderBottomColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:12},children:[(0,J.jsx)(o.default,{onPress:()=>e.goBack(),style:{marginRight:12},children:(0,J.jsx)(x.default,{name:"arrow-back",size:24,color:"#111827"})}),(0,J.jsx)(d.default,{style:{fontSize:20,fontWeight:"700",color:"#111827"},children:"Search Yard"})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",backgroundColor:"#F3F4F6",borderRadius:10,padding:12},children:[(0,J.jsx)(x.default,{name:"search",size:20,color:"#6B7280"}),(0,J.jsx)(h.default,{value:t,onChangeText:a,placeholder:"Search by job number, ID, or mark...",placeholderTextColor:"#9CA3AF",cursorColor:"#000000",autoFocus:!0,style:{flex:1,marginLeft:8,fontSize:15,color:"#111827"}}),t.length>0&&(0,J.jsx)(o.default,{onPress:()=>a(""),children:(0,J.jsx)(x.default,{name:"close-circle",size:20,color:"#6B7280"})})]}),(0,J.jsxs)(g.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:{marginTop:12},contentContainerStyle:{gap:8},children:[(0,J.jsx)(o.default,{onPress:()=>r(null),style:{backgroundColor:null===s?"#3B82F6":"#FFFFFF",paddingHorizontal:16,paddingVertical:8,borderRadius:20,borderWidth:1,borderColor:null===s?"#3B82F6":"#E5E7EB"},children:(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:null===s?"#FFFFFF":"#6B7280"},children:"All"})}),["Precast","Extruded","Wall Panels","Flexicore"].map(e=>{const t=c(e),a=s===e;return(0,J.jsx)(o.default,{onPress:()=>r(e),style:{backgroundColor:a?t.accent:"#FFFFFF",paddingHorizontal:16,paddingVertical:8,borderRadius:20,borderWidth:1,borderColor:a?t.accent:"#E5E7EB"},children:(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:a?"#FFFFFF":"#6B7280"},children:e})},e)})]}),(0,J.jsxs)(d.default,{style:{fontSize:13,color:"#6B7280",marginTop:12},children:[u.length," ",1===u.length?"piece":"pieces"," found"]})]}),(0,J.jsx)(g.default,{style:{flex:1},children:0===u.length?(0,J.jsxs)(n.default,{style:{alignItems:"center",justifyContent:"center",padding:32,marginTop:40},children:[(0,J.jsx)(x.default,{name:"search-outline",size:64,color:"#9CA3AF"}),(0,J.jsx)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#6B7280",marginTop:16},children:t.trim()?"No pieces found":"No pieces in yard"}),(0,J.jsx)(d.default,{style:{fontSize:13,color:"#9CA3AF",marginTop:4,textAlign:"center"},children:t.trim()?"Try a different search term":"Start by assigning pieces to yard locations"})]}):(0,J.jsx)(n.default,{style:{padding:16,gap:10},children:u.map(t=>{const a=i(t.yardLocationId),s=c(t.department);return(0,J.jsxs)(o.default,{onPress:()=>e.navigate("YardProductSelection",{pourEntryId:t.pourEntryId,department:t.department}),style:{backgroundColor:"#FFFFFF",borderRadius:12,padding:14,borderWidth:1,borderColor:"#E5E7EB"},children:[(0,J.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},children:[(0,J.jsxs)(n.default,{style:{flex:1},children:[(0,J.jsxs)(d.default,{style:{fontSize:16,fontWeight:"600",color:"#111827",marginBottom:4},children:["Job #",t.jobNumber]}),t.jobName&&(0,J.jsx)(d.default,{style:{fontSize:14,color:"#374151",marginBottom:4},children:t.jobName})]}),(0,J.jsx)(n.default,{style:{backgroundColor:s.bg,paddingHorizontal:10,paddingVertical:4,borderRadius:6,height:28},children:(0,J.jsx)(d.default,{style:{fontSize:12,fontWeight:"600",color:s.color},children:t.department})})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",flexWrap:"wrap",gap:8,marginBottom:10},children:[t.idNumber&&(0,J.jsxs)(d.default,{style:{fontSize:12,color:"#6B7280"},children:["ID: ",t.idNumber]}),t.markNumbers&&(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:t.markNumbers}),t.dimensions&&(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:t.dimensions})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",backgroundColor:"#F0FDF4",paddingHorizontal:10,paddingVertical:8,borderRadius:8},children:[(0,J.jsx)(x.default,{name:"location",size:16,color:"#10B981"}),(0,J.jsx)(d.default,{style:{fontSize:13,fontWeight:"600",color:"#166534",marginLeft:6,flex:1},children:a?.name||"Unknown Location"}),(0,J.jsx)(x.default,{name:"chevron-forward",size:18,color:"#10B981"})]}),(0,J.jsxs)(n.default,{style:{flexDirection:"row",gap:16,marginTop:8},children:[(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:10,color:"#9CA3AF",marginBottom:2},children:"Poured"}),(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:new Date(t.pourDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),(0,J.jsxs)(n.default,{children:[(0,J.jsx)(d.default,{style:{fontSize:10,color:"#9CA3AF",marginBottom:2},children:"Yarded"}),(0,J.jsx)(d.default,{style:{fontSize:12,color:"#6B7280"},children:new Date(t.yardedDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]})]})]},t.id)})})})]})})}const Ga=(0,m.createNativeStackNavigator)();if(s.default.ignoreLogs(["Expo AV has been deprecated","Disconnected from Metro"]),"undefined"!==typeof a.g.TextDecoder){const e=a.g.TextDecoder;class t extends e{isLatin1=!1;constructor(e,t){const a=e?.toLowerCase().replace(/[-_]/g,"")||"utf8";"latin1"===a||"iso88591"===a?(super("utf-8",t),this.isLatin1=!0):(super(e,t),this.isLatin1=!1)}decode(e,t){if(this.isLatin1&&e){const t=new Uint8Array(e instanceof ArrayBuffer?e:e.buffer);let a="";for(let e=0;e<t.length;e++)a+=String.fromCharCode(t[e]);return a}return super.decode(e,t)}}a.g.TextDecoder=t}(0,r.default)(function(){const e=G(e=>e.currentUser),t=G(e=>e.initializeAuth),a=ft(e=>e.initialize),s=le(e=>e.initialize),r=ne(e=>e.initialize),m=D(e=>e.initialize),g=L(e=>e.initialize),h=fe(e=>e.initialize),p=W(e=>e.initialize),[b,y]=(0,f.useState)("login"),[j,N]=(0,f.useState)(!0);(0,f.useEffect)(()=>{(async()=>{await t(),N(!1)})()},[]),(0,f.useEffect)(()=>{if(e&&"approved"===e.status){(async()=>{await Promise.all([a(),s(),r(),m(),g(),h(),p()])})()}},[e]);const w=e=>{e&&y("changePassword")},S=()=>{},F=()=>{y("requestSuccess")};return j?null:e?e.isTemporaryPassword?(0,J.jsx)(u.GestureHandlerRootView,{className:"flex-1",children:(0,J.jsxs)(i.SafeAreaProvider,{children:[(0,J.jsx)(Wa,{onSuccess:S}),(0,J.jsx)(l.StatusBar,{style:"auto"})]})}):(0,J.jsx)(u.GestureHandlerRootView,{className:"flex-1",children:(0,J.jsx)(i.SafeAreaProvider,{children:(0,J.jsxs)(c.NavigationContainer,{children:[(0,J.jsxs)(Ga.Navigator,{initialRouteName:"Dashboard",screenOptions:{headerStyle:{backgroundColor:"#FFFFFF"},headerTintColor:"#111827",headerTitleStyle:{fontWeight:"600"},headerShadowVisible:!1},children:[(0,J.jsx)(Ga.Screen,{name:"Dashboard",component:K,options:{title:"Precast Quality Tools",headerShown:!0}}),(0,J.jsx)(Ga.Screen,{name:"Calculator",component:he,options:({navigation:e})=>({title:"Camber Calculator",headerRight:()=>(0,J.jsxs)(n.default,{className:"flex-row gap-3 mr-1",children:[(0,J.jsx)(o.default,{onPress:()=>e.navigate("StrandPatterns"),children:(0,J.jsx)(x.default,{name:"albums-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("History"),children:(0,J.jsx)(x.default,{name:"time-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})]})})}),(0,J.jsx)(Ga.Screen,{name:"Results",component:Ne,options:({navigation:e})=>({title:"Results",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"History",component:Pe,options:({navigation:e})=>({title:"History",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"StrandPatterns",component:Be,options:({navigation:e})=>({title:"Strand Patterns",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"ProductDetails",component:Ie,options:({navigation:e})=>({title:"Product Details",headerRight:()=>(0,J.jsxs)(n.default,{className:"flex-row gap-3 mr-1",children:[(0,J.jsx)(o.default,{onPress:()=>e.navigate("StrandPatterns"),children:(0,J.jsx)(x.default,{name:"albums-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("SlippageHistory"),children:(0,J.jsx)(x.default,{name:"time-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})]})})}),(0,J.jsx)(Ga.Screen,{name:"SlippageIdentifier",component:Ue,options:({navigation:e})=>({title:"Slippage Identifier",headerRight:()=>(0,J.jsxs)(n.default,{className:"flex-row gap-3 mr-1",children:[(0,J.jsx)(o.default,{onPress:()=>e.navigate("SlippageHistory"),children:(0,J.jsx)(x.default,{name:"time-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})]})})}),(0,J.jsx)(Ga.Screen,{name:"SlippageSummary",component:tt,options:({navigation:e})=>({title:"Slippage Summary",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"SlippageHistory",component:st,options:({navigation:e})=>({title:"Slippage History",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"EmailComposer",component:it,options:{title:"Send Email Report",presentation:"modal"}}),(0,J.jsx)(Ga.Screen,{name:"StressingCalculator",component:gt,options:({navigation:e})=>({title:"Stressing Calculator",headerRight:()=>(0,J.jsxs)(n.default,{className:"flex-row gap-3 mr-1",children:[(0,J.jsx)(o.default,{onPress:()=>e.navigate("StrandLibrary"),children:(0,J.jsx)(x.default,{name:"library-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})]})})}),(0,J.jsx)(Ga.Screen,{name:"StressingResults",component:bt,options:({navigation:e})=>({title:"Elongation Results",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"StrandLibrary",component:yt,options:({navigation:e})=>({title:"Strand Library",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"AggregateGradation",component:Ft,options:({navigation:e})=>({title:"Aggregate Gradation",headerRight:()=>(0,J.jsxs)(n.default,{className:"flex-row gap-3 mr-1",children:[(0,J.jsx)(o.default,{onPress:()=>e.navigate("GradationAdmin"),children:(0,J.jsx)(x.default,{name:"settings-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("GradationHistory"),children:(0,J.jsx)(x.default,{name:"time-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})]})})}),(0,J.jsx)(Ga.Screen,{name:"GradationTest",component:Ct,options:({navigation:e,route:t})=>({title:`Test: ${t.params?.aggregateName||"Gradation"}`,headerRight:()=>(0,J.jsxs)(n.default,{className:"flex-row gap-3 mr-1",children:[(0,J.jsx)(o.default,{onPress:()=>e.navigate("GradationAdmin"),children:(0,J.jsx)(x.default,{name:"settings-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("GradationHistory"),children:(0,J.jsx)(x.default,{name:"time-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})]})})}),(0,J.jsx)(Ga.Screen,{name:"GradationResults",component:Pt,options:({navigation:e})=>({title:"Test Results",headerRight:()=>(0,J.jsxs)(n.default,{className:"flex-row gap-3 mr-1",children:[(0,J.jsx)(o.default,{onPress:()=>e.navigate("GradationAdmin"),children:(0,J.jsx)(x.default,{name:"settings-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("GradationHistory"),children:(0,J.jsx)(x.default,{name:"time-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})]})})}),(0,J.jsx)(Ga.Screen,{name:"GradationHistory",component:Tt,options:({navigation:e})=>({title:"Test Repository",headerRight:()=>(0,J.jsxs)(n.default,{className:"flex-row gap-3 mr-1",children:[(0,J.jsx)(o.default,{onPress:()=>e.navigate("GradationAdmin"),children:(0,J.jsx)(x.default,{name:"settings-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})]})})}),(0,J.jsx)(Ga.Screen,{name:"GradationAdmin",component:Et,options:({navigation:e})=>({title:"Aggregate Configuration",headerRight:()=>(0,J.jsxs)(n.default,{className:"flex-row gap-3 mr-1",children:[(0,J.jsx)(o.default,{onPress:()=>e.navigate("GradationHistory"),children:(0,J.jsx)(x.default,{name:"time-outline",size:24,color:"#111827"})}),(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})]})})}),(0,J.jsx)(Ga.Screen,{name:"GradationAddEditAggregate",component:zt,options:{title:"Configure Aggregate"}}),(0,J.jsx)(Ga.Screen,{name:"AggregateLibrary",component:Bt,options:({navigation:e})=>({title:"Aggregate Library",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"AggregateLibraryDetail",component:Dt,options:({navigation:e})=>({title:"Aggregate Details",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"AggregateLibraryAddEdit",component:Mt,options:({route:e})=>({title:e.params?.aggregateId?"Edit Aggregate":"Add Aggregate"})}),(0,J.jsx)(Ga.Screen,{name:"AdmixLibrary",component:Ut,options:({navigation:e})=>({title:"Admix Library",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"AdmixLibraryDetail",component:Gt,options:({navigation:e})=>({title:"Admixture Details",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"AdmixLibraryAddEdit",component:Qt,options:({route:e})=>({title:e.params?.admixId?"Edit Admixture":"Add Admixture"})}),(0,J.jsx)(Ga.Screen,{name:"Contacts",component:Xt,options:({navigation:e})=>({title:"Contacts",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"ContactDetail",component:Kt,options:({navigation:e})=>({title:"Contact Details",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),className:"mr-1",children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"ContactAddEdit",component:Zt,options:({route:e})=>({title:e.params?.contactId?"Edit Contact":"Add Contact"})}),(0,J.jsx)(Ga.Screen,{name:"QualityLogDashboard",component:aa,options:({navigation:e})=>({title:"Quality Logs",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),style:{marginRight:4},children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"QualityLogList",component:ra,options:({navigation:e,route:t})=>({title:`${t.params?.department} Logs`,headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),style:{marginRight:4},children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"QualityLogDetail",component:la,options:({navigation:e})=>({title:"Log Details",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),style:{marginRight:4},children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"QualityLogAddEdit",component:oa,options:({route:e})=>({title:e.params?.logId?"Edit Log Entry":"New Log Entry"})}),(0,J.jsx)(Ga.Screen,{name:"QualityLogMetrics",component:na,options:({navigation:e})=>({title:"Quality Metrics",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),style:{marginRight:4},children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"QualityLogSearch",component:da,options:{headerShown:!1}}),(0,J.jsx)(Ga.Screen,{name:"IssueCodeLibrary",component:ia,options:({navigation:e})=>({title:"Issue Code Library",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),style:{marginRight:4},children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"ProductLibrary",component:ca,options:({navigation:e})=>({title:"Product Library",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),style:{marginRight:4},children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"ProjectLibrary",component:ua,options:{headerShown:!1}}),(0,J.jsx)(Ga.Screen,{name:"ProjectLibraryDetail",component:ma,options:{headerShown:!1}}),(0,J.jsx)(Ga.Screen,{name:"ProjectLibraryAddEdit",component:ga,options:{headerShown:!1}}),(0,J.jsx)(Ga.Screen,{name:"ProjectLibraryExportImport",component:ha,options:{headerShown:!1}}),(0,J.jsx)(Ga.Screen,{name:"DailyPourSchedule",component:Pa,options:({navigation:e})=>({title:"Daily Pour Schedule",headerBackVisible:!0,headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),style:{marginRight:4},children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"ScheduleSearch",component:Ta,options:{headerShown:!1}}),(0,J.jsx)(Ga.Screen,{name:"ScheduleScanner",component:Ea,options:{headerShown:!1,presentation:"fullScreenModal"}}),(0,J.jsx)(Ga.Screen,{name:"ScheduleReview",component:za,options:{presentation:"modal"}}),(0,J.jsx)(Ga.Screen,{name:"ProductTagScanner",component:ka,options:{headerShown:!1,presentation:"fullScreenModal"}}),(0,J.jsx)(Ga.Screen,{name:"YardMap",component:Ma,options:({navigation:e})=>({title:"Yard Maps",headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),style:{marginRight:4},children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"YardDepartment",component:Ua,options:({navigation:e,route:t})=>({title:`${t.params?.department} Yard`,headerRight:()=>(0,J.jsx)(o.default,{onPress:()=>e.navigate("Dashboard"),style:{marginRight:4},children:(0,J.jsx)(x.default,{name:"home-outline",size:24,color:"#111827"})})})}),(0,J.jsx)(Ga.Screen,{name:"YardProductSelection",component:Ha,options:{title:"Assign Yard Location"}}),(0,J.jsx)(Ga.Screen,{name:"YardSearch",component:Va,options:{headerShown:!1}})]}),(0,J.jsx)(l.StatusBar,{style:"auto"})]})})}):(0,J.jsx)(u.GestureHandlerRootView,{className:"flex-1",children:(0,J.jsxs)(i.SafeAreaProvider,{children:["login"===b&&(0,J.jsx)(Ia,{onLoginSuccess:w,onRequestAccess:()=>y("registration")}),"registration"===b&&(0,J.jsx)(La,{onBack:()=>y("login"),onSuccess:F}),"requestSuccess"===b&&(0,J.jsxs)(n.default,{className:"flex-1 items-center justify-center px-6",style:{backgroundColor:"#3B82F6"},children:[(0,J.jsx)(n.default,{className:"bg-white rounded-full p-6 mb-6",children:(0,J.jsx)(x.default,{name:"checkmark-circle",size:64,color:"#10B981"})}),(0,J.jsxs)(n.default,{className:"bg-white rounded-2xl p-6 shadow-2xl max-w-md",children:[(0,J.jsx)(d.default,{className:"text-gray-900 text-2xl font-bold mb-2 text-center",children:"Request Submitted!"}),(0,J.jsx)(d.default,{className:"text-gray-600 text-base text-center mb-6",children:"Your access request has been submitted. An admin will review it and send you login credentials via email if approved."}),(0,J.jsx)(o.default,{onPress:()=>y("login"),className:"bg-blue-500 rounded-xl py-4 items-center active:bg-blue-600",children:(0,J.jsx)(d.default,{className:"text-white text-base font-semibold",children:"Back to Login"})})]})]}),"adminApproval"===b&&(0,J.jsx)($a,{onBack:()=>y("login")}),(0,J.jsx)(l.StatusBar,{style:"light"})]})})})}},t={};function a(s){var r=t[s];if(void 0!==r)return r.exports;var l=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(l.exports,l,l.exports,a),l.loaded=!0,l.exports}a.m=e,(()=>{var e=[];a.O=(t,s,r,l)=>{if(!s){var o=1/0;for(c=0;c<e.length;c++){for(var[s,r,l]=e[c],n=!0,d=0;d<s.length;d++)(!1&l||o>=l)&&Object.keys(a.O).every(e=>a.O[e](s[d]))?s.splice(d--,1):(n=!1,l<o&&(o=l));if(n){e.splice(c--,1);var i=r();void 0!==i&&(t=i)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[s,r,l]}})(),a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;a.t=function(s,r){if(1&r&&(s=this(s)),8&r)return s;if("object"===typeof s&&s){if(4&r&&s.__esModule)return s;if(16&r&&"function"===typeof s.then)return s}var l=Object.create(null);a.r(l);var o={};e=e||[null,t({}),t([]),t(t)];for(var n=2&r&&s;("object"==typeof n||"function"==typeof n)&&!~e.indexOf(n);n=t(n))Object.getOwnPropertyNames(n).forEach(e=>o[e]=()=>s[e]);return o.default=()=>s,a.d(l,o),l}})(),a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((t,s)=>(a.f[s](e,t),t),[])),a.u=e=>"static/js/"+e+"."+{293:"829b2bc3",389:"9b58149d",627:"ad30e811"}[e]+".chunk.js",a.miniCssF=e=>{},a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="web:";a.l=(s,r,l,o)=>{if(e[s])e[s].push(r);else{var n,d;if(void 0!==l)for(var i=document.getElementsByTagName("script"),c=0;c<i.length;c++){var u=i[c];if(u.getAttribute("src")==s||u.getAttribute("data-webpack")==t+l){n=u;break}}n||(d=!0,(n=document.createElement("script")).charset="utf-8",a.nc&&n.setAttribute("nonce",a.nc),n.setAttribute("data-webpack",t+l),n.src=s),e[s]=[r];var m=(t,a)=>{n.onerror=n.onload=null,clearTimeout(x);var r=e[s];if(delete e[s],n.parentNode&&n.parentNode.removeChild(n),r&&r.forEach(e=>e(a)),t)return t(a)},x=setTimeout(m.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=m.bind(null,n.onerror),n.onload=m.bind(null,n.onload),d&&document.head.appendChild(n)}}})(),a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),a.p="/",(()=>{var e={792:0};a.f.j=(t,s)=>{var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)s.push(r[2]);else{var l=new Promise((a,s)=>r=e[t]=[a,s]);s.push(r[2]=l);var o=a.p+a.u(t),n=new Error;a.l(o,s=>{if(a.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var l=s&&("load"===s.type?"missing":s.type),o=s&&s.target&&s.target.src;n.message="Loading chunk "+t+" failed.\n("+l+": "+o+")",n.name="ChunkLoadError",n.type=l,n.request=o,r[1](n)}},"chunk-"+t,t)}},a.O.j=t=>0===e[t];var t=(t,s)=>{var r,l,[o,n,d]=s,i=0;if(o.some(t=>0!==e[t])){for(r in n)a.o(n,r)&&(a.m[r]=n[r]);if(d)var c=d(a)}for(t&&t(s);i<o.length;i++)l=o[i],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(c)},s=self.webpackChunkweb=self.webpackChunkweb||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var s=a.O(void 0,[842],()=>a(68274));s=a.O(s)})();
//# sourceMappingURL=main.9f7f45e2.js.map